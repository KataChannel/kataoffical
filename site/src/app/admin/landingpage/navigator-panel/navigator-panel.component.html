<div class=" navigator-panel-content">
  <ul>
    <ng-container *ngTemplateOutlet="blockListTemplate; context: { blocks: blocks, level: 0 }"></ng-container>
  </ul>
</div>

<ng-template #blockListTemplate let-blockList="blocks" let-level="level">
  @for (block of blockList | sort:'order'; track block) {
    <li
      class="navigator-item level-{{level}}"
      [class.selected]="block.id === editorComponent?.selectedBlock?.id"
      (click)="selectBlock(block, $event)">
      <div class="navigator-item-content">
        <span class="indent" [style.padding-left.px]="level * 15"></span>
        <span class="icon">{{ getBlockIcon(block.type) }}</span>
        <span class="name">{{ getBlockDisplayName(block) }}</span>
      </div>
      @if (block.type === 'container' || block.type === 'section') {
        <ul>
          <ng-container *ngTemplateOutlet="blockListTemplate; context: { blocks: getChildBlocks(block), level: level + 1 }"></ng-container>
          @if (getChildBlocks(block).length === 0) {
            <div class="empty-placeholder-in-nav level-{{level + 1}}">
              <span class="indent" [style.padding-left.px]="(level + 1) * 15"></span>
              <i>(Empty {{ block.type }})</i>
            </div>
          }
        </ul>
      }
      @if (block.type === 'columns' && block.data?.columns?.length > 0) {
        <ul>
          @for (column of block.data.columns; track column; let colIndex = $index) {
            <li class="navigator-item column-node level-{{level + 1}}">
              <div class="navigator-item-content">
                <span class="indent" [style.padding-left.px]="(level + 1) * 15"></span>
                <span class="icon">‚ñç</span>
                <span class="name">Column {{ colIndex + 1 }}</span>
              </div>
              @if (getColumnChildBlocks(column.id).length > 0) {
                <ul>
                  <ng-container *ngTemplateOutlet="blockListTemplate; context: { blocks: getColumnChildBlocks(column.id), level: level + 2 }"></ng-container>
                </ul>
              }
              @if (getColumnChildBlocks(column.id).length === 0) {
                <div class="empty-placeholder-in-nav level-{{level + 2}}">
                  <span class="indent" [style.padding-left.px]="(level + 2) * 15"></span>
                  <i>(Empty)</i>
                </div>
              }
            </li>
          }
        </ul>
      }
    </li>
  }
</ng-template>