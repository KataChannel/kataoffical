@if (data) {
  <div class="block columns-block"
    [ngStyle]="block?.styles"
    [style.display]="'flex'"
    [style.gap]="data.gap || '0px'">
    @for (column of data.columns; track column; let i = $index) {
      <div
        class="column-container"
        [ngStyle]="column.styles"
        cdkDropList
        [id]="column.id"
        [cdkDropListData]="column.blocks"
        [cdkDropListConnectedTo]="editorComponent?.allDropListsIds || []"
        (cdkDropListDropped)="drop($event, column.id)"> <div class="column-content">
        @for (nestedBlock of column.blocks; track nestedBlock) {
          <div
            class="nested-block-wrapper"
            [class.selected]="nestedBlock.id === editorComponent?.selectedBlock?.id"
            (click)="selectNestedBlock(nestedBlock, $event)"
            cdkDrag [cdkDragData]="nestedBlock"> <div class="drag-handle nested-drag-handle" cdkDragHandle>
            <svg width="18px" fill="currentColor" viewBox="0 0 24 24"><path d="M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg>
          </div>
          @switch (nestedBlock.type) {
            @case ('text') {
              <app-text-block [block]="nestedBlock"></app-text-block>
            }
            @case ('image') {
              <app-image-block [block]="nestedBlock"></app-image-block>
            }
            @case ('button') {
              <app-button-block [block]="nestedBlock"></app-button-block>
            }
            @case ('columns') {
              <app-columns-block [block]="nestedBlock"></app-columns-block>
            }
            @default {
              <div class="unknown-block nested">
                Unknown nested block type: {{ nestedBlock.type }}
              </div>
            }
          }
          <div class="block-actions nested-actions">
            <button title="X√≥a" (click)="requestDeleteNestedBlock(nestedBlock.id, $event)">üóëÔ∏è</button>
          </div>
          <div *cdkDragPlaceholder class="block-placeholder nested-placeholder"></div>
        </div>
      }
      @if (column.blocks.length === 0) {
        <div class="empty-column-placeholder">
          Th·∫£ kh·ªëi v√†o ƒë√¢y
        </div>
      }
    </div>
  </div>
}
</div>
}