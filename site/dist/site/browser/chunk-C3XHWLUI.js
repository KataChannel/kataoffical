import{a as kt}from"./chunk-IF57OFVO.js";import{a as It}from"./chunk-TDDRYVX2.js";import{a as Ft,b as Tt}from"./chunk-6TMZITBX.js";import"./chunk-DKYA77CM.js";import"./chunk-NULFSBS2.js";import{b as Mt}from"./chunk-CTXI2QU4.js";import{a as yt,b as Et}from"./chunk-LUV6HXGG.js";import"./chunk-EIYXLBRB.js";import"./chunk-F5X5MWHG.js";import{d as pt,g as _t,h as ht,i as ut,j as dt,l as gt,m as ft,o as Dt,p as xt,r as Ct,s as wt,u as bt,v as St,w as vt}from"./chunk-JDAZ7UOT.js";import"./chunk-TJ2MV7VQ.js";import"./chunk-H7SBU2AA.js";import{h as nt}from"./chunk-QKKJE6ZT.js";import"./chunk-MS4AQ6UA.js";import"./chunk-W5IIUGZ7.js";import{d as ct,e as st}from"./chunk-XSWRQHH7.js";import{b as mt}from"./chunk-7BIMFKJV.js";import{d as lt}from"./chunk-LTETMMPY.js";import"./chunk-KDLSUHPH.js";import"./chunk-GQGNENQ4.js";import{b as X}from"./chunk-KL2CKZHV.js";import"./chunk-7RWCIHFI.js";import"./chunk-OYQAUG4H.js";import"./chunk-GKKZVB6V.js";import{a as j,c as z}from"./chunk-SVGWCZZA.js";import"./chunk-OMMN36AB.js";import"./chunk-FWJ3WEOZ.js";import{d as Y}from"./chunk-TPIVROA7.js";import"./chunk-54PG2AAV.js";import"./chunk-PKTJEQ3B.js";import{a as it,f as at,g as ot,j as rt}from"./chunk-DXHSMTKE.js";import{f as Z,i as tt,m as et}from"./chunk-WC4K2EFE.js";import{a as J,b as Q}from"./chunk-LEPFPKJ2.js";import"./chunk-4VR3POOM.js";import"./chunk-SGYCFQGT.js";import"./chunk-V7JB2Y7H.js";import"./chunk-42FQZPQC.js";import{c as q,f as G,h as U}from"./chunk-LFELKNV5.js";import"./chunk-7DGOHQPD.js";import"./chunk-TMDPBKA7.js";import"./chunk-K2M5JXAW.js";import{l as O,v as H,w as W}from"./chunk-VCJEB5TU.js";import{$b as l,Ab as R,Bc as V,Cc as L,Dc as B,Gb as b,Gc as K,Kc as E,Mc as M,Na as F,Qb as p,Vb as $,Xb as P,Yb as T,Zb as k,_b as o,ac as I,bc as v,bd as N,cc as y,ec as D,ic as d,jc as r,la as f,nb as s,ua as h,va as u,wc as m,xc as C,yc as S}from"./chunk-7U7GNSSJ.js";import"./chunk-EU2KAMEK.js";import{a as A,j as x}from"./chunk-47CWAPKR.js";var Lt=()=>({standalone:!0}),Bt=()=>[],Kt=(n,e)=>e.id;function At(n,e){if(n&1){let t=D();o(0,"button",1),d("click",function(){h(t);let i=r();return u(i.handleDonhangAction())}),o(1,"mat-icon"),m(2,"save"),l()()}}function Rt(n,e){if(n&1){let t=D();o(0,"button",1),d("click",function(){h(t);let i=r();return u(i.toggleEdit())}),o(1,"mat-icon"),m(2,"edit"),l()()}}function $t(n,e){if(n&1){let t=D();v(0),o(1,"div",8)(2,"div",9),m(3,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),l(),o(4,"div",10)(5,"button",11),d("click",function(){h(t);let i=r();return u(i.DeleteData())}),m(6,"\u0110\u1ED3ng \xDD"),l(),o(7,"button",12),d("click",function(){h(t);let i=r();return u(i.toggleDelete())}),m(8,"Hu\u1EF7 B\u1ECF"),l()()(),y()}}function Pt(n,e){if(n&1&&(o(0,"mat-option",22),m(1),l()),n&2){let t=e.$implicit;p("value",t.id),s(),C(t.title)}}function Nt(n,e){if(n&1&&(o(0,"th",32)(1,"span",33),m(2),l()()),n&2){let t=r().$implicit,a=r(2);s(2),S(" ",a.ColumnName[t]," ")}}function Ot(n,e){if(n&1){let t=D();o(0,"span",35)(1,"span"),m(2),l(),o(3,"button",41),d("click",function(){h(t);let i=r().$implicit,c=r(3);return u(c.RemoveSanpham(i))}),o(4,"mat-icon"),m(5,"delete"),l()()()}if(n&2){let t=r().index;s(2),S("",t+1," ")}}function Ht(n,e){if(n&1&&(o(0,"div",36),m(1),l()),n&2){let t=r().$implicit,a=r().$implicit;s(),C(t[a].title)}}function Wt(n,e){if(n&1){let t=D();o(0,"div",42),d("blur",function(i){h(t);let c=r(),w=c.$implicit,g=c.index,_=r(3);return u(_.updateBlurValue(i,g,w,"sldat","number"))}),m(1),E(2,"number"),l()}if(n&2){let t=r().$implicit,a=r().$implicit;p("contentEditable",!0),s(),S(" ",M(2,2,t[a]||0,"1.0-2")," ")}}function jt(n,e){if(n&1&&(o(0,"div",38),m(1),E(2,"number"),l()),n&2){let t=r().$implicit,a=r().$implicit;s(),C(M(2,1,t[a]||0,"1.0-2"))}}function zt(n,e){if(n&1&&(o(0,"div",38),m(1),E(2,"number"),l()),n&2){let t=r().$implicit,a=r().$implicit;s(),C(M(2,1,t[a]||0,"1.0-2"))}}function qt(n,e){if(n&1){let t=D();o(0,"div",43),d("blur",function(i){h(t);let c=r(),w=c.$implicit,g=c.index,_=r(3);return u(_.updateBlurValue(i,g,w,"ghichu","string"))}),m(1),l()}if(n&2){let t=r().$implicit,a=r().$implicit;p("contentEditable",!0),s(),S(" ",t[a]||""," ")}}function Gt(n,e){if(n&1&&(o(0,"span",40),m(1),l()),n&2){let t=r().$implicit,a=r().$implicit;s(),S(" ",t[a]," ")}}function Ut(n,e){if(n&1&&(o(0,"td",34),b(1,Ot,6,1,"span",35)(2,Ht,2,1,"div",36)(3,Wt,3,5,"div",37)(4,jt,3,4,"div",38)(5,zt,3,4,"div",38)(6,qt,2,2,"div",39)(7,Gt,2,1,"span",40),l()),n&2){let t,a=r().$implicit;s(),$((t=a)==="stt"?1:t==="sanpham"?2:t==="sldat"?3:t==="slgiao"?4:t==="slnhan"?5:t==="ghichu"?6:7)}}function Xt(n,e){if(n&1&&(v(0,26),b(1,Nt,3,1,"th",30)(2,Ut,8,1,"td",31),y()),n&2){let t=e.$implicit;p("matColumnDef",t)}}function Jt(n,e){n&1&&I(0,"tr",44)}function Qt(n,e){n&1&&I(0,"tr",45)}function Yt(n,e){n&1&&(o(0,"tr",46)(1,"td",47),m(2,"Kh\xF4ng t\xECm th\u1EA5y"),l()())}function Zt(n,e){if(n&1){let t=D();v(0),o(1,"div",13)(2,"div",3)(3,"mat-form-field",14)(4,"mat-label"),m(5,"Kh\xE1ch H\xE0ng"),l(),o(6,"mat-select",15),B("ngModelChange",function(i){h(t);let c=r();return L(c.DetailDonhang().khachhangId,i)||(c.DetailDonhang().khachhangId=i),u(i)}),o(7,"div",16)(8,"div",17)(9,"input",18),d("input",function(i){h(t);let c=r();return u(c.DoFindKhachhang(i))}),l(),o(10,"div",19)(11,"span",20),m(12,"search"),l()()(),o(13,"div",21),T(14,Pt,2,2,"mat-option",22,Kt),l()()()(),o(16,"app-searchfilter",23),d("OutFilter",function(i){h(t);let c=r();return u(c.onOutFilter(i))}),l()(),o(17,"div",24)(18,"table",25),T(19,Xt,3,1,"ng-container",26,P),b(21,Jt,1,0,"tr",27)(22,Qt,1,0,"tr",28)(23,Yt,3,0,"tr",29),l()()(),y()}if(n&2){let t,a,i=r();s(6),V("ngModel",i.DetailDonhang().khachhangId),p("ngModelOptions",K(12,Lt)),s(8),k(i.FilterKhachhang),s(2),p("ListItem",i.ListSanpham())("CountItems",(t=i.DetailDonhang())==null||t.donhangsanpham==null?null:t.donhangsanpham.length)("fieldsearch","title")("title","S\u1EA3n Ph\u1EA9m")("ListFilter",K(13,Bt))("filterItem",i.ListSanpham())("isEdit",i.isEdit),s(2),p("dataSource",(a=i.DetailDonhang())==null?null:a.donhangsanpham),s(),k(i.displayedColumns),s(2),p("matHeaderRowDef",i.displayedColumns),s(),p("matRowDefColumns",i.displayedColumns)}}var Vt=class n{_ListDonhangComponent=f(Tt);_DonhangService=f(Ft);_KhachhangService=f(kt);_SanphamService=f(It);_route=f(j);_router=f(z);_snackBar=f(X);DetailDonhang=this._DonhangService.DetailDonhang;isEdit=F(!1);isDelete=F(!1);donhangId=this._DonhangService.donhangId;ListKhachhang=this._KhachhangService.ListKhachhang;ListSanpham=this._SanphamService.ListSanpham;FilterKhachhang=[];constructor(){this._route.paramMap.subscribe(e=>{let t=e.get("id");this._DonhangService.setDonhangId(t)}),N(()=>x(this,null,function*(){let e=this._DonhangService.donhangId();yield this._KhachhangService.getAllKhachhang(),yield this._SanphamService.getAllSanpham(),e||(this._router.navigate(["/donhang"]),this._ListDonhangComponent.drawer.close()),e==="new"?(this.DetailDonhang.set({}),this._ListDonhangComponent.drawer.open(),this.isEdit.update(t=>!t),this._router.navigate(["/donhang","new"])):(yield this._DonhangService.getDonhangBy({id:e,isOne:!0}),this._ListDonhangComponent.drawer.open(),this._router.navigate(["/donhang",e]))}))}displayedColumns=[];ColumnName={stt:"#",sanpham:"S\u1EA3n ph\u1EA9m",sldat:"S\u1ED1 l\u01B0\u1EE3ng \u0111\u1EB7t",slgiao:"S\u1ED1 l\u01B0\u1EE3ng giao",slnhan:"S\u1ED1 l\u01B0\u1EE3ng nh\u1EADn",slhuy:"S\u1ED1 l\u01B0\u1EE3ng h\u1EE7y",giaban:"Gi\xE1 b\xE1n"};updateBlurValue(e,t,a,i,c){let w=e.target,g=c==="number"?Number(w.innerText.trim())||0:w.innerText.trim();this.DetailDonhang.update(_=>(t!==null?i==="sldat"?(_.sanpham[t].sldat=g,_.sanpham[t].slgiao=g):i==="slgiao"?g<_.sanpham[t].sldat?(_.sanpham[t].slgiao=_.sanpham[t].sldat,this._snackBar.open("S\u1ED1 l\u01B0\u1EE3ng giao ph\u1EA3i l\u1EDBn h\u01A1n s\u1ED1 l\u01B0\u1EE3ng \u0111\u1EB7t","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})):_.sanpham[t].slgiao=g:_.sanpham[t][i]=g:_[i]=g,_))}RemoveSanpham(e){}ngOnInit(){return x(this,null,function*(){yield this._KhachhangService.getAllKhachhang(),yield this._SanphamService.getAllSanpham(),this.FilterKhachhang=this.ListKhachhang(),this.displayedColumns=Object.keys(this.ColumnName)})}onOutFilter(e){console.log("OutFilter event:",e),this.DetailDonhang.update(t=>{let a=A({},t);return console.log(e),a.donhangsanpham=e.map(i=>({sanphamId:i.id,sanpham:i,sldat:1,slgiao:0,slnhan:0,slhuy:0,giaban:i.giagoc})),a.total=e.reduce((i,c)=>(i=i||0,!c.giagoc||!c.sldat?i:i+c.giagoc*c.sldat),0),console.log("Updated Donhang:",a),a})}DoFindKhachhang(e){let t=e.target.value.toLowerCase();if(!t||t.trim()===""){this.FilterKhachhang=this.ListKhachhang();return}this.FilterKhachhang=this.ListKhachhang().filter(a=>a.title.toLowerCase().includes(t))}handleDonhangAction(){return x(this,null,function*(){this.donhangId()==="new"?yield this.createDonhang():yield this.updateDonhang()})}createDonhang(){return x(this,null,function*(){try{yield this._DonhangService.CreateDonhang(this.DetailDonhang()),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi t\u1EA1o donhang:",e)}})}updateDonhang(){return x(this,null,function*(){try{yield this._DonhangService.updateDonhang(this.DetailDonhang()),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt donhang:",e)}})}DeleteData(){return x(this,null,function*(){try{yield this._DonhangService.DeleteDonhang(this.DetailDonhang()),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["donhang"])}catch(e){console.error("L\u1ED7i khi x\xF3a donhang:",e)}})}goBack(){this._router.navigate(["donhang"]),this._ListDonhangComponent.drawer.close()}trackByFn(e,t){return t.id}toggleEdit(){this.isEdit.update(e=>!e)}toggleDelete(){this.isDelete.update(e=>!e)}FillSlug(){this.DetailDonhang.update(e=>(e.slug=mt(e.title),e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=R({type:n,selectors:[["app-detaildonhang"]],decls:14,vars:8,consts:[[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center"],[3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[4,"ngIf"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"grid","grid-cols-1","gap-4"],["appearance","outline","subscriptSizing","dynamic"],[3,"ngModelChange","ngModel","ngModelOptions"],[1,"w-full","flex","flex-col","p-4","space-y-2"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"input"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"overflow-y-auto","max-h-44"],[3,"value"],[3,"OutFilter","ListItem","CountItems","fieldsearch","title","ListFilter","filterItem","isEdit"],[1,"w-full","overflow-auto"],["mat-table","",1,"!border","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["class","whitespace-nowrap","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"whitespace-nowrap"],[1,"line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-20","line-clamp-4","flex","flex-row","items-center"],[1,""],[1,"sldat-input","p-2","min-w-28","text-end","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"contentEditable"],[1,"text-end"],[1,"ghichu-input","p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"contentEditable"],[1,"max-w-40","line-clamp-4"],["mat-icon-button","","color","warn",3,"click"],[1,"sldat-input","p-2","min-w-28","text-end","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"blur","contentEditable"],[1,"ghichu-input","p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"blur","contentEditable"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,a){if(t&1&&(o(0,"div",0)(1,"button",1),d("click",function(){return a.goBack()}),o(2,"mat-icon"),m(3,"arrow_back"),l()(),o(4,"div",2),m(5),l(),o(6,"div",3)(7,"mat-slide-toggle",4),B("ngModelChange",function(c){return L(a.DetailDonhang().isActive,c)||(a.DetailDonhang().isActive=c),c}),m(8),l(),b(9,At,3,0,"button",5)(10,Rt,3,0,"button",5),l()(),o(11,"div",6),b(12,$t,9,0,"ng-container",7)(13,Zt,24,14,"ng-container",7),l()),t&2){let i;s(5),C(((i=a.DetailDonhang())==null?null:i.title)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),s(2),V("ngModel",a.DetailDonhang().isActive),p("disabled",!a.isEdit()),s(),C(a.DetailDonhang().isActive?"Hi\u1EC3n Th\u1ECB":"\u1EA8n"),s(),p("ngIf",a.isEdit()),s(),p("ngIf",!a.isEdit()),s(2),p("ngIf",a.isDelete()),s(),p("ngIf",!a.isDelete())}},dependencies:[ot,at,it,rt,et,Z,tt,Q,J,U,G,q,st,ct,lt,nt,W,O,H,Et,yt,Y,Mt,vt,ht,dt,xt,gt,ut,Ct,ft,Dt,wt,bt,St,_t,pt],encapsulation:2})};export{Vt as DetailDonhangComponent};
