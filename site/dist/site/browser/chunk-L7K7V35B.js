import{a as oe,b as re}from"./chunk-LTUGMEXB.js";import{a as he}from"./chunk-3KB3UONX.js";import{a as ie,b as ae}from"./chunk-DSEOT5US.js";import"./chunk-X66ZNF5X.js";import"./chunk-TAV3WY2S.js";import"./chunk-KXV7ROFD.js";import"./chunk-F5X5MWHG.js";import"./chunk-CNT5BRLC.js";import"./chunk-FH6ML5RX.js";import{h as Q}from"./chunk-WOSFHDPY.js";import{b as R,c as O,d as z}from"./chunk-P2G6NQFH.js";import"./chunk-MS4AQ6UA.js";import"./chunk-L2ETKM56.js";import{b as te}from"./chunk-45FHGQ3U.js";import"./chunk-DNIPJW6D.js";import"./chunk-54PG2AAV.js";import{b as ne}from"./chunk-7BIMFKJV.js";import"./chunk-PKTJEQ3B.js";import"./chunk-UR6MU37L.js";import"./chunk-4VR3POOM.js";import"./chunk-J4J2VAHN.js";import{b as W}from"./chunk-Z5ZVJLOF.js";import"./chunk-7RWCIHFI.js";import"./chunk-SGYCFQGT.js";import"./chunk-IFEVRPCP.js";import"./chunk-AUWKKKEZ.js";import"./chunk-X4VORVMX.js";import{a as B,d as A,f as P}from"./chunk-HKMQ4GPE.js";import"./chunk-C4PYTK5P.js";import{a as U,f as Y,g as Z,i as $,j as ee}from"./chunk-UEJ6LTLP.js";import{b as G,g as X,j as q,q as J}from"./chunk-LMHWZPEG.js";import"./chunk-J6BPCWMF.js";import"./chunk-W2555ALS.js";import{a as j,b as H}from"./chunk-NOCWUTO7.js";import"./chunk-OYQAUG4H.js";import"./chunk-EHRDPO6Z.js";import"./chunk-6NMWSGWX.js";import{a as V,c as L}from"./chunk-MVHR5SCV.js";import"./chunk-YOJOLIJ5.js";import{k as K,l as F,w as I}from"./chunk-AKORSCP4.js";import{$b as D,Ac as y,Eb as f,La as w,Ob as p,Yb as a,Zb as h,_c as T,ac as b,cc as k,gc as g,hc as u,ka as _,mb as l,sc as C,ta as m,tc as o,ua as s,uc as E,vc as S,yb as M,yc as x,zc as N}from"./chunk-5N4MQVR2.js";import{j as d}from"./chunk-6DNLS54U.js";function le(c,e){if(c&1){let n=k();a(0,"button",3),g("click",function(){m(n);let i=u();return s(i.handleNhomkhachhangAction())}),a(1,"mat-icon"),o(2,"save"),h()()}}function me(c,e){if(c&1){let n=k();a(0,"button",3),g("click",function(){m(n);let i=u();return s(i.toggleEdit())}),a(1,"mat-icon"),o(2,"edit"),h()()}}function se(c,e){if(c&1){let n=k();D(0),a(1,"div",11)(2,"div",12),o(3,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),h(),a(4,"div",13)(5,"button",14),g("click",function(){m(n);let i=u();return s(i.DeleteData())}),o(6,"\u0110\u1ED3ng \xDD"),h(),a(7,"button",15),g("click",function(){m(n);let i=u();return s(i.toggleDelete())}),o(8,"Hu\u1EF7 B\u1ECF"),h()()(),b()}}function ge(c,e){c&1&&(a(0,"span",31),o(1,"check"),h())}function ue(c,e){if(c&1){let n=k();a(0,"div",29),g("click",function(){let i=m(n).$implicit,r=u(2);return s(r.ChosenKhachhang(i))}),f(1,ge,2,0,"span",30),o(2),h()}if(c&2){let n=e.$implicit,t=u(2);l(),p("ngIf",t.CheckKhachhang(n)),l(),S(" ",n.name," ")}}function pe(c,e){if(c&1){let n=k();D(0)(1),a(2,"div",16)(3,"mat-form-field",17)(4,"mat-label"),o(5,"Nh\xF3m Kh\xE1ch h\xE0ng"),h(),a(6,"input",18),y("ngModelChange",function(i){m(n);let r=u();return N(r.DetailNhomkhachhang().name,i)||(r.DetailNhomkhachhang().name=i),s(i)}),g("input",function(){m(n);let i=u();return s(i.FillSlug())}),h()(),a(7,"mat-form-field",17)(8,"mat-label"),o(9,"M\xF4 T\u1EA3"),h(),a(10,"input",19),y("ngModelChange",function(i){m(n);let r=u();return N(r.DetailNhomkhachhang().description,i)||(r.DetailNhomkhachhang().description=i),s(i)}),g("input",function(){m(n);let i=u();return s(i.FillSlug())}),h()(),a(11,"div")(12,"span",20,0),o(14),h(),a(15,"mat-menu",null,1)(17,"div",21),g("click",function(i){return m(n),s(i.stopPropagation())}),a(18,"div",22)(19,"input",23),g("keyup",function(i){m(n);let r=u();return s(r.doFilterKhachhang(i))}),h(),a(20,"div",24)(21,"span",25),o(22,"search"),h()()(),a(23,"div",26),f(24,ue,3,2,"div",27),h(),a(25,"div",28)(26,"button",15),g("click",function(){m(n);let i=C(13);return s(i.closeMenu())}),o(27,"\u0110\xF3ng"),h(),a(28,"button",14),g("click",function(){m(n);let i=C(13),r=u();return s(r.ApplyKhachhang(i))}),o(29,"\xC1p D\u1EE5ng"),h()()()()()(),b()()}if(c&2){let n=C(16),t=u();l(6),x("ngModel",t.DetailNhomkhachhang().name),p("disabled",!t.isEdit()),l(4),x("ngModel",t.DetailNhomkhachhang().description),p("disabled",!t.isEdit()),l(2),p("matMenuTriggerFor",n),l(2),S(" ",t.CheckListKhachhang.length," Kh\xE1ch H\xE0ng "),l(10),p("ngForOf",t.ListKhachhang)("ngForTrackBy",t.trackByFn)}}var ce=class c{_ListnhomkhachhangComponent=_(re);_NhomkhachhangService=_(oe);_KhachhangService=_(he);_route=_(V);_router=_(L);_snackBar=_(W);constructor(){this._route.paramMap.subscribe(e=>{let n=e.get("id");this._NhomkhachhangService.setNhomkhachhangId(n)}),T(()=>d(this,null,function*(){let e=this._NhomkhachhangService.nhomkhachhangId();e||(this._router.navigate(["/admin/nhomkhachhang"]),this._ListnhomkhachhangComponent.drawer.close()),e==="0"?(this.DetailNhomkhachhang.update(()=>({})),this._ListnhomkhachhangComponent.drawer.open(),this.isEdit.update(n=>!n),this._router.navigate(["/admin/nhomkhachhang","0"])):(yield this._NhomkhachhangService.getNhomkhachhangByid(e),yield this._KhachhangService.getAllKhachhang(),this.ListKhachhang=this._KhachhangService.ListKhachhang(),this.CheckListKhachhang=this.DetailNhomkhachhang().khachhang,this._ListnhomkhachhangComponent.drawer.open(),this._router.navigate(["/admin/nhomkhachhang",e]))}))}DetailNhomkhachhang=this._NhomkhachhangService.DetailNhomkhachhang;isEdit=w(!1);isDelete=w(!1);nhomkhachhangId=this._NhomkhachhangService.nhomkhachhangId;ngOnInit(){return d(this,null,function*(){})}handleNhomkhachhangAction(){return d(this,null,function*(){this.nhomkhachhangId()==="0"?yield this.createNhomkhachhang():yield this.updateNhomkhachhang()})}createNhomkhachhang(){return d(this,null,function*(){try{this.DetailNhomkhachhang.update(e=>(delete e.khachhang,e)),yield this._NhomkhachhangService.CreateNhomkhachhang(this.DetailNhomkhachhang()),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi t\u1EA1o nhomkhachhang:",e)}})}updateNhomkhachhang(){return d(this,null,function*(){try{this.DetailNhomkhachhang.update(e=>(delete e.khachhang,e)),yield this._NhomkhachhangService.updateNhomkhachhang(this.DetailNhomkhachhang()),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt nhomkhachhang:",e)}})}DeleteData(){return d(this,null,function*(){try{yield this._NhomkhachhangService.DeleteNhomkhachhang(this.DetailNhomkhachhang()),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["/admin/nhomkhachhang"])}catch(e){console.error("L\u1ED7i khi x\xF3a nhomkhachhang:",e)}})}goBack(){this._router.navigate(["/admin/nhomkhachhang"]),this._ListnhomkhachhangComponent.drawer.close()}trackByFn(e,n){return n.id}toggleEdit(){this.isEdit.update(e=>!e)}toggleDelete(){this.isDelete.update(e=>!e)}FillSlug(){this.DetailNhomkhachhang.update(e=>(e.slug=ne(e.title),e))}ListKhachhang=[];CheckListKhachhang=[];doFilterKhachhang(e){let n=e.target.value;this.ListKhachhang=this._KhachhangService.ListKhachhang().filter(t=>t.name.toLowerCase().includes(n.toLowerCase()))}ChosenKhachhang(e){this.CheckListKhachhang.find(t=>t.id===e.id)?this.CheckListKhachhang=this.CheckListKhachhang.filter(t=>t.id!==e.id):this.CheckListKhachhang.push(e)}ApplyKhachhang(e){return d(this,null,function*(){console.log(this.DetailNhomkhachhang()),console.log(this.CheckListKhachhang);let n={nhomId:this.nhomkhachhangId(),khachhangIds:this.DetailNhomkhachhang().khachhang.map(v=>v.id)},t=yield this._NhomkhachhangService.removeKHfromNhom(n),i={nhomId:this.nhomkhachhangId(),khachhangIds:this.CheckListKhachhang.map(v=>v.id)},r=yield this._NhomkhachhangService.addKHtoNhom(i);Promise.all([t,r]).then(()=>{e.closeMenu()})})}CheckKhachhang(e){return!!this.CheckListKhachhang.find(n=>n.id===e.id)}static \u0275fac=function(n){return new(n||c)};static \u0275cmp=M({type:c,selectors:[["app-detailnhomkhachhang"]],decls:17,vars:8,consts:[["menuTrigger","matMenuTrigger"],["menu","matMenu"],[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center"],[3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","warn",3,"click"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[4,"ngIf"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"w-full","flex","flex-col","space-y-2"],["appearance","outline"],["matInput","","placeholder","Vui l\xF2ng nh\u1EADp Nh\xF3m Kh\xE1ch h\xE0ng",3,"ngModelChange","input","ngModel","disabled"],["matInput","","placeholder","Vui l\xF2ng nh\u1EADp M\xF4 T\u1EA3",3,"ngModelChange","input","ngModel","disabled"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200",3,"matMenuTriggerFor"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],["class","flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"]],template:function(n,t){if(n&1&&(a(0,"div",2)(1,"button",3),g("click",function(){return t.goBack()}),a(2,"mat-icon"),o(3,"arrow_back"),h()(),a(4,"div",4),o(5),h(),a(6,"div",5)(7,"mat-slide-toggle",6),y("ngModelChange",function(r){return N(t.DetailNhomkhachhang().isActive,r)||(t.DetailNhomkhachhang().isActive=r),r}),o(8),h(),f(9,le,3,0,"button",7)(10,me,3,0,"button",7),a(11,"button",8),g("click",function(){return t.toggleDelete()}),a(12,"mat-icon"),o(13,"delete"),h()()()(),a(14,"div",9),f(15,se,9,0,"ng-container",10)(16,pe,30,8,"ng-container",10),h()),n&2){let i;l(5),E(((i=t.DetailNhomkhachhang())==null?null:i.name)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),l(2),x("ngModel",t.DetailNhomkhachhang().isActive),p("disabled",!t.isEdit()),l(),E(t.DetailNhomkhachhang().isActive?"Hi\u1EC3n Th\u1ECB":"\u1EA8n"),l(),p("ngIf",t.isEdit()),l(),p("ngIf",!t.isEdit()),l(5),p("ngIf",t.isDelete()),l(),p("ngIf",!t.isDelete())}},dependencies:[Z,Y,U,ee,$,J,G,X,q,H,j,P,A,B,te,Q,I,K,F,ae,ie,z,R,O],encapsulation:2})};export{ce as DetailNhomkhachhangComponent};
