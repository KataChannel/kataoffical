import{a as It}from"./chunk-7KNXYKZ3.js";import{a as Tt,b as kt}from"./chunk-6ABXFVER.js";import{a as Ft}from"./chunk-TDDRYVX2.js";import"./chunk-DKYA77CM.js";import"./chunk-NULFSBS2.js";import{b as Mt}from"./chunk-CTXI2QU4.js";import{a as yt,b as Et}from"./chunk-LUV6HXGG.js";import"./chunk-EIYXLBRB.js";import"./chunk-F5X5MWHG.js";import{d as pt,g as ut,h as _t,i as dt,j as gt,l as ht,m as ft,o as Dt,p as Ct,r as xt,s as wt,u as bt,v as St,w as vt}from"./chunk-JDAZ7UOT.js";import"./chunk-TJ2MV7VQ.js";import"./chunk-H7SBU2AA.js";import{h as nt}from"./chunk-QKKJE6ZT.js";import"./chunk-MS4AQ6UA.js";import"./chunk-W5IIUGZ7.js";import{d as ct,e as st}from"./chunk-XSWRQHH7.js";import{b as mt}from"./chunk-7BIMFKJV.js";import{d as lt}from"./chunk-LTETMMPY.js";import"./chunk-KDLSUHPH.js";import"./chunk-GQGNENQ4.js";import{b as X}from"./chunk-KL2CKZHV.js";import"./chunk-7RWCIHFI.js";import"./chunk-OYQAUG4H.js";import"./chunk-GKKZVB6V.js";import{a as z,c as K}from"./chunk-SVGWCZZA.js";import"./chunk-OMMN36AB.js";import"./chunk-FWJ3WEOZ.js";import{d as Y}from"./chunk-TPIVROA7.js";import"./chunk-54PG2AAV.js";import"./chunk-PKTJEQ3B.js";import{a as it,f as at,g as ot,j as rt}from"./chunk-DXHSMTKE.js";import{f as Z,i as tt,m as et}from"./chunk-WC4K2EFE.js";import{a as J,b as Q}from"./chunk-LEPFPKJ2.js";import"./chunk-4VR3POOM.js";import"./chunk-SGYCFQGT.js";import"./chunk-V7JB2Y7H.js";import"./chunk-42FQZPQC.js";import{c as q,f as G,h as U}from"./chunk-LFELKNV5.js";import"./chunk-7DGOHQPD.js";import"./chunk-TMDPBKA7.js";import"./chunk-K2M5JXAW.js";import{l as H,v as W,w as j}from"./chunk-VCJEB5TU.js";import{$b as l,Ab as R,Bc as N,Cc as V,Dc as L,Gb as b,Gc as B,Kc as E,Mc as M,Na as F,Qb as p,Vb as $,Xb as P,Yb as T,Zb as k,_b as o,ac as I,bc as v,bd as O,cc as y,ec as D,ic as g,jc as r,la as f,nb as s,ua as _,va as d,wc as m,xc as x,yc as S}from"./chunk-7U7GNSSJ.js";import"./chunk-EU2KAMEK.js";import{a as A,j as C}from"./chunk-47CWAPKR.js";var Vt=()=>({standalone:!0}),Lt=()=>[],Bt=(n,e)=>e.id;function At(n,e){if(n&1){let t=D();o(0,"button",1),g("click",function(){_(t);let i=r();return d(i.handleDathangAction())}),o(1,"mat-icon"),m(2,"save"),l()()}}function Rt(n,e){if(n&1){let t=D();o(0,"button",1),g("click",function(){_(t);let i=r();return d(i.toggleEdit())}),o(1,"mat-icon"),m(2,"edit"),l()()}}function $t(n,e){if(n&1){let t=D();v(0),o(1,"div",8)(2,"div",9),m(3,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),l(),o(4,"div",10)(5,"button",11),g("click",function(){_(t);let i=r();return d(i.DeleteData())}),m(6,"\u0110\u1ED3ng \xDD"),l(),o(7,"button",12),g("click",function(){_(t);let i=r();return d(i.toggleDelete())}),m(8,"Hu\u1EF7 B\u1ECF"),l()()(),y()}}function Pt(n,e){if(n&1&&(o(0,"mat-option",22),m(1),l()),n&2){let t=e.$implicit;p("value",t.id),s(),x(t.title)}}function Ot(n,e){if(n&1&&(o(0,"th",32)(1,"span",33),m(2),l()()),n&2){let t=r().$implicit,a=r(2);s(2),S(" ",a.ColumnName[t]," ")}}function Ht(n,e){if(n&1){let t=D();o(0,"span",35)(1,"span"),m(2),l(),o(3,"button",41),g("click",function(){_(t);let i=r().$implicit,c=r(3);return d(c.RemoveSanpham(i))}),o(4,"mat-icon"),m(5,"delete"),l()()()}if(n&2){let t=r().index;s(2),S("",t+1," ")}}function Wt(n,e){if(n&1&&(o(0,"div",36),m(1),l()),n&2){let t=r().$implicit,a=r().$implicit;s(),x(t[a].title)}}function jt(n,e){if(n&1){let t=D();o(0,"div",42),g("blur",function(i){_(t);let c=r(),w=c.$implicit,h=c.index,u=r(3);return d(u.updateBlurValue(i,h,w,"sldat","number"))}),m(1),E(2,"number"),l()}if(n&2){let t=r().$implicit,a=r().$implicit;p("contentEditable",!0),s(),S(" ",M(2,2,t[a]||0,"1.0-2")," ")}}function zt(n,e){if(n&1&&(o(0,"div",38),m(1),E(2,"number"),l()),n&2){let t=r().$implicit,a=r().$implicit;s(),x(M(2,1,t[a]||0,"1.0-2"))}}function Kt(n,e){if(n&1&&(o(0,"div",38),m(1),E(2,"number"),l()),n&2){let t=r().$implicit,a=r().$implicit;s(),x(M(2,1,t[a]||0,"1.0-2"))}}function qt(n,e){if(n&1){let t=D();o(0,"div",43),g("blur",function(i){_(t);let c=r(),w=c.$implicit,h=c.index,u=r(3);return d(u.updateBlurValue(i,h,w,"ghichu","string"))}),m(1),l()}if(n&2){let t=r().$implicit,a=r().$implicit;p("contentEditable",!0),s(),S(" ",t[a]||""," ")}}function Gt(n,e){if(n&1&&(o(0,"span",40),m(1),l()),n&2){let t=r().$implicit,a=r().$implicit;s(),S(" ",t[a]," ")}}function Ut(n,e){if(n&1&&(o(0,"td",34),b(1,Ht,6,1,"span",35)(2,Wt,2,1,"div",36)(3,jt,3,5,"div",37)(4,zt,3,4,"div",38)(5,Kt,3,4,"div",38)(6,qt,2,2,"div",39)(7,Gt,2,1,"span",40),l()),n&2){let t,a=r().$implicit;s(),$((t=a)==="stt"?1:t==="sanpham"?2:t==="sldat"?3:t==="slgiao"?4:t==="slnhan"?5:t==="ghichu"?6:7)}}function Xt(n,e){if(n&1&&(v(0,26),b(1,Ot,3,1,"th",30)(2,Ut,8,1,"td",31),y()),n&2){let t=e.$implicit;p("matColumnDef",t)}}function Jt(n,e){n&1&&I(0,"tr",44)}function Qt(n,e){n&1&&I(0,"tr",45)}function Yt(n,e){n&1&&(o(0,"tr",46)(1,"td",47),m(2,"Kh\xF4ng t\xECm th\u1EA5y"),l()())}function Zt(n,e){if(n&1){let t=D();v(0),o(1,"div",13)(2,"div",3)(3,"mat-form-field",14)(4,"mat-label"),m(5,"Nh\xE0 Cung C\u1EA5p"),l(),o(6,"mat-select",15),L("ngModelChange",function(i){_(t);let c=r();return V(c.DetailDathang().nhacungcapId,i)||(c.DetailDathang().nhacungcapId=i),d(i)}),o(7,"div",16)(8,"div",17)(9,"input",18),g("input",function(i){_(t);let c=r();return d(c.DoFindNhacungcap(i))}),l(),o(10,"div",19)(11,"span",20),m(12,"search"),l()()(),o(13,"div",21),T(14,Pt,2,2,"mat-option",22,Bt),l()()()(),o(16,"app-searchfilter",23),g("OutFilter",function(i){_(t);let c=r();return d(c.onOutFilter(i))}),l()(),o(17,"div",24)(18,"table",25),T(19,Xt,3,1,"ng-container",26,P),b(21,Jt,1,0,"tr",27)(22,Qt,1,0,"tr",28)(23,Yt,3,0,"tr",29),l()()(),y()}if(n&2){let t,a,i=r();s(6),N("ngModel",i.DetailDathang().nhacungcapId),p("ngModelOptions",B(12,Vt)),s(8),k(i.FilterNhacungcap),s(2),p("ListItem",i.ListSanpham())("CountItems",(t=i.DetailDathang())==null||t.dathangsanpham==null?null:t.dathangsanpham.length)("fieldsearch","title")("title","S\u1EA3n Ph\u1EA9m")("ListFilter",B(13,Lt))("filterItem",i.ListSanpham())("isEdit",i.isEdit),s(2),p("dataSource",(a=i.DetailDathang())==null?null:a.dathangsanpham),s(),k(i.displayedColumns),s(2),p("matHeaderRowDef",i.displayedColumns),s(),p("matRowDefColumns",i.displayedColumns)}}var Nt=class n{_ListDathangComponent=f(kt);_DathangService=f(Tt);_NhacungcapService=f(It);_SanphamService=f(Ft);_route=f(z);_router=f(K);_snackBar=f(X);DetailDathang=this._DathangService.DetailDathang;isEdit=F(!1);isDelete=F(!1);dathangId=this._DathangService.dathangId;ListNhacungcap=this._NhacungcapService.ListNhacungcap;ListSanpham=this._SanphamService.ListSanpham;FilterNhacungcap=[];constructor(){this._route.paramMap.subscribe(e=>{let t=e.get("id");this._DathangService.setDathangId(t)}),O(()=>C(this,null,function*(){let e=this._DathangService.dathangId();yield this._NhacungcapService.getAllNhacungcap(),yield this._SanphamService.getAllSanpham(),e||(this._router.navigate(["/dathang"]),this._ListDathangComponent.drawer.close()),e==="new"?(this.DetailDathang.set({}),this._ListDathangComponent.drawer.open(),this.isEdit.update(t=>!t),this._router.navigate(["/dathang","new"])):(yield this._DathangService.getDathangBy({id:e,isOne:!0}),this._ListDathangComponent.drawer.open(),this._router.navigate(["/dathang",e]))}))}displayedColumns=[];ColumnName={stt:"#",sanpham:"S\u1EA3n ph\u1EA9m",sldat:"S\u1ED1 l\u01B0\u1EE3ng \u0111\u1EB7t",slgiao:"S\u1ED1 l\u01B0\u1EE3ng giao",slnhan:"S\u1ED1 l\u01B0\u1EE3ng nh\u1EADn",slhuy:"S\u1ED1 l\u01B0\u1EE3ng h\u1EE7y",giaban:"Gi\xE1 b\xE1n"};updateBlurValue(e,t,a,i,c){let w=e.target,h=c==="number"?Number(w.innerText.trim())||0:w.innerText.trim();this.DetailDathang.update(u=>(t!==null?i==="sldat"?(u.sanpham[t].sldat=h,u.sanpham[t].slgiao=h):i==="slgiao"?h<u.sanpham[t].sldat?(u.sanpham[t].slgiao=u.sanpham[t].sldat,this._snackBar.open("S\u1ED1 l\u01B0\u1EE3ng giao ph\u1EA3i l\u1EDBn h\u01A1n s\u1ED1 l\u01B0\u1EE3ng \u0111\u1EB7t","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})):u.sanpham[t].slgiao=h:u.sanpham[t][i]=h:u[i]=h,u))}RemoveSanpham(e){}ngOnInit(){return C(this,null,function*(){yield this._NhacungcapService.getAllNhacungcap(),yield this._SanphamService.getAllSanpham(),this.FilterNhacungcap=this.ListNhacungcap(),this.displayedColumns=Object.keys(this.ColumnName)})}onOutFilter(e){console.log("OutFilter event:",e),this.DetailDathang.update(t=>{let a=A({},t);return console.log(e),a.dathangsanpham=e.map(i=>({sanphamId:i.id,sanpham:i,sldat:1,slgiao:0,slnhan:0,slhuy:0,giaban:i.giagoc})),a.total=e.reduce((i,c)=>(i=i||0,!c.giagoc||!c.sldat?i:i+c.giagoc*c.sldat),0),console.log("Updated Dathang:",a),a})}DoFindNhacungcap(e){let t=e.target.value.toLowerCase();if(!t||t.trim()===""){this.FilterNhacungcap=this.ListNhacungcap();return}this.FilterNhacungcap=this.ListNhacungcap().filter(a=>a.title.toLowerCase().includes(t))}handleDathangAction(){return C(this,null,function*(){this.dathangId()==="new"?yield this.createDathang():yield this.updateDathang()})}createDathang(){return C(this,null,function*(){try{yield this._DathangService.CreateDathang(this.DetailDathang()),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi t\u1EA1o dathang:",e)}})}updateDathang(){return C(this,null,function*(){try{yield this._DathangService.updateDathang(this.DetailDathang()),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt dathang:",e)}})}DeleteData(){return C(this,null,function*(){try{yield this._DathangService.DeleteDathang(this.DetailDathang()),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["dathang"])}catch(e){console.error("L\u1ED7i khi x\xF3a dathang:",e)}})}goBack(){this._router.navigate(["dathang"]),this._ListDathangComponent.drawer.close()}trackByFn(e,t){return t.id}toggleEdit(){this.isEdit.update(e=>!e)}toggleDelete(){this.isDelete.update(e=>!e)}FillSlug(){this.DetailDathang.update(e=>(e.slug=mt(e.title),e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=R({type:n,selectors:[["app-detaildathang"]],decls:14,vars:8,consts:[[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center"],[3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[4,"ngIf"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"grid","grid-cols-1","gap-4"],["appearance","outline","subscriptSizing","dynamic"],[3,"ngModelChange","ngModel","ngModelOptions"],[1,"w-full","flex","flex-col","p-4","space-y-2"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"input"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"overflow-y-auto","max-h-44"],[3,"value"],[3,"OutFilter","ListItem","CountItems","fieldsearch","title","ListFilter","filterItem","isEdit"],[1,"w-full","overflow-auto"],["mat-table","",1,"!border","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["class","whitespace-nowrap","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"whitespace-nowrap"],[1,"line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-20","line-clamp-4","flex","flex-row","items-center"],[1,""],[1,"sldat-input","p-2","min-w-28","text-end","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"contentEditable"],[1,"text-end"],[1,"ghichu-input","p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"contentEditable"],[1,"max-w-40","line-clamp-4"],["mat-icon-button","","color","warn",3,"click"],[1,"sldat-input","p-2","min-w-28","text-end","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"blur","contentEditable"],[1,"ghichu-input","p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"blur","contentEditable"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,a){if(t&1&&(o(0,"div",0)(1,"button",1),g("click",function(){return a.goBack()}),o(2,"mat-icon"),m(3,"arrow_back"),l()(),o(4,"div",2),m(5),l(),o(6,"div",3)(7,"mat-slide-toggle",4),L("ngModelChange",function(c){return V(a.DetailDathang().isActive,c)||(a.DetailDathang().isActive=c),c}),m(8),l(),b(9,At,3,0,"button",5)(10,Rt,3,0,"button",5),l()(),o(11,"div",6),b(12,$t,9,0,"ng-container",7)(13,Zt,24,14,"ng-container",7),l()),t&2){let i;s(5),x(((i=a.DetailDathang())==null?null:i.codeId)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),s(2),N("ngModel",a.DetailDathang().isActive),p("disabled",!a.isEdit()),s(),x(a.DetailDathang().isActive?"Hi\u1EC3n Th\u1ECB":"\u1EA8n"),s(),p("ngIf",a.isEdit()),s(),p("ngIf",!a.isEdit()),s(2),p("ngIf",a.isDelete()),s(),p("ngIf",!a.isDelete())}},dependencies:[ot,at,it,rt,et,Z,tt,Q,J,U,G,q,st,ct,lt,nt,j,H,W,Et,yt,Y,Mt,vt,_t,gt,Ct,ht,dt,xt,ft,Dt,wt,bt,St,ut,pt],encapsulation:2})};export{Nt as DetailDathangComponent};
