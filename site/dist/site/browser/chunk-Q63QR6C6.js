import{a as kt}from"./chunk-YTE7GW5F.js";import{a as Ft,b as Tt}from"./chunk-ZTFT6FSF.js";import{a as It}from"./chunk-6UNRWNJZ.js";import"./chunk-NULFSBS2.js";import{b as Mt}from"./chunk-WGRZ7OU3.js";import{a as yt,b as Et}from"./chunk-INAH5Y6A.js";import"./chunk-EIYXLBRB.js";import"./chunk-F5X5MWHG.js";import{d as dt,g as pt,h as ht,i as ut,j as _t,l as gt,m as ft,o as Ct,p as Dt,r as xt,s as wt,u as bt,v as vt,w as St}from"./chunk-6YWI4PR3.js";import"./chunk-AH445ACS.js";import"./chunk-25O4DVGE.js";import"./chunk-MZ2MZ5BK.js";import{h as nt}from"./chunk-BMYJTCCL.js";import"./chunk-V2HNV6GD.js";import"./chunk-MS4AQ6UA.js";import{d as ct,e as st}from"./chunk-O5ADOJKP.js";import{b as mt}from"./chunk-7BIMFKJV.js";import{d as rt}from"./chunk-O6JYMFHC.js";import"./chunk-KDLSUHPH.js";import"./chunk-E3L4RDDQ.js";import{b as X}from"./chunk-BZD55ANN.js";import"./chunk-OYQAUG4H.js";import"./chunk-5LVD2PK4.js";import{a as j,c as z}from"./chunk-YY2IMMDR.js";import"./chunk-6H4HLFRK.js";import"./chunk-BVBYNWHQ.js";import{d as Y}from"./chunk-RT2KEOZH.js";import{a as it,f as at,g as ot,j as lt}from"./chunk-LE5WZP6V.js";import{f as Z,i as tt,m as et}from"./chunk-6ZJGR7X4.js";import{a as J,b as Q}from"./chunk-F3NJGPQK.js";import"./chunk-EEDTNJ2B.js";import"./chunk-JSBH4EGU.js";import{c as q,e as G,f as U}from"./chunk-MDDDUITI.js";import"./chunk-R5QIVXGH.js";import"./chunk-TPO34YLD.js";import"./chunk-UBLFOWKT.js";import{q as N,r as W}from"./chunk-Y5KLSAKG.js";import{Ac as K,Ec as y,Gc as E,Lb as b,Mb as v,Nc as H,Ob as $,Pb as T,Qb as k,Rb as u,Sb as o,Tb as r,Ub as I,Vb as P,Wb as O,Yb as C,ac as _,bc as l,eb as s,ka as f,pa as p,pc as m,qa as h,qb as R,qc as x,rc as S,uc as V,vc as L,wb as F,wc as B,za as M}from"./chunk-TWMQPIMW.js";import"./chunk-EU2KAMEK.js";import{a as A,j as D}from"./chunk-47CWAPKR.js";var Lt=()=>({standalone:!0}),Bt=()=>[],Kt=(n,e)=>e.id;function At(n,e){if(n&1){let t=C();o(0,"button",1),_("click",function(){p(t);let i=l();return h(i.handleDonhangAction())}),o(1,"mat-icon"),m(2,"save"),r()()}}function Rt(n,e){if(n&1){let t=C();o(0,"button",1),_("click",function(){p(t);let i=l();return h(i.toggleEdit())}),o(1,"mat-icon"),m(2,"edit"),r()()}}function $t(n,e){if(n&1){let t=C();o(0,"div",7)(1,"div",9),m(2,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),r(),o(3,"div",10)(4,"button",11),_("click",function(){p(t);let i=l();return h(i.DeleteData())}),m(5,"\u0110\u1ED3ng \xDD"),r(),o(6,"button",12),_("click",function(){p(t);let i=l();return h(i.toggleDelete())}),m(7,"Hu\u1EF7 B\u1ECF"),r()()()}}function Pt(n,e){if(n&1&&(o(0,"mat-option",21),m(1),r()),n&2){let t=e.$implicit;u("value",t.id),s(),x(t.title)}}function Ot(n,e){if(n&1&&(o(0,"th",31)(1,"span",32),m(2),r()()),n&2){let t=l().$implicit,a=l(2);s(2),S(" ",a.ColumnName[t]," ")}}function Ht(n,e){if(n&1){let t=C();o(0,"span",34)(1,"span"),m(2),r(),o(3,"button",40),_("click",function(){p(t);let i=l().$implicit,c=l(3);return h(c.RemoveSanpham(i))}),o(4,"mat-icon"),m(5,"delete"),r()()()}if(n&2){let t=l().index;s(2),S("",t+1," ")}}function Nt(n,e){if(n&1&&(o(0,"div",35),m(1),r()),n&2){let t=l().$implicit,a=l().$implicit;s(),x(t[a].title)}}function Wt(n,e){if(n&1){let t=C();o(0,"div",41),_("blur",function(i){p(t);let c=l(),w=c.$implicit,g=c.index,d=l(3);return h(d.updateBlurValue(i,g,w,"sldat","number"))}),m(1),y(2,"number"),r()}if(n&2){let t=l().$implicit,a=l().$implicit;u("contentEditable",!0),s(),S(" ",E(2,2,t[a]||0,"1.0-2")," ")}}function jt(n,e){if(n&1&&(o(0,"div",37),m(1),y(2,"number"),r()),n&2){let t=l().$implicit,a=l().$implicit;s(),x(E(2,1,t[a]||0,"1.0-2"))}}function zt(n,e){if(n&1&&(o(0,"div",37),m(1),y(2,"number"),r()),n&2){let t=l().$implicit,a=l().$implicit;s(),x(E(2,1,t[a]||0,"1.0-2"))}}function qt(n,e){if(n&1){let t=C();o(0,"div",42),_("blur",function(i){p(t);let c=l(),w=c.$implicit,g=c.index,d=l(3);return h(d.updateBlurValue(i,g,w,"ghichu","string"))}),m(1),r()}if(n&2){let t=l().$implicit,a=l().$implicit;u("contentEditable",!0),s(),S(" ",t[a]||""," ")}}function Gt(n,e){if(n&1&&(o(0,"span",39),m(1),r()),n&2){let t=l().$implicit,a=l().$implicit;s(),S(" ",t[a]," ")}}function Ut(n,e){if(n&1&&(o(0,"td",33),b(1,Ht,6,1,"span",34)(2,Nt,2,1,"div",35)(3,Wt,3,5,"div",36)(4,jt,3,4,"div",37)(5,zt,3,4,"div",37)(6,qt,2,2,"div",38)(7,Gt,2,1,"span",39),r()),n&2){let t,a=l().$implicit;s(),v((t=a)==="stt"?1:t==="sanpham"?2:t==="sldat"?3:t==="slgiao"?4:t==="slnhan"?5:t==="ghichu"?6:7)}}function Xt(n,e){if(n&1&&(P(0,25),F(1,Ot,3,1,"th",29)(2,Ut,8,1,"td",30),O()),n&2){let t=e.$implicit;u("matColumnDef",t)}}function Jt(n,e){n&1&&I(0,"tr",43)}function Qt(n,e){n&1&&I(0,"tr",44)}function Yt(n,e){n&1&&(o(0,"tr",45)(1,"td",46),m(2,"Kh\xF4ng t\xECm th\u1EA5y"),r()())}function Zt(n,e){if(n&1){let t=C();o(0,"div",8)(1,"div",3)(2,"mat-form-field",13)(3,"mat-label"),m(4,"Kh\xE1ch H\xE0ng"),r(),o(5,"mat-select",14),B("ngModelChange",function(i){p(t);let c=l();return L(c.DetailDonhang().khachhangId,i)||(c.DetailDonhang().khachhangId=i),h(i)}),o(6,"div",15)(7,"div",16)(8,"input",17),_("input",function(i){p(t);let c=l();return h(c.DoFindKhachhang(i))}),r(),o(9,"div",18)(10,"span",19),m(11,"search"),r()()(),o(12,"div",20),T(13,Pt,2,2,"mat-option",21,Kt),r()()()(),o(15,"app-searchfilter",22),_("OutFilter",function(i){p(t);let c=l();return h(c.onOutFilter(i))}),r()(),o(16,"div",23)(17,"table",24),T(18,Xt,3,1,"ng-container",25,$),F(20,Jt,1,0,"tr",26)(21,Qt,1,0,"tr",27)(22,Yt,3,0,"tr",28),r()()()}if(n&2){let t,a,i=l();s(5),V("ngModel",i.DetailDonhang().khachhangId),u("ngModelOptions",K(12,Lt)),s(8),k(i.FilterKhachhang),s(2),u("ListItem",i.ListSanpham())("CountItems",(t=i.DetailDonhang())==null||t.donhangsanpham==null?null:t.donhangsanpham.length)("fieldsearch","title")("title","S\u1EA3n Ph\u1EA9m")("ListFilter",K(13,Bt))("filterItem",i.ListSanpham())("isEdit",i.isEdit),s(2),u("dataSource",(a=i.DetailDonhang())==null?null:a.donhangsanpham),s(),k(i.displayedColumns),s(2),u("matHeaderRowDef",i.displayedColumns),s(),u("matRowDefColumns",i.displayedColumns)}}var Vt=class n{_ListDonhangComponent=f(Tt);_DonhangService=f(Ft);_KhachhangService=f(kt);_SanphamService=f(It);_route=f(j);_router=f(z);_snackBar=f(X);DetailDonhang=this._DonhangService.DetailDonhang;isEdit=M(!1);isDelete=M(!1);donhangId=this._DonhangService.donhangId;ListKhachhang=this._KhachhangService.ListKhachhang;ListSanpham=this._SanphamService.ListSanpham;FilterKhachhang=[];constructor(){this._route.paramMap.subscribe(e=>{let t=e.get("id");this._DonhangService.setDonhangId(t)}),H(()=>D(this,null,function*(){let e=this._DonhangService.donhangId();yield this._KhachhangService.getAllKhachhang(),yield this._SanphamService.getAllSanpham(),e||(this._router.navigate(["/donhang"]),this._ListDonhangComponent.drawer.close()),e==="new"?(this.DetailDonhang.set({}),this._ListDonhangComponent.drawer.open(),this.isEdit.update(t=>!t),this._router.navigate(["/donhang","new"])):(yield this._DonhangService.getDonhangBy({id:e,isOne:!0}),this._ListDonhangComponent.drawer.open(),this._router.navigate(["/donhang",e]))}))}displayedColumns=[];ColumnName={stt:"#",sanpham:"S\u1EA3n ph\u1EA9m",sldat:"S\u1ED1 l\u01B0\u1EE3ng \u0111\u1EB7t",slgiao:"S\u1ED1 l\u01B0\u1EE3ng giao",slnhan:"S\u1ED1 l\u01B0\u1EE3ng nh\u1EADn",slhuy:"S\u1ED1 l\u01B0\u1EE3ng h\u1EE7y",giaban:"Gi\xE1 b\xE1n"};updateBlurValue(e,t,a,i,c){let w=e.target,g=c==="number"?Number(w.innerText.trim())||0:w.innerText.trim();this.DetailDonhang.update(d=>(t!==null?i==="sldat"?(d.sanpham[t].sldat=g,d.sanpham[t].slgiao=g):i==="slgiao"?g<d.sanpham[t].sldat?(d.sanpham[t].slgiao=d.sanpham[t].sldat,this._snackBar.open("S\u1ED1 l\u01B0\u1EE3ng giao ph\u1EA3i l\u1EDBn h\u01A1n s\u1ED1 l\u01B0\u1EE3ng \u0111\u1EB7t","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})):d.sanpham[t].slgiao=g:d.sanpham[t][i]=g:d[i]=g,d))}RemoveSanpham(e){}ngOnInit(){return D(this,null,function*(){yield this._KhachhangService.getAllKhachhang(),yield this._SanphamService.getAllSanpham(),this.FilterKhachhang=this.ListKhachhang(),this.displayedColumns=Object.keys(this.ColumnName)})}onOutFilter(e){console.log("OutFilter event:",e),this.DetailDonhang.update(t=>{let a=A({},t);return console.log(e),a.donhangsanpham=e.map(i=>({sanphamId:i.id,sanpham:i,sldat:1,slgiao:0,slnhan:0,slhuy:0,giaban:i.giagoc})),a.total=e.reduce((i,c)=>(i=i||0,!c.giagoc||!c.sldat?i:i+c.giagoc*c.sldat),0),console.log("Updated Donhang:",a),a})}DoFindKhachhang(e){let t=e.target.value.toLowerCase();if(!t||t.trim()===""){this.FilterKhachhang=this.ListKhachhang();return}this.FilterKhachhang=this.ListKhachhang().filter(a=>a.title.toLowerCase().includes(t))}handleDonhangAction(){return D(this,null,function*(){this.donhangId()==="new"?yield this.createDonhang():yield this.updateDonhang()})}createDonhang(){return D(this,null,function*(){try{yield this._DonhangService.CreateDonhang(this.DetailDonhang()),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi t\u1EA1o donhang:",e)}})}updateDonhang(){return D(this,null,function*(){try{yield this._DonhangService.updateDonhang(this.DetailDonhang()),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt donhang:",e)}})}DeleteData(){return D(this,null,function*(){try{yield this._DonhangService.DeleteDonhang(this.DetailDonhang()),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["donhang"])}catch(e){console.error("L\u1ED7i khi x\xF3a donhang:",e)}})}goBack(){this._router.navigate(["donhang"]),this._ListDonhangComponent.drawer.close()}trackByFn(e,t){return t.id}toggleEdit(){this.isEdit.update(e=>!e)}toggleDelete(){this.isDelete.update(e=>!e)}FillSlug(){this.DetailDonhang.update(e=>(e.slug=mt(e.title),e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=R({type:n,selectors:[["app-detaildonhang"]],decls:14,vars:8,consts:[[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center"],[3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","color","primary"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"grid","grid-cols-1","gap-4"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],["appearance","outline","subscriptSizing","dynamic"],[3,"ngModelChange","ngModel","ngModelOptions"],[1,"w-full","flex","flex-col","p-4","space-y-2"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"input"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"overflow-y-auto","max-h-44"],[3,"value"],[3,"OutFilter","ListItem","CountItems","fieldsearch","title","ListFilter","filterItem","isEdit"],[1,"w-full","overflow-auto"],["mat-table","",1,"!border","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["class","whitespace-nowrap","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"whitespace-nowrap"],[1,"line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-20","line-clamp-4","flex","flex-row","items-center"],[1,""],[1,"sldat-input","p-2","min-w-28","text-end","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"contentEditable"],[1,"text-end"],[1,"ghichu-input","p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"contentEditable"],[1,"max-w-40","line-clamp-4"],["mat-icon-button","","color","warn",3,"click"],[1,"sldat-input","p-2","min-w-28","text-end","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"blur","contentEditable"],[1,"ghichu-input","p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"blur","contentEditable"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,a){if(t&1&&(o(0,"div",0)(1,"button",1),_("click",function(){return a.goBack()}),o(2,"mat-icon"),m(3,"arrow_back"),r()(),o(4,"div",2),m(5),r(),o(6,"div",3)(7,"mat-slide-toggle",4),B("ngModelChange",function(c){return L(a.DetailDonhang().isActive,c)||(a.DetailDonhang().isActive=c),c}),m(8),r(),b(9,At,3,0,"button",5),b(10,Rt,3,0,"button",5),r()(),o(11,"div",6),b(12,$t,8,0,"div",7),b(13,Zt,23,14,"div",8),r()),t&2){let i;s(5),x(((i=a.DetailDonhang())==null?null:i.title)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),s(2),V("ngModel",a.DetailDonhang().isActive),u("disabled",!a.isEdit()),s(),x(a.DetailDonhang().isActive?"Hi\u1EC3n Th\u1ECB":"\u1EA8n"),s(),v(a.isEdit()?9:-1),s(),v(a.isEdit()?-1:10),s(2),v(a.isDelete()?12:-1),s(),v(a.isDelete()?-1:13)}},dependencies:[ot,at,it,lt,et,Z,tt,Q,J,U,G,q,st,ct,rt,nt,W,N,Et,yt,Y,Mt,St,ht,_t,Dt,gt,ut,xt,ft,Ct,wt,bt,vt,pt,dt],encapsulation:2})};export{Vt as DetailDonhangComponent};
