import './polyfills.server.mjs';
import{l as M,m as T,u as k}from"./chunk-RO5ZX6QD.mjs";import{Vb as p,Wb as o,Xb as s,ac as x,ec as u,fa as y,fc as m,gb as c,lb as _,pa as g,qa as v,rc as h,sb as C,tc as f,xc as b,yb as l}from"./chunk-LD2AVDEF.mjs";import"./chunk-W2PR56MU.mjs";import"./chunk-RIAI3ORJ.mjs";var d=class n{map=[];characters=[];currentTurn="player";constructor(){this.initializeMap(10,10),this.initializeCharacters()}initializeMap(t,e){for(let i=0;i<e;i++){let a=[];for(let r=0;r<t;r++)a.push({x:r,y:i,terrain:"plain"});this.map.push(a)}}initializeCharacters(){this.characters=[{id:1,name:"Sigurd",hp:30,maxHp:30,attack:15,defense:10,position:{x:0,y:0},moveRange:5,attackRange:1,team:"player"},{id:2,name:"Enemy",hp:25,maxHp:25,attack:12,defense:8,position:{x:8,y:8},moveRange:4,attackRange:1,team:"enemy"}],this.updateMap()}moveCharacter(t,e,i){this.isValidMove(t,e,i)&&(t.position={x:e,y:i},this.updateMap())}isValidMove(t,e,i){return Math.abs(t.position.x-e)+Math.abs(t.position.y-i)<=t.moveRange&&!this.map[i][e].occupiedBy&&e>=0&&i>=0&&e<this.map[0].length&&i<this.map.length}attack(t,e){if(Math.abs(t.position.x-e.position.x)+Math.abs(t.position.y-e.position.y)<=t.attackRange){let a=Math.max(0,t.attack-e.defense);e.hp=Math.max(0,e.hp-a),e.hp===0&&(this.characters=this.characters.filter(r=>r.id!==e.id)),this.updateMap()}}updateMap(){this.map.forEach(t=>t.forEach(e=>e.occupiedBy=void 0)),this.characters.forEach(t=>{this.map[t.position.y][t.position.x].occupiedBy=t})}endTurn(){this.currentTurn=this.currentTurn==="player"?"enemy":"player"}static \u0275fac=function(e){return new(e||n)};static \u0275prov=y({token:n,factory:n.\u0275fac,providedIn:"root"})};function w(n,t){if(n&1&&(o(0,"span"),f(1),s()),n&2){let e=m().$implicit;h("player",e.occupiedBy.team==="player")("enemy",e.occupiedBy.team==="enemy"),c(),b(" ",e.occupiedBy.name," (",e.occupiedBy.hp,"/",e.occupiedBy.maxHp,") ")}}function I(n,t){if(n&1){let e=x();o(0,"div",6),u("click",function(){let a=g(e).$implicit,r=m(2);return v(r.selectTile(a))}),l(1,w,2,7,"span",7),s()}if(n&2){let e=t.$implicit,i=m(2);h("selected",i.selectedCharacter&&(e.occupiedBy==null?null:e.occupiedBy.id)===i.selectedCharacter.id),c(),p("ngIf",e.occupiedBy)}}function P(n,t){if(n&1&&(o(0,"div",4),l(1,I,2,3,"div",5),s()),n&2){let e=t.$implicit;c(),p("ngForOf",e)}}var B=class n{constructor(t){this.gameService=t}map=[];selectedCharacter=null;currentTurn="player";ngOnInit(){this.map=this.gameService.map,this.currentTurn=this.gameService.currentTurn}selectTile(t){this.selectedCharacter?(t.occupiedBy&&t.occupiedBy.team!==this.selectedCharacter.team?this.gameService.attack(this.selectedCharacter,t.occupiedBy):this.gameService.moveCharacter(this.selectedCharacter,t.x,t.y),this.selectedCharacter=null):t.occupiedBy&&t.occupiedBy.team==="player"&&(this.selectedCharacter=t.occupiedBy)}endTurn(){this.gameService.endTurn(),this.selectedCharacter=null}static \u0275fac=function(e){return new(e||n)(_(d))};static \u0275cmp=C({type:n,selectors:[["app-game4"]],decls:5,vars:2,consts:[[1,"map"],["class","row",4,"ngFor","ngForOf"],[1,"controls"],[3,"click","disabled"],[1,"row"],["class","tile",3,"selected","click",4,"ngFor","ngForOf"],[1,"tile",3,"click"],[3,"player","enemy",4,"ngIf"]],template:function(e,i){e&1&&(o(0,"div",0),l(1,P,2,1,"div",1),s(),o(2,"div",2)(3,"button",3),u("click",function(){return i.endTurn()}),f(4,"End Turn"),s()()),e&2&&(c(),p("ngForOf",i.map),c(2),p("disabled",i.currentTurn!=="player"))},dependencies:[k,M,T],styles:[".map[_ngcontent-%COMP%]{display:inline-block}.row[_ngcontent-%COMP%]{display:flex}.tile[_ngcontent-%COMP%]{width:60px;height:60px;border:1px solid black;display:flex;align-items:center;justify-content:center;cursor:pointer;background-color:#f0f0f0}.tile[_ngcontent-%COMP%]:hover{background-color:#ddd}.selected[_ngcontent-%COMP%]{background-color:#afa}.player[_ngcontent-%COMP%]{color:#00f;font-weight:700}.enemy[_ngcontent-%COMP%]{color:red;font-weight:700}.controls[_ngcontent-%COMP%]{margin-top:10px}button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px}"]})};export{B as Game4};
