import './polyfills.server.mjs';
import{Pb as p,Qb as f,Wb as s,Xb as o,Yb as g,gb as h,jc as y,kc as E,lc as C,sb as v,tc as a,uc as x,vc as d}from"./chunk-LD2AVDEF.mjs";import"./chunk-W2PR56MU.mjs";import"./chunk-RIAI3ORJ.mjs";var R=["gameCanvas"];function z(l,e){l&1&&(s(0,"div",4),a(1,"\u0110ang t\u1EA3i game..."),o())}var c=class{constructor(e,t,i){this.x=e;this.y=t;this.size=i}isPlanted=!1;plant=null;contains(e,t){return e>this.x&&e<this.x+this.size&&t>this.y&&t<this.y+this.size}},u=class{growth=0;maxGrowth=100;growthRate=.5;isReadyToHarvest=!1;update(){this.growth<this.maxGrowth&&(this.growth+=this.growthRate,this.growth>=this.maxGrowth&&(this.growth=this.maxGrowth,this.isReadyToHarvest=!0))}},w=class l{canvasRef;ctx;loading=!0;gameRunning=!0;money=100;plantCost=10;harvestValue=20;plotSize=50;plotPadding=10;numRows=5;numCols=8;plots=[];animationFrameId=0;resizeHandler=()=>this.resizeCanvas();ngOnInit(){this.initGameData()}ngAfterViewInit(){if(!this.canvasRef){console.error("Canvas element not found!");return}let e=this.canvasRef.nativeElement;this.ctx=e.getContext("2d"),this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas.bind(this)),e.addEventListener("click",this.handleCanvasClick.bind(this)),this.gameLoop()}ngOnDestroy(){this.gameRunning=!1,cancelAnimationFrame(this.animationFrameId),window.removeEventListener("resize",this.resizeHandler)}initGameData(){this.plots=[];for(let e=0;e<this.numRows;e++)for(let t=0;t<this.numCols;t++){let i=t*(this.plotSize+this.plotPadding)+this.plotPadding,n=e*(this.plotSize+this.plotPadding)+this.plotPadding;this.plots.push(new c(i,n,this.plotSize))}}gameLoop=()=>{this.gameRunning&&(this.updateGame(),this.drawGame(),this.animationFrameId=requestAnimationFrame(this.gameLoop))};updateGame(){this.plots.forEach(e=>{e.plant?.update()})}drawGame(){if(!this.ctx)return;let e=this.canvasRef.nativeElement;this.ctx.clearRect(0,0,e.width,e.height),this.plots.forEach(t=>{this.ctx.fillStyle=t.isPlanted?"#8B4513":"#D2B48C",this.ctx.fillRect(t.x,t.y,t.size,t.size),this.ctx.strokeStyle="#A0522D",this.ctx.strokeRect(t.x,t.y,t.size,t.size),t.isPlanted&&t.plant&&this.drawPlant(t.plant,t.x+t.size/2,t.y+t.size/2)})}drawPlant(e,t,i){if(!this.ctx)return;let n=e.growth/e.maxGrowth*(this.plotSize/3)+5,m=e.isReadyToHarvest?"#006400":"#32CD32";this.ctx.fillStyle=m,this.ctx.beginPath(),this.ctx.arc(t,i,n,0,Math.PI*2),this.ctx.fill()}handleCanvasClick(e){let i=this.canvasRef.nativeElement.getBoundingClientRect(),n=e.clientX-i.left,m=e.clientY-i.top;for(let r of this.plots)if(r.contains(n,m)){r.isPlanted?r.plant?.isReadyToHarvest&&(this.money+=this.harvestValue,r.isPlanted=!1,r.plant=null):this.money>=this.plantCost&&(this.money-=this.plantCost,r.isPlanted=!0,r.plant=new u);break}}resizeCanvas(){let e=this.canvasRef.nativeElement,t=e.parentElement;if(t){let i=t.clientWidth,n=i/1.5;e.width=i,e.height=n>400?400:n,this.drawGame()}}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=v({type:l,selectors:[["app-game1"]],viewQuery:function(t,i){if(t&1&&y(R,5),t&2){let n;E(n=C())&&(i.canvasRef=n.first)}},decls:17,vars:4,consts:[["gameCanvas",""],[1,"game-container"],["id","info"],["id","money"],[1,"loading"]],template:function(t,i){t&1&&(s(0,"div",1)(1,"h1"),a(2,"Simple Planting Game Demo (Angular)"),o(),s(3,"div",2),a(4," Ti\u1EC1n: "),s(5,"span",3),a(6),o(),a(7),o(),p(8,z,2,0,"div",4),g(9,"canvas",null,0),s(11,"p"),a(12),o(),s(13,"p"),a(14,"Click v\xE0o c\xE2y \u0111\xE3 l\u1EDBn (m\xE0u xanh \u0111\u1EADm) \u0111\u1EC3 thu ho\u1EA1ch."),o(),s(15,"p"),a(16,"Xem console (F12) \u0111\u1EC3 th\u1EA5y th\xF4ng b\xE1o."),o()()),t&2&&(h(6),x(i.money),h(),d(" | Gi\xE1 tr\u1ED3ng c\xE2y: ",i.plantCost," "),h(),f(i.loading?8:-1),h(4),d("Click v\xE0o \xF4 \u0111\u1EA5t tr\u1ED1ng \u0111\u1EC3 tr\u1ED3ng c\xE2y (gi\xE1 ",i.plantCost," ti\u1EC1n)."))},encapsulation:2})};export{w as Game1Component};
