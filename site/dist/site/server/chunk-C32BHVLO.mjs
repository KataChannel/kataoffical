import './polyfills.server.mjs';
import{g as J,j}from"./chunk-WSPF3LUS.mjs";import"./chunk-IX5DRZQV.mjs";import{n as L}from"./chunk-6CWZJNK3.mjs";import"./chunk-YD76QD52.mjs";import{a as N,b as q}from"./chunk-BG4ZJEEA.mjs";import{a as m}from"./chunk-7TFSUZVW.mjs";import{a as M}from"./chunk-UB5YCHDJ.mjs";import"./chunk-H4PJ2UHT.mjs";import{d as A}from"./chunk-YRF26LGI.mjs";import"./chunk-E5PZ4VN2.mjs";import{m as x,y as O}from"./chunk-2BU3FGIB.mjs";import{Ab as w,Gb as E,La as g,Sb as I,Wb as b,ac as n,bc as d,ea as _,gc as T,ja as y,kc as h,ob as f,rc as C,sc as k,ta as o,tb as S,tc as P,ua as l,wc as D,xc as p,yc as V}from"./chunk-6DA2FG3T.mjs";import"./chunk-KB5IWD3E.mjs";import{j as u}from"./chunk-RIAI3ORJ.mjs";var v=class c{constructor(s,t){this._StorageService=s;this.router=t}ListDashboard=g([]);DetailDashboard=g({});dashboardId=g(null);setDashboardId(s){this.dashboardId.set(s)}sendMessage(s){return u(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},e=yield fetch(`${m.APIURL}/chatbot/ask`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let r=yield e.json();return e.ok,console.log(r),r}catch(t){return console.error(t)}})}CreateDashboard(s){return u(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},e=yield fetch(`${m.APIURL}/dashboard`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let r=yield e.json();e.ok,this.getAllDashboard(),this.dashboardId.set(r.id)}catch(t){return console.error(t)}})}getAllDashboard(){return u(this,null,function*(){try{let s={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},t=yield fetch(`${m.APIURL}/dashboard`,s);if(!t.ok)if(t.status===401){let r=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(t.status===403){let r=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(t.status===500){let r=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else{let r=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}let e=yield t.json();this.ListDashboard.set(e)}catch(s){return console.error(s)}})}getDashboardByid(s){return u(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},e=yield fetch(`${m.APIURL}/dashboard/findid/${s}`,t);if(!e.ok)if(e.status===401){let i=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(e.status===403){let i=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(e.status===500){let i=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else{let i=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}let r=yield e.json();this.DetailDashboard.set(r)}catch(t){return console.error(t)}})}updateDashboard(s){return u(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},e=yield fetch(`${m.APIURL}/dashboard/${s.id}`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let r=yield e.json();if(!e.ok)if(e.status===401){let i=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(e.status===403){let i=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(e.status===500){let i=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else{let i=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}this.getAllDashboard(),this.getDashboardByid(s.id)}catch(t){return console.error(t)}})}DeleteDashboard(s){return u(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json"}},e=yield fetch(`${m.APIURL}/dashboard/${s.id}`,t);if(!e.ok)if(e.status===401){let r=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(e.status===403){let r=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(e.status===500){let r=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else{let r=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}this.getAllDashboard()}catch(t){return console.error(t)}})}static \u0275fac=function(t){return new(t||c)(y(M),y(A))};static \u0275prov=_({token:c,factory:c.\u0275fac,providedIn:"root"})};var B=["editablechatAI"];function U(c,s){if(c&1&&(n(0,"div")(1,"span"),p(2),d()()),c&2){let t=s.$implicit;b("message ",t.sender?"text-start":"text-end",""),f(2),V(t==null||t.text==null?null:t.text.reply)}}var $=class c{constructor(s){this._DashboardService=s}messages=[];userMessage="";userId="user_123";editablechatAI;ngAfterViewInit(){this.focusEditableDiv()}sendMessage(s){let t=s;if(t.key==="Enter"&&!t.shiftKey){if(s.preventDefault(),this.userMessage=this.editablechatAI.nativeElement.textContent?.trim()||"",!this.userMessage)return;this.messages.push({sender:"user",text:this.userMessage}),this.messages.push({sender:"bot",text:"...",isTyping:!0}),this.resetEditableDiv();let e={userId:this.userId,message:this.userMessage};this._DashboardService.sendMessage(e).then(r=>{this.messages=this.messages.filter(i=>!i.isTyping),this.messages.push({sender:"bot",text:r}),this.focusEditableDiv()}).catch(r=>{console.error("Error sending message:",r),this.messages=this.messages.filter(i=>!i.isTyping),this.messages.push({sender:"bot",text:"An error occurred."}),this.focusEditableDiv()})}}resetEditableDiv(){this.editablechatAI&&(this.editablechatAI.nativeElement.textContent="",this.focusEditableDiv())}focusEditableDiv(){this.editablechatAI&&this.editablechatAI.nativeElement.focus()}isDragging=!1;handlePaste(s){}handleInput(s){}onDragOver(s){}onDragLeave(s){}onInput(s){}onDrop(s){}onFileSelected(s){}uploadDriver(s){}static \u0275fac=function(t){return new(t||c)(S(v))};static \u0275cmp=w({type:c,selectors:[["app-dashboard"]],viewQuery:function(t,e){if(t&1&&C(B,5),t&2){let r;k(r=P())&&(e.editablechatAI=r.first)}},decls:27,vars:4,consts:[["editablechatAI","","editable",""],["fileInput",""],["fileDrive",""],[1,"container","w-full","h-full","mx-auto","py-8","justify-center","items-center","text-center"],[1,"flex","flex-col","space-y-2","container","p-4","rounded-lg","border","border-gray-200"],[1,"chat-box"],[3,"class",4,"ngFor","ngForOf"],[1,"relative","w-full","flex","flex-col","space-y-2"],[1,"flex","flex-row","space-x-2"],["contenteditable","true","data-placeholder","Nh\u1EADp n\u1ED9i dung \u1EDF \u0111\xE2y...","autofocus","",3,"keyup.enter","paste","dragover","dragleave","drop","input"],["mat-icon-button","","color","primary",3,"click"],[1,"flex","flex-row","space-x-2","items-center"],["type","file",1,"hidden",3,"change"]],template:function(t,e){if(t&1){let r=T();n(0,"div",3)(1,"h1"),p(2,"Dashboard"),d(),n(3,"div"),p(4,"Coming Soon"),d(),n(5,"div",4)(6,"div",5),E(7,U,3,4,"div",6),d(),n(8,"div",7)(9,"div",8)(10,"div",9,0),h("keyup.enter",function(a){return o(r),l(e.sendMessage(a))})("paste",function(a){return o(r),l(e.handlePaste(a))})("dragover",function(a){return o(r),l(e.onDragOver(a))})("dragleave",function(a){return o(r),l(e.onDragLeave(a))})("drop",function(a){return o(r),l(e.onDrop(a))})("input",function(a){return o(r),l(e.onInput(a))}),d(),n(13,"button",10),h("click",function(a){return o(r),l(e.sendMessage(a))}),n(14,"mat-icon"),p(15,"send"),d()()(),n(16,"div",11)(17,"button",10),h("click",function(){o(r);let a=D(24);return l(a.click())}),n(18,"mat-icon"),p(19,"image"),d()(),n(20,"button",10),h("click",function(){o(r);let a=D(26);return l(a.click())}),n(21,"mat-icon"),p(22,"cloud_upload"),d()(),n(23,"input",12,1),h("change",function(a){return o(r),l(e.onFileSelected(a))}),d(),n(25,"input",12,2),h("change",function(a){return o(r),l(e.uploadDriver(a))}),d()()()()()}t&2&&(f(7),I("ngForOf",e.messages),f(3),b("w-full text-start border p-4 editable rounded-lg ",e.isDragging?"h-40 border-2 border-dashed border-blue-500 bg-slate-100":"",""))},dependencies:[O,x,L,j,J,q,N],encapsulation:2})};export{$ as DashboardComponent};
