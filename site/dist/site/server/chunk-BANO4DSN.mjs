import './polyfills.server.mjs';
import{n as w,y as R}from"./chunk-D3F6VAXE.mjs";import{Bc as a,Cc as x,Db as v,Dc as d,Jb as p,Vb as f,dc as s,ec as o,fc as g,qb as m,uc as y,vc as E,wc as C}from"./chunk-IXG76IG3.mjs";import"./chunk-KB5IWD3E.mjs";import"./chunk-RIAI3ORJ.mjs";var G=["gameCanvas"];function b(l,t){l&1&&(s(0,"div",5),a(1,"\u0110ang t\u1EA3i game..."),o())}var c=class{constructor(t,e,i){this.x=t;this.y=e;this.size=i}isPlanted=!1;plant=null;contains(t,e){return t>this.x&&t<this.x+this.size&&e>this.y&&e<this.y+this.size}},u=class{growth=0;maxGrowth=100;growthRate=.5;isReadyToHarvest=!1;update(){this.growth<this.maxGrowth&&(this.growth+=this.growthRate,this.growth>=this.maxGrowth&&(this.growth=this.maxGrowth,this.isReadyToHarvest=!0))}},z=class l{canvasRef;ctx;loading=!0;gameRunning=!0;money=100;plantCost=10;harvestValue=20;plotSize=50;plotPadding=10;numRows=5;numCols=8;plots=[];animationFrameId=0;resizeHandler=()=>this.resizeCanvas();ngOnInit(){this.initGameData()}ngAfterViewInit(){if(!this.canvasRef){console.error("Canvas element not found!");return}let t=this.canvasRef.nativeElement;this.ctx=t.getContext("2d"),this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas.bind(this)),t.addEventListener("click",this.handleCanvasClick.bind(this)),this.gameLoop()}ngOnDestroy(){this.gameRunning=!1,cancelAnimationFrame(this.animationFrameId),window.removeEventListener("resize",this.resizeHandler)}initGameData(){this.plots=[];for(let t=0;t<this.numRows;t++)for(let e=0;e<this.numCols;e++){let i=e*(this.plotSize+this.plotPadding)+this.plotPadding,n=t*(this.plotSize+this.plotPadding)+this.plotPadding;this.plots.push(new c(i,n,this.plotSize))}}gameLoop=()=>{this.gameRunning&&(this.updateGame(),this.drawGame(),this.animationFrameId=requestAnimationFrame(this.gameLoop))};updateGame(){this.plots.forEach(t=>{t.plant?.update()})}drawGame(){if(!this.ctx)return;let t=this.canvasRef.nativeElement;this.ctx.clearRect(0,0,t.width,t.height),this.plots.forEach(e=>{this.ctx.fillStyle=e.isPlanted?"#8B4513":"#D2B48C",this.ctx.fillRect(e.x,e.y,e.size,e.size),this.ctx.strokeStyle="#A0522D",this.ctx.strokeRect(e.x,e.y,e.size,e.size),e.isPlanted&&e.plant&&this.drawPlant(e.plant,e.x+e.size/2,e.y+e.size/2)})}drawPlant(t,e,i){if(!this.ctx)return;let n=t.growth/t.maxGrowth*(this.plotSize/3)+5,h=t.isReadyToHarvest?"#006400":"#32CD32";this.ctx.fillStyle=h,this.ctx.beginPath(),this.ctx.arc(e,i,n,0,Math.PI*2),this.ctx.fill()}handleCanvasClick(t){let i=this.canvasRef.nativeElement.getBoundingClientRect(),n=t.clientX-i.left,h=t.clientY-i.top;for(let r of this.plots)if(r.contains(n,h)){r.isPlanted?r.plant?.isReadyToHarvest&&(this.money+=this.harvestValue,r.isPlanted=!1,r.plant=null):this.money>=this.plantCost&&(this.money-=this.plantCost,r.isPlanted=!0,r.plant=new u);break}}resizeCanvas(){let t=this.canvasRef.nativeElement,e=t.parentElement;if(e){let i=e.clientWidth,n=i/1.5;t.width=i,t.height=n>400?400:n,this.drawGame()}}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=v({type:l,selectors:[["app-game1"]],viewQuery:function(e,i){if(e&1&&y(G,5),e&2){let n;E(n=C())&&(i.canvasRef=n.first)}},decls:17,vars:4,consts:[["gameCanvas",""],[1,"game-container"],["id","info"],["id","money"],["class","loading",4,"ngIf"],[1,"loading"]],template:function(e,i){e&1&&(s(0,"div",1)(1,"h1"),a(2,"Simple Planting Game Demo (Angular)"),o(),s(3,"div",2),a(4," Ti\u1EC1n: "),s(5,"span",3),a(6),o(),a(7),o(),p(8,b,2,0,"div",4),g(9,"canvas",null,0),s(11,"p"),a(12),o(),s(13,"p"),a(14,"Click v\xE0o c\xE2y \u0111\xE3 l\u1EDBn (m\xE0u xanh \u0111\u1EADm) \u0111\u1EC3 thu ho\u1EA1ch."),o(),s(15,"p"),a(16,"Xem console (F12) \u0111\u1EC3 th\u1EA5y th\xF4ng b\xE1o."),o()()),e&2&&(m(6),x(i.money),m(),d(" | Gi\xE1 tr\u1ED3ng c\xE2y: ",i.plantCost," "),m(),f("ngIf",i.loading),m(4),d("Click v\xE0o \xF4 \u0111\u1EA5t tr\u1ED1ng \u0111\u1EC3 tr\u1ED3ng c\xE2y (gi\xE1 ",i.plantCost," ti\u1EC1n)."))},dependencies:[R,w],encapsulation:2})};export{z as Game1Component};
