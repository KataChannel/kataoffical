# ğŸ“– HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng: Import/Export Phiáº¿u Chuyá»ƒn

## ğŸ¯ Má»¥c ÄÃ­ch
TÃ­nh nÄƒng nÃ y cho phÃ©p báº¡n:
- **Xuáº¥t Excel**: Táº¡o file Excel chá»©a thÃ´ng tin Ä‘Æ¡n hÃ ng vÃ  phiáº¿u chuyá»ƒn
- **Chá»‰nh sá»­a**: Cáº­p nháº­t thÃ´ng tin Shipper, Giá» Ä‘i/vá», Phiáº¿u vá», KÃ½ nháº­n
- **Import láº¡i**: Cáº­p nháº­t hÃ ng loáº¡t thÃ´ng tin vÃ o há»‡ thá»‘ng

## ğŸ“ Vá»‹ TrÃ­ TÃ­nh NÄƒng

**Menu:** ÄÆ¡n HÃ ng â†’ Váº­n ÄÆ¡n

**CÃ¡c nÃºt chá»©c nÄƒng:**
- ğŸ“¥ **Xuáº¥t Excel**: Download file Excel vá»›i 2 sheet
- ğŸ“¤ **Import Phiáº¿u Chuyá»ƒn**: Upload file Excel Ä‘Ã£ chá»‰nh sá»­a

---

## ğŸ“¤ BÆ¯á»šC 1: XUáº¤T EXCEL

### CÃ¡ch Thá»±c Hiá»‡n:

1. **VÃ o trang Váº­n ÄÆ¡n**
   - Click menu `ÄÆ¡n HÃ ng` > `Váº­n ÄÆ¡n`

2. **Chá»n ngÃ y cáº§n xuáº¥t**
   - Chá»n `Báº¯t Äáº§u`: NgÃ y báº¯t Ä‘áº§u
   - Chá»n `Káº¿t ThÃºc`: NgÃ y káº¿t thÃºc
   - Há»‡ thá»‘ng tá»± Ä‘á»™ng load dá»¯ liá»‡u

3. **Click nÃºt "Xuáº¥t Excel"**
   - Icon: ğŸ“¥ (mÃ u xanh dÆ°Æ¡ng - accent)
   - Tooltip: "Xuáº¥t Excel (2 sheet: Váº­n Ä‘Æ¡n + Phiáº¿u chuyá»ƒn)"

4. **Káº¿t quáº£**
   - File Excel Ä‘Æ°á»£c download tá»± Ä‘á»™ng
   - TÃªn file: `VanDon_PhieuChuyen_2025-10-30.xlsx`
   - ThÃ´ng bÃ¡o: âœ… "Xuáº¥t Excel thÃ nh cÃ´ng"

### Cáº¥u TrÃºc File Excel:

File Excel cÃ³ **2 sheets**:

#### **Sheet 1: "Váº­n ÄÆ¡n"**
Danh sÃ¡ch chi tiáº¿t sáº£n pháº©m trong Ä‘Æ¡n hÃ ng

| STT | MÃ£ ÄÆ¡n HÃ ng | KhÃ¡ch HÃ ng | TÃªn Sáº£n Pháº©m | ÄÆ¡n Vá»‹ TÃ­nh | SL Äáº·t | SL Giao | SL Nháº­n | NgÃ y Giao | Tráº¡ng ThÃ¡i |
|-----|-------------|------------|--------------|-------------|--------|---------|---------|-----------|------------|
| 1   | DH001       | Cty A      | Rau xÃ  lÃ¡ch  | ThÃ¹ng       | 10     | 10      | 10      | 30/10/25  | ÄÃ£ Giao    |

#### **Sheet 2: "Phiáº¿u Chuyá»ƒn"** â­
ThÃ´ng tin giao hÃ ng - **Sheet quan trá»ng Ä‘á»ƒ chá»‰nh sá»­a**

| STT | MÃ£ ÄÆ¡n HÃ ng | NgÃ y Giao | TÃªn KH | Sá»‘ LÆ°á»£ng | Äá»‹a Chá»‰ | SÄT | **Shipper** | **Phiáº¿u Vá»** | **Giá» Äi** | **Giá» Vá»** | **KÃ½ Nháº­n** |
|-----|-------------|-----------|--------|----------|---------|-----|-------------|--------------|------------|------------|-------------|
| 1   | DH001       | 30/10/25  | Cty A  | 10       | HN      | 090... | *empty*   | *empty*      | *empty*    | *empty*    | *empty*     |

**ChÃº Ã½:** CÃ¡c cá»™t **in Ä‘áº­m** lÃ  nhá»¯ng trÆ°á»ng báº¡n cáº§n Ä‘iá»n thÃ´ng tin

---

## âœï¸ BÆ¯á»šC 2: CHá»ˆNH Sá»¬A EXCEL

### Má»Ÿ File Excel:

1. **Má»Ÿ file vá»«a download**
   - Double-click file `VanDon_PhieuChuyen_2025-10-30.xlsx`
   - Excel/LibreOffice tá»± Ä‘á»™ng má»Ÿ

2. **Chá»n Sheet "Phiáº¿u Chuyá»ƒn"**
   - Click tab "Phiáº¿u Chuyá»ƒn" á»Ÿ cuá»‘i mÃ n hÃ¬nh

### Äiá»n ThÃ´ng Tin:

**5 cá»™t cáº§n Ä‘iá»n:**

| Cá»™t | MÃ´ Táº£ | VÃ­ Dá»¥ | Báº¯t Buá»™c |
|-----|-------|-------|----------|
| **Shipper** | TÃªn ngÆ°á»i giao hÃ ng | "Nguyá»…n VÄƒn A" | KhÃ´ng |
| **Phiáº¿u Vá»** | MÃ£ phiáº¿u vá» | "PV-001" | KhÃ´ng |
| **Giá» Äi** | Giá» xuáº¥t phÃ¡t giao hÃ ng | "08:00" hoáº·c "8h30" | KhÃ´ng |
| **Giá» Vá»** | Giá» vá» Ä‘áº¿n kho | "17:00" hoáº·c "5h30 chiá»u" | KhÃ´ng |
| **KÃ½ Nháº­n** | NgÆ°á»i kÃ½ nháº­n hÃ ng | "Tráº§n VÄƒn B" | KhÃ´ng |

### VÃ­ Dá»¥ Äiá»n ThÃ´ng Tin:

**Before (sau khi xuáº¥t):**
```
| MÃ£ ÄÆ¡n HÃ ng | Shipper | Phiáº¿u Vá» | Giá» Äi | Giá» Vá» | KÃ½ Nháº­n |
|-------------|---------|----------|--------|--------|---------|
| DH001       |         |          |        |        |         |
| DH002       |         |          |        |        |         |
```

**After (sau khi Ä‘iá»n):**
```
| MÃ£ ÄÆ¡n HÃ ng | Shipper      | Phiáº¿u Vá» | Giá» Äi | Giá» Vá» | KÃ½ Nháº­n      |
|-------------|--------------|----------|--------|--------|--------------|
| DH001       | Nguyá»…n VÄƒn A | PV-001   | 08:00  | 17:00  | Tráº§n VÄƒn B   |
| DH002       | LÃª Thá»‹ C     | PV-002   | 09:00  | 18:30  | Nguyá»…n VÄƒn D |
```

### LÆ°u Ã Quan Trá»ng:

âœ… **ÄÆ¯á»¢C:**
- Äiá»n má»™t sá»‘ cá»™t, bá» trá»‘ng cÃ¡c cá»™t khÃ¡c
- Sá»­a thÃ´ng tin cÅ© sang thÃ´ng tin má»›i
- ThÃªm thÃ´ng tin vÃ o dÃ²ng trá»‘ng

âŒ **KHÃ”NG ÄÆ¯á»¢C:**
- Äá»•i tÃªn cÃ¡c cá»™t (Header pháº£i giá»¯ nguyÃªn)
- XÃ³a cá»™t "MÃ£ ÄÆ¡n HÃ ng"
- ThÃªm/xÃ³a dÃ²ng (chá»‰ sá»­a dá»¯ liá»‡u)
- Thay Ä‘á»•i Sheet name "Phiáº¿u Chuyá»ƒn"

### LÆ°u File:

- **Ctrl + S** hoáº·c **File > Save**
- Giá»¯ nguyÃªn format `.xlsx`
- ÄÃ³ng Excel

---

## ğŸ“¤ BÆ¯á»šC 3: IMPORT Láº I Há»† THá»NG

### CÃ¡ch Thá»±c Hiá»‡n:

1. **Quay láº¡i trang Váº­n ÄÆ¡n**
   - Äáº£m báº£o Ä‘ang á»Ÿ trang `ÄÆ¡n HÃ ng` > `Váº­n ÄÆ¡n`

2. **Click nÃºt "Import Phiáº¿u Chuyá»ƒn"**
   - Icon: ğŸ“¤ (mÃ u xanh lÃ¡ - primary)
   - Tooltip: "Import Phiáº¿u Chuyá»ƒn (Cáº­p nháº­t Shipper, Giá» Ä‘i/vá», v.v.)"

3. **Chá»n file Excel Ä‘Ã£ chá»‰nh sá»­a**
   - Há»™p thoáº¡i chá»n file xuáº¥t hiá»‡n
   - Chá»n file `VanDon_PhieuChuyen_2025-10-30.xlsx`
   - Click **Open**

4. **Theo dÃµi tiáº¿n trÃ¬nh**
   
   Há»‡ thá»‘ng sáº½ hiá»ƒn thá»‹ cÃ¡c thÃ´ng bÃ¡o theo thá»© tá»±:

   ```
   ğŸ“‚ Äang Ä‘á»c file Excel...
   
   â³ Äang xá»­ lÃ½ 0/50...
   
   â³ Äang xá»­ lÃ½ 10/50 (20%)...
   
   â³ Äang xá»­ lÃ½ 20/50 (40%)...
   
   â³ Äang xá»­ lÃ½ 50/50 (100%)...
   
   âœ… Import thÃ nh cÃ´ng 48 Ä‘Æ¡n hÃ ng
   ```

5. **Kiá»ƒm tra káº¿t quáº£**
   - Náº¿u thÃ nh cÃ´ng 100%: `âœ… Import thÃ nh cÃ´ng 48 Ä‘Æ¡n hÃ ng`
   - Náº¿u cÃ³ lá»—i: `âš ï¸ 45 thÃ nh cÃ´ng, 3 lá»—i`
   - Dá»¯ liá»‡u tá»± Ä‘á»™ng refresh trÃªn mÃ n hÃ¬nh

---

## ğŸ¯ CÃC TÃŒNH HUá»NG THÆ¯á»œNG Gáº¶P

### âœ… TÃ¬nh Huá»‘ng 1: Import ThÃ nh CÃ´ng HoÃ n ToÃ n

**Ká»‹ch báº£n:**
- File Excel cÃ³ 50 dÃ²ng
- Táº¥t cáº£ MÃ£ ÄÆ¡n HÃ ng Ä‘á»u tá»“n táº¡i trong há»‡ thá»‘ng
- KhÃ´ng cÃ³ lá»—i

**Káº¿t quáº£:**
```
âœ… Import thÃ nh cÃ´ng 50 Ä‘Æ¡n hÃ ng
```

**Console Log:**
```
[IMPORT] Báº¯t Ä‘áº§u import 50 dÃ²ng...
[IMPORT] Äang xÃ³a cache...
[IMPORT] Äang lÃ m má»›i dá»¯ liá»‡u...
[IMPORT] HoÃ n thÃ nh trong 8.5s: { success: 50, error: 0, total: 50 }
```

---

### âš ï¸ TÃ¬nh Huá»‘ng 2: CÃ³ Má»™t Sá»‘ Lá»—i

**Ká»‹ch báº£n:**
- File cÃ³ 50 dÃ²ng
- 3 dÃ²ng cÃ³ MÃ£ ÄÆ¡n HÃ ng khÃ´ng tá»“n táº¡i
- 47 dÃ²ng import thÃ nh cÃ´ng

**Káº¿t quáº£:**
```
âš ï¸ 47 thÃ nh cÃ´ng, 3 lá»—i
```

**Console Log:**
```
[IMPORT] HoÃ n thÃ nh trong 9.2s: { success: 47, error: 3, total: 50 }
[IMPORT] Lá»—i: [
  "DH099: KhÃ´ng tÃ¬m tháº¥y",
  "DH100: KhÃ´ng tÃ¬m tháº¥y",
  "DÃ²ng 45: Timeout"
]
```

**CÃ¡ch xá»­ lÃ½:**
1. Má»Ÿ Console (F12)
2. Xem chi tiáº¿t lá»—i
3. Sá»­a MÃ£ ÄÆ¡n HÃ ng trong Excel
4. Import láº¡i

---

### âŒ TÃ¬nh Huá»‘ng 3: Lá»—i File Excel

**Ká»‹ch báº£n:**
- File khÃ´ng cÃ³ Sheet "Phiáº¿u Chuyá»ƒn"
- File bá»‹ lá»—i format
- File rá»—ng

**Káº¿t quáº£:**
```
âš ï¸ File khÃ´ng cÃ³ dá»¯ liá»‡u
```

**CÃ¡ch xá»­ lÃ½:**
1. Xuáº¥t láº¡i Excel tá»« há»‡ thá»‘ng
2. Äáº£m báº£o Sheet name lÃ  "Phiáº¿u Chuyá»ƒn"
3. Kiá»ƒm tra file cÃ³ dá»¯ liá»‡u

---

### ğŸ”„ TÃ¬nh Huá»‘ng 4: Chá»‰ Update Má»™t Sá»‘ Cá»™t

**Excel:**
```
| MÃ£ ÄÆ¡n HÃ ng | Shipper      | Phiáº¿u Vá» | Giá» Äi | Giá» Vá» | KÃ½ Nháº­n |
|-------------|--------------|----------|--------|--------|---------|
| DH001       | Nguyá»…n VÄƒn A |          |        |        |         |
| DH002       |              | PV-002   | 09:00  |        |         |
```

**Káº¿t quáº£:**
- DH001: Chá»‰ cáº­p nháº­t `shipper = "Nguyá»…n VÄƒn A"`
- DH002: Cáº­p nháº­t `phieuve = "PV-002"` vÃ  `giodi = "09:00"`
- CÃ¡c trÆ°á»ng khÃ¡c giá»¯ nguyÃªn giÃ¡ trá»‹ cÅ©

---

## ğŸ“Š KIá»‚M TRA Dá»® LIá»†U SAU IMPORT

### CÃ¡ch 1: Xem TrÃªn MÃ n HÃ¬nh

1. **ThÃªm cá»™t hiá»ƒn thá»‹** (náº¿u chÆ°a cÃ³)
   - Click icon âš™ï¸ (Tune) á»Ÿ gÃ³c trÃªn
   - Tick chá»n: Shipper, Phiáº¿u Vá», Giá» Äi, Giá» Vá», KÃ½ Nháº­n
   - CÃ¡c cá»™t tá»± Ä‘á»™ng xuáº¥t hiá»‡n trong báº£ng

2. **Kiá»ƒm tra giÃ¡ trá»‹**
   - Scroll qua cÃ¡c dÃ²ng
   - Verify thÃ´ng tin Ä‘Ã£ cáº­p nháº­t Ä‘Ãºng

### CÃ¡ch 2: Xuáº¥t Excel Láº¡i

1. Click "Xuáº¥t Excel" láº§n ná»¯a
2. Má»Ÿ file má»›i download
3. So sÃ¡nh Sheet "Phiáº¿u Chuyá»ƒn" vá»›i file gá»‘c
4. Verify dá»¯ liá»‡u Ä‘Ã£ update

### CÃ¡ch 3: Xem Console Log

1. Má»Ÿ Developer Tools (F12)
2. Tab Console
3. TÃ¬m log `[IMPORT] HoÃ n thÃ nh trong...`
4. Xem chi tiáº¿t result

---

## âš¡ Máº¸O VÃ€ THá»¦ THUáº¬T

### Máº¹o 1: Import Nhanh Vá»›i Template

**Táº¡o Template:**
1. Xuáº¥t Excel má»™t láº§n
2. LÆ°u file vá»›i tÃªn `Template_PhieuChuyen.xlsx`
3. XÃ³a háº¿t dá»¯ liá»‡u, chá»‰ giá»¯ header
4. LÆ°u láº¡i

**Sá»­ dá»¥ng:**
- Copy dá»¯ liá»‡u má»›i vÃ o template
- Import trá»±c tiáº¿p

### Máº¹o 2: Import Tá»«ng Batch

**Náº¿u cÃ³ nhiá»u Ä‘Æ¡n (>100):**
1. Chia file Excel thÃ nh cÃ¡c file nhá» (50-100 dÃ²ng/file)
2. Import láº§n lÆ°á»£t tá»«ng file
3. Giáº£m thá»i gian chá» vÃ  dá»… kiá»ƒm soÃ¡t lá»—i

### Máº¹o 3: Backup TrÆ°á»›c Khi Import

**An toÃ n hÆ¡n:**
1. Xuáº¥t Excel Ä‘á»ƒ backup dá»¯ liá»‡u hiá»‡n táº¡i
2. LÆ°u vá»›i tÃªn `Backup_YYYY-MM-DD.xlsx`
3. Import dá»¯ liá»‡u má»›i
4. Náº¿u cÃ³ váº¥n Ä‘á», dÃ¹ng backup Ä‘á»ƒ restore

### Máº¹o 4: Sá»­ dá»¥ng Excel Functions

**Tá»± Ä‘á»™ng Ä‘iá»n:**
```excel
// Tá»± Ä‘á»™ng thÃªm prefix cho Phiáº¿u Vá»
=CONCATENATE("PV-", TEXT(ROW()-1, "000"))
// Result: PV-001, PV-002, ...

// Copy Shipper tá»« dÃ²ng trÆ°á»›c
=B2
// KÃ©o xuá»‘ng Ä‘á»ƒ copy
```

---

## â“ CÃ‚U Há»I THÆ¯á»œNG Gáº¶P

### Q1: Import cÃ³ ghi Ä‘Ã¨ dá»¯ liá»‡u cÅ© khÃ´ng?

**A:** CÃ³, nhÆ°ng chá»‰ cÃ¡c trÆ°á»ng báº¡n Ä‘iá»n vÃ o Excel.

**VÃ­ dá»¥:**
- Dá»¯ liá»‡u cÅ©: `shipper="ABC", giodi="08:00"`
- Excel: Chá»‰ Ä‘iá»n `shipper="XYZ"`, bá» trá»‘ng `giodi`
- Káº¿t quáº£: `shipper="XYZ", giodi="08:00"` (giodi giá»¯ nguyÃªn)

### Q2: CÃ³ thá»ƒ import nhiá»u láº§n khÃ´ng?

**A:** CÃ³, khÃ´ng giá»›i háº¡n sá»‘ láº§n.
- Má»—i láº§n import sáº½ update láº¡i dá»¯ liá»‡u
- GiÃ¡ trá»‹ má»›i nháº¥t sáº½ Ä‘Æ°á»£c lÆ°u

### Q3: Máº¥t bao lÃ¢u Ä‘á»ƒ import?

**A:** Phá»¥ thuá»™c sá»‘ lÆ°á»£ng:
- 10-50 dÃ²ng: 3-10 giÃ¢y
- 50-100 dÃ²ng: 10-20 giÃ¢y
- 100-200 dÃ²ng: 20-40 giÃ¢y

### Q4: Import cÃ³ áº£nh hÆ°á»Ÿng Ä‘áº¿n Ä‘Æ¡n hÃ ng khÃ¡c khÃ´ng?

**A:** KhÃ´ng.
- Chá»‰ update Ä‘Ãºng cÃ¡c Ä‘Æ¡n hÃ ng cÃ³ trong Excel
- CÃ¡c Ä‘Æ¡n khÃ¡c khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng

### Q5: TÃªn cá»™t cÃ³ phÃ¢n biá»‡t chá»¯ hoa/thÆ°á»ng khÃ´ng?

**A:** CÃ³.
- Pháº£i giá»¯ chÃ­nh xÃ¡c: "Shipper", "Phiáº¿u Vá»", "Giá» Äi", "Giá» Vá»", "KÃ½ Nháº­n"
- KhÃ´ng Ä‘Æ°á»£c viáº¿t: "shipper", "SHIPPER", "Shiper"

### Q6: CÃ³ thá»ƒ import file CSV khÃ´ng?

**A:** KhÃ´ng.
- Chá»‰ há»— trá»£ file `.xlsx` (Excel)
- Náº¿u cÃ³ CSV, convert sang Excel trÆ°á»›c

### Q7: Import lá»—i cÃ³ rollback khÃ´ng?

**A:** KhÃ´ng.
- Import thÃ nh cÃ´ng tá»«ng dÃ²ng má»™t
- Náº¿u dÃ²ng lá»—i, dÃ²ng Ä‘Ã³ bá»‹ bá» qua
- CÃ¡c dÃ²ng Ä‘Ã£ import thÃ nh cÃ´ng váº«n Ä‘Æ°á»£c lÆ°u

---

## ğŸš¨ Xá»¬ LÃ Lá»–I

### Lá»—i: "KhÃ´ng tÃ¬m tháº¥y Ä‘Æ¡n hÃ ng"

**NguyÃªn nhÃ¢n:**
- MÃ£ ÄÆ¡n HÃ ng khÃ´ng tá»“n táº¡i trong há»‡ thá»‘ng
- ÄÃ¡nh mÃ¡y sai MÃ£ ÄÆ¡n HÃ ng

**CÃ¡ch fix:**
1. Kiá»ƒm tra MÃ£ ÄÆ¡n HÃ ng trong há»‡ thá»‘ng
2. Sá»­a láº¡i trong Excel
3. Import láº¡i

### Lá»—i: "File khÃ´ng cÃ³ dá»¯ liá»‡u"

**NguyÃªn nhÃ¢n:**
- Sheet "Phiáº¿u Chuyá»ƒn" bá»‹ xÃ³a hoáº·c Ä‘á»•i tÃªn
- File Excel rá»—ng

**CÃ¡ch fix:**
1. Xuáº¥t láº¡i Excel tá»« há»‡ thá»‘ng
2. Äáº£m báº£o Sheet name chÃ­nh xÃ¡c
3. Äiá»n dá»¯ liá»‡u

### Lá»—i: Timeout/Connection Failed

**NguyÃªn nhÃ¢n:**
- Máº¡ng cháº­m
- Server quÃ¡ táº£i

**CÃ¡ch fix:**
1. Chia nhá» file Excel (50 dÃ²ng/file)
2. Import tá»«ng batch
3. Thá»­ láº¡i sau vÃ i phÃºt

---

## ğŸ“ Há»– TRá»¢

**Náº¿u gáº·p váº¥n Ä‘á»:**

1. **Kiá»ƒm tra Console Log**
   - F12 > Console
   - Screenshot lá»—i

2. **LiÃªn há»‡ IT Support**
   - Gá»­i file Excel gáº·p lá»—i
   - Gá»­i screenshot lá»—i
   - MÃ´ táº£ chi tiáº¿t váº¥n Ä‘á»

3. **Tham kháº£o Log**
   - Má»Ÿ Console (F12)
   - TÃ¬m `[IMPORT]` Ä‘á»ƒ xem chi tiáº¿t

---

## ğŸ“ CHECKLIST Sá»¬ Dá»¤NG

**TrÆ°á»›c khi Import:**
- [ ] ÄÃ£ xuáº¥t Excel thÃ nh cÃ´ng
- [ ] ÄÃ£ Ä‘iá»n Ä‘áº§y Ä‘á»§ thÃ´ng tin cáº§n thiáº¿t
- [ ] ÄÃ£ kiá»ƒm tra MÃ£ ÄÆ¡n HÃ ng chÃ­nh xÃ¡c
- [ ] ÄÃ£ lÆ°u file Excel
- [ ] Sheet name lÃ  "Phiáº¿u Chuyá»ƒn"

**Trong khi Import:**
- [ ] Theo dÃµi progress bar
- [ ] Chá» Ä‘áº¿n khi cÃ³ thÃ´ng bÃ¡o káº¿t quáº£
- [ ] KhÃ´ng Ä‘Ã³ng trÃ¬nh duyá»‡t

**Sau khi Import:**
- [ ] Äá»c thÃ´ng bÃ¡o káº¿t quáº£
- [ ] Kiá»ƒm tra dá»¯ liá»‡u trÃªn mÃ n hÃ¬nh
- [ ] Xem Console log náº¿u cÃ³ lá»—i
- [ ] Backup file Excel náº¿u cáº§n

---

**ğŸ‰ ChÃºc báº¡n sá»­ dá»¥ng tÃ­nh nÄƒng thÃ nh cÃ´ng!**

*Cáº­p nháº­t: 30/10/2025*
