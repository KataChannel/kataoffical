/// prisma/cosmetics.prisma (Cosmetics Service)
datasource db { provider = "postgresql"; url = env("COSMETICS_DATABASE_URL"); }
generator client { provider = "prisma-client-js"; output = "../node_modules/.prisma/client-cosmetics"; previewFeatures = ["extendedWhereUnique"]; }
enum OrderStatus { PENDING_PAYMENT PROCESSING SHIPPED DELIVERED CANCELLED RETURNED }
model Customer { id String @id @default(uuid()); customerId String @unique; loyaltyPoints Int @default(0); createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; orders SalesOrder[]; activities Activity[] @relation("ActivityCustomers"); @@map("customers"); }
model Product { id String @id @default(uuid()); name String @unique; sku String @unique; price Decimal; isActive Boolean @default(true); createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; inventoryItems InventoryItem[]; orderItems OrderItem[]; @@map("products"); }
model InventoryItem { id String @id @default(uuid()); productId String; product Product @relation(fields: [productId], references: [id], onDelete: Cascade); location String? @default("default"); quantity Int; lastUpdated DateTime @updatedAt; @@unique([productId, location]); @@map("inventory_items"); }
model SalesOrder { id String @id @default(uuid()); orderNumber String @unique; customerId String; customer Customer @relation(fields: [customerId], references: [id], onDelete: Restrict); orderDate DateTime @default(now()); status OrderStatus; totalAmount Decimal; currency String @default("VND"); createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; items OrderItem[]; activities Activity[] @relation("ActivityOrders"); @@index([customerId]); @@index([status]); @@map("sales_orders"); }
model OrderItem { id String @id @default(uuid()); orderId String; order SalesOrder @relation(fields: [orderId], references: [id], onDelete: Cascade); productId String; product Product @relation(fields: [productId], references: [id], onDelete: Restrict); quantity Int; unitPrice Decimal; totalPrice Decimal; createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; @@index([orderId]); @@index([productId]); @@map("order_items"); }
model Activity { id String @id @default(uuid()); subject String; type String; status String @default("OPEN"); dueDate DateTime?; description String?; ownerId String; customerId String?; customer Customer? @relation("ActivityCustomers", fields: [customerId], references: [id], onDelete: Cascade); orderId String?; order SalesOrder? @relation("ActivityOrders", fields: [orderId], references: [id], onDelete: Cascade); createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; @@index([ownerId]); @@index([customerId]); @@index([orderId]); @@map("activities"); }