import{a as A0}from"./chunk-VJVYYU3A.js";import{b as M0,c as v0,d as r0}from"./chunk-6DJAFDTV.js";import{a as k,b as p0,c as C0,d as y0,e as f0,f as b0,h as L0,i as _0,k as x0,l as B0,n as k0,o as H0,q as N0,r as w0,s as D0,t as R0}from"./chunk-G2W2EW2N.js";import{a as K0,b as m0,c as E}from"./chunk-ZAG3K7T2.js";import{a as c0,b as d0,c as T0,d as S0}from"./chunk-PGBUMDHU.js";import{a as $0}from"./chunk-AUNJNMHO.js";import{b as n0,c as l0}from"./chunk-G2JGHO3B.js";import{b as B,c as s0}from"./chunk-OPSDER4V.js";import{b as u0}from"./chunk-Y4AWVQ5M.js";import{c as a0,g as e0,h as o0}from"./chunk-HNUPK34J.js";import{b as F0}from"./chunk-7PW7EJWC.js";import{a as V0,b as G0}from"./chunk-BALLAHYH.js";import{a as E0}from"./chunk-UHVDGNAF.js";import{a as X0}from"./chunk-ZTXOZSEW.js";import{a as P0,c as I0,e as h0}from"./chunk-ACURKAFZ.js";import{q as i0,r as g0}from"./chunk-H6K2N2AQ.js";import{o as J,p as W,q as Z,r as t0}from"./chunk-XPJYUAXQ.js";import{r as z,s as Y}from"./chunk-UAZLFQKL.js";import{$b as w,Ac as x,Bc as c,Cc as F,Dc as m,Gb as f,Lc as Q,Mc as U,Rc as j,Sb as h,Tc as $,Zb as X,_b as A,ac as D,bc as e,cc as n,dc as p,ec as O,fc as q,hc as R,la as N,mb as d,mc as K,nb as y,oc as v,ua as r,va as P,vc as b,wc as L,xc as _,zb as G}from"./chunk-QJD4TKMG.js";import{g as j0,i as s}from"./chunk-66YHNWRR.js";var O0=[{id:1,Title:"H\u1ECD T\xEAn",value:"Hoten",Type:"text",required:!0,isShow:!0},{id:2,Title:"Email",value:"email",Type:"select",required:!0,isShow:!0},{id:3,Title:"SDT",value:"SDT",Type:"textarea",required:!1},{id:4,Title:"M\u1EADt Kh\u1EA9u",value:"password",Type:"radio",required:!0},{id:5,Title:"Tr\u1EA1ng Th\xE1i",value:"Status",Type:"toggle",required:!0}];var Q0=j0($0());var z0=["drawer"],Y0=(a,t)=>t.key,J0=()=>[5,10,25,100],W0=a=>[a];function Z0(a,t){if(a&1){let i=R();e(0,"button",35),K("click",function(o){let l=r(i).$implicit;return v().toggleColumn(l),P(o.stopPropagation())}),e(1,"mat-icon"),c(2),n(),e(3,"span"),c(4),n()()}if(a&2){let i=t.$implicit;d(2),F(i.isShow?"check_box":"check_box_outline_blank"),d(2),F(i.value)}}function tt(a,t){if(a&1&&(e(0,"th",38)(1,"span",39),c(2),n()()),a&2){let i=v().$implicit,g=v();d(2),m(" ",g.ColumnName[i]," ")}}function it(a,t){if(a&1&&(e(0,"span",39),c(1),n()),a&2){let i=v().index;d(),m(" ",i+1," ")}}function gt(a,t){if(a&1&&(e(0,"span",39),c(1),j(2,"number"),n()),a&2){let i=v().$implicit,g=v().$implicit;d(),m(" ",$(2,1,i[g],"1.0-0")," \u0111 ")}}function at(a,t){if(a&1&&(e(0,"span",39),c(1),n()),a&2){let i=v().$implicit,g=v().$implicit;d(),m(" ",i[g]," ")}}function et(a,t){if(a&1&&(e(0,"td",40),f(1,it,2,1,"span",39)(2,gt,3,4,"span",39)(3,at,2,1,"span",39),n()),a&2){let i,g=v().$implicit;d(),X((i=g)==="STT"?1:i==="giagoc"?2:3)}}function ot(a,t){if(a&1&&(O(0,30),f(1,tt,3,1,"th",36)(2,et,4,1,"td",37),q()),a&2){let i=t.$implicit;h("matColumnDef",i)}}function nt(a,t){a&1&&p(0,"tr",41)}function lt(a,t){if(a&1&&p(0,"tr",42),a&2){let i=t.$implicit;h("routerLink",U(1,W0,i.id))}}function ct(a,t){if(a&1&&(e(0,"tr",43)(1,"td",44),c(2),n()()),a&2){v();let i=x(11);d(2),m('Kh\xF4ng t\xECm th\u1EA5y "',i.value,'"')}}var q0=class a{constructor(t,i,g){this._breakpointObserver=t;this._router=i;this._snackBar=g}Detail={};dataSource;displayedColumns=["STT","Title","MaSP","giagoc","dvt","Actions"];ColumnName={STT:"STT",Title:"T\xEAn S\u1EA3n Ph\u1EA9m",MaSP:"M\xE3 S\u1EA3n Ph\u1EA9m",giagoc:"Gi\xE1 G\u1ED1c",dvt:"\u0110\u01A1n V\u1ECB T\xEDnh"};Forms=O0;FilterColumns=JSON.parse(localStorage.getItem("Sanpham_FilterColumns")||"[]");Columns=[];ListSanpham=[];CountItem=0;paginator;sort;drawer;_SanphamsService=N(A0);_DonhangsService=N(X0);ngOnInit(){return s(this,null,function*(){this._breakpointObserver.observe([g0.Handset]).subscribe(t=>{t.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"}),yield this._SanphamsService.getAllSanpham(),this.ListSanpham=this._SanphamsService.ListSanpham(),this.initializeColumns(),this.setupDataSource()})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(t=>({key:t,value:this.ColumnName[t],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("Sanpham_FilterColumns",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(t=>t.isShow).map(t=>t.key),this.ColumnName=this.FilterColumns.reduce((t,i)=>(i.isShow&&(t[i.key]=i.value),t),{})}setupDataSource(){this.dataSource=new R0(this.ListSanpham),this.CountItem=this.dataSource.data.length,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i"}toggleColumn(t){let i=this.FilterColumns.find(g=>g.key===t.key);i&&(i.isShow=!i.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(t=>t.isShow).map(t=>t.key),this.ColumnName=this.FilterColumns.reduce((t,i)=>(i.isShow&&(t[i.key]=i.value),t),{}),this.setupDataSource(),localStorage.setItem("Sanpham_FilterColumns",JSON.stringify(this.FilterColumns))}doFilterColumns(t){let i=t.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(g=>g.value.toLowerCase().includes(i))}applyFilter(t){let i=t.target.value;this.dataSource.filter=i.trim().toLowerCase(),this.CountItem=this.dataSource.filteredData.length,this.dataSource.paginator&&this.dataSource.paginator.firstPage()}create(){this.drawer.open(),this._router.navigate(["admin/sanpham",0])}goToDetail(t){console.log(t),this.drawer.open()}LoadDrive(){return s(this,null,function*(){let t={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"SanphamImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},i=yield this._DonhangsService.getDrive(t),o=F0(i.values).map(S=>({Title:S?.Title?.trim(),MaSP:S?.MaSP?.trim(),giagoc:Number(S?.giagoc),dvt:S?.dvt,Soluong:Number(S?.Soluong)})),l=this._snackBar.open("\u0110ang T\u1EA3i","",{duration:0,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]}),T=0,H=this._SanphamsService.ListSanpham().map((S,C)=>new Promise(V=>{setTimeout(()=>s(this,null,function*(){let I=o.find(M=>M.MaSP===S.MaSP);(I&&Number(I.giagoc)!==Number(S.giagoc)||Number(I.Soluong)!==Number(S.Soluong))&&(T++,S.Title=I.Title.trim(),S.giagoc=Number(I.giagoc),S.dvt=I.dvt,S.Soluong=Number(I.Soluong),yield this._SanphamsService.updateOneSanpham(S)),V()}),C*10)}));Promise.all(H).then(()=>{console.log(T),console.log(o),l.dismiss(),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})})}readExcelFile(t){let i=t.target.files[0],g=new FileReader;g.onload=o=>{let l=new Uint8Array(o.target.result),T=K0(l,{type:"array"}),H=T.SheetNames[0],S=T.Sheets[H],C=E.sheet_to_json(S,{raw:!0});console.log(C);let I=C.map(M=>({Title:M.Title.trim(),MaSP:M.MaSP.trim(),giagoc:Number(M.giagoc),dvt:M.dvt,Soluong:Number(M.Soluong)})).map(M=>s(this,null,function*(){let u=this._SanphamsService.ListSanpham().find(U0=>U0.MaSP===M.MaSP);u&&(u.Title=M.Title,u.giagoc=M.giagoc,u.dvt=M.dvt,u.Soluong=Number(M.Soluong),yield this._SanphamsService.updateOneSanpham(u))}));Promise.all(I).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),window.location.reload()})},g.readAsArrayBuffer(i)}writeExcelFile(){console.log(this._SanphamsService.ListSanpham());let t=this._SanphamsService.ListSanpham().map(l=>({Title:l.Title,MaSP:l.MaSP,giagoc:Number(l.giagoc),dvt:l.dvt,Soluong:Number(l.Soluong)})),g={Sheets:{Sheet1:E.json_to_sheet(t)},SheetNames:["Sheet1"]},o=m0(g,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(o,"danhsachsanpham_"+(0,Q0.default)().format("DD_MM_YYYY"))}saveAsExcelFile(t,i){let g=new Blob([t],{type:"application/octet-stream"}),o=window.URL.createObjectURL(g),l=document.createElement("a");l.href=o,l.download=`${i}.xlsx`,l.click(),window.URL.revokeObjectURL(o),l.remove()}static \u0275fac=function(i){return new(i||a)(y(i0),y(W),y(E0))};static \u0275cmp=G({type:a,selectors:[["app-listsanpham"]],viewQuery:function(i,g){if(i&1&&(b(B,5),b(k,5),b(z0,7)),i&2){let o;L(o=_())&&(g.paginator=o.first),L(o=_())&&(g.sort=o.first),L(o=_())&&(g.drawer=o.first)}},decls:59,vars:8,consts:[["drawer",""],["input",""],["uploadfile",""],["menu","matMenu"],["autosize","",1,"w-full","h-full"],[1,"flex","flex-col","lg:!w-1/2","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","justify-between","p-2"],[1,"flex","flex-col","space-y-2","w-full","p-2"],[1,"cursor-pointer","w-full","flex","flex-row","space-x-2","items-center","justify-between","bg-white","rounded-lg","p-2"],[1,"flex","flex-row","space-x-2","items-center"],[1,"relative"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],["mat-flat-button","","color","primary",3,"click"],[1,"whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],[1,"flex","flex-col","items-center","p-2","hover:bg-gray-200","rounded-lg",3,"click"],["matTooltip","Upload File",1,"material-symbols-outlined","text-xl"],[1,"text-xs"],["type","file",1,"hidden",3,"change"],["color","primary","mat-icon-button","",3,"click"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","routerLinkActive","!bg-slate-100",3,"routerLink",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4"],["mat-cell",""],["mat-header-row",""],["mat-row","","routerLinkActive","!bg-slate-100",3,"routerLink"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(i,g){if(i&1){let o=R();e(0,"mat-drawer-container",4)(1,"mat-drawer",5,0),p(3,"router-outlet"),n(),e(4,"div",6)(5,"div",7)(6,"div",8)(7,"div",8)(8,"div",9)(9,"div",10)(10,"input",11,1),K("keyup",function(T){return r(o),P(g.applyFilter(T))}),n(),e(12,"div",12)(13,"span",13),c(14,"search"),n()()(),e(15,"button",14),K("click",function(){return r(o),P(g.create())}),e(16,"span"),c(17,"Th\xEAm"),n(),e(18,"mat-icon"),c(19,"add_circle"),n()()(),e(20,"div",9)(21,"span",15),c(22),n(),e(23,"div",16),K("click",function(){return r(o),P(g.writeExcelFile())}),e(24,"span",17),c(25,"file_download"),n(),e(26,"span",18),c(27,"Download"),n()(),e(28,"div",16),K("click",function(){r(o);let T=x(34);return P(T.click())}),e(29,"span",17),c(30,"file_upload"),n(),e(31,"span",18),c(32,"Upload"),n(),e(33,"input",19,2),K("change",function(T){return r(o),P(g.readExcelFile(T))}),n()(),e(35,"button",20),K("click",function(){return r(o),P(g.LoadDrive())}),e(36,"mat-icon"),c(37,"cloud_download"),n()(),e(38,"button",21)(39,"mat-icon"),c(40,"tune"),n()(),e(41,"mat-menu",null,3)(43,"div",22)(44,"mat-form-field",23)(45,"input",24),K("input",function(T){return r(o),P(g.doFilterColumns(T))})("click",function(T){return r(o),P(T.stopPropagation())}),n(),e(46,"mat-icon",25),c(47,"search"),n()()(),e(48,"div",26),w(49,Z0,5,2,"button",27,Y0),n()()()()(),e(51,"div",28)(52,"table",29),w(53,ot,3,1,"ng-container",30,A),f(55,nt,1,0,"tr",31)(56,lt,1,3,"tr",32)(57,ct,3,1,"tr",33),n(),p(58,"mat-paginator",34),n()()()()}if(i&2){let o=x(42);d(),h("position","end"),d(21),m(" ",g.CountItem," S\u1EA3n Ph\u1EA9m "),d(16),h("matMenuTriggerFor",o),d(11),D(g.FilterColumns),d(3),h("dataSource",g.dataSource),d(),D(g.displayedColumns),d(2),h("matHeaderRowDef",g.displayedColumns),d(),h("matRowDefColumns",g.displayedColumns),d(2),h("pageSizeOptions",Q(7,J0))}},dependencies:[o0,e0,a0,l0,n0,D0,y0,b0,B0,L0,f0,k0,_0,x0,H0,N0,w0,C0,k,p0,s0,B,S0,d0,c0,T0,r0,M0,v0,J,G0,V0,h0,P0,I0,u0,Y,z,Z,t0],encapsulation:2})};export{q0 as a};
