import './polyfills.server.mjs';
import{a as ut}from"./chunk-5BR6KYCS.mjs";import{a as ft}from"./chunk-5STWNSQI.mjs";import{a as ht}from"./chunk-HJ5P55UZ.mjs";import{a as _t}from"./chunk-QXSAOUK4.mjs";import{c as et,d as tt,e as it,f as at,g as nt,h as rt,i as ot,j as st,k as lt}from"./chunk-2XUIDBTW.mjs";import"./chunk-OB6WK4UN.mjs";import{a as A,b as Ne,c as Xe,d as ze,e as We,f as He,h as $e,i as je,k as Ue,l as Ge,n as Ye,o as qe,q as Qe,r as Ze,s as Je,t as W}from"./chunk-AWVOBO46.mjs";import{b as Ve,c as Re}from"./chunk-JA5FUANC.mjs";import{a as Ee,b as ke,c as Te,d as Pe}from"./chunk-2SPWQTUK.mjs";import{b as F,c as Oe}from"./chunk-AN7XHSP3.mjs";import{a as wt}from"./chunk-DMGGUUBV.mjs";import{b as Me,c as Be}from"./chunk-TMXDKQ3S.mjs";import{a as Ke,b as Ie}from"./chunk-2ORIYJC7.mjs";import{a as xe,c as Se,d as ve,g as we,h as De}from"./chunk-BSNIFGO2.mjs";import"./chunk-RWP2M6BI.mjs";import{b as he,g as fe,j as be,l as ye,r as Ce}from"./chunk-UB2O3VBN.mjs";import"./chunk-JGATIPIB.mjs";import{a as dt,b as pt}from"./chunk-3SMMAAF6.mjs";import{a as mt}from"./chunk-7LSZI76F.mjs";import{a as gt}from"./chunk-VZM6J5LW.mjs";import{b as ct}from"./chunk-L4NLH23U.mjs";import{a as Le,c as Fe,e as Ae}from"./chunk-T3MZ2PZ5.mjs";import{L as ge,R as ue,_ as _e}from"./chunk-T45AR7GG.mjs";import"./chunk-AF4BUXQF.mjs";import"./chunk-G7N755OS.mjs";import"./chunk-5YH22JMS.mjs";import{r as de,u as pe}from"./chunk-CKIW7MJC.mjs";import{o as ce,u as me}from"./chunk-SJCEIPIQ.mjs";import{Ac as O,Bb as P,Bc as N,Cb as Z,Ec as L,Fa as j,Fc as c,Ga as U,Gc as X,Hb as J,Hc as S,Ib as b,Ja as G,Lc as w,Mc as D,Nc as M,Oc as oe,Pa as Y,Pc as y,Rc as se,Vb as ee,Wb as g,Xb as K,Yb as te,_b as ie,bc as C,cc as ae,dc as E,dd as le,ec as k,fc as o,ga as H,gc as s,hc as f,ia as $,ic as ne,jc as re,la as h,lc as x,md as z,ob as l,qc as u,sc as m,tb as q,ua as d,va as p,wb as Q,zc as I}from"./chunk-T45FBOIK.mjs";import"./chunk-KB5IWD3E.mjs";import{a as B,g as vt,i as v}from"./chunk-AFOT676I.mjs";var V=vt(wt());function Mt(n,a){n&1&&f(0,"div",2)}var Bt=new $("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");var yt=(()=>{class n{_elementRef=h(G);_ngZone=h(U);_changeDetectorRef=h(le);_renderer=h(q);_cleanupTransitionEnd;_animationMode=h(Y,{optional:!0});constructor(){let e=h(Bt,{optional:!0});this._isNoopAnimation=this._animationMode==="NoopAnimations",e&&(e.color&&(this.color=this._defaultColor=e.color),this.mode=e.mode||this.mode)}_isNoopAnimation=!1;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";get value(){return this._value}set value(e){this._value=bt(e||0),this._changeDetectorRef.markForCheck()}_value=0;get bufferValue(){return this._bufferValue||0}set bufferValue(e){this._bufferValue=bt(e||0),this._changeDetectorRef.markForCheck()}_bufferValue=0;animationEnd=new j;get mode(){return this._mode}set mode(e){this._mode=e,this._changeDetectorRef.markForCheck()}_mode="determinate";ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._cleanupTransitionEnd=this._renderer.listen(this._elementRef.nativeElement,"transitionend",this._transitionendHandler)})}ngOnDestroy(){this._cleanupTransitionEnd?.()}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${this.mode==="buffer"?this.bufferValue:100}%`}_isIndeterminate(){return this.mode==="indeterminate"||this.mode==="query"}_transitionendHandler=e=>{this.animationEnd.observers.length===0||!e.target||!e.target.classList.contains("mdc-linear-progress__primary-bar")||(this.mode==="determinate"||this.mode==="buffer")&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))};static \u0275fac=function(i){return new(i||n)};static \u0275cmp=P({type:n,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(i,t){i&2&&(ee("aria-valuenow",t._isIndeterminate()?null:t.value)("mode",t.mode),ie("mat-"+t.color),te("_mat-animation-noopable",t._isNoopAnimation)("mdc-linear-progress--animation-ready",!t._isNoopAnimation)("mdc-linear-progress--indeterminate",t._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",z],bufferValue:[2,"bufferValue","bufferValue",z],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[J],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(i,t){i&1&&(o(0,"div",0),f(1,"div",1),b(2,Mt,1,0,"div",2),s(),o(3,"div",3),f(4,"span",4),s(),o(5,"div",5),f(6,"span",4),s()),i&2&&(l(),K("flex-basis",t._getBufferBarFlexBasis()),l(),C(t.mode==="buffer"?2:-1),l(),K("transform",t._getPrimaryBarTransform()))},styles:[`.mat-mdc-progress-bar{display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mdc-linear-progress-track-height, 4px),var(--mdc-linear-progress-active-indicator-height, 4px))}@media(forced-colors: active){.mdc-linear-progress{outline-color:CanvasText}}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mdc-linear-progress-active-indicator-color, var(--mat-sys-primary));border-top-width:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mdc-linear-progress-track-height, 4px);border-radius:var(--mdc-linear-progress-track-shape, var(--mat-sys-corner-none))}.mdc-linear-progress__buffer-dots{-webkit-mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear;background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}@media(forced-colors: active){.mdc-linear-progress__buffer-dots{background-color:ButtonBorder}}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mdc-linear-progress-track-height, 4px) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}`],encapsulation:2,changeDetection:0})}return n})();function bt(n,a=0,e=100){return Math.max(a,Math.min(e,n))}var Ct=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Z({type:n});static \u0275inj=H({imports:[ge]})}return n})();var xt=(n,a)=>a.key,kt=(n,a)=>a.id,T=()=>({standalone:!0}),Tt=()=>({key:"bansi",value:"B\xE1n S\u1EC9"}),Pt=()=>({key:"banle",value:"B\xE1n L\u1EBB"}),Lt=(n,a)=>[n,a],Ft=()=>[5,10,25,100];function At(n,a){n&1&&c(0," Th\xEAm B\u1EA3ng Gi\xE1 ")}function Vt(n,a){if(n&1&&c(0),n&2){let e,i=m();S(" ",((e=i.Detail())==null?null:e.Title)||"Ch\u01B0a \u0110\u1EB7t T\xEAn"," ")}}function Rt(n,a){if(n&1){let e=x();o(0,"button",12),u("click",function(){d(e);let t=m();return p(t.isDelete=!0)}),o(1,"mat-icon"),c(2,"delete"),s()()}}function Kt(n,a){if(n&1){let e=x();o(0,"div",10)(1,"div",6),c(2,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),s(),o(3,"div",13)(4,"button",14),u("click",function(){d(e);let t=m();return p(t.DeleteData())}),c(5," \u0110\u1ED3ng \xDD "),s(),o(6,"button",15),u("click",function(){d(e);let t=m();return p(t.isDelete=!1)}),c(7," Hu\u1EF7 B\u1ECF "),s()()()}}function It(n,a){if(n&1&&(o(0,"mat-option",20),c(1),s()),n&2){let e=a.$implicit;g("value",e.key),l(),X(e.value)}}function Ot(n,a){if(n&1){let e=x();o(0,"button",54),u("click",function(t){let r=d(e).$implicit;return m(2).ChosenKhachhang(r),p(t.stopPropagation())}),o(1,"span"),c(2),s()()}if(n&2){let e=a.$implicit;l(2),X(e.TenKH||e.Hoten||"Ch\u01B0a \u0110\u1EB7t T\xEAn")}}function Nt(n,a){if(n&1){let e=x();o(0,"div",36)(1,"span"),c(2),s(),o(3,"mat-icon",55),u("click",function(){let t=d(e).$implicit,r=m(2);return p(r.RemoveKhachhang(t))}),c(4,"cancel"),s()()}if(n&2){let e=a.$implicit;l(2),S(" ",e.TenKH||e.Hoten||"Ch\u01B0a \u0110\u1EB7t T\xEAn"," ")}}function Xt(n,a){n&1&&f(0,"mat-progress-bar",56)}function zt(n,a){if(n&1&&(o(0,"th",59)(1,"span",60),c(2),s()()),n&2){let e=m().$implicit,i=m(2);l(2),S(" ",i.ColumnName[e]," ")}}function Wt(n,a){if(n&1&&(o(0,"span",60),c(1),s()),n&2){let e=m().index;l(),S(" ",e+1," ")}}function Ht(n,a){if(n&1){let e=x();o(0,"mat-form-field",62)(1,"mat-label"),c(2,"Gi\xE1 B\xE1n"),s(),o(3,"input",63),M("ngModelChange",function(t){d(e);let r=m().$implicit,_=m().$implicit;return D(r[_],t)||(r[_]=t),p(t)}),u("change",function(t){d(e);let r=m().$implicit,_=m(3);return p(_.updateGiaBan(r,t))}),s()()}if(n&2){let e=m().$implicit,i=m().$implicit;l(3),w("ngModel",e[i]),g("ngModelOptions",y(2,T))}}function $t(n,a){if(n&1&&(o(0,"span",60),c(1),s()),n&2){let e=m().$implicit,i=m().$implicit;l(),S(" ",e[i]," ")}}function jt(n,a){if(n&1&&(o(0,"td",61),b(1,Wt,2,1,"span",60)(2,Ht,4,3,"mat-form-field",62)(3,$t,2,1,"span",60),s()),n&2){let e,i=m().$implicit;l(),C((e=i)==="STT"?1:e==="giaban"?2:3)}}function Ut(n,a){if(n&1&&(ne(0,49),b(1,zt,3,1,"th",57)(2,jt,4,1,"td",58),re()),n&2){let e=a.$implicit;g("matColumnDef",e)}}function Gt(n,a){n&1&&f(0,"tr",64)}function Yt(n,a){n&1&&f(0,"tr",65)}function qt(n,a){n&1&&f(0,"tr",66)}function Qt(n,a){if(n&1){let e=x();o(0,"div",11)(1,"div",16)(2,"mat-form-field",17)(3,"mat-label"),c(4,"Ti\xEAu \u0110\u1EC1"),s(),o(5,"input",18),M("ngModelChange",function(t){d(e);let r=m();return D(r.Detail().Title,t)||(r.Detail().Title=t),p(t)}),s()(),o(6,"mat-form-field",17)(7,"mat-label"),c(8,"Lo\u1EA1i"),s(),o(9,"mat-select",19),M("ngModelChange",function(t){d(e);let r=m();return D(r.Detail().Type,t)||(r.Detail().Type=t),p(t)}),E(10,It,2,2,"mat-option",20,xt),s()(),o(12,"mat-form-field",21)(13,"mat-label"),c(14,"Kho\u1EA3ng Th\u1EDDi Gian"),s(),o(15,"mat-date-range-input",22)(16,"input",23),M("ngModelChange",function(t){d(e);let r=m();return D(r.Detail().Batdau,t)||(r.Detail().Batdau=t),p(t)}),s(),o(17,"input",24),M("ngModelChange",function(t){d(e);let r=m();return D(r.Detail().Ketthuc,t)||(r.Detail().Ketthuc=t),p(t)}),s()(),f(18,"mat-datepicker-toggle",25),o(19,"mat-date-range-picker",26,0)(21,"mat-date-range-picker-actions")(22,"button",27),c(23,"Hu\u1EF7 B\u1ECF"),s(),o(24,"button",28),u("click",function(){d(e);let t=m();return p(t.ApplyDate())}),c(25,"\u0110\u1ED3ng \xDD"),s()()()()(),o(26,"div",29)(27,"span"),c(28,"Nh\xE0 h\xE0ng \u0111ang s\u1EED d\u1EE5ng b\u1EA3ng gi\xE1 n\xE0y : "),s(),o(29,"button",30)(30,"span"),c(31,"Th\xEAm"),s(),o(32,"mat-icon"),c(33,"add_circle"),s()(),o(34,"mat-menu",null,1)(36,"div",31)(37,"mat-form-field",17)(38,"input",32),u("input",function(t){d(e);let r=m();return p(r.doFilterKhachhang(t))})("click",function(t){return d(e),p(t.stopPropagation())}),s(),o(39,"mat-icon",33),c(40,"search"),s()()(),o(41,"div",34),E(42,Ot,3,1,"button",35,xt),s()(),E(44,Nt,5,1,"div",36,kt),s(),o(46,"div",37)(47,"div",38)(48,"span",39),c(49),s(),o(50,"div",40)(51,"input",41,2),u("keyup",function(t){d(e);let r=m();return p(r.applyFilter(t))}),s(),o(53,"div",42)(54,"span",43),c(55,"search"),s()()(),o(56,"button",44),u("click",function(){d(e);let t=m();return p(t.writeExcelFile())}),o(57,"mat-icon"),c(58,"file_download"),s()(),o(59,"button",44),u("click",function(){d(e);let t=L(63);return p(t.click())}),o(60,"mat-icon"),c(61,"file_upload"),s()(),o(62,"input",45,3),u("change",function(t){d(e);let r=m();return p(r.readExcelFile(t))}),s(),o(64,"button",44),u("click",function(){d(e);let t=m();return p(t.LoadDrive())}),o(65,"mat-icon"),c(66,"cloud_download"),s()(),b(67,Xt,1,0,"mat-progress-bar",46),s(),o(68,"div",47)(69,"table",48),E(70,Ut,3,1,"ng-container",49,ae),b(72,Gt,1,0,"tr",50)(73,Yt,1,0,"tr",51)(74,qt,1,0,"tr",52),s(),f(75,"mat-paginator",53),s()()()}if(n&2){let e,i=L(20),t=L(35),r=m();l(5),w("ngModel",r.Detail().Title),g("ngModelOptions",y(19,T)),l(4),w("ngModel",r.Detail().Type),g("ngModelOptions",y(20,T)),l(),k(se(23,Lt,y(21,Tt),y(22,Pt))),l(2),g("appearance","outline")("subscriptSizing","dynamic"),l(3),g("rangePicker",i),l(),w("ngModel",r.Detail().Batdau),g("ngModelOptions",y(26,T)),l(),w("ngModel",r.Detail().Ketthuc),g("ngModelOptions",y(27,T)),l(),g("for",i),l(11),g("matMenuTriggerFor",t),l(13),k(r.FilterKhachhang),l(2),k(r.ExistsKhachhang),l(5),S("Danh S\xE1ch S\u1EA3n Ph\u1EA9m (",(e=r.Detail())==null||e.ListSP==null?null:e.ListSP.length,")"),l(18),g("ngIf",r.isLoading),l(2),g("dataSource",r.dataSource),l(),k(r.displayedColumns),l(2),g("matHeaderRowDef",r.displayedColumns),l(),g("matRowDefColumns",r.displayedColumns),l(2),g("pageSizeOptions",y(28,Ft))}}var St=class n{_ListbanggiaComponent=h(ft);_BanggiasService=h(_t);_SanphamsService=h(ut);_DonhangsService=h(gt);_KhachhangsService=h(ht);_router=h(de);_Router=h(pe);_snackBar=h(mt);constructor(){}Detail=Q({Type:"bansi",ListSP:[],Batdau:(0,V.default)().startOf("day").toDate(),Ketthuc:(0,V.default)().startOf("day").toDate()});isEdit=!1;isDelete=!1;idBanggia;ListSanpham=[];ListKhachhang=[];FilterKhachhang=[];ExistsKhachhang=[];CountItem=0;dataSource;displayedColumns=["id","STT","MaSP","Title","dvt","giagoc","giaban"];ColumnName={id:"ID",STT:"STT",MaSP:"M\xE3 S\u1EA3n Ph\u1EA9m",Title:"T\xEAn S\u1EA3n Ph\u1EA9m",dvt:"\u0110\u01A1n V\u1ECB T\xEDnh",giagoc:"Gi\xE1 G\u1ED1c",giaban:"Gi\xE1 B\xE1n"};paginator;sort;ngOnInit(){this._router.paramMap.subscribe(a=>v(this,null,function*(){this.idBanggia=a.get("id"),this.isEdit=this.idBanggia==="0",this.idBanggia&&this.idBanggia!=="0"?(this._ListbanggiaComponent.drawer.open(),yield this._BanggiasService.getBanggiaByid(this.idBanggia).then(e=>v(this,null,function*(){e&&(this.Detail=this._BanggiasService.Banggia,console.log(this.Detail()),yield this._KhachhangsService.getAllKhachhang(),this.ExistsKhachhang=this._KhachhangsService.ListKhachhang().filter(i=>i.idBanggia===this.idBanggia),this.FilterKhachhang=this.ListKhachhang=this._KhachhangsService.ListKhachhang().filter(i=>!this.ExistsKhachhang.some(t=>t.id===i.id)),this.MappingListSanpham())}))):this.idBanggia==="0"?(this.MappingListSanpham(),this._ListbanggiaComponent.drawer.open()):this._ListbanggiaComponent.drawer.close()}))}MappingListSanpham(){return v(this,null,function*(){yield this._SanphamsService.getAllSanpham(),this.ListSanpham=this._SanphamsService.ListSanpham(),this.Detail().ListSP=this.ListSanpham.map(a=>{let e=this.Detail()?.ListSP?.find(i=>i.MaSP===a.MaSP);return{id:a.id,Title:a.Title,MaSP:a.MaSP,giagoc:a.giagoc,dvt:a.dvt,giaban:e&&e.giaban>0?e.giaban:0}}),console.log(this.Detail().ListSP),this.dataSource=new W(this.Detail().ListSP),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,console.log(this.dataSource.data),this.dataSource.data,this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i",this.paginator._intl.getRangeLabel=(a,e,i)=>{if(i===0||e===0)return`0 c\u1EE7a ${i}`;i=Math.max(i,0);let t=a*e,r=t<i?Math.min(t+e,i):t+e;return`${t+1} - ${r} c\u1EE7a ${i}`},this.CountItem=this.dataSource.data.length})}updateGiaBan(a,e){let i=this.Detail().ListSP.findIndex(t=>t.MaSP===a.MaSP);this.Detail().ListSP[i]=a}ApplyDate(){}goBack(){window.location.href="/admin/banggia"}doFilterKhachhang(a){let e=a.target.value.toLowerCase();this.FilterKhachhang=this.ListKhachhang.filter(i=>i.value.toLowerCase().includes(e))}ChosenKhachhang(a){a.idBanggia=this.idBanggia,this._KhachhangsService.updateOneKhachhang(a).then(e=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}).catch(e=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\u1EA5t B\u1EA1i","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),console.error("Error updating Khachhang:",e)}),this.ExistsKhachhang=this._KhachhangsService.ListKhachhang().filter(e=>e.idBanggia===this.idBanggia),this.FilterKhachhang=this.ListKhachhang.filter(e=>!this.ExistsKhachhang.some(i=>i.id===e.id))}RemoveKhachhang(a){a.idBanggia="",this._KhachhangsService.updateOneKhachhang(a).then(e=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}),this.ExistsKhachhang=this._KhachhangsService.ListKhachhang().filter(e=>e.idBanggia===this.idBanggia),this.FilterKhachhang=this.ListKhachhang.filter(e=>this.ExistsKhachhang.some(i=>!i.id==e.id))}SaveData(){this.Detail().Title==""||this.Detail().Title==null?this._snackBar.open("Vui l\xF2ng nh\u1EADp ti\xEAu \u0111\u1EC1","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]}):(this.idBanggia=="0"?(this.Detail().ListSP=this.Detail().ListSP.map(a=>({MaSP:a.MaSP,giaban:a.giaban})),this._BanggiasService.CreateBanggia(this.Detail()).then(()=>{this._snackBar.open("Th\xEAm M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),window.location.href="/admin/banggia"})):(this.Detail().ListSP=this.Detail().ListSP.map(a=>({MaSP:a.MaSP,giaban:a.giaban})),this._BanggiasService.updateOneBanggia(this.Detail()).then(a=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})),this.isEdit=!1)}applyFilter(a){let e=a.target.value;this.dataSource.filter=e.trim().toLowerCase(),console.log(this.dataSource.filteredData),this.CountItem=this.dataSource.filteredData.length,this.dataSource.paginator&&this.dataSource.paginator.firstPage()}CoppyBanggia(){this._snackBar.open("\u0110ang Coppy","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]}),this.Detail().ListSP=this.Detail().ListSP.map(a=>({MaSP:a.MaSP,giaban:a.giaban})),delete this.Detail().id,this.Detail().Title=this.Detail().Title+" - Coppy",this._BanggiasService.CreateBanggia(this.Detail()).then(a=>{a&&setTimeout(()=>{window.location.href=`admin/banggia/${a.id}`},1e3)})}DeleteData(){this._BanggiasService.DeleteBanggia(this.Detail()).then(a=>{a&&this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}),window.location.href="/admin/banggia"}LoadDrive(){return v(this,null,function*(){this.isLoading=!0,this._snackBar.open("\u0110ang T\u1EA3i","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});let a={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"banggiaimport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},e=yield this._DonhangsService.getDrive(a),t=ct(e.values).map(r=>({MaSP:r.MaSP.trim(),giaban:Number(r?.giaban)||0}));if(console.log(t),typeof Worker<"u"){let r=new Worker(new URL("worker-OVFPWS2M.js",import.meta.url),{type:"module"});r.postMessage({sanphams:this._SanphamsService.ListSanpham(),transformedData:t}),r.onmessage=({data:_})=>{_.status==="success"?this.processData(_.data.transformedData):(this._snackBar.open("L\u1ED7i c\u1EADp nh\u1EADt: "+_.message,"",{duration:3e3,panelClass:["snackbar-error"]}),console.log(_.message)),this.isLoading=!1,r.terminate()}}else this._snackBar.open("Tr\xECnh duy\u1EC7t kh\xF4ng h\u1ED7 tr\u1EE3 Web Worker!","",{duration:3e3,panelClass:["snackbar-error"]}),this.isLoading=!1})}isLoading=!1;readExcelFile(a){let e=a.target.files[0];if(!e)return;this.isLoading=!0;let i=new FileReader;i.onload=t=>{let r=new Uint8Array(t.target.result);if(typeof Worker<"u"){let _=new Worker(new URL("worker-NWWMGLUR.js",import.meta.url),{type:"module"});_.postMessage(r),_.onmessage=({data:R})=>{R.status==="success"?this.processData(R.data):this._snackBar.open("L\u1ED7i \u0111\u1ECDc file: "+R.message,"",{duration:3e3,panelClass:["snackbar-error"]}),this.isLoading=!1,_.terminate()}}else this._snackBar.open("Tr\xECnh duy\u1EC7t kh\xF4ng h\u1ED7 tr\u1EE3 Web Worker!","",{duration:3e3,panelClass:["snackbar-error"]}),this.isLoading=!1},i.readAsArrayBuffer(e)}processData(a){return v(this,null,function*(){console.log(a);let e=a.map(t=>({MaSP:t.MaSP.trim(),giaban:Number(t.giaban)}));this.Detail().ListSP.forEach(t=>{t.giaban=0});let i=this.ListSanpham.map(t=>{let r=e.find(_=>_.MaSP===t.MaSP);return console.log(B(B({},t),r)),r?B(B({},t),r):t});this.Detail().ListSP=i.map(t=>({MaSP:t.MaSP.trim(),giaban:Number(t.giaban)||0})),console.log(this.ListSanpham),console.log(i.find(t=>t.MaSP=="I100002")),console.log(this.Detail().ListSP),console.log(this.Detail().ListSP.find(t=>t.MaSP=="I100002")),this.dataSource=new W(i),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this._BanggiasService.updateOneBanggia(this.Detail()).then(t=>{this._snackBar.open("Upload Th\xE0nh C\xF4ng!","",{duration:1e3,panelClass:["snackbar-success"]})})})}writeExcelFile(){let a=this.Detail().ListSP.map(r=>({MaSP:r.MaSP,giaban:r.giaban})),i={Sheets:{Sheet1:Re.json_to_sheet(a)},SheetNames:["Sheet1"]},t=Ve(i,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(t,"banggia_"+(0,V.default)().format("DD_MM_YYYY"))}saveAsExcelFile(a,e){let i=new Blob([a],{type:"application/octet-stream"}),t=window.URL.createObjectURL(i),r=document.createElement("a");r.href=t,r.download=`${e}.xlsx`,r.click(),window.URL.revokeObjectURL(t),r.remove()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=P({type:n,selectors:[["app-detailbanggia"]],viewQuery:function(e,i){if(e&1&&(I(F,5),I(A,5)),e&2){let t;O(t=N())&&(i.paginator=t.first),O(t=N())&&(i.sort=t.first)}},features:[oe([ue()])],decls:18,vars:3,consts:[["picker",""],["menu","matMenu"],["input",""],["uploadfile",""],[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold","text-lg"],[1,"flex","flex-row","space-x-2","items-center"],["mat-icon-button","","color","warn"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"w-full","flex","flex-col","space-y-6","items-center","p-2"],["mat-icon-button","","color","warn",3,"click"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"w-full","flex","lg:flex-row","flex-col","lg:space-x-2","lg:space-y-0","space-y-4","items-center"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","Vui l\xF2ng Nh\u1EADp Ti\xEAu \u0110\u1EC1",3,"ngModelChange","ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"],[3,"value"],[1,"w-full",3,"appearance","subscriptSizing"],[3,"rangePicker"],["matStartDate","","placeholder","Ng\xE0y B\u1EAFt \u0110\u1EA7u",3,"ngModelChange","ngModel","ngModelOptions"],["matEndDate","","placeholder","Ng\xE0y K\u1EBFt Th\xFAc",3,"ngModelChange","ngModel","ngModelOptions"],["matIconSuffix","",3,"for"],["touchUi",""],["mat-stroked-button","","color","warn","matDateRangePickerCancel",""],["mat-stroked-button","","color","primary","matDateRangePickerApply","",3,"click"],[1,"w-full","flex","flex-row","flex-wrap","gap-2","space-x-2","items-center","cursor-pointer"],["mat-flat-button","","color","primary",3,"matMenuTriggerFor"],[1,"p-4"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],[1,"flex","flex-row","space-x-2","items-center","cursor-pointer","rounded-lg","bg-slate-200","hover:bg-slate-50","p-2"],[1,"w-full","flex","flex-col","space-y-2","items-center"],[1,"flex","flex-row","space-x-2","items-center","cursor-pointer"],[1,"font-bold"],[1,"relative"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],["color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],["mode","indeterminate",4,"ngIf"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],["color","warn",3,"click"],["mode","indeterminate"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4"],["mat-cell",""],["appearance","outline","subscriptSizing","dynamic"],["matInput","","type","number","placeholder","Vui l\xF2ng Nh\u1EADp Ti\xEAu \u0110\u1EC1",3,"ngModelChange","change","ngModel","ngModelOptions"],["mat-header-row",""],["mat-row",""],[1,"mat-row"]],template:function(e,i){e&1&&(o(0,"div",4)(1,"button",5),u("click",function(){return i.goBack()}),o(2,"mat-icon"),c(3,"arrow_back"),s()(),o(4,"div",6),b(5,At,1,0)(6,Vt,1,1),s(),o(7,"div",7)(8,"button",5),u("click",function(){return i.CoppyBanggia()}),o(9,"mat-icon"),c(10,"content_copy"),s()(),o(11,"button",5),u("click",function(){return i.SaveData()}),o(12,"mat-icon"),c(13,"save"),s()(),b(14,Rt,3,0,"button",8),s()(),o(15,"div",9),b(16,Kt,8,0,"div",10)(17,Qt,76,29,"div",11),s()),e&2&&(l(5),C(i.idBanggia==0?5:6),l(9),C(i.idBanggia!="0"?14:-1),l(2),C(i.isDelete==!0?16:17))},dependencies:[De,we,xe,Se,ve,Be,Me,Ce,he,ye,fe,be,pt,dt,Ae,Le,Fe,Ie,Ke,_e,Je,ze,He,Ge,$e,We,Ye,je,Ue,qe,Qe,Ze,Oe,F,Xe,A,Ne,lt,et,at,tt,it,nt,st,ot,rt,me,ce,Ct,yt,Pe,ke,Ee,Te],encapsulation:2})};export{St as DetailBanggiaComponent};
