import './polyfills.server.mjs';
import{G as u,L as m}from"./chunk-T45AR7GG.mjs";import{b as v}from"./chunk-CKIW7MJC.mjs";import{Cb as f,F as c,fa as h,ga as b,ia as p,ka as l,p as g,s}from"./chunk-T45FBOIK.mjs";var j=(()=>{class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=f({type:r});static \u0275inj=b({imports:[u,m,m]})}return r})();var y=new p("Google Sheets API key"),T=(()=>{class r{constructor(t,e){this.http=t,this.apiKey=e,this.defaultActiveValues=["true","1","yes"]}get(t,e,i){return this.getRows(t,e).pipe(s(n=>this.rowsToEntries(n).map(a=>this.getObjectFromEntry(a,i))))}getActive(t,e,i,n="is_active",a=null){return a===null?a=this.defaultActiveValues:Array.isArray(a)||(a=[a]),this.getRows(t,e).pipe(s(o=>this.rowsToEntries(o).filter(d=>a.includes(d[n].toLowerCase())).map(d=>this.getObjectFromEntry(d,i))))}getSpreadsheetUrl(t,e){return"https://sheets.googleapis.com/v4/spreadsheets/"+t+"/values/"+encodeURI(e)+"?key="+this.apiKey}getRows(t,e){let i=this.getSpreadsheetUrl(t,e);return this.http.get(i).pipe(s(n=>n.values),c(this.handleError))}rowsToEntries(t){let e=t[0].map(this.cleanColumnName);return t.slice(1).map(i=>e.reduce((n,a,o)=>(n[a]=i.length>o?i[o]:"",n),{}))}cleanColumnName(t){return t.trim()}arrayToObject(t){return t.reduce((e,i)=>(e[i]=i,e),{})}getObjectFromEntry(t,e){return Array.isArray(e)&&(e=this.arrayToObject(e)),this.getObjectFromEntryObject(t,e)}getObjectFromEntryObject(t,e,i=""){let n={};for(let a in Object(e))if(e.hasOwnProperty(a)&&!["_prefix","_listField"].includes(a))if(typeof e[a]=="string")n[a]=this.getValueFromEntry(t,i+e[a]);else if(typeof e[a]=="object"){let o="";e[a].hasOwnProperty("_prefix")&&(o=e[a]._prefix),e[a]._listField?n[a]=this.getListFromEntry(t,i+o):n[a]=this.getObjectFromEntryObject(t,e[a],i+o)}else console.log(`Unknown type for ${a}`);return n}getValueFromEntry(t,e){return e=this.cleanColumnName(e),t.hasOwnProperty(e)?t[e]:null}getListFromEntry(t,e){let i=[],n=1,a=this.getValueFromEntry(t,`${e}${n}`);for(;a;)i.push(a),n++,a=this.getValueFromEntry(t,`${e}${n}`);return i}handleError(t){return t.error instanceof ErrorEvent?console.error("An error occurred:",t.error.message):console.error(`Backend returned code ${t.status}, body was: ${t.error}`),g("Something bad happened; please try again later.")}}return r.\u0275prov=h({factory:function(){return new r(l(v),l(y))},token:r,providedIn:"root"}),r})();export{j as a,y as b,T as c};
