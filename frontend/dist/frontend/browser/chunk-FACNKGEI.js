import{a as Ut}from"./chunk-F53MXFV5.js";import{a as Zt,b as Yt}from"./chunk-4LF5H6KK.js";import{a as wt}from"./chunk-F7ZUSHKR.js";import{a as Wt}from"./chunk-COWQVJ22.js";import{b as bt,d as Ft,e as kt}from"./chunk-3F7BKIWY.js";import{a as Lt,b as It,c as L,d as Vt,e as I,f as Nt,g as At,h as Pt,i as $t,j as Ot,k as Rt,l as Bt,m as zt,n as Ht,o as Qt,p as qt,q as Jt,r as Gt,s as Kt,t as jt}from"./chunk-BT34QCGY.js";import{a as ut,b as dt,c as _t,d as ht}from"./chunk-4VMWOG5L.js";import{a as lt,b as st,c as mt}from"./chunk-TLJY3B4G.js";import{h as Et}from"./chunk-AVTK7OHB.js";import{a as ct,b as pt}from"./chunk-2PYSLW36.js";import{B as Mt,C as Tt,b as ot,d as rt,f as gt,k as ft,n as Ct,r as xt,t as yt,u as Dt,y as St,z as vt}from"./chunk-BV4CB2ZV.js";import{b as et,c as it}from"./chunk-AT25UK5T.js";import{H as nt,I as at}from"./chunk-UJ6KPBTM.js";import{l as Y,m as U,o as X,q as tt}from"./chunk-DWIAGLI5.js";import{$b as a,Ac as f,Bc as G,Dc as K,Ec as j,Fc as W,Gb as y,Hc as O,Mc as F,Oc as k,Qb as h,Tb as B,Ub as z,Wb as N,Yb as H,Zb as A,_b as P,ac as o,ad as Z,bc as v,cc as Q,dc as q,fc as S,kc as g,la as D,mc as s,nb as l,qc as J,sc as M,tc as T,ua as d,uc as E,va as _,xc as $,yc as c,zb as R,zc as b}from"./chunk-IP4WVCMP.js";import{a as V,i as w}from"./chunk-GHPEL4IW.js";var ne=["drawer"],ae=()=>[5,10,25,100],oe=()=>({standalone:!0}),re=(n,e)=>e.key;function le(n,e){if(n&1){let t=S();a(0,"button",30),g("click",function(r){let p=d(t).$implicit;return s().toggleColumn(p),_(r.stopPropagation())}),a(1,"mat-icon"),c(2),o(),a(3,"span"),c(4),o()()}if(n&2){let t=e.$implicit;l(2),b(t.isShow?"check_box":"check_box_outline_blank"),l(2),b(t.value)}}function se(n,e){if(n&1){let t=S();a(0,"mat-form-field",33)(1,"mat-label"),c(2),o(),a(3,"input",34),g("keyup",function(){d(t);let r=s(2);return _(r.applyFilter())}),W("ngModelChange",function(r){let p=d(t).$implicit,u=s(2);return j(u.filterValues[p],r)||(u.filterValues[p]=r),_(r)}),o()()}if(n&2){let t=e.$implicit,i=s(2);l(2),b(i.ColumnName[t]),l(),J("placeholder","Vui l\xF2ng Nh\u1EADp ",t,""),K("ngModel",i.filterValues[t]),h("ngModelOptions",O(5,oe))}}function me(n,e){if(n&1&&(a(0,"div",31),y(1,se,4,6,"mat-form-field",32),o()),n&2){let t=s();l(),h("ngForOf",t.displayedColumns)}}function ce(n,e){if(n&1&&(a(0,"th",37)(1,"span",38),c(2),o()()),n&2){let t=s().$implicit,i=s();l(2),f(" ",i.ColumnName[t]," ")}}function pe(n,e){if(n&1&&(a(0,"span",40),c(1),o()),n&2){let t=s().index;l(),f(" ",t+1," ")}}function ue(n,e){if(n&1&&(a(0,"span",40),c(1),o()),n&2){let t=s().$implicit,i=s().$implicit;l(),f(" ",t[i].length," ")}}function de(n,e){if(n&1&&(a(0,"span",40),c(1),o()),n&2){let t=s().$implicit,i=s().$implicit;l(),G(" (",t[i].mancc,") ",t[i].name," ")}}function _e(n,e){if(n&1&&(a(0,"span",40),c(1),F(2,"date"),o()),n&2){let t=s().$implicit,i=s().$implicit;l(),f(" ",k(2,1,t[i],"dd/MM/yyyy")," ")}}function he(n,e){if(n&1&&(a(0,"span",40),c(1),F(2,"date"),o()),n&2){let t=s().$implicit,i=s().$implicit;l(),f(" ",k(2,1,t[i],"dd/MM/yyyy")," ")}}function ge(n,e){n&1&&(a(0,"mat-icon",41),c(1,"check_circle"),o())}function fe(n,e){n&1&&(a(0,"mat-icon",42),c(1,"cancel"),o())}function Ce(n,e){if(n&1&&(a(0,"span",40),y(1,ge,2,0,"mat-icon",41)(2,fe,2,0,"mat-icon",42),o()),n&2){let t=s().$implicit,i=s().$implicit;l(),N(t[i]?1:2)}}function xe(n,e){if(n&1&&(a(0,"span",40),c(1),F(2,"date"),o()),n&2){let t=s().$implicit,i=s().$implicit;l(),f(" ",k(2,1,t[i],"dd/MM/yyyy")," ")}}function we(n,e){if(n&1&&(a(0,"span",40),c(1),o()),n&2){let t=s().$implicit,i=s().$implicit;l(),f(" ",t[i]," ")}}function ye(n,e){if(n&1&&(a(0,"td",39),y(1,pe,2,1,"span",40)(2,ue,2,1,"span",40)(3,de,2,2,"span",40)(4,_e,3,4,"span",40)(5,he,3,4,"span",40)(6,Ce,3,1,"span",40)(7,xe,3,4,"span",40)(8,we,2,1,"span",40),o()),n&2){let t,i=s().$implicit;l(),N((t=i)==="STT"?1:t==="sanpham"?2:t==="nhacungcap"?3:t==="ngaynhan"?4:t==="createdAt"?5:t==="isActive"?6:t==="updatedAt"?7:8)}}function De(n,e){if(n&1&&(Q(0,25),y(1,ce,3,1,"th",35)(2,ye,9,1,"td",36),q()),n&2){let t=e.$implicit;h("matColumnDef",t)}}function Se(n,e){n&1&&v(0,"tr",43)}function ve(n,e){if(n&1){let t=S();a(0,"tr",44),g("click",function(){let r=d(t).$implicit,p=s();return _(p.goToDetail(r))}),o()}if(n&2){let t=e.$implicit,i=s();z("hover:bg-slate-100 ",i.dathangId()==t.id?"!bg-slate-200":"","")}}function Me(n,e){n&1&&(a(0,"tr",45)(1,"td",46),c(2,"Kh\xF4ng t\xECm th\u1EA5y"),o()())}var Xt=class n{Detail={};displayedColumns=["STT","nhacungcap","sanpham","ngaynhan","ghichu","isActive","createdAt","updatedAt"];ColumnName={STT:"STT",nhacungcap:"Nh\xE0 Cung C\u1EA5p",sanpham:"S\u1EA3n Ph\u1EA9m",ngaynhan:"Ng\xE0y Nh\u1EADn",ghichu:"Ghi Ch\xFA",isActive:"Tr\u1EA1ng Th\xE1i",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("DathangColFilter")||"[]");Columns=[];isFilter=!1;paginator;sort;drawer;filterValues={};_DathangService=D(Ut);_breakpointObserver=D(nt);_GoogleSheetService=D(Wt);_router=D(it);Listdathang=this._DathangService.ListDathang;dataSource=Z(()=>{let e=new jt(this.Listdathang());return e.filterPredicate=this.createFilter(),e.paginator=this.paginator,e.sort=this.sort,e});dathangId=this._DathangService.dathangId;_snackBar=D(wt);CountItem=0;constructor(){this.displayedColumns.forEach(e=>{this.filterValues[e]=""})}createFilter(){return(e,t)=>{let i=JSON.parse(t),r=!0;return this.displayedColumns.forEach(p=>{if(i[p]){let u=e[p]?e[p].toString().toLowerCase():"";r=r&&u.includes(i[p].toLowerCase())}}),r}}applyFilter(){this.dataSource().filter=JSON.stringify(this.filterValues)}ngOnInit(){return w(this,null,function*(){yield this._DathangService.getAllDathang(),this.CountItem=this.Listdathang().length,this.initializeColumns(),this.setupDrawer(),this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i"})}refresh(){return w(this,null,function*(){yield this._DathangService.getAllDathang()})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(e=>({key:e,value:this.ColumnName[e],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("DathangColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{})}setupDrawer(){this._breakpointObserver.observe([at.Handset]).subscribe(e=>{e.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}toggleColumn(e){let t=this.FilterColumns.find(i=>i.key===e.key);t&&(t.isShow=!t.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{}),localStorage.setItem("DathangColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(e){let t=e.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(i=>i.value.toLowerCase().includes(t))}create(){this.drawer.open(),this._router.navigate(["admin/dathang",0])}goToDetail(e){this._DathangService.setDathangId(e.id),this.drawer.open(),this._router.navigate(["admin/dathang",e.id])}LoadDrive(){return w(this,null,function*(){let e={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"SPImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},t=yield this._GoogleSheetService.getDrive(e),i=bt(t.values);console.log(i),this.DoImportData(i)})}DoImportData(e){console.log(e);let i=e.map(m=>({title:m.title?.trim()||"",masp:m.masp?.trim()||"",slug:`${Ft(m?.title?.trim()||"")}_${kt(5,!1)}`,giagoc:Number(m.giagoc)||0,dvt:m.dvt||"",soluong:Number(m.soluong)||0,soluongkho:Number(m.soluongkho)||0,ghichu:m.ghichu||"",order:Number(m.order)||0})).filter((m,C,x)=>C===x.findIndex(ie=>ie.masp===m.masp)),r=i.map(m=>m.masp),p=this._DathangService.ListDathang().map(m=>m.masp),u=r.filter(m=>!p.includes(m)),te=i.map(m=>w(this,null,function*(){let C=this._DathangService.ListDathang().find(x=>x.masp===m.masp);if(C){let x=V(V({},C),m);yield this._DathangService.updateDathang(x)}else yield this._DathangService.CreateDathang(m)})),ee=u.map(m=>w(this,null,function*(){let C=this._DathangService.ListDathang().find(x=>x.masp===m);C.isActive=!1,yield this._DathangService.updateDathang(C)}));Promise.all([...te,...ee]).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ImporExcel(e){return w(this,null,function*(){let t=yield Yt(e);this.DoImportData(t)})}ExportExcel(e,t){Zt(e,t)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=R({type:n,selectors:[["app-listdathang"]],viewQuery:function(t,i){if(t&1&&(M(L,5),M(I,5),M(ne,7)),t&2){let r;T(r=E())&&(i.paginator=r.first),T(r=E())&&(i.sort=r.first),T(r=E())&&(i.drawer=r.first)}},decls:48,vars:12,consts:[["drawer",""],["menu","matMenu"],["uploadfile",""],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[1,"cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","p-2","bg-white","rounded-lg"],[1,"flex","flex-row","space-x-2","items-center"],["matTooltip","Th\xEAm m\u1EDBi","color","primary","mat-icon-button","",3,"click"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","B\u1ED9 L\u1ECDc","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i l\xEAn file excel","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],["matTooltip","T\u1EA3i d\u1EEF li\u1EC7u t\u1EEB drive","color","primary","mat-icon-button","",3,"click"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],["class","w-full grid grid-cols-2 gap-2 lg:flex lg:flex-row lg:space-x-2 items-center",4,"ngIf"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"class","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],[1,"w-full","grid","grid-cols-2","gap-2","lg:flex","lg:flex-row","lg:space-x-2","items-center"],["appearance","outline","subscriptSizing","dynamic",4,"ngFor","ngForOf"],["appearance","outline","subscriptSizing","dynamic"],["matInput","",3,"keyup","ngModelChange","ngModel","ngModelOptions","placeholder"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,i){if(t&1){let r=S();a(0,"mat-drawer-container",3)(1,"mat-drawer",4,0),v(3,"router-outlet"),o(),a(4,"div",5)(5,"div",6)(6,"div",7)(7,"button",8),g("click",function(){return d(r),_(i.create())}),a(8,"mat-icon"),c(9,"add_circle"),o()(),a(10,"button",9)(11,"mat-icon"),c(12,"tune"),o()(),a(13,"mat-menu",null,1)(15,"div",10)(16,"mat-form-field",11)(17,"input",12),g("input",function(u){return d(r),_(i.doFilterColumns(u))})("click",function(u){return d(r),_(u.stopPropagation())}),o(),a(18,"mat-icon",13),c(19,"search"),o()()(),a(20,"div",14),A(21,le,5,2,"button",15,re),o()(),a(23,"button",16),g("click",function(){return d(r),_(i.isFilter=!i.isFilter)}),a(24,"mat-icon"),c(25,"filter_list"),o()(),a(26,"button",17),g("click",function(){return d(r),_(i.ExportExcel(i.Listdathang(),"Dathang"))}),a(27,"mat-icon"),c(28,"file_download"),o()(),a(29,"button",18),g("click",function(){d(r);let u=$(33);return _(u.click())}),a(30,"mat-icon"),c(31,"file_upload"),o()(),a(32,"input",19,2),g("change",function(u){return d(r),_(i.ImporExcel(u))}),o(),a(34,"button",20),g("click",function(){return d(r),_(i.LoadDrive())}),a(35,"mat-icon"),c(36,"cloud_download"),o()(),a(37,"span",21),c(38),o()()(),y(39,me,2,1,"div",22),a(40,"div",23)(41,"table",24),A(42,De,3,1,"ng-container",25,H),y(44,Se,1,0,"tr",26)(45,ve,1,3,"tr",27)(46,Me,3,0,"tr",28),o(),v(47,"mat-paginator",29),o()()()}if(t&2){let r=$(14);l(),h("position","end"),l(9),h("matMenuTriggerFor",r),l(11),P(i.FilterColumns),l(2),B(i.isFilter?"!bg-slate-200":""),l(15),f(" ",i.CountItem," S\u1EA3n Ph\u1EA9m "),l(),h("ngIf",i.isFilter),l(2),h("dataSource",i.dataSource()),l(),P(i.displayedColumns),l(2),h("matHeaderRowDef",i.displayedColumns),l(),h("matRowDefColumns",i.displayedColumns),l(2),h("pageSizeOptions",O(11,ae))}},dependencies:[vt,St,yt,Dt,Tt,Mt,Kt,Pt,Ot,Ht,Rt,$t,Qt,Bt,zt,qt,Jt,Gt,At,I,Nt,Vt,L,ht,dt,ut,_t,mt,lt,st,et,pt,ct,rt,ot,Et,tt,Y,U,X,xt,gt,ft,Ct,It,Lt],encapsulation:2})};export{Xt as a};
