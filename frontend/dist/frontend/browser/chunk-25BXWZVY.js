import{a as te}from"./chunk-OPAPPQ3O.js";import{a as ee}from"./chunk-RW3EOWVC.js";import{a as ie}from"./chunk-4UNTAX4Q.js";import"./chunk-EOEI42HP.js";import{a as Z,b as $}from"./chunk-TJBBA2QJ.js";import"./chunk-HVTWWBOW.js";import{h as O}from"./chunk-YHRNRWAA.js";import"./chunk-SXROZ6BE.js";import"./chunk-EF567M4M.js";import"./chunk-ZSJ3UUDV.js";import"./chunk-BAB5DLUR.js";import{a as K}from"./chunk-TXRZKS7R.js";import"./chunk-7AFVU22B.js";import"./chunk-YVAFC575.js";import{h as Y}from"./chunk-NTYGSVCK.js";import"./chunk-AJYWXVCD.js";import"./chunk-QXLQC4O2.js";import"./chunk-3F7BKIWY.js";import{a as N,b as W}from"./chunk-5BXLQK5T.js";import{B as Q,C as U,a as V,b as A,d as L,f as j,k as z,n as H,r as G,t as X,y as q,z as J}from"./chunk-TIGKRONL.js";import"./chunk-KMCH6EOU.js";import"./chunk-T3Q3DASN.js";import"./chunk-VUZTNYK4.js";import"./chunk-NRLKFN6P.js";import"./chunk-3PGBSEPL.js";import{a as F,c as B}from"./chunk-KS4WA6LC.js";import"./chunk-CK5GBNZG.js";import{m as T,q as I}from"./chunk-7YK4IZ67.js";import{$b as o,Ac as P,Dc as y,Ec as w,Fc as S,Gb as C,Na as R,Qb as m,Xb as b,Zb as M,_b as k,ac as r,cc as D,dc as v,fc as f,kc as d,la as _,mc as p,nb as s,ua as g,va as h,yc as a,zb as E,zc as x}from"./chunk-4NDLGA7M.js";import{j as u}from"./chunk-XXD5T5ZZ.js";function ne(l,e){if(l&1){let t=f();o(0,"button",1),d("click",function(){g(t);let n=p();return h(n.handleRoleAction())}),o(1,"mat-icon"),a(2,"save"),r()()}}function re(l,e){if(l&1){let t=f();o(0,"button",1),d("click",function(){g(t);let n=p();return h(n.toggleEdit())}),o(1,"mat-icon"),a(2,"edit"),r()()}}function le(l,e){if(l&1){let t=f();D(0),o(1,"div",9)(2,"div",10),a(3,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),r(),o(4,"div",11)(5,"button",12),d("click",function(){g(t);let n=p();return h(n.DeleteData())}),a(6,"\u0110\u1ED3ng \xDD"),r(),o(7,"button",13),d("click",function(){g(t);let n=p();return h(n.toggleDelete())}),a(8,"Hu\u1EF7 B\u1ECF"),r()()(),v()}}function ae(l,e){if(l&1){let t=f();o(0,"mat-slide-toggle",19),d("change",function(){let n=g(t).$implicit,c=p(2);return h(c.togglePermission(n))}),a(1),r()}if(l&2){let t=e.$implicit;m("checked",t.hasPermission),s(),P(" ",t.description," ")}}function se(l,e){if(l&1){let t=f();D(0),o(1,"div",14)(2,"mat-form-field",15)(3,"mat-label"),a(4,"T\xEAn Nh\xF3m"),r(),o(5,"input",16),S("ngModelChange",function(n){g(t);let c=p();return w(c.DetailRole.name,n)||(c.DetailRole.name=n),h(n)}),r()()(),o(6,"div",17),M(7,ae,2,2,"mat-slide-toggle",18,b),r(),v()}if(l&2){let t=p();s(5),y("ngModel",t.DetailRole.name),m("disabled",!t.isEdit()),s(2),k(t.filterPermission)}}var oe=class l{_ListroleComponent=_(te);_RoleService=_(ee);_PermissionService=_(ie);_route=_(F);_router=_(B);_snackBar=_(K);ListPermission=[];filterPermission=[];idRole=0;constructor(){this._route.paramMap.subscribe(e=>u(this,null,function*(){this.idRole=e.get("id")}))}DetailRole={};isEdit=R(!1);isDelete=R(!1);ngOnInit(){return u(this,null,function*(){yield this._PermissionService.getAllPermission(),this.ListPermission=this._PermissionService.ListPermission(),this.idRole?this.idRole==="0"?(this._ListroleComponent.drawer.open(),this.isEdit.update(e=>!e),this._router.navigate(["/admin/nhomuser","0"])):(yield this._RoleService.getRoleByid(this.idRole).then(()=>{this.DetailRole=this._RoleService.DetailRole(),this.filterPermission=this.ListPermission.map(e=>(this.DetailRole?.permissions?.length>0&&(e.hasPermission=!!this.DetailRole?.permissions.find(t=>t.permissionId===e.id)),e))}),this._ListroleComponent.drawer.open(),this._router.navigate(["/admin/nhomuser",this.idRole])):(this._router.navigate(["/admin/nhomuser"]),this._ListroleComponent.drawer.close())})}handleRoleAction(){return u(this,null,function*(){this.idRole==="0"?yield this.createRole():yield this.updateRole()})}createRole(){return u(this,null,function*(){console.log(this.DetailRole);try{yield this._RoleService.CreateRole(this.DetailRole),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi t\u1EA1o role:",e)}})}updateRole(){return u(this,null,function*(){try{yield this._RoleService.updateRole(this.DetailRole),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt role:",e)}})}DeleteData(){return u(this,null,function*(){try{yield this._RoleService.DeleteRole(this.DetailRole),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["/admin/nhomuser"])}catch(e){console.error("L\u1ED7i khi x\xF3a role:",e)}})}goBack(){this._router.navigate(["/admin/nhomuser"]),this._ListroleComponent.drawer.close()}trackByFn(e,t){return t.id}toggleEdit(){this.isEdit.update(e=>!e)}toggleDelete(){this.isDelete.update(e=>!e)}FillSlug(){}togglePermission(e){e.hasPermission=!e.hasPermission,console.log(e),e.hasPermission?this._RoleService.assignPermissionToRole({roleId:this.idRole,permissionId:e.id}):this._RoleService.removePermissionFromRole({roleId:this.idRole,permissionId:e.id})}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=E({type:l,selectors:[["app-detailrole"]],decls:17,vars:8,consts:[[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center"],[3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","warn",3,"click"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[4,"ngIf"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"w-full","flex","flex-col","space-y-2"],["appearance","outline"],["matInput","","placeholder","Vui l\xF2ng nh\u1EADp T\xEAn Nh\xF3m",3,"ngModelChange","ngModel","disabled"],[1,"grid","grid-cols-3","gap-2"],[3,"checked"],[3,"change","checked"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"button",1),d("click",function(){return i.goBack()}),o(2,"mat-icon"),a(3,"arrow_back"),r()(),o(4,"div",2),a(5),r(),o(6,"div",3)(7,"mat-slide-toggle",4),S("ngModelChange",function(c){return w(i.DetailRole.isActive,c)||(i.DetailRole.isActive=c),c}),a(8),r(),C(9,ne,3,0,"button",5)(10,re,3,0,"button",5),o(11,"button",6),d("click",function(){return i.toggleDelete()}),o(12,"mat-icon"),a(13,"delete"),r()()()(),o(14,"div",7),C(15,le,9,0,"ng-container",8)(16,se,9,2,"ng-container",8),r()),t&2&&(s(5),x((i.DetailRole==null?null:i.DetailRole.name)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),s(2),y("ngModel",i.DetailRole.isActive),m("disabled",!i.isEdit()),s(),x(i.DetailRole.isActive?"Hi\u1EC3n Th\u1ECB":"\u1EA8n"),s(),m("ngIf",i.isEdit()),s(),m("ngIf",!i.isEdit()),s(5),m("ngIf",i.isDelete()),s(),m("ngIf",!i.isDelete()))},dependencies:[J,q,X,U,Q,G,j,z,H,W,N,L,V,A,Y,O,I,T,$,Z],encapsulation:2})};export{oe as DetailRoleComponent};
