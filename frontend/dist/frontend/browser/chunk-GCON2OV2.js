import{a as We}from"./chunk-AEPCMZ5D.js";import"./chunk-ABTDJQ6E.js";import"./chunk-YNYKMNIR.js";import"./chunk-ZEYFBF7A.js";import"./chunk-BUZBW4C3.js";import{a as Ue}from"./chunk-DR2PQTJV.js";import"./chunk-JTZUWKWU.js";import{a as Qe}from"./chunk-WRIJV6WX.js";import"./chunk-MC2RAUNI.js";import"./chunk-4ZVJO4SQ.js";import{a as fe}from"./chunk-OVT7LFB2.js";import{a as Oe,b as je}from"./chunk-56ORBITA.js";import{h as Ee}from"./chunk-BCBTBOVP.js";import{k as ze}from"./chunk-EHVZN42O.js";import"./chunk-C4KH6DZD.js";import"./chunk-UECSKQ7N.js";import"./chunk-JNVUT6FC.js";import{c as L,d as Te,e as H,f as ke,g as Ie,h as Me,i as Ve,j as Fe,l as Ne,m as Be,o as Ae,p as Le,r as He,s as Re,u as $e,v as Ge,w as Ke,x as q}from"./chunk-NQP2WNBB.js";import{d as Pe}from"./chunk-SUUFLDBI.js";import"./chunk-ZW44ZSN2.js";import"./chunk-Q7CE64BH.js";import{d as Ce}from"./chunk-WUN7FXX4.js";import"./chunk-Q7E7WSHM.js";import{b as Se}from"./chunk-5AMYNOUY.js";import{a as W,b as xe}from"./chunk-RVJDGNJ3.js";import{g as De,j as be,n as we,w as ye,z as ve}from"./chunk-LSGA5JFB.js";import"./chunk-QDG2E6X5.js";import{a as pe}from"./chunk-OPU2N4BX.js";import{a as de,c as ge}from"./chunk-CTVEDBGH.js";import"./chunk-XDHS5TNN.js";import"./chunk-7J2XRCI6.js";import{a as _e,c as Q,e as me}from"./chunk-K6EQGLI7.js";import"./chunk-2PPFUFFT.js";import"./chunk-ISKV6H7R.js";import"./chunk-2I2TRREU.js";import{m as se,r as ce,t as U,u as he}from"./chunk-6552EW4T.js";import{$b as ee,Aa as C,Ac as K,Bc as z,Cc as O,Gb as X,Hc as l,Ic as P,Jc as f,Kc as ie,Mc as ne,Nb as w,Nc as ae,Oc as oe,Qc as j,Ta as R,Ub as J,Vb as Z,Wb as M,Wc as D,Xb as m,Yc as b,Zc as re,cc as V,ec as te,fc as $,gc as G,hc as r,ic as o,jc as y,kc as B,lc as A,ld as le,nc as S,nd as ue,ob as Y,qa as T,sc as E,tb as c,uc as h,za as x}from"./chunk-E4DUHMSF.js";import"./chunk-LWLSKGAV.js";import{a as k,b as I,j as v}from"./chunk-6DYNGEAS.js";var Xe=()=>[De,be,W,Q,U,Oe,Me,Fe,Le,Ne,Ve,He,Be,Ae,Re,$e,Ge,H,ke,L],Je=()=>({standalone:!0}),Ze=()=>[50,100],et=(i,t)=>t.id;function tt(i,t){if(i&1){let e=S();r(0,"button",2),E("click",function(){x(e);let n=h();return C(n.printContent())}),r(1,"mat-icon"),l(2,"print"),o()()}}function it(i,t){if(i&1){let e=S();r(0,"button",2),E("click",function(){x(e);let n=h();return C(n.handlePhieugiaohangAction())}),r(1,"mat-icon"),l(2,"save"),o()()}}function nt(i,t){if(i&1){let e=S();r(0,"button",2),E("click",function(){x(e);let n=h(2);return C(n.toggleEdit())}),r(1,"mat-icon"),l(2,"edit"),o()()}}function at(i,t){if(i&1&&w(0,nt,3,0,"button",6),i&2){let e=h();m("ngIf",!e.isEdit())}}function ot(i,t){if(i&1){let e=S();B(0),r(1,"div",10)(2,"div",11),l(3,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),o(),r(4,"div",12)(5,"button",13),E("click",function(){x(e);let n=h();return C(n.DeleteData())}),l(6,"\u0110\u1ED3ng \xDD"),o(),r(7,"button",14),E("click",function(){x(e);let n=h();return C(n.toggleDelete())}),l(8,"Hu\u1EF7 B\u1ECF"),o()()(),A()}}function rt(i,t){i&1&&(r(0,"div",26),y(1,"img",27),r(2,"div",28)(3,"div",29),l(4,"C\xD4NG TY TNHH N\xD4NG S\u1EA2N TH\u1EF0C PH\u1EA8M TR\u1EA6N GIA"),o(),r(5,"div"),l(6,"H\u1EE3p t\xE1c x\xE3: \u1EA4p L\u1ED9c Ti\u1EBFn, X\xE3 M\u1EF9 L\u1ED9c, Huy\u1EC7n C\u1EA7n Giu\u1ED9c, T\u1EC9nh Long An"),o(),r(7,"div"),l(8,"V\u0103n ph\xF2ng: T\xF2a nh\xE0 An Ph\xFA Plaza, 117-119 L\xFD Ch\xEDnh Th\u1EAFng, P.7, Q.3, TP.HCM"),o(),r(9,"div"),l(10,"Kho s\u01A1 ch\u1EBF: 30 Kha V\u1EA1n C\xE2n, P. Hi\u1EC7p B\xECnh Ch\xE1nh, TP. Th\u1EE7 \u0110\u1EE9c, TP.HCM"),o(),r(11,"div"),l(12,"Website: http://rausachtrangia.com - Hotline: 090.245.8081"),o()(),y(13,"img",30),o())}function lt(i,t){if(i&1&&y(0,"div",31),i&2){let e=h(2);m("innerHTML",e.DetailPhieugiaohang().khachhang.ghichu,Y)}}function ut(i,t){if(i&1&&(r(0,"th",48)(1,"span",49),l(2),o()()),i&2){let e=h().$implicit,a=h(4);c(2),f(" ",a.ColumnName[e]," ")}}function st(i,t){if(i&1){let e=S();r(0,"span",51)(1,"span"),l(2),o(),r(3,"button",55),E("click",function(){x(e);let n=h().$implicit,d=h(5);return C(d.RemoveSanpham(n))}),r(4,"mat-icon"),l(5,"delete"),o()()()}if(i&2){let e=h().index;c(2),f("",e+1," ")}}function ct(i,t){if(i&1&&(r(0,"div",52),l(1),D(2,"number"),o()),i&2){let e=h().$implicit,a=h().$implicit;c(),f(" ",b(2,1,e[a]||0,"1.0-2")," ")}}function ht(i,t){if(i&1&&(r(0,"div",52),l(1),D(2,"number"),o()),i&2){let e=h().$implicit,a=h().$implicit;c(),f(" ",b(2,1,e[a]||0,"1.0-2")," ")}}function dt(i,t){if(i&1&&(r(0,"div",52),l(1),D(2,"number"),o()),i&2){let e=h().$implicit,a=h().$implicit;c(),f(" ",b(2,1,e[a]||0,"1.0-2")," ")}}function gt(i,t){if(i&1){let e=S();r(0,"div",57),E("focus",function(n){x(e);let d=h(7);return C(d.onInputFocus(n))})("blur",function(n){x(e);let d=h(2),_=d.$implicit,u=d.index,g=h(5);return C(g.updateBlurValue(n,u,_,"slgiao","number"))})("keydown",function(n){x(e);let d=h(2),_=d.$implicit,u=d.index,g=h(5);return C(g.updateValue(n,u,_,"slgiao","number"))}),l(1),D(2,"number"),o()}if(i&2){let e=h(2),a=e.$implicit,n=e.index,d=h().$implicit;m("contentEditable",!0),M("data-index",n)("data-id",a.id),c(),f(" ",b(2,4,a[d]||0,"1.0-2")," ")}}function _t(i,t){if(i&1&&(r(0,"div",52),l(1),D(2,"number"),o()),i&2){let e=h(2).$implicit,a=h().$implicit;c(),f(" ",b(2,1,e[a]||0,"1.0-2")," ")}}function mt(i,t){if(i&1&&w(0,gt,3,7,"div",56)(1,_t,3,4,"div",52),i&2){let e=h(6);V(e.DetailPhieugiaohang().status!="dagiao"?0:1)}}function pt(i,t){if(i&1){let e=S();r(0,"div",58),E("focus",function(n){x(e);let d=h(6);return C(d.onInputFocus(n))})("blur",function(n){x(e);let d=h(),_=d.$implicit,u=d.index,g=h(5);return C(g.updateBlurValue(n,u,_,"slnhan","number"))})("keydown",function(n){x(e);let d=h(),_=d.$implicit,u=d.index,g=h(5);return C(g.updateValue(n,u,_,"slnhan","number"))}),l(1),D(2,"number"),o()}if(i&2){let e=h(),a=e.$implicit,n=e.index,d=h().$implicit;m("contentEditable",!0),M("data-index",n)("data-id",a.id),c(),f(" ",b(2,4,a[d]||0,"1.0-2")," ")}}function ft(i,t){if(i&1){let e=S();r(0,"div",59),E("focus",function(n){x(e);let d=h(6);return C(d.onInputFocus(n))})("blur",function(n){x(e);let d=h(),_=d.$implicit,u=d.index,g=h(5);return C(g.updateBlurValue(n,u,_,"ghichu","string"))})("keydown",function(n){x(e);let d=h(),_=d.$implicit,u=d.index,g=h(5);return C(g.updateValue(n,u,_,"ghichu","string"))}),l(1),o()}if(i&2){let e=h(),a=e.$implicit,n=e.index,d=h().$implicit;m("contentEditable",!0),M("data-index",n)("data-id",a.id),c(),f(" ",a[d]||""," ")}}function xt(i,t){if(i&1&&(r(0,"span",49),l(1),o()),i&2){let e=h().$implicit,a=h().$implicit;c(),f(" ",e[a]," ")}}function Ct(i,t){if(i&1&&(r(0,"td",50),w(1,st,6,1,"span",51)(2,ct,3,4,"div",52)(3,ht,3,4,"div",52)(4,dt,3,4,"div",52)(5,mt,2,1)(6,pt,3,7,"div",53)(7,ft,2,4,"div",54)(8,xt,2,1,"span",49),o()),i&2){let e,a=h().$implicit;c(),V((e=a)==="STT"?1:e==="sldat"?2:e==="giaban"?3:e==="ttgiao"?4:e==="slgiao"?5:e==="slnhan"?6:e==="ghichu"?7:8)}}function Dt(i,t){if(i&1&&(B(0,41),w(1,ut,3,1,"th",46)(2,Ct,9,1,"td",47),A()),i&2){let e=t.$implicit;m("matColumnDef",e)}}function bt(i,t){i&1&&y(0,"tr",60)}function wt(i,t){i&1&&y(0,"tr",61)}function Et(i,t){if(i&1&&(r(0,"tr",62)(1,"td",63),l(2,"Kh\xF4ng t\xECm th\u1EA5y"),o()()),i&2){let e=h(4);c(),M("colspan",e.displayedColumns.length)}}function yt(i,t){if(i&1){let e=S();r(0,"div",33)(1,"div",4)(2,"mat-slide-toggle",34),oe("ngModelChange",function(n){x(e);let d=h(3);return ae(d.DetailPhieugiaohang().isshowvat,n)||(d.DetailPhieugiaohang().isshowvat=n),C(n)}),E("toggleChange",function(){x(e);let n=h(3);return C(n.onChangeVat())}),r(3,"span",35),l(4,"VAT"),o()(),r(5,"div",36)(6,"input",37),E("keyup",function(n){x(e);let d=h(3);return C(d.applyFilter(n))}),o(),r(7,"div",38)(8,"span",39),l(9,"search"),o()()()(),r(10,"table",40),$(11,Dt,3,1,"ng-container",41,te),w(13,bt,1,0,"tr",42)(14,wt,1,0,"tr",43)(15,Et,3,1,"tr",44),o(),y(16,"mat-paginator",45,0),o()}if(i&2){let e=h(3);c(2),ne("ngModel",e.DetailPhieugiaohang().isshowvat),m("ngModelOptions",j(6,Je)),c(8),m("dataSource",e.dataSource),c(),G(e.displayedColumns),c(2),m("matHeaderRowDef",e.displayedColumns),c(),m("matRowDefColumns",e.displayedColumns),c(2),m("pageSizeOptions",j(7,Ze))}}function vt(i,t){i&1&&(r(0,"div",32),w(1,yt,18,8),J(2,1,Xe),Z(),o())}function St(i,t){i&1&&(r(0,"th",70),l(1,"\u0110\u01A1n gi\xE1"),o())}function Pt(i,t){i&1&&(r(0,"th",70),l(1,"Th\xE0nh Ti\u1EC1n"),o())}function Tt(i,t){if(i&1&&(r(0,"td",79),l(1),D(2,"number"),o()),i&2){let e=h().$implicit;c(),f(" ",b(2,1,e.giaban,"1.0-2"),"")}}function kt(i,t){if(i&1&&(r(0,"td",79),l(1),D(2,"number"),o()),i&2){let e=h().$implicit;c(),f(" ",b(2,1,e.ttgiao,"1.0-2"),"")}}function It(i,t){if(i&1&&(r(0,"tr",65)(1,"td",75),l(2),o(),r(3,"td",76),l(4),o(),r(5,"td",67),l(6),o(),r(7,"td",77),l(8),D(9,"number"),o(),w(10,Tt,3,4,"td",78)(11,kt,3,4,"td",78),r(12,"td",79),l(13),D(14,"number"),o(),r(15,"td",76),l(16),o()()),i&2){let e,a,n,d,_=t.$implicit,u=t.$index,g=h(3);c(2),P(u+1),c(2),P(!((e=g.DetailPhieugiaohang())==null||e.khachhang==null)&&e.khachhang.istitle2?_.title2:_.title),c(2),P(_.dvt),c(2),P(b(9,8,_.slgiao,"1.0-2")),c(2),m("ngIf",(a=g.DetailPhieugiaohang())==null||a.khachhang==null?null:a.khachhang.hiengia),c(),m("ngIf",(n=g.DetailPhieugiaohang())==null||n.khachhang==null?null:n.khachhang.hiengia),c(2),P(((d=g.DetailPhieugiaohang())==null?null:d.status)==="danhan"?re(14,11,_.slnhan,"1.0-2",""):""),c(3),P(_.ghichu)}}function Mt(i,t){i&1&&y(0,"td",72)}function Vt(i,t){if(i&1&&(r(0,"td",72),l(1),D(2,"number"),o()),i&2){let e=h(3);c(),f(" ",b(2,1,e.TinhTong(e.DetailPhieugiaohang().sanpham,"ttgiao"),"1.0-2"),"")}}function Ft(i,t){if(i&1&&(r(0,"tr",65)(1,"td",80),l(2,"Vat:"),o(),r(3,"td",72),l(4),D(5,"number"),o(),y(6,"td",74)(7,"td",74),o(),r(8,"tr",65)(9,"td",80),l(10,"T\u1ED5ng Ti\u1EC1n:"),o(),r(11,"td",72),l(12),D(13,"number"),o(),y(14,"td",74),o()),i&2){let e,a,n=h(3);c(4),P(b(5,2,(e=n.DetailPhieugiaohang())==null?null:e.tongvat,"1.0-2")),c(8),P(b(13,5,(a=n.DetailPhieugiaohang())==null?null:a.tongtien,"1.0-2"))}}function Nt(i,t){if(i&1&&(r(0,"table",64)(1,"thead")(2,"tr",65)(3,"th",66),l(4,"STT"),o(),r(5,"th",67),l(6,"T\xEAn s\u1EA3n ph\u1EA9m"),o(),r(7,"th",67),l(8,"\u0110VT"),o(),r(9,"th",68),l(10,"SL"),o(),w(11,St,2,0,"th",69)(12,Pt,2,0,"th",69),r(13,"th",70),l(14,"SL Nh\u1EADn"),o(),r(15,"th",67),l(16,"Ghi ch\xFA"),o()()(),r(17,"tbody"),$(18,It,17,15,"tr",65,et),r(20,"tr",65)(21,"td",71),l(22,"T\u1ED5ng:"),o(),r(23,"td",72),l(24),D(25,"number"),o(),w(26,Mt,1,0,"td",73)(27,Vt,3,4,"td",73),r(28,"td",72),l(29),D(30,"number"),o(),y(31,"td",74),o(),w(32,Ft,15,8),o()()),i&2){let e,a,n,d,_,u=h(2);c(11),m("ngIf",(e=u.DetailPhieugiaohang())==null||e.khachhang==null?null:e.khachhang.hiengia),c(),m("ngIf",(a=u.DetailPhieugiaohang())==null||a.khachhang==null?null:a.khachhang.hiengia),c(6),G(u.DetailPhieugiaohang().sanpham),c(6),f(" ",b(25,7,u.TinhTong(u.DetailPhieugiaohang().sanpham,"slgiao"),"1.0-2"),""),c(2),m("ngIf",(n=u.DetailPhieugiaohang())==null||n.khachhang==null?null:n.khachhang.hiengia),c(),m("ngIf",(d=u.DetailPhieugiaohang())==null||d.khachhang==null?null:d.khachhang.hiengia),c(2),P(((_=u.DetailPhieugiaohang())==null?null:_.status)==="danhan"?b(30,10,u.TinhTong(u.DetailPhieugiaohang().sanpham,"slnhan"),"1.0-2"):""),c(3),V(u.DetailPhieugiaohang().isshowvat?32:-1)}}function Bt(i,t){if(i&1&&(B(0),r(1,"div",15)(2,"div",16),w(3,rt,14,0,"div",17),r(4,"div",18),l(5),D(6,"date"),o(),r(7,"div"),l(8),o(),w(9,lt,1,1,"div",19),r(10,"div",20)(11,"div",21)(12,"div",22)(13,"strong"),l(14,"\u0110\u1ECBa Ch\u1EC9 : "),o(),l(15),o(),r(16,"div",22)(17,"strong"),l(18,"Ghi Ch\xFA : "),o(),l(19),o(),r(20,"div",22)(21,"strong"),l(22,"S\u1ED1 \u0110i\u1EC7n Tho\u1EA1i : "),o(),l(23),o(),r(24,"div",22)(25,"strong"),l(26),D(27,"number"),o()()()(),w(28,vt,4,0,"div",23)(29,Nt,33,13,"table",24),r(30,"div",25)(31,"p")(32,"strong"),l(33,"Ng\u01B0\u1EDDi v\u1EADn chuy\u1EC3n"),o()(),r(34,"p")(35,"strong"),l(36,"Ng\u01B0\u1EDDi nh\u1EADn h\xE0ng"),o()(),r(37,"p")(38,"strong"),l(39,"Ng\u01B0\u1EDDi l\u1EADp"),o()()()()(),A()),i&2){let e,a,n,d,_,u,g,s=h();c(3),m("ngIf",!s.isEdit()),c(2),f("B\u1EA2NG K\xCA GIAO H\xC0NG NG\xC0Y ",b(6,14,s.DetailPhieugiaohang().ngaygiao,"dd/MM/yyyy"),""),c(2),ee("font-bold text-[18px] uppercase ",(e=s.DetailPhieugiaohang())!=null&&e.khachhangId?"":"text-red-700 italic",""),c(),f(" ",((a=s.DetailPhieugiaohang())==null||a.khachhang==null?null:a.khachhang.name)||"Ch\u01B0a Ch\u1ECDn Kh\xE1ch H\xE0ng",""),c(),m("ngIf",s.isEdit()&&((n=s.DetailPhieugiaohang())==null||n.khachhang==null?null:n.khachhang.ghichu)),c(6),f(" ",(d=s.DetailPhieugiaohang())==null||d.khachhang==null?null:d.khachhang.diachi,""),c(4),f(" ",(_=s.DetailPhieugiaohang())==null?null:_.ghichu,""),c(4),f(" ",(u=s.DetailPhieugiaohang())==null||u.khachhang==null?null:u.khachhang.sdt,""),c(3),ie("T\u1ED5ng kh\u1ED1i l\u01B0\u1EE3ng - \u0110\u01A1n V\u1ECB T\xEDnh : ",s.GetDVT(s.DetailPhieugiaohang())," (",b(27,17,s.TinhTong((g=s.DetailPhieugiaohang())==null?null:g.sanpham,"slgiao"),"1.0-2"),") "),c(2),m("ngIf",s.isEdit()),c(),m("ngIf",!s.isEdit())}}var qe=class i{_ListphieugiaohangComponent=T(We);_PhieugiaohangService=T(Ue);_SanphamService=T(Qe);_UserService=T(fe);_route=T(de);_router=T(ge);_snackBar=T(pe);displayedColumns=["STT","title","masp","dvt","sldat","slgiao","giaban","ttgiao","slnhan","ghichu"];ColumnName={STT:"STT",title:"Ti\xEAu \u0110\u1EC1",masp:"M\xE3 SP",dvt:"\u0110\u01A1n V\u1ECB T\xEDnh",sldat:"SL \u0110\u1EB7t",slgiao:"SL Giao",giaban:"Gi\xE1 B\xE1n",ttgiao:"TT Giao",slnhan:"Th\u1EF1c Nh\u1EADn",ghichu:"Ghi Ch\xFA"};dataSource=new q([]);CountItem=le(()=>this.dataSource.data.length);paginator;sort;DetailPhieugiaohang=this._PhieugiaohangService.DetailDonhang;profile=this._UserService.profile;isEdit=R(!0);isDelete=R(!1);filterKhachhang=[];filterBanggia=[];filterSanpham=[];phieugiaohangId=this._PhieugiaohangService.donhangId;ListSanpham=this._SanphamService.ListSanpham;Trangthai=[{value:"dadat",title:"\u0110\xE3 \u0110\u1EB7t"},{value:"dagiao",title:"\u0110\xE3 Giao"},{value:"danhan",title:"\u0110\xE3 Nh\u1EADn"},{value:"huy",title:"H\u1EE7y"}];constructor(){this._route.paramMap.subscribe(t=>v(this,null,function*(){let e=t.get("id");this._PhieugiaohangService.setDonhangId(e),yield this._SanphamService.getAllSanpham(),this.filterSanpham=this._SanphamService.ListSanpham()})),ue(()=>v(this,null,function*(){yield this._UserService.getProfile();let t=this._PhieugiaohangService.donhangId();if(!t||t==="0")this._router.navigate(["/admin/phieugiaohang"]),this._ListphieugiaohangComponent.drawer.close();else{yield this._PhieugiaohangService.Phieugiaohang({id:t});let e=this.DetailPhieugiaohang();this.isEdit.set(e.status!=="danhan");let a=e?.sanpham?.map(n=>I(k({},n),{ttgiao:(Number(n.slgiao)||0)*(Number(n.giaban)||0)}))||[];this.DetailPhieugiaohang.update(n=>I(k({},n),{sanpham:a})),this.dataSource.data=a,setTimeout(()=>{this.dataSource.sort=this.sort},300),this.setupDataSource(),this._ListphieugiaohangComponent.drawer.open(),this._router.navigate(["/admin/phieugiaohang",t])}}))}getTitle(t){return this.Trangthai.find(e=>e.value===t)?.title}ngOnInit(){return v(this,null,function*(){yield this._UserService.getProfile(),console.log(this.profile());let t=this.phieugiaohangId();if(t){try{yield this._PhieugiaohangService.Phieugiaohang({id:t});let e=this.DetailPhieugiaohang();if(this.isEdit.set(e.status!=="danhan"),e?.sanpham?.length){let a=e.sanpham.map(n=>I(k({},n),{ttgiao:(Number(n.slgiao)||0)*(Number(n.giaban)||0)}));this.DetailPhieugiaohang.update(n=>I(k({},n),{sanpham:a}))}}catch(e){console.error("Error loading phieu giao hang:",e),this._snackBar.open("L\u1ED7i khi t\u1EA3i phi\u1EBFu giao h\xE0ng","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}this.dataSource=new q(this.DetailPhieugiaohang().sanpham),setTimeout(()=>{this.dataSource.sort=this.sort},300)}})}ngAfterViewInit(){this.setupDataSource()}onChangeVat(){this.DetailPhieugiaohang.update(t=>(t.isshowvat=!t.isshowvat,t)),console.log("VAT changed:",this.DetailPhieugiaohang().isshowvat)}setupDataSource(){this.paginator&&(this.dataSource.paginator=this.paginator),this.sort&&(this.dataSource.sort=this.sort)}GetDVT(t){return t?.sanpham?.length>0&&t?.sanpham[0]?.dvt||""}handlePhieugiaohangAction(){return v(this,null,function*(){this.phieugiaohangId()==="0"?yield this.createPhieugiaohang():yield this.updatePhieugiaohang()})}createPhieugiaohang(){return v(this,null,function*(){})}updatePhieugiaohang(){return v(this,null,function*(){try{this.DetailPhieugiaohang().sanpham=this.DetailPhieugiaohang().sanpham.map(t=>(t.ttgiao=Number(t.slgiao)*Number(t.giaban)||0,{id:t.id,ttgiao:t.ttgiao,slgiao:t.slgiao,slnhan:t.slnhan,ghichu:t.ghichu})),yield this._PhieugiaohangService.updatePhieugiao(this.DetailPhieugiaohang()),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(t=>!t)}catch(t){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt phieugiaohang:",t)}})}DeleteData(){return v(this,null,function*(){})}goBack(){this._router.navigate(["/admin/phieugiaohang"]),this._ListphieugiaohangComponent.drawer.close()}trackByFn(t,e){return e.id}onInputFocus(t){let e=t.target;e&&e.isContentEditable&&setTimeout(()=>{if(document.createRange&&window.getSelection){let a=document.createRange();a.selectNodeContents(e);let n=window.getSelection();n?.removeAllRanges(),n?.addRange(a)}},10)}handleNumericInput(t,e){if(t.code==="NumpadDecimal"||t.key==="."||t.key===","){let a=e.innerText;if(a.includes(".")||a.includes(",")){t.preventDefault();return}}t.code&&t.code.startsWith("Numpad")&&/Numpad[0-9]/.test(t.code)}formatNumberDisplay(t){return isNaN(t)||t===0?"0":t.toLocaleString("vi-VN",{minimumFractionDigits:0,maximumFractionDigits:2})}toggleEdit(){this.isEdit.update(t=>!t)}toggleDelete(){this.isDelete.update(t=>!t)}FillSlug(){this.DetailPhieugiaohang.update(t=>(t.slug=Pe(t.title),t))}DoFindBanggia(t){let e=t.target.value.toLowerCase()}UpdateBangia(){}SelectBanggia(t){console.log(t.value)}Chonkhachhang(t){this.DetailPhieugiaohang.update(e=>(e.khachhangId=t.id,e))}updateValue(t,e,a,n,d){let _=t.target,u;if(d==="number"){let s=_.innerText.trim().replace(/,/g,".");u=Number(s)||0}else u=_.innerText.trim();let g=t;if(g.key==="Enter"&&!g.shiftKey&&(t.preventDefault(),e!==null)){let s=document.querySelectorAll(n==="ghichu"?".ghichu-input":".slgiao-input");if(e<this.dataSource.filteredData.length-1){let p=s[e+1];p&&(p.focus(),setTimeout(()=>{if(document.createRange&&window.getSelection){let F=document.createRange();F.selectNodeContents(p);let N=window.getSelection();N?.removeAllRanges(),N?.addRange(F)}},10))}}if(d==="number"){let s=["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","0","1","2","3","4","5","6","7","8","9",".",",","Home","End","PageUp","PageDown"],p=/^[0-9]$/.test(g.key),F=g.code&&g.code.startsWith("Numpad")&&/Numpad[0-9]/.test(g.code),N=g.key==="."||g.key===",",Ye=s.includes(g.key);if(!p&&!F&&!N&&!Ye){t.preventDefault();return}this.handleNumericInput(g,_)}if(e!==null&&a?.id){let s=this.DetailPhieugiaohang().sanpham.findIndex(p=>p.id===a.id);if(s===-1){console.warn("Item not found in original data:",a.id);return}this.DetailPhieugiaohang.update(p=>{switch(n){case"sldat":p.sanpham[s].sldat=u,p.sanpham[s].slgiao=u,p.sanpham[s].slnhan=u,p.sanpham[s].ttgiao=Number(u)*(p.sanpham[s].giaban||0);break;case"slgiao":p.sanpham[s].slgiao=u,p.sanpham[s].slnhan=u,p.sanpham[s].ttgiao=Number(u)*(p.sanpham[s].giaban||0);break;case"slnhan":p.sanpham[s].slnhan=u;break;case"giaban":p.sanpham[s].giaban=u,p.sanpham[s].ttgiao=(p.sanpham[s].slgiao||0)*Number(u);break;case"ghichu":p.sanpham[s].ghichu=u;break;default:p.sanpham[s][n]=u}return p}),this.dataSource.data=[...this.DetailPhieugiaohang().sanpham]}else e===null&&this.DetailPhieugiaohang.update(s=>(s[n]=u,s))}updateBlurValue(t,e,a,n,d){let _=t.target,u;if(d==="number"){let g=_.innerText.trim().replace(/,/g,".");u=Number(g)||0}else u=_.innerText.trim();if(e!==null&&a?.id){let g=this.DetailPhieugiaohang().sanpham.findIndex(s=>s.id===a.id);if(g===-1){console.warn("Item not found in original data:",a.id);return}this.DetailPhieugiaohang.update(s=>{switch(n){case"sldat":s.sanpham[g].sldat=u,s.sanpham[g].slgiao=u,s.sanpham[g].slnhan=u,s.sanpham[g].ttgiao=Number(u)*(s.sanpham[g].giaban||0);break;case"slgiao":s.sanpham[g].slgiao=u,s.sanpham[g].slnhan=u,s.sanpham[g].ttgiao=Number(u)*(s.sanpham[g].giaban||0);break;case"slnhan":s.sanpham[g].slnhan=u;break;case"giaban":s.sanpham[g].giaban=u,s.sanpham[g].ttgiao=(s.sanpham[g].slgiao||0)*Number(u);break;case"ghichu":s.sanpham[g].ghichu=u;break;default:s.sanpham[g][n]=u}return s}),this.dataSource.data=[...this.DetailPhieugiaohang().sanpham]}else e===null&&this.DetailPhieugiaohang.update(g=>(g[n]=u,g))}GiaoDonhang(){return v(this,null,function*(){try{this.DetailPhieugiaohang.update(t=>(t.status="dagiao",t)),yield this._PhieugiaohangService.DagiaoDonhang(this.DetailPhieugiaohang()),this._snackBar.open("Giao \u0111\u01A1n h\xE0ng th\xE0nh c\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch(t){console.error("L\u1ED7i khi giao \u0111\u01A1n h\xE0ng:",t),this._snackBar.open("Giao \u0111\u01A1n h\xE0ng th\u1EA5t b\u1EA1i","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}Danhanhang(){return v(this,null,function*(){try{this.DetailPhieugiaohang.update(t=>(t.status="danhan",t)),yield this._PhieugiaohangService.updateDonhang(this.DetailPhieugiaohang()),this._snackBar.open("\u0110\xE3 Nh\u1EADn \u0111\u01A1n h\xE0ng th\xE0nh c\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(t=>!t)}catch(t){console.error("L\u1ED7i khi nh\u1EADn \u0111\u01A1n h\xE0ng:",t),this._snackBar.open("Nh\u1EADn \u0111\u01A1n h\xE0ng th\u1EA5t b\u1EA1i","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}Tongcong=0;Tong=0;Tinhtongcong(t){this.Tongcong=t.Tongcong,this.Tong=t.Tong}TinhTong(t,e){return t?.reduce((a,n)=>a+(n[e]||0),0)||0}applyFilter(t){let e=t.target.value;this.dataSource.filter=e.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}EmptyCart(){this.DetailPhieugiaohang.update(t=>(t.sanpham=[],t))}RemoveSanpham(t){console.log(t),this.DetailPhieugiaohang.update(e=>(e.sanpham=e.sanpham.filter(a=>a.id!==t.id),this.reloadfilter(),e))}reloadfilter(){this.filterSanpham=this.ListSanpham().filter(t=>!this.DetailPhieugiaohang().sanpham.some(e=>e.id===t.id))}CoppyDon(){}printContent(){let t=document.getElementById("printContent");if(t){let e=window.open("","_blank");e?(e.document.write(`
          <html>
          <head>
            <title>${this.DetailPhieugiaohang()?.madonhang}</title>
             
    <script src="https://cdn.tailwindcss.com"><\/script>
    <script>
      tailwind.config = {
        theme: { extend: {} }
      };
    <\/script>
  
            <style>
              body { font-size: 12px; 'Times New Roman', Times, serif !important; }
              table { width: 100%; border-collapse: collapse; }
              th, td { border: 1px solid #000; padding: 4px; text-align: left; }
              .font-times {font-family: 'Times New Roman', Times, serif !important;}
              @media print { 
              body { margin: 0; font-family: 'Times New Roman', Times, serif !important;} 
              img {height:80px}
             .font-times {font-family: 'Times New Roman', Times, serif !important;}
              }
            </style>
          </head>
          <body>
            ${t.outerHTML}
            <script>
              window.onload = function() { window.print(); window.close(); }
            <\/script>
          </body>
          </html>
        `),e.document.close(),this.DetailPhieugiaohang().status==="dadat"&&this.Danhanhang()):console.error("Kh\xF4ng th\u1EC3 m\u1EDF c\u1EEDa s\u1ED5 in")}else console.error("Kh\xF4ng t\xECm th\u1EA5y ph\u1EA7n t\u1EED printContent")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=X({type:i,selectors:[["app-detailphieugiaohang"]],viewQuery:function(e,a){if(e&1&&(K(L,5),K(H,5)),e&2){let n;z(n=O())&&(a.paginator=n.first),z(n=O())&&(a.sort=n.first)}},decls:15,vars:7,consts:[["paginator","matPaginator"],[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"p-2","min-w-28","font-bold","focus:border","focus:rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none","transition-colors","duration-200"],[1,"flex","flex-row","space-x-2","items-center"],["mat-flat-button","","color","primary",3,"click","disabled"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","primary"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[4,"ngIf"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],["id","printContent",1,"font-times","min-w-[800px]","flex","flex-col","space-y-6","items-center","p-2","rounded-lg"],[1,"w-full","flex","flex-col","items-center","justify-center"],["class","w-full flex flex-row space-x-2 items-center justify-between",4,"ngIf"],[1,"font-bold","text-[18px]","uppercase"],["class","p-2 rounded-lg border text-red-600",3,"innerHTML",4,"ngIf"],[1,"w-full","flex","flex-row","items-center","mb-2"],[1,"w-full","flex","flex-col","space-y-1","divide-y","divide-gray-300"],[1,"w-full","flex","items-start"],["class","w-full flex flex-col overflow-y-auto",4,"ngIf"],["class","w-full border-collapse border mt-4",4,"ngIf"],[1,"w-full","flex","justify-between","items-center","text-center","mt-6","p-2","px-16"],[1,"w-full","flex","flex-row","space-x-2","items-center","justify-between"],["src","/images/logo-full.png",1,"h-14","mx-auto"],[1,"w-2/3","flex","flex-col"],[1,"font-bold","text-[18px]"],["src","/images/qrcodedonhang.svg",1,"h-32","ml-auto","p-4"],[1,"p-2","rounded-lg","border","text-red-600",3,"innerHTML"],[1,"w-full","flex","flex-col","overflow-y-auto"],[1,"w-full","overflow-auto"],[3,"ngModelChange","toggleChange","ngModel","ngModelOptions"],[1,"font-medium"],[1,"relative","w-full","py-2"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4"],["mat-cell",""],[1,"max-w-20","line-clamp-4","flex","flex-row","items-center"],[1,"text-end"],[1,"p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none","transition-colors","duration-200",3,"contentEditable"],[1,"ghichu-input","p-2","min-w-28","bg-slate-200","focus:border","text-end","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none","transition-colors","duration-200",3,"contentEditable"],["mat-icon-button","","color","warn",3,"click"],[1,"slgiao-input","p-2","min-w-28","bg-slate-200","focus:border","text-end","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none","transition-colors","duration-200",3,"contentEditable"],[1,"slgiao-input","p-2","min-w-28","bg-slate-200","focus:border","text-end","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none","transition-colors","duration-200",3,"focus","blur","keydown","contentEditable"],[1,"p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none","transition-colors","duration-200",3,"focus","blur","keydown","contentEditable"],[1,"ghichu-input","p-2","min-w-28","bg-slate-200","focus:border","text-end","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none","transition-colors","duration-200",3,"focus","blur","keydown","contentEditable"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell","p-4"],[1,"w-full","border-collapse","border","mt-4"],[1,"border"],[1,"border","px-2","max-w-10","text-center"],[1,"border","px-2","text-center"],[1,"border","px-2","text-center","max-w-10","whitespace-nowrap"],["class","border px-2 text-center max-w-15 whitespace-nowrap",4,"ngIf"],[1,"border","px-2","text-center","max-w-15","whitespace-nowrap"],["colspan","3",1,"border","px-2","text-start"],[1,"border","px-2","text-end","font-bold"],["class","border px-2 text-end font-bold",4,"ngIf"],[1,"border","px-2","text-end"],[1,"border","px-2","text-center","max-w-10"],[1,"border","px-2"],[1,"border","px-2","text-end","max-w-10"],["class","border px-2 text-end max-w-15",4,"ngIf"],[1,"border","px-2","text-end","max-w-15"],["colspan","5",1,"border","px-2","text-start"]],template:function(e,a){if(e&1&&(r(0,"div",1)(1,"button",2),E("click",function(){return a.goBack()}),r(2,"mat-icon"),l(3,"arrow_back"),o()(),r(4,"div",3),l(5),o(),r(6,"div",4)(7,"button",5),E("click",function(){return a.Danhanhang()}),l(8," \u0110\xE3 Nh\u1EADn "),o(),w(9,tt,3,0,"button",6)(10,it,3,0,"button",6)(11,at,1,1,"button",7),o()(),r(12,"div",8),w(13,ot,9,0,"ng-container",9)(14,Bt,40,20,"ng-container",9),o()),e&2){let n;c(5),f(" ",((n=a.DetailPhieugiaohang())==null?null:n.madonhang)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"," "),c(2),m("disabled",a.DetailPhieugiaohang().status=="danhan"),c(2),m("ngIf",!a.isEdit()),c(),m("ngIf",a.isEdit()),c(),V(a.DetailPhieugiaohang().status!=="danhan"||a.profile().roles.includes("Admin")?11:-1),c(2),m("ngIf",a.isDelete()),c(),m("ngIf",!a.isDelete())}},dependencies:[ye,ve,we,xe,W,me,_e,Q,Se,Ee,he,se,U,ce,je,Ce,ze,Ke,Ie,Te],encapsulation:2,changeDetection:0})};export{qe as DetailPhieugiaohangComponent};
