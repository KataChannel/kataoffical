import{a as Bt}from"./chunk-VTCQHFRM.js";import{a as At,b as Nt,c as Vt}from"./chunk-H5KPETAK.js";import{a as Ot}from"./chunk-MFOZXGRX.js";import{a as Mt}from"./chunk-OLHI56R2.js";import{a as wt,b as Tt}from"./chunk-OZKZ3OK7.js";import{a as W,b as Dt,c as Lt}from"./chunk-AWIJDIBZ.js";import{f as Ft}from"./chunk-N62VL4FK.js";import{a as Rt}from"./chunk-P7PTBZX5.js";import{a as It}from"./chunk-Q553FXZK.js";import{a as Gt}from"./chunk-JNVUT6FC.js";import{b as et,d as tt,e as nt}from"./chunk-STTHC4C4.js";import{a as I}from"./chunk-ZW44ZSN2.js";import{a as Te,b as De,c as Le}from"./chunk-5DTNZ7N6.js";import{a as Ie,b as Ae,c as Ne,d as Ve}from"./chunk-JQGNFFL5.js";import{b as xe,c as Ce}from"./chunk-J2Y4KAF7.js";import{c as $e,d as Ge,e as Re,f as Oe,g as ze,h as Xe}from"./chunk-6FUHXED4.js";import{a as we}from"./chunk-4YBUVQ6H.js";import{a as it,b as at,c as ot,k as rt}from"./chunk-3PV2YRJD.js";import{a as lt}from"./chunk-QTYBGOD4.js";import{a as ct,b as st,c as ht,e as mt,f as ut,h as pt,i as dt,k as gt,l as _t,n as ft,o as xt,p as Ct,q as oe}from"./chunk-3KWMXYFI.js";import{a as Et,b as yt,d as St,f as vt}from"./chunk-BHX4BLPD.js";import{a as kt,b as bt}from"./chunk-VWVQAVIP.js";import{b as Ze}from"./chunk-3U2TZNZV.js";import{b as Qe,c as Je}from"./chunk-V2GY2FCA.js";import{B as We,C as Ue,b as Be,g as Pe,j as Ke,s as He,u as Ye,x as qe,y as je}from"./chunk-4CVHWQN7.js";import{a as Fe,b as Me}from"./chunk-RGDRMKRB.js";import{a as ve,c as ke,e as be}from"./chunk-RLVN5MEI.js";import{la as Se,y as Ee,z as ye}from"./chunk-S5JPUYH3.js";import{k as ue,l as pe,m as de,s as ge,v as _e,x as fe}from"./chunk-S4P46B33.js";import{Bc as M,Cc as c,Db as ce,Dc as T,Ec as p,Fc as he,Hc as te,Ic as ne,Jc as ie,Kb as E,Lc as ae,Qc as me,Rc as y,Tb as N,Tc as S,Ub as d,Wb as q,Xc as j,Yb as se,_b as V,ac as R,bc as K,cc as H,dc as a,ec as o,fc as F,gc as J,hc as Z,jc as w,oc as C,pa as P,qc as m,rb as s,tc as ee,wc as O,xc as z,ya as _,yc as X,za as f}from"./chunk-ZVDIRTLG.js";import{a as $,b as Y,g as Q,h as G,j as k}from"./chunk-6DYNGEAS.js";var A=Q(Rt());var L=Q(Gt());var Ht=Q(Ot());var zt=["drawer"],Xt=["ConfirmDongboDialog"],Pt=()=>({standalone:!0}),Yt=(r,n,e,t,i)=>({"text-blue-500":r,"text-yellow-500":n,"text-green-500":e,"text-purple-500":t,"text-red-500":i}),qt=(r,n)=>n.key;function jt(r,n){r&1&&(a(0,"div",46)(1,"div",47),F(2,"div",48),a(3,"span",49),c(4,"\u0110ang t\u1EA3i d\u1EEF li\u1EC7u..."),o()()())}function Wt(r,n){r&1&&(a(0,"div",50),F(1,"div",51),o())}function Ut(r,n){r&1&&(a(0,"div",50),F(1,"div",51),o())}function Qt(r,n){if(r&1){let e=w();a(0,"button",27),C("click",function(i){let l=_(e).$implicit;return m().toggleColumn(l),f(i.stopPropagation())}),a(1,"mat-icon"),c(2),o(),a(3,"span"),c(4),o()()}if(r&2){let e=n.$implicit;s(2),T(e.isShow?"check_box":"check_box_outline_blank"),s(2),T(e.value)}}function Jt(r,n){if(r&1){let e=w();a(0,"mat-chip",63),C("removed",function(){let i=_(e).$implicit,l=m(2);return f(l.removeSelectedNhomkhachhang(i))}),a(1,"span"),c(2),o(),a(3,"button",64)(4,"mat-icon"),c(5,"cancel"),o()()()}if(r&2){let e=n.$implicit;d("removable",!0),s(2),T(typeof e=="string"?e:e.name),s(),N("aria-label","X\xF3a "+(typeof e=="string"?e:e.name))}}function Zt(r,n){if(r&1&&(a(0,"small",66),c(1),o()),r&2){let e=m().$implicit;s(),T(e.description)}}function en(r,n){if(r&1&&(a(0,"mat-option",59)(1,"span",65),c(2),o(),E(3,Zt,2,1,"small",66),o()),r&2){let e=n.$implicit;d("value",typeof e=="string"?e:e.name),s(2),T(typeof e=="string"?e:e.name),s(),V(typeof e!="string"&&e.description?3:-1)}}function tn(r,n){if(r&1){let e=w();a(0,"button",67),C("click",function(){_(e);let i=m(2);return f(i.clearAllSelectedNhomKhachhang())}),a(1,"mat-icon"),c(2,"close"),o()()}}function nn(r,n){if(r&1){let e=w();a(0,"mat-chip",63),C("removed",function(){let i=_(e).$implicit,l=m(2);return f(l.removeSelectedCustomer(i))}),a(1,"span"),c(2),o(),a(3,"button",64)(4,"mat-icon"),c(5,"cancel"),o()()()}if(r&2){let e=n.$implicit;d("removable",!0),s(2),T(typeof e=="string"?e:e.name),s(),N("aria-label","X\xF3a "+(typeof e=="string"?e:e.name))}}function an(r,n){if(r&1&&(a(0,"small",66),c(1),o()),r&2){let e=m().$implicit;s(),p("M\xE3 KH: ",e.makh,"")}}function on(r,n){if(r&1&&(a(0,"mat-option",59)(1,"span",65),c(2),o(),E(3,an,2,1,"small",66),o()),r&2){let e=n.$implicit;d("value",typeof e=="string"?e:e.name),s(2),T(typeof e=="string"?e:e.name),s(),V(typeof e!="string"&&e.makh?3:-1)}}function rn(r,n){if(r&1){let e=w();a(0,"button",68),C("click",function(){_(e);let i=m(2);return f(i.clearAllSelectedCustomers())}),a(1,"mat-icon"),c(2,"close"),o()()}}function ln(r,n){if(r&1){let e=w();a(0,"div",38)(1,"div",52)(2,"div",53),c(3,"Nh\xF3m Kh\xE1ch H\xE0ng "),o(),a(4,"mat-form-field",54)(5,"mat-chip-set",55),K(6,Jt,6,3,"mat-chip",56,R),o(),a(8,"input",57,8),C("keyup",function(i){_(e);let l=m();return f(l.doFilterNhomKhachhang(i))}),o(),a(10,"mat-autocomplete",58,9),C("optionSelected",function(i){_(e);let l=m();return f(l.onNhomKhachhangSelected(i))}),K(12,en,4,3,"mat-option",59,R),o(),E(14,tn,3,0,"button",60),o()(),a(15,"div",52)(16,"div",53),c(17,"Kh\xE1ch H\xE0ng "),o(),a(18,"mat-form-field",54)(19,"mat-chip-set",61),K(20,nn,6,3,"mat-chip",56,R),o(),a(22,"input",57,10),C("keyup",function(i){_(e);let l=m();return f(l.doFilterKhachhang(i))}),o(),a(24,"mat-autocomplete",58,11),C("optionSelected",function(i){_(e);let l=m();return f(l.onCustomerSelected(i))}),K(26,on,4,3,"mat-option",59,R),o(),E(28,rn,3,0,"button",62),o()()()}if(r&2){let e=M(11),t=M(25),i=m();s(4),d("appearance","outline")("subscriptSizing","dynamic"),s(2),H(i.SelectedNhomKhachhang),s(2),ee("placeholder",i.SelectedNhomKhachhang.length===0?"T\xECm v\xE0 ch\u1ECDn nhi\u1EC1u nh\xF3m kh\xE1ch h\xE0ng":"Th\xEAm nh\xF3m kh\xE1ch h\xE0ng"),d("matAutocomplete",e),s(4),H(i.filterListNhomKhachhang),s(2),V(i.SelectedNhomKhachhang.length>0?14:-1),s(4),d("appearance","outline")("subscriptSizing","dynamic"),s(2),H(i.SelectedKhachhang),s(2),ee("placeholder",i.SelectedKhachhang.length===0?"T\xECm v\xE0 ch\u1ECDn nhi\u1EC1u kh\xE1ch h\xE0ng":"Th\xEAm kh\xE1ch h\xE0ng"),d("matAutocomplete",t),s(4),H(i.filterListKhachhang),s(2),V(i.SelectedKhachhang.length>0?28:-1)}}function cn(r,n){r&1&&(a(0,"div",69)(1,"div",47),F(2,"div",70),a(3,"span",71),c(4,"\u0110ang t\u1EA3i d\u1EEF li\u1EC7u..."),o()()())}function sn(r,n){r&1&&(a(0,"span",92),c(1,"check"),o())}function hn(r,n){if(r&1&&(a(0,"span"),c(1),y(2,"date"),o()),r&2){let e=m().$implicit,t=m(2).$implicit;s(),T(S(2,1,e[t],"dd/MM/yyyy"))}}function mn(r,n){if(r&1&&(a(0,"span"),c(1),y(2,"date"),o()),r&2){let e=m().$implicit,t=m(2).$implicit;s(),T(S(2,1,e[t],"dd/MM/yyyy"))}}function un(r,n){if(r&1&&(a(0,"span"),c(1),y(2,"date"),o()),r&2){let e=m().$implicit,t=m(2).$implicit;s(),T(S(2,1,e[t],"dd/MM/yyyy"))}}function pn(r,n){if(r&1&&(a(0,"span"),c(1),o()),r&2){let e=m().$implicit,t=m(2).$implicit;s(),p("",e[t],"%")}}function dn(r,n){if(r&1&&(a(0,"span"),c(1),o()),r&2){let e=m().$implicit,t=m(2).$implicit;s(),p(" ",e[t]||"Tr\u1ED1ng","")}}function gn(r,n){if(r&1){let e=w();a(0,"div",90),C("click",function(){let i=_(e).$implicit,l=m(2).$implicit,h=m();return f(h.ChosenItem(i,l))}),E(1,sn,2,0,"span",91)(2,hn,3,4,"span")(3,mn,3,4,"span")(4,un,3,4,"span")(5,pn,2,1,"span")(6,dn,2,1,"span"),o()}if(r&2){let e,t=n.$implicit,i=m(2).$implicit,l=m();s(),d("ngIf",l.CheckItem(t)),s(),V((e=i)==="createdAt"?2:e==="updatedAt"?3:e==="ngaygiao"?4:e==="haohut"?5:6)}}function _n(r,n){if(r&1){let e=w();a(0,"th",74)(1,"span",75),c(2),o(),a(3,"span",76,12),c(5," filter_alt "),o(),a(6,"mat-menu",null,4)(8,"div",77),C("click",function(i){return _(e),f(i.stopPropagation())}),a(9,"div",78)(10,"input",79),C("keyup",function(i){_(e);let l=m().$implicit,h=m();return f(h.doFilterHederColumn(i,l))}),o(),a(11,"div",80)(12,"span",81),c(13,"search"),o()()(),a(14,"div",82)(15,"div",83)(16,"span",84),C("click",function(){_(e);let i=m().$implicit,l=m();return f(l.ChosenAll(l.FilterHederColumn(l.dataSource.filteredData,i)))}),c(17),o(),a(18,"span",84),C("click",function(){_(e);let i=m(2);return f(i.EmptyFiter())}),c(19,"Xo\xE1"),o()(),a(20,"span",84),C("click",function(){_(e);let i=m(2);return f(i.ResetFilter())}),c(21,"Reset"),o()(),a(22,"div",85),E(23,gn,7,2,"div",86),o(),a(24,"div",87)(25,"button",88),C("click",function(){_(e);let i=M(4);return f(i.closeMenu())}),c(26," \u0110\xF3ng "),o(),a(27,"button",89),C("click",function(){_(e);let i=M(4),l=m(2);return f(l.ApplyFilterColum(i))}),c(28," \xC1p D\u1EE5ng "),o()()()()()}if(r&2){let e=M(7),t=m().$implicit,i=m();s(2),p(" ",i.ColumnName[t]," "),s(),d("matMenuTriggerFor",e),s(14),p("Ch\u1ECDn T\u1EA5t C\u1EA3 ",i.FilterHederColumn(i.dataSource.filteredData,t).length||0,""),s(6),d("ngForOf",i.FilterHederColumn(i.dataSource.filteredData,t))("ngForTrackBy",i.trackByFn)}}function fn(r,n){r&1&&(a(0,"span",102),c(1,"check_box"),o())}function xn(r,n){if(r&1){let e=w();a(0,"span",100),C("click",function(){_(e);let i=m().$implicit,l=m(2);return f(l.toggleDonhang(i))}),c(1),E(2,fn,2,0,"span",101),o()}if(r&2){let e=m(),t=e.$implicit,i=e.index,l=m(2);s(),p(" ",i+1," "),s(),d("ngIf",l.CheckItemInDonhang(t))}}function Cn(r,n){if(r&1&&(a(0,"span",95),c(1),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",e[t]," ")}}function En(r,n){if(r&1&&(a(0,"span",96),c(1),y(2,"date"),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",S(2,1,e[t],"HH:mm:ss dd/MM/yyyy")," ")}}function yn(r,n){if(r&1&&(a(0,"span",97),c(1),y(2,"date"),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",S(2,1,e[t],"dd/MM/yyyy")," ")}}function Sn(r,n){if(r&1&&(a(0,"span",97),c(1),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",e[t].name," ")}}function vn(r,n){if(r&1&&(a(0,"span",98),c(1),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",e[t]," ")}}function kn(r,n){if(r&1&&(a(0,"span",98),c(1),y(2,"number"),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",S(2,1,e[t],"1.0-3")," ")}}function bn(r,n){if(r&1&&(a(0,"span",98),c(1),y(2,"number"),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",S(2,1,e[t],"1.0-3")," ")}}function wn(r,n){if(r&1&&(a(0,"span",98),c(1),y(2,"number"),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",S(2,1,e[t],"1.0-3")," ")}}function Tn(r,n){if(r&1&&(a(0,"span",98),c(1),y(2,"number"),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",S(2,1,e[t],"1.0-3")," ")}}function Dn(r,n){r&1&&(a(0,"mat-icon",103),c(1,"check_circle"),o())}function Ln(r,n){r&1&&(a(0,"mat-icon",104),c(1,"cancel"),o())}function Fn(r,n){if(r&1&&(a(0,"span",97),E(1,Dn,2,0,"mat-icon",103)(2,Ln,2,0,"mat-icon",104),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),V(e[t]?1:2)}}function Mn(r,n){if(r&1&&(a(0,"span",99),c(1),o()),r&2){let e=m().$implicit,t=m().$implicit,i=m();d("ngClass",me(2,Yt,e[t]==="dadat",e[t]==="dagiao",e[t]==="danhan",e[t]==="hoanthanh",e[t]==="huy")),s(),p(" ",i.Trangthaidon[e[t]]," ")}}function In(r,n){if(r&1&&(a(0,"span",96),c(1),y(2,"date"),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",S(2,1,e[t],"HH:mm:ss dd/MM/yyyy")," ")}}function An(r,n){if(r&1&&(a(0,"span",97),c(1),o()),r&2){let e=m().$implicit,t=m().$implicit;s(),p(" ",e[t]," ")}}function Nn(r,n){if(r&1&&(a(0,"td",93),E(1,xn,3,2,"span",94)(2,Cn,2,1,"span",95)(3,En,3,4,"span",96)(4,yn,3,4,"span",97)(5,Sn,2,1,"span",97)(6,vn,2,1,"span",98)(7,kn,3,4,"span",98)(8,bn,3,4,"span",98)(9,wn,3,4,"span",98)(10,Tn,3,4,"span",98)(11,Fn,3,1,"span",97)(12,Mn,2,8,"span",99)(13,In,3,4,"span",96)(14,An,2,1,"span",97),o()),r&2){let e,t=m().$implicit;s(),V((e=t)==="STT"?1:e==="madonhang"?2:e==="createdAt"?3:e==="ngaygiao"?4:e==="khachhang"?5:e==="dvt"?6:e==="soluong"?7:e==="tong"?8:e==="tongvat"?9:e==="tongtien"?10:e==="isActive"?11:e==="status"?12:e==="updatedAt"?13:14)}}function Vn(r,n){if(r&1&&(J(0,42),E(1,_n,29,5,"th",72)(2,Nn,15,1,"td",73),Z()),r&2){let e=n.$implicit;d("matColumnDef",e)}}function Bn(r,n){r&1&&F(0,"tr",105)}function Pn(r,n){if(r&1){let e=w();a(0,"tr",106),C("click",function(){let i=_(e).$implicit,l=m();return f(l.toggleDonhang(i))}),o()}if(r&2){let e=n.$implicit,t=m();se("hover:bg-slate-100 ",t.CheckItemInDonhang(e)?"!bg-slate-200":"","")}}function Kn(r,n){r&1&&(a(0,"div",110)(1,"div",111)(2,"mat-icon",112),c(3,"search_off"),o()(),a(4,"span",113),c(5,"Kh\xF4ng t\xECm th\u1EA5y d\u1EEF li\u1EC7u"),o()())}function Hn(r,n){if(r&1&&(a(0,"tr",107)(1,"td",108),E(2,Kn,6,0,"div",109),o()()),r&2){let e=m();s(),N("colspan",e.displayedColumns.length),s(),d("ngIf",!e.isLoading)}}function $n(r,n){if(r&1&&(a(0,"td",127),c(1),y(2,"date"),o()),r&2){let e=m(2).$implicit;N("rowspan",e.sanpham.length),s(),p(" ",S(2,2,e.ngaygiao,"dd/MM/yyyy")," ")}}function Gn(r,n){if(r&1&&(a(0,"td",127),c(1),o()),r&2){let e=m(2).$implicit;N("rowspan",e.sanpham.length),s(),p(" ",e.makh," ")}}function Rn(r,n){if(r&1&&(a(0,"td",127),c(1),o()),r&2){let e=m(2).$implicit;N("rowspan",e.sanpham.length),s(),p(" ",e.name," ")}}function On(r,n){if(r&1&&(a(0,"td",127),c(1),o()),r&2){let e=m(2).$implicit;N("rowspan",e.sanpham.length),s(),p(" ",e.madonhang," ")}}function zn(r,n){if(r&1&&(a(0,"td",127),c(1),y(2,"number"),o()),r&2){let e=m(2).$implicit,t=m(2);N("rowspan",e.sanpham.length),s(),p(" ",S(2,2,t.TinhTong(e.sanpham,"ttgiao"),"1.0-0")," ")}}function Xn(r,n){if(r&1&&(a(0,"tr"),E(1,$n,3,5,"td",123)(2,Gn,2,2,"td",123)(3,Rn,2,2,"td",123)(4,On,2,2,"td",123)(5,zn,3,5,"td",123),a(6,"td",124),c(7),o(),a(8,"td",125),c(9),o(),a(10,"td",124),c(11),o(),a(12,"td",126),c(13),y(14,"number"),o(),a(15,"td",126),c(16),y(17,"number"),o(),a(18,"td",126),c(19),y(20,"number"),o()()),r&2){let e=n.$implicit,t=n.index;s(),d("ngIf",t===0),s(),d("ngIf",t===0),s(),d("ngIf",t===0),s(),d("ngIf",t===0),s(),d("ngIf",t===0),s(2),p(" ",e.masp," "),s(2),T(e.title),s(2),p(" ",e.dvt," "),s(2),p(" ",S(14,11,e.soluong,"1.1-3")," "),s(3),p(" ",S(17,14,e.giaban,"1.0-0")," "),s(3),p(" ",S(20,17,e.ttgiao,"1.0-0")," ")}}function Yn(r,n){if(r&1&&(J(0),E(1,Xn,21,20,"tr",120),Z()),r&2){let e=n.$implicit;s(),d("ngForOf",e.sanpham)}}function qn(r,n){if(r&1){let e=w();a(0,"h2",114),c(1," C\xF4ng N\u1EE3 "),a(2,"button",115),C("click",function(){_(e);let i=m();return f(i.printContent())}),a(3,"mat-icon"),c(4,"print"),o()()(),a(5,"mat-dialog-content")(6,"div",116)(7,"div",117)(8,"table",118)(9,"thead")(10,"tr")(11,"th",119),c(12," NG\xC0Y GIAO "),o(),a(13,"th",119),c(14," M\xC3 KH\xC1CH H\xC0NG "),o(),a(15,"th",119),c(16," T\xCAN KH\xC1CH H\xC0NG "),o(),a(17,"th",119),c(18," M\xC3 \u0110\u01A0N H\xC0NG "),o(),a(19,"th",119),c(20," T\u1ED4NG TI\u1EC0N "),o(),a(21,"th",119),c(22," M\xC3 H\xC0NG "),o(),a(23,"th",119),c(24," T\xCAN H\xC0NG "),o(),a(25,"th",119),c(26," \u0110VT "),o(),a(27,"th",119),c(28," S\u1ED0 L\u01AF\u1EE2NG "),o(),a(29,"th",119),c(30," \u0110\u01A0N GI\xC1 "),o(),a(31,"th",119),c(32," TH\xC0NH TI\u1EC0N "),o()()(),a(33,"tbody"),E(34,Yn,2,1,"ng-container",120),o()()()()(),a(35,"mat-dialog-actions",121)(36,"button",122),c(37,"\u0110\xF3ng"),o()()}if(r&2){let e=m();s(34),d("ngForOf",e.editDonhang),s(),d("align","end")}}function jn(r,n){if(r&1&&(a(0,"tr",144)(1,"td",124),c(2),y(3,"date"),o(),a(4,"td",124),c(5),o(),a(6,"td",125),c(7),o(),a(8,"td",124),c(9),o(),a(10,"td",124),c(11),o(),a(12,"td",125),c(13),o(),a(14,"td",124),c(15),o(),a(16,"td",126),c(17),y(18,"number"),o(),a(19,"td",126),c(20),y(21,"number"),o(),a(22,"td",126),c(23),y(24,"number"),o(),a(25,"td",126),c(26),o()()),r&2){let e=n.$implicit;s(2),p(" ",S(3,11,e.ngaygiao,"dd/MM/yyyy")," "),s(3),p(" ",e.makh," "),s(2),p(" ",e.tenkh," "),s(2),p(" ",e.madonhang," "),s(2),p(" ",e.masp," "),s(2),p(" ",e.tensp," "),s(2),p(" ",e.dvt," "),s(2),p(" ",S(18,14,e.slnhan,"1.1-3")," "),s(3),p(" ",S(21,17,e.giaban,"1.0-0")," "),s(3),p(" ",S(24,20,e.ttnhan,"1.0-0")," "),s(3),p(" ",e.ghichu," ")}}function Wn(r,n){if(r&1&&(a(0,"h2",114),c(1,"Xem Tr\u01B0\u1EDBc M\u1EABu Excel"),o(),a(2,"mat-dialog-content",128)(3,"div",117)(4,"table",129)(5,"thead")(6,"tr")(7,"th",130),F(8,"img",131),o(),a(9,"th",132)(10,"span",133),c(11,"C\xD4NG TY TNHH N\xD4NG S\u1EA2N TH\u1EF0C PH\u1EA8M TR\u1EA6N GIA"),o(),a(12,"span"),c(13,"HTX: \u1EA4p L\u1ED9c Ti\u1EBFn, X\xE3 M\u1EF9 L\u1ED9c, Huy\u1EC7n C\u1EA7n Giu\u1ED9c, T\u1EC9nh Long An"),o(),a(14,"span"),c(15,"VP: T\xF2a nh\xE0 An Ph\xFA Plaza, 117-119 L\xFD Ch\xEDnh Th\u1EAFng, P.7. Q.3,"),o(),a(16,"span"),c(17,"TP.HCM Kho s\u01A1 ch\u1EBF: 30 Kha V\u1EA1n C\xE2n, P. Hi\u1EC7p B\xECnh Ch\xE1nh,"),o(),a(18,"span"),c(19,"TP.Th\u1EE7 \u0110\u1EE9c, TP.HCM Kho \u0110\xE0 L\u1EA1t: 69 Tr\u1EA7n Th\u1EE7 \u0110\u1ED9,"),o(),a(20,"span"),c(21,"TT Li\xEAn Ngh\u0129a, Huy\u1EC7n \u0110\u1EE9c Tr\u1ECDng, T\u1EC9nh L\xE2m \u0110\u1ED3ng."),o(),a(22,"span"),c(23,"Website: rausachtrangia.com - Hotline: 090.245.8081"),o()()()(),a(24,"thead")(25,"tr")(26,"th",134),c(27,"CHI TI\u1EBET \u0110\u1ED0I CHI\u1EBEU C\xD4NG N\u1EE2"),o()()(),a(28,"thead")(29,"tr")(30,"th",135),c(31),y(32,"date"),y(33,"date"),o()()(),a(34,"thead")(35,"tr")(36,"th",135),c(37),o()()(),a(38,"thead")(39,"tr")(40,"th",135),c(41),o()()(),a(42,"tbody")(43,"tr")(44,"th",130),c(45),o(),a(46,"th",136),c(47),o()()(),a(48,"thead")(49,"tr",137),F(50,"th",138),o()(),a(51,"thead")(52,"tr",139)(53,"th",140),c(54,"NG\xC0Y GIAO"),o(),a(55,"th",140),c(56,"M\xC3 KH\xC1CH H\xC0NG"),o(),a(57,"th",140),c(58,"T\xCAN KH\xC1CH H\xC0NG"),o(),a(59,"th",140),c(60,"M\xC3 \u0110\u01A0N H\xC0NG"),o(),a(61,"th",140),c(62,"M\xC3 H\xC0NG"),o(),a(63,"th",140),c(64,"T\xCAN H\xC0NG"),o(),a(65,"th",140),c(66,"\u0110VT"),o(),a(67,"th",140),c(68,"S\u1ED0 L\u01AF\u1EE2NG"),o(),a(69,"th",140),c(70,"\u0110\u01A0N GI\xC1"),o(),a(71,"th",140),c(72,"TH\xC0NH TI\u1EC0N"),o(),a(73,"th",140),c(74,"GHI CH\xDA"),o()()(),a(75,"tbody"),E(76,jn,27,23,"tr",141),o()()()(),a(77,"mat-dialog-actions",142)(78,"button",143),c(79,"\u0110\xF3ng"),o()()),r&2){let e=m();s(31),he(" T\u1EEB Ng\xE0y ",S(32,7,e.SearchParams.Batdau,"dd/MM/yyyy")," : - \u0110\u1EBFn Ng\xE0y : ",S(33,10,e.SearchParams.Ketthuc,"dd/MM/yyyy")," "),s(6),p("T\xEAn Kh\xE1ch H\xE0ng : ",e.exampleExport[0]==null?null:e.exampleExport[0].tenkh,""),s(4),p("\u0110\u1ECBa Ch\u1EC9 : ",e.exampleExport[0]==null?null:e.exampleExport[0].diachi,""),s(4),p("Ng\u01B0\u1EDDi Li\xEAn h\u1EC7 : ",e.exampleExport[0]==null?null:e.exampleExport[0].lienhe,""),s(2),p("Email : ",e.exampleExport[0]==null?null:e.exampleExport[0].email,""),s(29),d("ngForOf",e.exampleExport)}}function Un(r,n){if(r&1&&(a(0,"div",145)(1,"mat-icon",146),c(2,"currency_exchange"),o(),a(3,"span",147),c(4,"X\xE1c nh\u1EADn \u0111\u1ED3ng b\u1ED9 gi\xE1 v\xE0 VAT"),o()(),a(5,"mat-dialog-content",128)(6,"div",148)(7,"div",149)(8,"mat-icon",150),c(9,"info"),o(),a(10,"div",151)(11,"h4",152),c(12,"Th\xF4ng tin \u0111\u1ED3ng b\u1ED9"),o(),a(13,"p",153),c(14," \u0110\u1ED3ng b\u1ED9 gi\xE1 v\xE0 VAT cho "),a(15,"strong",154),c(16),o(),c(17," \u0111\u01B0\u1EE3c ch\u1ECDn "),o()()(),a(18,"div",155)(19,"h4",156),c(20,"Thao t\xE1c s\u1EBD th\u1EF1c hi\u1EC7n:"),o(),a(21,"ul",157)(22,"li",158)(23,"mat-icon",159),c(24,"check_circle"),o(),a(25,"span"),c(26,"C\u1EADp nh\u1EADt gi\xE1 b\xE1n t\u1EEB b\u1EA3ng gi\xE1 t\u01B0\u01A1ng \u1EE9ng"),o()(),a(27,"li",158)(28,"mat-icon",159),c(29,"check_circle"),o(),a(30,"span"),c(31,"T\xEDnh l\u1EA1i t\u1ED5ng ti\u1EC1n c\u1EE7a \u0111\u01A1n h\xE0ng"),o()(),a(32,"li",158)(33,"mat-icon",159),c(34,"check_circle"),o(),a(35,"span"),c(36,"T\xEDnh l\u1EA1i VAT d\u1EF1a tr\xEAn t\u1ED5ng ti\u1EC1n v\xE0 t\u1EF7 l\u1EC7 VAT"),o()(),a(37,"li",158)(38,"mat-icon",159),c(39,"check_circle"),o(),a(40,"span"),c(41,"C\u1EADp nh\u1EADt tr\u01B0\u1EDDng tongvat cho t\u1EA5t c\u1EA3 \u0111\u01A1n h\xE0ng"),o()(),a(42,"li",158)(43,"mat-icon",159),c(44,"check_circle"),o(),a(45,"span"),c(46,"L\u01B0u thay \u0111\u1ED5i v\xE0o c\u01A1 s\u1EDF d\u1EEF li\u1EC7u"),o()()()(),a(47,"div",160)(48,"mat-icon",161),c(49,"warning"),o(),a(50,"div",151)(51,"h4",162),c(52,"L\u01B0u \xFD quan tr\u1ECDng"),o(),a(53,"p",163),c(54," Thao t\xE1c n\xE0y s\u1EBD thay \u0111\u1ED5i d\u1EEF li\u1EC7u hi\u1EC7n t\u1EA1i v\xE0 kh\xF4ng th\u1EC3 ho\xE0n t\xE1c. Vui l\xF2ng \u0111\u1EA3m b\u1EA3o b\u1EA1n \u0111\xE3 ki\u1EC3m tra k\u1EF9 tr\u01B0\u1EDBc khi th\u1EF1c hi\u1EC7n. "),o()()()()(),a(55,"mat-dialog-actions",164)(56,"button",143),c(57,"H\u1EE7y"),o(),a(58,"button",165)(59,"mat-icon",166),c(60,"currency_exchange"),o(),c(61," X\xE1c nh\u1EADn \u0111\u1ED3ng b\u1ED9 "),o()()),r&2){let e=m();s(16),p("",e.editDonhang.length," \u0111\u01A1n h\xE0ng"),s(42),d("mat-dialog-close","true")}}var B=class B{Detail={};isLoading=!1;isSearching=!1;isExporting=!1;isShowKH=!0;displayedColumns=["ngaygiao","madonhang","makh","name","soluong","tong","tongvat","tongtien"];ColumnName={ngaygiao:"Ng\xE0y Giao",madonhang:"M\xE3 \u0110\u01A1n H\xE0ng",makh:"M\xE3 Kh\xE1ch H\xE0ng",name:"T\xEAn Kh\xE1ch H\xE0ng",soluong:"S\u1ED1 L\u01B0\u1EE3ng",tong:"T\u1ED5ng",tongvat:"T\u1ED5ng VAT",tongtien:"T\u1ED5ng Ti\u1EC1n"};FilterColumns=JSON.parse(localStorage.getItem("CongnoColFilter")||"[]");exampleExport={};Columns=[];isFilter=!1;Trangthaidon=Bt;paginator;sort;drawer;confirmDongboDialog;filterValues={};_DonhangService=P(It);_breakpointObserver=P(Ee);_GoogleSheetService=P(Mt);_GraphqlService=P(lt);_router=P(Ce);Listdonhang=this._DonhangService.ListDonhang;ListKhachhang=[];filterListKhachhang=[];ListNhomKhachhang=[];filterListNhomKhachhang=[];SelectedKhachhang=[];SelectedNhomKhachhang=[];ListCongno=[];dataSource=new oe([]);donhangId=this._DonhangService.donhangId;_snackBar=P(we);CountItem=0;SearchParams={Batdau:(0,L.default)().toDate(),Ketthuc:(0,L.default)().toDate(),Type:"donsi",Status:["danhan","hoanthanh"],khachhangIds:[]};ListDate=[{id:1,Title:"1 Ng\xE0y",value:"day"},{id:2,Title:"1 Tu\u1EA7n",value:"week"},{id:3,Title:"1 Th\xE1ng",value:"month"},{id:4,Title:"1 N\u0103m",value:"year"}];Chonthoigian="day";isSearch=!1;constructor(){this.displayedColumns.forEach(n=>{this.filterValues[n]=""})}getCustomerName(n){return typeof n=="string"?n:n.name||n.makh||"Unknown"}getNhomKhachhangName(n){return typeof n=="string"?n:n.name||n.manhom||"Unknown"}onSelectionChange(n){this.ngOnInit()}onDateChange(n){}createFilter(){return(n,e)=>{let t=JSON.parse(e),i=!0;return this.displayedColumns.forEach(l=>{if(t[l]){let h=n[l]?n[l].toString().toLowerCase():"";i=i&&h.includes(t[l].toLowerCase())}}),i}}applyFilter(n){return k(this,null,function*(){let e=n.target.value;console.log("filterValue",e),this.SearchParams=Y($({},this.SearchParams),{query:e}),this.loadData(this.SearchParams)})}ngOnInit(){return k(this,null,function*(){this.initializeColumns(),this.setupDrawer(),this.loadData(this.SearchParams)})}doSearch(){return k(this,null,function*(){this.isSearching=!0;try{yield this.loadData(this.SearchParams)}finally{this.isSearching=!1}})}ListExport=[];onKhachhangChange(n){this.onCustomerSelected(n)}onNhomKhachhangChange(n){this.onNhomKhachhangSelected(n)}onNhomKhachhangSelected(n){let e=n.option.value,t=this.ListNhomKhachhang.find(h=>(typeof h=="string"?h:h.name)===e),i=t||e;this.SelectedNhomKhachhang.some(h=>(typeof h=="string"?h:h.name)===e)||(this.SelectedNhomKhachhang.push(i),this.addCustomersFromGroup(t),this.refreshNhomKhachhangFilter(),this.refreshCustomerFilter()),setTimeout(()=>{document.querySelectorAll("input[matautocomplete]").forEach(g=>{(g.placeholder.includes("nh\xF3m kh\xE1ch h\xE0ng")||g.placeholder.includes("Th\xEAm nh\xF3m kh\xE1ch h\xE0ng"))&&(g.value="")})},100)}doFilterKhachhang(n){let e=n.target.value.toLowerCase();console.log("query",e);let t=this.SelectedKhachhang.map(l=>typeof l=="string"?l:l.name),i=this.ListKhachhang.filter(l=>{let h=typeof l=="string"?l:l.name;return!t.includes(h)});if(!e){this.filterListKhachhang=i;return}this.filterListKhachhang=i.filter(l=>l?.name?.toLowerCase().includes(e)||I(l?.name).toLowerCase().includes(I(e))||l?.makh?.toLowerCase().includes(e)||I(l?.makh).toLowerCase().includes(I(e)))}doFilterNhomKhachhang(n){let e=n.target.value.toLowerCase();console.log("query",e);let t=this.SelectedNhomKhachhang.map(l=>typeof l=="string"?l:l.name),i=this.ListNhomKhachhang.filter(l=>{let h=typeof l=="string"?l:l.name;return!t.includes(h)});if(!e){this.filterListNhomKhachhang=i;return}this.filterListNhomKhachhang=i.filter(l=>{let h=typeof l=="string"?l:l.name||"",g=typeof l!="string"&&l.description||"";return h.toLowerCase().includes(e)||I(h).toLowerCase().includes(I(e))||g.toLowerCase().includes(e)||I(g).toLowerCase().includes(I(e))})}onCustomerSelected(n){let e=n.option.value,i=this.ListKhachhang.find(h=>(typeof h=="string"?h:h.name)===e)||e;this.SelectedKhachhang.some(h=>(typeof h=="string"?h:h.name)===e)||(this.SelectedKhachhang.push(i),this.SearchParams.khachhangIds=this.SelectedKhachhang.map(h=>typeof h=="string"?h:h.id),this.refreshCustomerFilter()),setTimeout(()=>{document.querySelectorAll("input[matautocomplete]").forEach(g=>{(g.placeholder.includes("kh\xE1ch h\xE0ng")||g.placeholder.includes("Th\xEAm kh\xE1ch h\xE0ng"))&&(g.value="")})},100)}removeSelectedCustomer(n){let e=this.SelectedKhachhang.findIndex(t=>(typeof t=="string"?t:t.name)===(typeof n=="string"?n:n.name));e>=0&&(this.SelectedKhachhang.splice(e,1),this.SearchParams.khachhangIds=this.SelectedKhachhang.map(t=>typeof t=="string"?t:t.id),this.refreshCustomerFilter())}removeSelectedNhomkhachhang(n){let e=this.SelectedNhomKhachhang.findIndex(t=>(typeof t=="string"?t:t.name)===(typeof n=="string"?n:n.name));e>=0&&(this.removeCustomersFromGroup(n),this.SelectedNhomKhachhang.splice(e,1),this.refreshNhomKhachhangFilter(),this.refreshCustomerFilter())}clearAllSelectedCustomers(){this.SelectedKhachhang=[],this.SearchParams.khachhangIds=[],this.refreshCustomerFilter()}clearAllSelectedNhomKhachhang(){this.SelectedNhomKhachhang.forEach(n=>{this.removeCustomersFromGroup(n)}),this.SelectedNhomKhachhang=[],this.refreshNhomKhachhangFilter(),this.refreshCustomerFilter()}refreshCustomerFilter(){let n=this.SelectedKhachhang.map(e=>typeof e=="string"?e:e.name);this.filterListKhachhang=this.ListKhachhang.filter(e=>{let t=typeof e=="string"?e:e.name;return!n.includes(t)})}refreshNhomKhachhangFilter(){let n=this.SelectedNhomKhachhang.map(e=>typeof e=="string"?e:e.name);this.filterListNhomKhachhang=this.ListNhomKhachhang.filter(e=>{let t=typeof e=="string"?e:e.name;return!n.includes(t)})}addCustomersFromGroup(n){if(!n||typeof n=="string")return;(n.khachhang||[]).forEach(t=>{this.SelectedKhachhang.some(l=>(typeof l=="string"?l:l.name)===t.name)||this.SelectedKhachhang.push(t)}),this.SearchParams.khachhangIds=this.SelectedKhachhang.map(t=>typeof t=="string"?t:t.id)}removeCustomersFromGroup(n){if(!n||typeof n=="string")return;(n.khachhang||[]).forEach(t=>{let i=this.SelectedKhachhang.findIndex(l=>(typeof l=="string"?l:l.name)===t.name);i>=0&&this.SelectedKhachhang.splice(i,1)}),this.SearchParams.khachhangIds=this.SelectedKhachhang.map(t=>typeof t=="string"?t:t.id)}loadData(n){return k(this,null,function*(){this.isLoading=!0;try{yield this._DonhangService.searchCongno(n),this.CountItem=this.Listdonhang().length||0;let e=new Map;this.ListCongno=this.Listdonhang(),this.dataSource=new oe(this.ListCongno),this.dataSource.sort=this.sort,this.dataSource.filterPredicate=this.createFilter();let t=yield this._GraphqlService.findAll("khachhang",{aggressiveCache:!0,enableStreaming:!0,select:{id:!0,name:!0,makh:!0}});this.ListKhachhang=this.filterListKhachhang=t.data;let i=yield this._GraphqlService.findAll("nhomkhachhang",{aggressiveCache:!0,enableStreaming:!0,select:{id:!0,name:!0,description:!0,khachhang:{select:{id:!0,name:!0,makh:!0}}}});this.ListNhomKhachhang=this.filterListNhomKhachhang=i.data}finally{this.isLoading=!1}})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(n=>({key:n,value:this.ColumnName[n],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("CongnoColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(n=>n.isShow).map(n=>n.key),this.ColumnName=this.FilterColumns.reduce((n,e)=>(e.isShow&&(n[e.key]=e.value),n),{})}setupDrawer(){this._breakpointObserver.observe([ye.Handset]).subscribe(n=>{n.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(n=>n.isShow).map(n=>n.key),this.ColumnName=this.FilterColumns.reduce((n,e)=>(e.isShow&&(n[e.key]=e.value),n),{}),localStorage.setItem("CongnoColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(n){let e=n.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(t=>t.value.toLowerCase().includes(e))}toggleColumn(n){let e=this.FilterColumns.find(t=>t.key===n.key);e&&(e.isShow=!e.isShow,this.updateDisplayedColumns())}FilterHederColumn(n,e){return n.filter((i,l,h)=>l===h.findIndex(g=>g[e]===i[e]))}doFilterHederColumn(n,e){this.dataSource.filteredData=this.Listdonhang().filter(i=>I(i[e]).includes(n.target.value.toLowerCase())||i[e].toLowerCase().includes(n.target.value.toLowerCase()));let t=n.target.value.toLowerCase()}ListFilter=[];ChosenItem(n,e){let t=this.dataSource.filteredData.filter(l=>l[e]===n[e]);this.ListFilter.filter(l=>l[e]===n[e]).length>0?this.ListFilter=this.ListFilter.filter(l=>l[e]!==n[e]):this.ListFilter=[...this.ListFilter,...t]}ChosenAll(n){n.forEach(e=>{!!this.ListFilter.find(i=>i.id===e.id)?this.ListFilter=this.ListFilter.filter(i=>i.id!==i.id):this.ListFilter.push(e)})}ResetFilter(){this.ListFilter=this.Listdonhang(),this.dataSource.data=this.Listdonhang(),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}EmptyFiter(){this.ListFilter=[]}CheckItem(n){return!!this.ListFilter.find(e=>e.id===n.id)}ApplyFilterColum(n){this.dataSource.data=this.Listdonhang().filter(e=>this.ListFilter.some(t=>t.id===e.id)),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,n.closeMenu()}create(){this.drawer.open(),this._router.navigate(["admin/congnokhachhang",0])}goToDetail(n){this._DonhangService.setDonhangId(n.id),this.drawer.open(),this._router.navigate(["admin/congnokhachhang",n.id])}ToggleAll(){this.editDonhang.length===this.dataSource.filteredData.length?this.editDonhang=[]:this.editDonhang=[...this.dataSource.filteredData]}editDonhang=[];toggleDonhang(n){let e=this.editDonhang.findIndex(t=>t.id===n.id);e!==-1?this.editDonhang.splice(e,1):this.editDonhang.push(n)}TinhTong(n,e){return n?.reduce((t,i)=>t+(i[e]||0),0)||0}dialog=P($e);dialogCreateRef;Phieuchia=[];openCreateDialog(n){this.Phieuchia=this.editDonhang.map(e=>({makh:e.khachhang?.makh,name:e.khachhang?.name,madonhang:e.madonhang,ngaygiao:e.ngaygiao,sanpham:e.sanpham.map(t=>({masp:t.masp,title:t.title,dvt:t.dvt,slgiao:t.slgiao,giaban:t.giaban,ttgiao:t.ttgiao}))})),console.log(this.Phieuchia),this.dialogCreateRef=this.dialog.open(n,{hasBackdrop:!0,disableClose:!0})}openPreviewExport(n){return k(this,null,function*(){if(this.editDonhang.length>0){let e=yield this.ChuyendoiExport(this.editDonhang);this.exampleExport=this.convertFlatData(e[0]||{}),console.log("exampleExport",this.exampleExport),this.dialogCreateRef=this.dialog.open(n,{hasBackdrop:!0,disableClose:!0})}else this._snackBar.open("Vui l\xF2ng ch\u1ECDn \xEDt nh\u1EA5t m\u1ED9t kh\xE1ch h\xE0ng","\u0110\xF3ng",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-warning"]})})}convertFlatData(n){return n?.sanpham?.map(e=>({madonhang:n.madonhang,ngaygiao:n.ngaygiao,masp:e.sanpham.masp,tensp:e.sanpham.title,dvt:e.sanpham.dvt,slnhan:e.slnhan,giaban:e.giaban,ttnhan:e.ttnhan,makh:n.khachhang.makh,tenkh:n.khachhang.name,diachi:n.khachhang.diachi||"",email:n.khachhang.email||"",ghichu:e.ghichu||""}))}ChuyendoiExport(n){return k(this,null,function*(){return(yield this._GraphqlService.findAll("donhang",{aggressiveCache:!0,enableStreaming:!0,where:{id:{in:n.map(t=>t.id)},ngaygiao:{gte:(0,L.default)(this.SearchParams.Batdau).startOf("day").toDate(),lte:(0,L.default)(this.SearchParams.Ketthuc).endOf("day").toDate()},status:{in:this.SearchParams.Status}},select:{id:!0,madonhang:!0,ngaygiao:!0,sanpham:{select:{slnhan:!0,ttnhan:!0,giaban:!0,ghichu:!0,sanpham:{select:{masp:!0,title:!0,dvt:!0}}}},khachhang:{select:{makh:!0,name:!0,diachi:!0,email:!0}}}})).data})}BackStatus(){this.editDonhang.forEach(n=>{n.status="dadat",this._DonhangService.updateDonhang(n)}),this.ngOnInit()}Hoanthanh(){this.editDonhang.forEach(n=>{n.status="hoanthanh",this._DonhangService.updateDonhang(n)})}getUniqueProducts(){let n=new Set;return this.Phieuchia.forEach(e=>e.sanpham.forEach(t=>n.add(t.title))),Array.from(n)}getProductQuantity(n,e){let i=this.Phieuchia.find(l=>l.makh===e)?.sanpham.find(l=>l.title===n);return i?i.slgiao:""}getDvtForProduct(n){let t=Array.from(new Map(this.Phieuchia.flatMap(i=>i.sanpham.map(l=>Y($({},l),{makh:i.makh,name:i.name}))).map(i=>[i.title,i])).values()).find(i=>i.title===n);return t?t.dvt:""}CheckItemInDonhang(n){return this.editDonhang.findIndex(e=>e.id===n.id)!==-1}DeleteDonhang(){}LoadDrive(){return k(this,null,function*(){let n={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"SPImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},e=yield this._GoogleSheetService.getDrive(n),t=et(e.values);console.log(t),this.DoImportData(t)})}DoImportData(n){console.log(n);let t=n.map(u=>({title:u.title?.trim()||"",masp:u.masp?.trim()||"",slug:`${tt(u?.title?.trim()||"")}_${nt(5,!1)}`,giagoc:Number(u.giagoc)||0,dvt:u.dvt||"",soluong:Number(u.soluong)||0,soluongkho:Number(u.soluongkho)||0,ghichu:u.ghichu||"",order:Number(u.order)||0})).filter((u,b,x)=>b===x.findIndex(D=>D.masp===u.masp)),i=t.map(u=>u.masp),l=this._DonhangService.ListDonhang().map(u=>u.masp),h=i.filter(u=>!l.includes(u)),g=t.map(u=>k(this,null,function*(){let b=this._DonhangService.ListDonhang().find(x=>x.masp===u.masp);if(b){let x=$($({},b),u);yield this._DonhangService.updateDonhang(x)}else yield this._DonhangService.CreateDonhang(u)})),v=h.map(u=>k(this,null,function*(){let b=this._DonhangService.ListDonhang().find(x=>x.masp===u);b.isActive=!1,yield this._DonhangService.updateDonhang(b)}));Promise.all([...g,...v]).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ImporExcel(n){return k(this,null,function*(){let e=yield Ft(n);this.DoImportData(e)})}ExportExcel(n,e){return k(this,null,function*(){this.isExporting=!0,this.editDonhang.length>0?this.SearchParams.ids=this.editDonhang.map(t=>t.id):this.SearchParams.ids=n.map(t=>t.id);try{console.log("Attempting server-based Excel export..."),yield this._DonhangService.downloadCongno(this.SearchParams),this._snackBar.open("Xu\u1EA5t file Excel t\u1EEB server th\xE0nh c\xF4ng!","\u0110\xF3ng",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-success"]}),this.editDonhang=[]}catch(t){console.warn("Server export failed, falling back to client-side export:",t);try{console.log("Attempting client-side Excel export with table format...");let i=[];this.editDonhang.length>0?i=(yield this.ChuyendoiExport(this.editDonhang)).flatMap(h=>this.convertFlatData(h)):i=(yield this.ChuyendoiExport(n)).flatMap(h=>this.convertFlatData(h)),yield this.generateExcelWithTableFormat(i,e),this._snackBar.open("Xu\u1EA5t file Excel (\u0111\u1ECBnh d\u1EA1ng b\u1EA3ng) th\xE0nh c\xF4ng!","\u0110\xF3ng",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-success"]}),this.editDonhang=[]}catch(i){console.error("Client-side export also failed:",i),console.log("Attempting final fallback export..."),yield this.ExportExcelFallback(n,e)}}finally{this.isExporting=!1}})}ExportExcelTableFormat(n,e){return k(this,null,function*(){this.isExporting=!0;try{console.log("Exporting Excel with table format...");let t=[];this.editDonhang.length>0?t=(yield this.ChuyendoiExport(this.editDonhang)).flatMap(l=>this.convertFlatData(l)):t=(yield this.ChuyendoiExport(n)).flatMap(l=>this.convertFlatData(l)),yield this.generateExcelWithTableFormat(t,e),this.editDonhang=[],this._snackBar.open("Xu\u1EA5t file Excel (\u0111\u1ECBnh d\u1EA1ng b\u1EA3ng) th\xE0nh c\xF4ng!","\u0110\xF3ng",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-success"]})}catch(t){console.error("Error exporting Excel with table format:",t),this._snackBar.open("L\u1ED7i khi xu\u1EA5t file Excel (\u0111\u1ECBnh d\u1EA1ng b\u1EA3ng)!","\u0110\xF3ng",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.isExporting=!1}})}ExportExcelFallback(n,e){return k(this,null,function*(){try{let t=["Ng\xE0y","M\xE3 Kh\xE1ch H\xE0ng","T\xEAn Kh\xE1ch H\xE0ng","M\xE3 \u0110\u01A1n H\xE0ng","M\xE3 H\xE0ng","T\xEAn H\xE0ng","\u0110VT","S\u1ED1 L\u01B0\u1EE3ng","\u0110\u01A1n Gi\xE1","Th\xE0nh Ti\u1EC1n Tr\u01B0\u1EDBc VAT","VAT","\u0110\u01A1n Gi\xE1 VAT","Th\xE0nh Ti\u1EC1n Sau VAT","Ghi Ch\xFA","T\u1ED5ng Ti\u1EC1n Sau Thu\u1EBF"],i=[];n.length>0?i=this.groupDataByCustomer(n):i=this.groupDataByCustomer(this.ListCongno),this.writeExcelFileWithMergedCells(i,e,t)}catch(t){console.error("Error in fallback Excel export:",t)}})}groupDataByCustomer(n){let e=new Map;n.forEach(i=>{let l=i.makhachhang;e.has(l)||e.set(l,[]),e.get(l).push(i)});let t=[];return e.forEach((i,l)=>{let h=i.reduce((g,v)=>g+(v.thanhtiensauvat||0),0);i.forEach((g,v)=>{t.push(Y($({},g),{tongtiensauthue:v===0?h:null}))})}),t}writeExcelFileWithMergedCells(n,e,t){let i=n.map(u=>({Ng\u00E0y:(0,L.default)(u.ngaygiao).format("DD/MM/YYYY"),"M\xE3 Kh\xE1ch H\xE0ng":u.makhachhang,"T\xEAn Kh\xE1ch H\xE0ng":u.tenkhachhang,"M\xE3 \u0110\u01A1n H\xE0ng":u.madonhang,"M\xE3 H\xE0ng":u.mahang,"T\xEAn H\xE0ng":u.tenhang,\u0110VT:u.dvt,"S\u1ED1 L\u01B0\u1EE3ng":u.soluong,"\u0110\u01A1n Gi\xE1":u.dongia,"Th\xE0nh Ti\u1EC1n Tr\u01B0\u1EDBc VAT":u.thanhtientruocvat,VAT:u.vat,"\u0110\u01A1n Gi\xE1 VAT":u.dongiavathoadon,"Th\xE0nh Ti\u1EC1n Sau VAT":u.thanhtiensauvat,"Ghi Ch\xFA":u.ghichu,"T\u1ED5ng Ti\u1EC1n Sau Thu\u1EBF":u.tongtiensauthue})),l=A.utils.json_to_sheet(i),h=this.createMergeRanges(n);h.length>0&&(l["!merges"]=h);let g=A.utils.book_new();A.utils.book_append_sheet(g,l,"CongNo");let v=A.write(g,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(v,`${e}_${(0,L.default)().format("DD_MM_YYYY")}`)}createMergeRanges(n){let e=[],t=new Map;n.forEach((l,h)=>{let g=l.makhachhang;t.has(g)||t.set(g,{start:h+1,count:0}),t.get(g).count++});let i=14;return t.forEach(l=>{l.count>1&&e.push({s:{r:l.start,c:i},e:{r:l.start+l.count-1,c:i}})}),e}saveAsExcelFile(n,e){let t=new Blob([n],{type:"application/octet-stream"}),i=window.URL.createObjectURL(t),l=document.createElement("a");l.href=i,l.download=`${e}.xlsx`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(i)}generateExcelWithTableFormat(n,e){return k(this,null,function*(){try{let t=A.utils.book_new(),i=new Map;if(n.forEach(h=>{let g=h.makh||"Unknown",v=h.tenkh||h.tenkhachhang||"Unknown Customer",u=`${g}_${v}`;i.has(u)||i.set(u,[]),i.get(u).push(h)}),i.size===0)yield this.createCustomerSheet(t,n,"All Customers",n[0]||{});else{let h=new Set;i.forEach((g,v)=>{let u=g[0]||{},b=u.tenkh||u.tenkhachhang||"Unknown Customer",x=this.sanitizeSheetName(b),D=x,re=1;for(;h.has(D);){let le=`_${re}`,$t=31-le.length;D=`${x.substring(0,$t)}${le}`,re++}h.add(D),this.createCustomerSheet(t,g,D,u)})}let l=A.write(t,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(l,`${e}_${(0,L.default)().format("DD_MM_YYYY")}`)}catch(t){throw console.error("Error generating Excel with table format:",t),t}})}createCustomerSheet(n,e,t,i){let l=[["LOGO","","","","C\xD4NG TY TNHH N\xD4NG S\u1EA2N TH\u1EF0C PH\u1EA8M TR\u1EA6N GIA","","","","","",""],["","","","","HTX: \u1EA4p L\u1ED9c Ti\u1EBFn, X\xE3 M\u1EF9 L\u1ED9c, Huy\u1EC7n C\u1EA7n Giu\u1ED9c, T\u1EC9nh Long An","","","","","",""],["","","","","VP: T\xF2a nh\xE0 An Ph\xFA Plaza, 117-119 L\xFD Ch\xEDnh Th\u1EAFng, P.7. Q.3,","","","","","",""],["","","","","TP.HCM Kho s\u01A1 ch\u1EBF: 30 Kha V\u1EA1n C\xE2n, P. Hi\u1EC7p B\xECnh Ch\xE1nh,","","","","","",""],["","","","","TP.Th\u1EE7 \u0110\u1EE9c, TP.HCM Kho \u0110\xE0 L\u1EA1t: 69 Tr\u1EA7n Th\u1EE7 \u0110\u1ED9,","","","","","",""],["","","","","TT Li\xEAn Ngh\u0129a, Huy\u1EC7n \u0110\u1EE9c Tr\u1ECDng, T\u1EC9nh L\xE2m \u0110\u1ED3ng.","","","","","",""],["","","","","Website: rausachtrangia.com - Hotline: 090.245.8081","","","","","",""],["CHI TI\u1EBET \u0110\u1ED0I CHI\u1EBEU C\xD4NG N\u1EE2","","","","","","","","","",""],[`T\u1EEB Ng\xE0y ${(0,L.default)(this.SearchParams.Batdau).format("DD/MM/YYYY")} : - \u0110\u1EBFn Ng\xE0y : ${(0,L.default)(this.SearchParams.Ketthuc).format("DD/MM/YYYY")}`,"","","","","","","","","",""],[`T\xEAn Kh\xE1ch H\xE0ng : ${i.tenkh||i.tenkhachhang||""}`,"","","","","","","","","",""],[`\u0110\u1ECBa Ch\u1EC9 : ${i.diachi||""}`,"","","","","","","","","",""],[`Ng\u01B0\u1EDDi Li\xEAn h\u1EC7 : ${i.lienhe||""}`,"","","",`Email : ${i.email||""}`,"","","","","",""],["","","","","","","","","","",""],["NG\xC0Y GIAO","M\xC3 KH\xC1CH H\xC0NG","T\xCAN KH\xC1CH H\xC0NG","M\xC3 \u0110\u01A0N H\xC0NG","M\xC3 H\xC0NG","T\xCAN H\xC0NG","\u0110VT","S\u1ED0 L\u01AF\u1EE2NG","\u0110\u01A0N GI\xC1","TH\xC0NH TI\u1EC0N","GHI CH\xDA"]];e.sort((x,D)=>(x.tensp||"").localeCompare(D.tensp||"")),e.forEach(x=>{l.push([(0,L.default)(x.ngaygiao).format("DD/MM/YYYY")||"",x.makh||"",x.tenkh||x.tenkhachhang||"",x.madonhang||"",x.masp||"",x.tensp||"",x.dvt||"",Number(x.slnhan)||0,Number(x.giaban)||0,Number(x.ttnhan)||0,x.ghichu||""])});let h=e.reduce((x,D)=>x+(Number(D.slnhan)||0),0),g=e.reduce((x,D)=>x+(Number(D.ttnhan)||0),0);l.push(["","","","","","T\u1ED4NG C\u1ED8NG:","",h,"",g,""]);let v=A.utils.aoa_to_sheet(l),u=[{wch:12},{wch:15},{wch:25},{wch:15},{wch:12},{wch:30},{wch:8},{wch:12},{wch:15},{wch:15},{wch:20}];v["!cols"]=u;let b=[{s:{r:0,c:0},e:{r:6,c:3}},{s:{r:0,c:4},e:{r:0,c:10}},{s:{r:1,c:4},e:{r:1,c:10}},{s:{r:2,c:4},e:{r:2,c:10}},{s:{r:3,c:4},e:{r:3,c:10}},{s:{r:4,c:4},e:{r:4,c:10}},{s:{r:5,c:4},e:{r:5,c:10}},{s:{r:6,c:4},e:{r:6,c:10}},{s:{r:7,c:0},e:{r:7,c:10}},{s:{r:8,c:0},e:{r:8,c:10}},{s:{r:9,c:0},e:{r:9,c:10}},{s:{r:10,c:0},e:{r:10,c:10}},{s:{r:11,c:0},e:{r:11,c:3}},{s:{r:11,c:4},e:{r:11,c:10}},{s:{r:12,c:0},e:{r:12,c:10}}];v["!merges"]=b,A.utils.book_append_sheet(n,v,t)}sanitizeSheetName(n){let e=n.replace(/[\/\\?*\[\]]/g,"_").trim();return e.length>31&&(e=e.substring(0,31)),(!e||e.length===0)&&(e="Customer"),e}addLogoToWorksheet(n,e){return k(this,null,function*(){try{(yield this.loadImageAsBase64("/images/logo.svg"))&&console.log("Logo loaded successfully for Excel");let l=n.A1;l&&(l.s={font:{bold:!0,size:12,color:{rgb:"2E5A87"},name:"Arial"},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"F8F9FA"}},border:{top:{style:"thin",color:{rgb:"D1D5DB"}},bottom:{style:"thin",color:{rgb:"D1D5DB"}},left:{style:"thin",color:{rgb:"D1D5DB"}},right:{style:"thin",color:{rgb:"D1D5DB"}}}},l.v="C\xD4NG TY TR\u1EA6N GIA",l.t="s")}catch(t){console.warn("Could not load/add logo to Excel file:",t);let i=n.A1;i&&(i.v="LOGO",i.s={font:{bold:!0,size:10},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"E5E7EB"}}})}})}loadImageAsBase64(n){return k(this,null,function*(){try{let e=yield fetch(n);if(!e.ok)throw new Error("Failed to load image");let t=yield e.blob();return new Promise((i,l)=>{let h=new FileReader;h.onload=()=>i(h.result),h.onerror=l,h.readAsDataURL(t)})}catch(e){return console.warn("Failed to load image:",e),null}})}printContent(){let n=document.getElementById("printContent");n&&(0,Ht.default)(n,{scale:2}).then(e=>{let t=e.toDataURL("image/png"),i=window.open("","_blank");i&&(i.document.write(`
        <html>
          <head>
            <title>Phi\u1EBFu Chia H\xE0ng ${(0,L.default)().format("DD/MM/YYYY")}</title>
          </head>
          <body style="text-align: center;">
            <img src="${t}" style="max-width: 100%;"/>
            <script>
              window.onload = function() {
                window.print();
                window.onafterprint = function() { window.close(); };
              };
            <\/script>
          </body>
        </html>
      `),i.document.close())})}DongboVat(){return k(this,null,function*(){this.openDongboDialog()})}openDongboDialog(){if(this.editDonhang.length===0){this._snackBar.open("Kh\xF4ng c\xF3 \u0111\u01A1n h\xE0ng n\xE0o \u0111\u1EC3 \u0111\u1ED3ng b\u1ED9","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}this.dialog.open(this.confirmDongboDialog,{hasBackdrop:!0,disableClose:!0,width:"600px",maxWidth:"90vw"}).afterClosed().subscribe(e=>{e==="true"&&this.executeDongboVat()})}executeDongboVat(){return k(this,null,function*(){this.isLoading=!0;let n=this._snackBar.open(`\u0110ang \u0111\u1ED3ng b\u1ED9 gi\xE1 v\xE0 VAT cho ${this.editDonhang.length} \u0111\u01A1n h\xE0ng...`,"\u0110ang x\u1EED l\xFD",{duration:0,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-info"]});try{let e=yield this._DonhangService.DongboGia(this.editDonhang);if(!e||e.status!=="success")throw new Error(e?.message||"L\u1ED7i \u0111\u1ED3ng b\u1ED9 gi\xE1");let t=0,i=0,l=[];yield this.loadData(this.SearchParams);for(let h of this.editDonhang)try{let g=this.dataSource.data.find(x=>x.id===h.id),v=Number(g?.tongtien||h.tongtien)||0,u=Number(g?.vat||h.vat)||.05,b=v*u;yield this._GraphqlService.updateOne("donhang",{id:h.id},{tongvat:Math.round(b*100)/100,vat:u}),h.tongvat=Math.round(b*100)/100,h.tongtien=v,t++}catch(g){console.error(`Error updating VAT for order ${h.madonhang}:`,g),i++,l.push(`${h.madonhang}: ${g.message||"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"}`)}if(n.dismiss(),e.updatedCount>0||t>0){let h=`\u2705 \u0110\u1ED3ng b\u1ED9 ho\xE0n t\u1EA5t!
`;if(e.updatedCount!==void 0){let v=Math.round(e.updatedCount/e.totalProcessed*100);h+=`\u{1F4CA} Gi\xE1: ${e.updatedCount}/${e.totalProcessed} \u0111\u01A1n h\xE0ng (${v}%)
`,e.errorCount>0&&(h+=`\u26A0\uFE0F L\u1ED7i gi\xE1: ${e.errorCount} \u0111\u01A1n h\xE0ng
`)}let g=Math.round(t/this.editDonhang.length*100);h+=`\u{1F4B0} VAT: ${t}/${this.editDonhang.length} \u0111\u01A1n h\xE0ng (${g}%)`,i>0&&(h+=`
\u26A0\uFE0F L\u1ED7i VAT: ${i} \u0111\u01A1n h\xE0ng`,console.warn("VAT sync errors:",l)),this._snackBar.open(h,"\u2705 Th\xE0nh c\xF4ng",{duration:8e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),yield this.loadData(this.SearchParams),this.editDonhang=[]}else this._snackBar.open("\u274C Kh\xF4ng c\xF3 \u0111\u01A1n h\xE0ng n\xE0o \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt","\u0110\xF3ng",{duration:4e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}catch(e){console.error("Error syncing prices and VAT:",e),n.dismiss();let t="L\u1ED7i khi \u0111\u1ED3ng b\u1ED9 gi\xE1 v\xE0 VAT";e?.error?.message?(t=e.error.message,e.error.message.includes("Transaction already closed")&&(t="\u23F1\uFE0F Thao t\xE1c m\u1EA5t qu\xE1 nhi\u1EC1u th\u1EDDi gian. Vui l\xF2ng th\u1EED l\u1EA1i v\u1EDBi \xEDt \u0111\u01A1n h\xE0ng h\u01A1n.")):e?.message&&(t=e.message,e.message.includes("timeout")&&(t="\u23F1\uFE0F H\u1EBFt th\u1EDDi gian ch\u1EDD. H\u1EC7 th\u1ED1ng \u0111ang x\u1EED l\xFD qu\xE1 nhi\u1EC1u \u0111\u01A1n h\xE0ng c\xF9ng l\xFAc.")),this._snackBar.open(`\u274C ${t}`,"\u0110\xF3ng",{duration:6e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.isLoading=!1}})}trackByFn(n,e){return e.id}static \u0275fac=function(e){return new(e||B)};static \u0275cmp=ce({type:B,selectors:[["app-listcongnokhachhang"]],viewQuery:function(e,t){if(e&1&&(O(wt,5),O(W,5),O(zt,7),O(Xt,5)),e&2){let i;z(i=X())&&(t.paginator=i.first),z(i=X())&&(t.sort=i.first),z(i=X())&&(t.drawer=i.first),z(i=X())&&(t.confirmDongboDialog=i.first)}},decls:83,vars:36,consts:[["drawer",""],["pickerBatdau",""],["pickerKetthuc",""],["exportMenu","matMenu"],["menu","matMenu"],["dialogCreateTemplate",""],["dialogPreviewExport",""],["ConfirmDongboDialog",""],["nhomKHInput",""],["autoNhom","matAutocomplete"],["customerInput",""],["auto","matAutocomplete"],["menuTrigger","matMenuTrigger"],["autosize","",1,"w-full","h-full"],["class","fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",4,"ngIf"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[1,"w-full","grid","gap-2","items-center"],[1,"w-full","flex","flex-row","space-x-2","items-center"],[1,"w-full",3,"appearance","subscriptSizing"],["matInput","",3,"dateChange","ngModelChange","matDatepicker","ngModel","ngModelOptions"],["matIconSuffix","",3,"for"],[1,"lg:flex","hidden","cursor-pointer","whitespace-nowrap","p-2","rounded-lg","bg-slate-200",3,"click"],[1,"lg:flex","hidden","cursor-pointer","whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],["matTooltip","Xem M\u1EABu","mat-icon-button","","color","primary",3,"click"],["matTooltip","Xu\u1EA5t file Excel","color","primary","mat-icon-button","",1,"relative",3,"matMenuTriggerFor"],["class","absolute inset-0 flex items-center justify-center",4,"ngIf"],["mat-menu-item","",3,"click"],["matTooltip","T\xECm ki\u1EBFm","color","primary","mat-icon-button","",1,"relative",3,"click","disabled"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","\u1EA8n hi\u1EC7n Tool Kh\xE1ch H\xE0ng","mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","primary","matTooltip","\u0110\u1ED3ng b\u1ED9 gi\xE1 t\u1EEB b\u1EA3ng gi\xE1 cho t\u1EA5t c\u1EA3 \u0111\u01A1n h\xE0ng \u0111\xE3 ch\u1ECDn",3,"click","disabled"],[1,"w-full","grid","lg:grid-cols-2","gap-2","items-center"],[1,"w-full","overflow-auto","relative"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-90 z-10",4,"ngIf"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"class","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"fixed","inset-0","bg-white","bg-opacity-75","flex","items-center","justify-center","z-50"],[1,"flex","flex-col","items-center","space-y-4"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600"],[1,"text-lg","text-gray-700"],[1,"absolute","inset-0","flex","items-center","justify-center"],[1,"animate-spin","rounded-full","h-5","w-5","border-b-2","border-blue-600"],[1,"flex","flex-col","space-y-2","w-full"],[1,"font-bold"],[3,"appearance","subscriptSizing"],["aria-label","Ch\u1ECDn nh\xF3m kh\xE1ch h\xE0ng"],[3,"removable"],["matInput","",3,"keyup","placeholder","matAutocomplete"],["panelWidth","auto",1,"max-w-none",3,"optionSelected"],[1,"!whitespace-normal","!h-auto","!py-2",3,"value"],["matTooltip","X\xF3a t\u1EA5t c\u1EA3 nh\xF3m kh\xE1ch h\xE0ng \u0111\xE3 ch\u1ECDn","color","warn","mat-icon-button","","matSuffix",""],["aria-label","Ch\u1ECDn kh\xE1ch h\xE0ng"],["matTooltip","X\xF3a t\u1EA5t c\u1EA3 kh\xE1ch h\xE0ng \u0111\xE3 ch\u1ECDn","color","warn","mat-icon-button","","matSuffix",""],[3,"removed","removable"],["matChipRemove",""],[1,"text-sm"],[1,"text-xs","text-gray-500","block"],["matTooltip","X\xF3a t\u1EA5t c\u1EA3 nh\xF3m kh\xE1ch h\xE0ng \u0111\xE3 ch\u1ECDn","color","warn","mat-icon-button","","matSuffix","",3,"click"],["matTooltip","X\xF3a t\u1EA5t c\u1EA3 kh\xE1ch h\xE0ng \u0111\xE3 ch\u1ECDn","color","warn","mat-icon-button","","matSuffix","",3,"click"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-90","z-10"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"text-gray-600"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],[1,"z-10","material-symbols-outlined","text-gray-500",3,"matMenuTriggerFor"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"flex","flex-row","space-x-2","items-center","justify-between"],[1,"flex","flex-row","space-x-2","items-center"],[1,"text-xs","text-blue-600","underline",3,"click"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],["class","flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"],["mat-cell",""],[1,"max-w-40","line-clamp-4","flex","items-center"],[1,"max-w-40","line-clamp-4","font-bold","text-blue-700"],[1,"max-w-40","line-clamp-4","text-xs"],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","text-end"],[1,"max-w-40","line-clamp-4","font-bold",3,"ngClass"],[1,"max-w-40","line-clamp-4","flex","items-center",3,"click"],["class","material-symbols-outlined",4,"ngIf"],[1,"material-symbols-outlined"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],[1,"mat-cell","p-4"],["class","text-center py-8",4,"ngIf"],[1,"text-center","py-8"],[1,"text-gray-500","mb-2"],[1,"text-4xl"],[1,"text-gray-500"],["mat-dialog-title",""],["mat-icon-button","","color","primary",3,"click"],[1,"lg:min-w-[400px]","w-full","h-full","flex","flex-col","space-y-8","items-center","p-4"],[1,"w-full","overflow-x-auto"],["id","printContent",1,"w-full","border-collapse"],[1,"p-2","border","border-gray-300","bg-yellow-200","text-center","font-bold"],[4,"ngFor","ngForOf"],[3,"align"],["mat-flat-button","","color","warn","mat-dialog-close","false"],["class","p-2 border border-gray-300 align-middle text-center",4,"ngIf"],[1,"p-2","border","border-gray-300","text-center"],[1,"p-2","border","border-gray-300"],[1,"p-2","border","border-gray-300","text-right"],[1,"p-2","border","border-gray-300","align-middle","text-center"],[1,"mat-typography"],["id","exporttable",1,"text-xs","border-collapse","border","border-gray-300"],["colspan","4",1,"text-start","p-2","border"],["src","/images/logo.svg",1,"h-20","mx-auto"],["colspan","7",1,"text-start","p-2","flex","flex-col","gap-2"],[1,"text-md","font-bold"],["colspan","11",1,"text-md","font-bold","text-start","p-2","border"],["colspan","11",1,"text-start","p-2","border"],["colspan","7",1,"text-start","p-2","border"],[1,"text-start"],["colspan","11",1,"p-8"],[1,"bg-gray-300"],[1,"p-2","border","border-gray-300","text-center","font-bold"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],["align","end"],["mat-button","","mat-dialog-close",""],[1,"hover:bg-gray-50"],["mat-dialog-title","",1,"flex","items-center","space-x-2"],["color","primary"],[1,"font-semibold","text-xl"],[1,"flex","flex-col","space-y-4","py-4"],[1,"flex","items-start","space-x-3","p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-blue-600","mt-1"],[1,"flex-1"],[1,"font-semibold","text-blue-800","mb-2"],[1,"text-sm","text-blue-700"],[1,"font-semibold"],[1,"space-y-3"],[1,"font-semibold","text-gray-800"],[1,"space-y-2","text-sm","text-gray-700"],[1,"flex","items-start","space-x-2"],[1,"text-green-600","text-base","mt-0.5"],[1,"flex","items-start","space-x-3","p-4","bg-amber-50","rounded-lg","border-l-4","border-amber-400"],[1,"text-amber-600","mt-1"],[1,"font-semibold","text-amber-800","mb-2"],[1,"text-sm","text-amber-700"],["align","end",1,"border-t","pt-4"],["mat-flat-button","","color","primary",1,"ml-2",3,"mat-dialog-close"],[1,"mr-1"]],template:function(e,t){if(e&1){let i=w();a(0,"mat-drawer-container",13),E(1,jt,5,0,"div",14),a(2,"mat-drawer",15,0),F(4,"router-outlet"),o(),a(5,"div",16)(6,"div",17)(7,"div",18)(8,"mat-form-field",19)(9,"mat-label"),c(10,"B\u1EAFt \u0110\u1EA7u"),o(),a(11,"input",20),C("dateChange",function(h){return _(i),f(t.onDateChange(h))}),ie("ngModelChange",function(h){return _(i),ne(t.SearchParams.Batdau,h)||(t.SearchParams.Batdau=h),f(h)}),o(),F(12,"mat-datepicker-toggle",21)(13,"mat-datepicker",null,1),o(),a(15,"mat-form-field",19)(16,"mat-label"),c(17,"K\u1EBFt Th\xFAc"),o(),a(18,"input",20),C("dateChange",function(h){return _(i),f(t.onDateChange(h))}),ie("ngModelChange",function(h){return _(i),ne(t.SearchParams.Ketthuc,h)||(t.SearchParams.Ketthuc=h),f(h)}),o(),F(19,"mat-datepicker-toggle",21)(20,"mat-datepicker",null,2),o(),a(22,"span",22),C("click",function(){return _(i),f(t.ToggleAll())}),c(23),o(),a(24,"span",23),c(25),o(),a(26,"button",24),C("click",function(){_(i);let h=M(80);return f(t.openPreviewExport(h))}),a(27,"mat-icon"),c(28,"preview"),o()(),a(29,"button",25),E(30,Wt,2,0,"div",26),a(31,"mat-icon"),c(32,"file_download"),o()(),a(33,"mat-menu",null,3)(35,"button",27),C("click",function(){return _(i),f(t.ExportExcel(t.editDonhang,"Congno"))}),a(36,"mat-icon"),c(37,"cloud_download"),o(),a(38,"span"),c(39,"Xu\u1EA5t t\u1EEB Server (Nhanh)"),o()(),a(40,"button",27),C("click",function(){return _(i),f(t.ExportExcelTableFormat(t.editDonhang,"Congno"))}),a(41,"mat-icon"),c(42,"table_view"),o(),a(43,"span"),c(44,"Xu\u1EA5t \u0111\u1ECBnh d\u1EA1ng b\u1EA3ng (Chi ti\u1EBFt)"),o()()(),a(45,"button",28),C("click",function(){return _(i),f(t.doSearch())}),E(46,Ut,2,0,"div",26),a(47,"mat-icon"),c(48,"search"),o()(),a(49,"button",29)(50,"mat-icon"),c(51,"tune"),o()(),a(52,"mat-menu",null,4)(54,"div",30)(55,"mat-form-field",31)(56,"input",32),C("input",function(h){return _(i),f(t.doFilterColumns(h))})("click",function(h){return _(i),f(h.stopPropagation())}),o(),a(57,"mat-icon",33),c(58,"search"),o()()(),a(59,"div",34),K(60,Qt,5,2,"button",35,qt),o()(),a(62,"button",36),C("click",function(){return _(i),f(t.isShowKH=!t.isShowKH)}),a(63,"mat-icon"),c(64),o()(),a(65,"button",37),C("click",function(){return _(i),f(t.DongboVat())}),a(66,"mat-icon"),c(67,"currency_exchange"),o()()()(),E(68,ln,29,10,"div",38),a(69,"div",39),E(70,cn,5,0,"div",40),a(71,"table",41),K(72,Vn,3,1,"ng-container",42,R),E(74,Bn,1,0,"tr",43)(75,Pn,1,3,"tr",44)(76,Hn,3,2,"tr",45),o()()()(),E(77,qn,38,2,"ng-template",null,5,j)(79,Wn,80,13,"ng-template",null,6,j)(81,Un,62,2,"ng-template",null,7,j)}if(e&2){let i=M(14),l=M(21),h=M(34),g=M(53);s(),d("ngIf",t.isLoading),s(),d("position","end"),s(3),q("opacity-50",t.isLoading),s(3),d("appearance","outline")("subscriptSizing","dynamic"),s(3),d("matDatepicker",i),te("ngModel",t.SearchParams.Batdau),d("ngModelOptions",ae(34,Pt)),s(),d("for",i),s(3),d("appearance","outline")("subscriptSizing","dynamic"),s(3),d("matDatepicker",l),te("ngModel",t.SearchParams.Ketthuc),d("ngModelOptions",ae(35,Pt)),s(),d("for",l),s(4),p(" ",t.CountItem," B\u1EA3n Ghi "),s(2),p(" ",t.editDonhang.length," \u0110\xE3 Ch\u1ECDn "),s(4),d("matMenuTriggerFor",h),s(),d("ngIf",t.isExporting),s(),q("opacity-0",t.isExporting),s(14),d("disabled",t.isSearching),s(),d("ngIf",t.isSearching),s(),q("opacity-0",t.isSearching),s(2),d("matMenuTriggerFor",g),s(11),H(t.FilterColumns),s(4),T(t.isShowKH?"visibility":"visibility_off"),s(),d("disabled",t.isLoading||t.editDonhang.length===0),s(3),V(t.isShowKH?68:-1),s(2),d("ngIf",t.isLoading&&t.dataSource.data.length===0),s(),d("dataSource",t.dataSource),s(),H(t.displayedColumns),s(2),d("matHeaderRowDef",t.displayedColumns),s(),d("matRowDefColumns",t.displayedColumns)}},dependencies:[Ue,We,Ye,qe,je,Je,Qe,Ct,ct,ht,dt,mt,st,gt,ut,pt,_t,ft,xt,Lt,W,Dt,Tt,Ve,Ae,Ie,Ne,Le,Te,De,xe,Me,Fe,be,ve,ke,Ze,Se,fe,ue,pe,de,_e,ge,He,Be,Pe,Ke,bt,kt,rt,it,at,ot,Xe,Ge,Re,ze,Oe,Vt,At,Nt,vt,yt,Et,St],encapsulation:2})};G([U(300)],B.prototype,"applyFilter",1),G([U(100)],B.prototype,"doFilterKhachhang",1),G([U(100)],B.prototype,"doFilterNhomKhachhang",1),G([Qn()],B.prototype,"FilterHederColumn",1),G([U(300)],B.prototype,"doFilterHederColumn",1);var Kt=B;function Qn(){return function(r,n,e){let t=e.value,i=new Map;return e.value=function(...l){let h=JSON.stringify(l);if(i.has(h))return i.get(h);let g=t.apply(this,l);return i.set(h,g),g},e}}function U(r=300){return function(n,e,t){let i=t.value,l;return t.value=function(...h){clearTimeout(l),l=setTimeout(()=>{i.apply(this,h)},r)},t}}export{Kt as a};
