import{a as n}from"./chunk-VUZTNYK4.js";import{b as y}from"./chunk-7U2T4VS7.js";import{c as u}from"./chunk-WDMWHZJL.js";import{Ra as c,ia as l,na as h}from"./chunk-OSJESZB6.js";import{j as s}from"./chunk-6DYNGEAS.js";var p=class g{constructor(a,r){this._StorageService=a;this.router=r}ListBanggia=c([]);DetailBanggia=c({});banggiaId=c(null);setBanggiaId(a){this.banggiaId.set(a)}importBGKH(a){return s(this,null,function*(){try{let r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},t=yield fetch(`${n.APIURL}/banggia/importbgkh`,r);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let o=yield t.json();t.ok||this.handleError(t.status),this.getAllBanggia()}catch(r){return console.error(r)}})}importSPBG(a){return s(this,null,function*(){try{let t=[];for(let o=0;o<a.length;o+=10)t.push(a.slice(o,o+10));for(let o of t){let e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},i=yield fetch(`${n.APIURL}/banggia/importspbg`,e);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);let d=yield i.json();i.ok||this.handleError(i.status)}this.getAllBanggia()}catch(r){return console.error(r)}})}ImportBanggia(a){return s(this,null,function*(){console.log("bg",a);try{let r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},t=yield fetch(`${n.APIURL}/banggia/import`,r);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let o=yield t.json();t.ok||this.handleError(t.status),this.getAllBanggia()}catch(r){return console.error(r)}})}CreateBanggia(a){return s(this,null,function*(){try{let r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},t=yield fetch(`${n.APIURL}/banggia`,r);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let o=yield t.json();t.ok||this.handleError(t.status),this.getAllBanggia(),this.banggiaId.set(o.id)}catch(r){return console.error(r)}})}getAllBanggia(){return s(this,null,function*(){try{let a={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},r=yield fetch(`${n.APIURL}/banggia`,a);r.ok||this.handleError(r.status);let t=yield r.json();return this.ListBanggia.set(t),t}catch(a){console.error(a)}})}getAllBGSP(){return s(this,null,function*(){try{let a={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},r=yield fetch(`${n.APIURL}/banggia/getbgsp`,a);return r.ok||this.handleError(r.status),yield r.json()}catch(a){console.error(a)}})}getAllBGKH(){return s(this,null,function*(){try{let a={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},r=yield fetch(`${n.APIURL}/banggia/getbgkh`,a);return r.ok||this.handleError(r.status),yield r.json()}catch(a){console.error(a)}})}handleError(a){let r="L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh";switch(a){case 401:r="Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i";break;case 403:r="B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp";break;case 500:r="L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau";break}let t=JSON.stringify({code:a,title:r});this.router.navigate(["/errorserver"],{queryParams:{data:t}})}getBanggiaByid(a){return s(this,null,function*(){try{let r={method:"GET",headers:{"Content-Type":"application/json"}},t=yield fetch(`${n.APIURL}/banggia/findid/${a}`,r);t.ok||this.handleError(t.status);let o=yield t.json();this.DetailBanggia.set(o)}catch(r){return console.error(r)}})}updateBanggia(a){return s(this,null,function*(){try{let r={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},t=yield fetch(`${n.APIURL}/banggia/${a.id}`,r);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let o=yield t.json();t.ok||this.handleError(t.status),this.getAllBanggia(),this.getBanggiaByid(a.id)}catch(r){return console.error(r)}})}DeleteBanggia(a){return s(this,null,function*(){try{let r={method:"DELETE",headers:{"Content-Type":"application/json"}},t=yield fetch(`${n.APIURL}/banggia/${a.id}`,r);t.ok||this.handleError(t.status),this.getAllBanggia()}catch(r){return console.error(r)}})}addKHtoBG(a){return s(this,null,function*(){try{let r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},t=yield fetch(`${n.APIURL}/banggia/addKHtoBG`,r);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let o=yield t.json();if(!t.ok)if(t.status===401){let e=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:e}})}else if(t.status===403){let e=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:e}})}else if(t.status===500){let e=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:e}})}else{let e=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:e}})}this.getBanggiaByid(a.banggiaId)}catch(r){return console.error(r)}})}removeKHfromBG(a){return s(this,null,function*(){try{let r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},t=yield fetch(`${n.APIURL}/banggia/removeKHfromBG`,r);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let o=yield t.json();if(!t.ok)if(t.status===401){let e=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:e}})}else if(t.status===403){let e=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:e}})}else if(t.status===500){let e=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:e}})}else{let e=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:e}})}this.getBanggiaByid(a.banggiaId)}catch(r){return console.error(r)}})}static \u0275fac=function(r){return new(r||g)(h(y),h(u))};static \u0275prov=l({token:g,factory:g.\u0275fac,providedIn:"root"})};export{p as a};
