import{a as ie}from"./chunk-2ESOPHUI.js";import{a as ee,b as te}from"./chunk-ZRDBMRQ6.js";import"./chunk-BFIAAR4D.js";import"./chunk-XLFIXRGG.js";import"./chunk-LTIMMLFX.js";import"./chunk-AGNKQBAM.js";import"./chunk-ZW44ZSN2.js";import"./chunk-BQNHPUMH.js";import"./chunk-SLRDYDMI.js";import"./chunk-N7PBUGTM.js";import{a as Z,b as $}from"./chunk-TPFOWWOO.js";import"./chunk-TDAACTQD.js";import{h as O}from"./chunk-INJUMOX2.js";import"./chunk-H7UDLENL.js";import{a as N}from"./chunk-GD7IEZTW.js";import"./chunk-DP4FJZ2N.js";import"./chunk-QIIVLJEC.js";import{a as F,c as B}from"./chunk-RFYKARPR.js";import"./chunk-B52A5VRT.js";import{b as Y}from"./chunk-6S4AGD7B.js";import{A as U,b as z,g as H,j as G,o as K,q as X,w as q,x as J,z as Q}from"./chunk-KWM4OIFF.js";import"./chunk-KBSHTQVA.js";import{a as W,b as j}from"./chunk-4KMAECDD.js";import"./chunk-B5XVARHK.js";import"./chunk-KY47JUDC.js";import"./chunk-2PPFUFFT.js";import{a as V,c as A,e as L}from"./chunk-5RXGINDA.js";import"./chunk-RO6MDUJX.js";import"./chunk-HMVCX5BQ.js";import{m as T,w as I}from"./chunk-RGQ7KTVF.js";import{Db as S,Dc as a,Ec as x,Gc as P,Ic as w,Jc as y,Kb as C,Kc as E,Ra as R,Ub as d,ac as b,cc as M,dc as k,ec as n,fc as r,hc as D,ic as v,kc as f,pa as _,pc as u,rb as s,rc as c,ya as g,za as h}from"./chunk-OL5DVADB.js";import"./chunk-LWLSKGAV.js";import{j as p}from"./chunk-6DYNGEAS.js";function oe(l,e){if(l&1){let t=f();n(0,"button",1),u("click",function(){g(t);let o=c();return h(o.handleRoleAction())}),n(1,"mat-icon"),a(2,"save"),r()()}}function re(l,e){if(l&1){let t=f();n(0,"button",1),u("click",function(){g(t);let o=c();return h(o.toggleEdit())}),n(1,"mat-icon"),a(2,"edit"),r()()}}function le(l,e){if(l&1){let t=f();D(0),n(1,"div",9)(2,"div",10),a(3,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),r(),n(4,"div",11)(5,"button",12),u("click",function(){g(t);let o=c();return h(o.DeleteData())}),a(6,"\u0110\u1ED3ng \xDD"),r(),n(7,"button",13),u("click",function(){g(t);let o=c();return h(o.toggleDelete())}),a(8,"Hu\u1EF7 B\u1ECF"),r()()(),v()}}function ae(l,e){if(l&1){let t=f();n(0,"mat-slide-toggle",19),u("change",function(){let o=g(t).$implicit,m=c(2);return h(m.togglePermission(o))}),a(1),r()}if(l&2){let t=e.$implicit,i=c(2);d("disabled",!i.isEdit())("checked",t.hasPermission),s(),P(" ",t.name," - (",t.description||"Ch\u01B0a M\xF4 T\u1EA3",") ")}}function se(l,e){if(l&1){let t=f();D(0),n(1,"div",14)(2,"mat-form-field",15)(3,"mat-label"),a(4,"T\xEAn Nh\xF3m"),r(),n(5,"input",16),E("ngModelChange",function(o){g(t);let m=c();return y(m.DetailRole.name,o)||(m.DetailRole.name=o),h(o)}),r()()(),n(6,"div",17),M(7,ae,2,4,"mat-slide-toggle",18,b),r(),v()}if(l&2){let t=c();s(5),w("ngModel",t.DetailRole.name),d("disabled",!t.isEdit()),s(2),k(t.filterPermission)}}var ne=class l{_ListroleComponent=_(te);_RoleService=_(ee);_PermissionService=_(ie);_route=_(F);_router=_(B);_snackBar=_(N);ListPermission=[];filterPermission=[];idRole=0;constructor(){this._route.paramMap.subscribe(e=>p(this,null,function*(){this.idRole=e.get("id")}))}DetailRole={};isEdit=R(!1);isDelete=R(!1);ngOnInit(){return p(this,null,function*(){yield this._PermissionService.getAllPermission(1e3),this.ListPermission=this._PermissionService.ListPermission(),this.idRole?this.idRole==="new"?(this._ListroleComponent.drawer.open(),this.isEdit.update(e=>!e),this.filterPermission=this.ListPermission,this._router.navigate(["/admin/nhomuser","new"])):(yield this._RoleService.getRoleByid(this.idRole).then(()=>{this.DetailRole=this._RoleService.DetailRole(),this.filterPermission=this.ListPermission.map(e=>(this.DetailRole?.permissions?.length>0&&(e.hasPermission=!!this.DetailRole?.permissions.find(t=>t.permissionId===e.id)),e))}),this._ListroleComponent.drawer.open(),this._router.navigate(["/admin/nhomuser",this.idRole])):(this._router.navigate(["/admin/nhomuser"]),this._ListroleComponent.drawer.close()),setTimeout(()=>{console.log(this.filterPermission)},200)})}handleRoleAction(){return p(this,null,function*(){this.idRole==="new"?yield this.createRole():yield this.updateRole()})}createRole(){return p(this,null,function*(){console.log(this.DetailRole);try{yield this._RoleService.CreateRole(this.DetailRole),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi t\u1EA1o role:",e)}})}updateRole(){return p(this,null,function*(){try{yield this._RoleService.updateRole(this.DetailRole),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt role:",e)}})}DeleteData(){return p(this,null,function*(){try{yield this._RoleService.DeleteRole(this.DetailRole),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["/admin/nhomuser"])}catch(e){console.error("L\u1ED7i khi x\xF3a role:",e)}})}goBack(){this._router.navigate(["/admin/nhomuser"]),this._ListroleComponent.drawer.close()}trackByFn(e,t){return t.id}toggleEdit(){this.isEdit.update(e=>!e)}toggleDelete(){this.isDelete.update(e=>!e)}FillSlug(){}togglePermission(e){e.hasPermission=!e.hasPermission,console.log(e),e.hasPermission?this._RoleService.assignPermissionToRole({roleId:this.idRole,permissionId:e.id}):this._RoleService.removePermissionFromRole({roleId:this.idRole,permissionId:e.id})}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=S({type:l,selectors:[["app-detailrole"]],decls:17,vars:8,consts:[[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center"],[3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","warn",3,"click"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[4,"ngIf"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"w-full","flex","flex-col","space-y-2"],["appearance","outline"],["matInput","","placeholder","Vui l\xF2ng nh\u1EADp T\xEAn Nh\xF3m",3,"ngModelChange","ngModel","disabled"],[1,"grid","grid-cols-3","gap-2"],[3,"disabled","checked"],[3,"change","disabled","checked"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"button",1),u("click",function(){return i.goBack()}),n(2,"mat-icon"),a(3,"arrow_back"),r()(),n(4,"div",2),a(5),r(),n(6,"div",3)(7,"mat-slide-toggle",4),E("ngModelChange",function(m){return y(i.DetailRole.isActive,m)||(i.DetailRole.isActive=m),m}),a(8),r(),C(9,oe,3,0,"button",5)(10,re,3,0,"button",5),n(11,"button",6),u("click",function(){return i.toggleDelete()}),n(12,"mat-icon"),a(13,"delete"),r()()()(),n(14,"div",7),C(15,le,9,0,"ng-container",8)(16,se,9,2,"ng-container",8),r()),t&2&&(s(5),x((i.DetailRole==null?null:i.DetailRole.name)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),s(2),w("ngModel",i.DetailRole.isActive),d("disabled",!i.isEdit()),s(),x(i.DetailRole.isActive?"Hi\u1EC3n Th\u1ECB":"\u1EA8n"),s(),d("ngIf",i.isEdit()),s(),d("ngIf",!i.isEdit()),s(5),d("ngIf",i.isDelete()),s(),d("ngIf",!i.isDelete()))},dependencies:[J,q,X,U,Q,K,z,H,G,j,W,L,V,A,Y,O,I,T,$,Z],encapsulation:2})};export{ne as DetailRoleComponent};
