import{a as W}from"./chunk-ZW44ZSN2.js";import{a as j}from"./chunk-5BO56RLT.js";import{a as K}from"./chunk-VODLHY7C.js";import{a as U}from"./chunk-M3LUYOXS.js";import"./chunk-EOEI42HP.js";import"./chunk-HVTWWBOW.js";import{a as $}from"./chunk-6XOJN6DV.js";import{a as k}from"./chunk-X66ZAGGX.js";import"./chunk-N6OM2W2M.js";import"./chunk-5H4TKPBO.js";import"./chunk-567GRPMV.js";import{a as N,b as x,d as V}from"./chunk-3QQ7WLKN.js";import{b as H,g as z,j as Z,n as G,p as Y,u as X,v as q,x as J,y as Q}from"./chunk-4NZTMXFR.js";import"./chunk-VFJNSHJY.js";import{a as L,b as R}from"./chunk-K2APTHBJ.js";import"./chunk-AQK6ZTVG.js";import"./chunk-ZSAEAR5C.js";import"./chunk-T3Q3DASN.js";import"./chunk-A6EBYKJ6.js";import{d as P}from"./chunk-XTAZPAMD.js";import"./chunk-L4PP27XR.js";import{d as D,l as B,m as F,q as O}from"./chunk-IXS2H2R2.js";import{$b as a,Ab as M,Hb as v,Jc as E,Ob as I,Pb as w,Rb as m,ac as r,bc as y,ed as T,fa as S,fc as C,jb as A,kc as f,la as c,mc as l,ob as p,ua as g,va as _,yc as s,zc as h}from"./chunk-64COTWEO.js";import{j as u}from"./chunk-XXD5T5ZZ.js";var b=class{_document;_textarea;constructor(t,e){this._document=e;let i=this._textarea=this._document.createElement("textarea"),o=i.style;o.position="fixed",o.top=o.opacity="0",o.left="-999em",i.setAttribute("aria-hidden","true"),i.value=t,i.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(i)}copy(){let t=this._textarea,e=!1;try{if(t){let i=this._document.activeElement;t.select(),t.setSelectionRange(0,t.value.length),e=this._document.execCommand("copy"),i&&i.focus()}}catch{}return e}destroy(){let t=this._textarea;t&&(t.remove(),this._textarea=void 0)}},ee=(()=>{class n{_document=c(D);constructor(){}copy(e){let i=this.beginCopy(e),o=i.copy();return i.destroy(),o}beginCopy(e){return new b(e,this._document)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=S({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ne=()=>[B,F,X,Y,N,x,L,J,H,z,Z],oe=()=>["/welcome"];function ae(n,t){if(n&1){let e=C();a(0,"button",15),f("click",function(){g(e);let o=l().$implicit,d=l(2);return _(d.CreateAffiliateLink(o))}),s(1,"T\u1EA1o M\u1EDBi"),r()}}function re(n,t){if(n&1){let e=C();a(0,"div",16)(1,"mat-form-field",17)(2,"mat-label"),s(3,"Li\xEAn K\u1EBFt"),r(),y(4,"input",18),r(),a(5,"button",6),f("click",function(){g(e);let o=l().$implicit,d=l(2);return _(d.CopyLinkAffiliate(o))}),a(6,"mat-icon"),s(7,"content_copy"),r()(),a(8,"button",6),f("click",function(){g(e);let o=l().$implicit,d=l(2);return _(d.SharedAffiliate(o))}),a(9,"mat-icon"),s(10,"share"),r()()()}if(n&2){let e=l().$implicit,i=l(2);p(4),m("disabled",!0)("ngModel",i.getAffiliateLink(e))}}function le(n,t){if(n&1&&(a(0,"div",8)(1,"div",9),s(2),r(),a(3,"div",10),y(4,"img",11),a(5,"div",12),s(6),r()(),a(7,"div",3),v(8,ae,2,0,"button",13)(9,re,11,2,"div",14),r()()),n&2){let e=t.$implicit,i=l(2);p(2),h(e.title),p(2),m("src",e.thumbnail,A),p(2),h(e.description),p(2),m("ngIf",!i.getAffiliateLink(e)),p(),m("ngIf",i.getAffiliateLink(e))}}function ce(n,t){if(n&1&&v(0,le,10,5,"div",7),n&2){let e=l();m("ngForOf",e.ListLandingpage())}}var te=class n{_LandingpageService=c(K);_AffiliatelinkService=c(j);_UserService=c(U);_clipboard=c(ee);_MatSnackBar=c(k);_ErrorLogService=c($);_snackBar=c(k);ListLandingpage=this._LandingpageService.ListLandingpage;LinkAffiliate=this._AffiliatelinkService.ListAffiliatelink;Profile;constructor(){T(()=>u(this,null,function*(){yield this._LandingpageService.getAllLandingpage(),yield this._UserService.getProfile(),this.Profile=this._UserService.profile(),yield this._AffiliatelinkService.getAffiliateListBy({createdById:this.Profile.id})}))}ngOnInit(){this._AffiliatelinkService.listenAffiliatelinkUpdates()}getAffiliateLink(t){let e=this.LinkAffiliate().find(o=>o.landingPageId==t.id);return e?e?.landingPage?.slug+"/?ref="+e.codeId:null}CreateAffiliateLink(t){return u(this,null,function*(){this.Profile.id;let e={landingPageId:t.id,createdById:this.Profile.id};yield this._AffiliatelinkService.CreateAffiliatelink(e),yield this._AffiliatelinkService.getAffiliateListBy({createdById:this.Profile.id}),console.log(this._AffiliatelinkService.ListAffiliatelink())})}CopyLinkAffiliate(t){let i=`${window.location.origin}/landingpage/${this.getAffiliateLink(t)}`;this._clipboard.copy(i),this._MatSnackBar.open("\u0110\xE3 copy li\xEAn k\u1EBFt","\u0110\xF3ng",{duration:2e3,panelClass:["snackbar-success"]})}SharedAffiliate(t){window.open(`/landingpage/${this.getAffiliateLink(t)}`,"_blank")}applyFilter(t){let e=t.target.value.toLowerCase();e===""?this._LandingpageService.getAllLandingpage():this._LandingpageService.ListLandingpage.update(i=>i.filter(o=>W(o?.title||"").toLowerCase().includes(e)||(o?.title||"").toLowerCase().includes(e)))}ClearCache(){return u(this,null,function*(){let t=localStorage.getItem("token"),e=localStorage.getItem("permissions");localStorage.clear(),t&&localStorage.setItem("token",t),e&&localStorage.setItem("permissions",e),yield this._ErrorLogService.ClearRedisCache(),this._snackBar.open("Xo\xE1 Cache Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-landingpage"]],decls:16,vars:2,consts:[[1,"container","grid","lg:grid-cols-3","gap-4","m-auto","lg:p-8","p-2"],[1,"lg:col-span-3","flex","items-center","space-x-2"],["mat-icon-button","","color","primary",3,"routerLink"],[1,"relative"],[1,"absolute","text-blue-600","inset-y-0","start-0","flex","items-center","ps-3","pointer-events-none"],["type","text","placeholder","Vui l\xF2ng T\xECm Ki\u1EBFm",1,"w-full","max-w-2xl","border","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","ps-10","p-2.5",3,"keyup"],["mat-icon-button","","color","primary",3,"click"],["class","relative rounded-lg p-3 flex flex-col space-y-2 border",4,"ngFor","ngForOf"],[1,"relative","rounded-lg","p-3","flex","flex-col","space-y-2","border"],[1,"relative","font-bold","text-center"],[1,"relative","h-full","flex","flex-col","space-y-2","overflow-auto"],["alt","Thumbnail",1,"w-full","h-auto","rounded-md",3,"src"],[1,"line-clamp-3"],["mat-flat-button","","color","primary",3,"click",4,"ngIf"],["class","flex flex-row space-x-2 items-center",4,"ngIf"],["mat-flat-button","","color","primary",3,"click"],[1,"flex","flex-row","space-x-2","items-center"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","Vui l\xF2ng Nh\u1EADp Li\xEAn K\u1EBFt",3,"disabled","ngModel"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"button",2)(3,"mat-icon"),s(4,"arrow_back"),r()(),a(5,"div",3)(6,"div",4)(7,"mat-icon"),s(8,"search"),r()(),a(9,"input",5),f("keyup",function(d){return i.applyFilter(d)}),r()(),a(10,"button",6),f("click",function(){return i.ClearCache()}),a(11,"mat-icon"),s(12,"refresh"),r()()(),v(13,ce,1,1),I(14,13,ne),w(),r()),e&2&&(p(2),m("routerLink",E(1,oe)))},dependencies:[O,q,V,x,R,L,Q,G,P],encapsulation:2})};export{te as LandingpageComponent};
