import{a as l}from"./chunk-H7UDLENL.js";import{a as b}from"./chunk-RQQ6YENK.js";import{a as d,d as m}from"./chunk-3QZHTKAG.js";import{ja as h,pa as g,u as n}from"./chunk-WYL4U5YK.js";import{a as p,b as u,j as i}from"./chunk-6DYNGEAS.js";var I=class o{http=g(m);storageService=g(b);baseUrl=l.APIURL;getHeaders(){return new d({"Content-Type":"application/json",Authorization:"Bearer "+this.storageService.getItem("token")})}getCurrentUserId(){try{let e=this.storageService.getItem("user");return e&&JSON.parse(e)?.id||null}catch(e){return console.warn("Failed to get current user ID:",e),null}}getPriceHistory(e,r){return i(this,null,function*(){try{let t=`${this.baseUrl}/banggia/${e}/sanpham/${r}/price-history`;return yield n(this.http.get(t,{headers:this.getHeaders()}))}catch(t){throw console.error("Error fetching price history:",t),t}})}getCurrentPrice(e,r){return i(this,null,function*(){try{let t=`${this.baseUrl}/banggia/${e}/sanpham/${r}/current-price`;return yield n(this.http.get(t,{headers:this.getHeaders()}))}catch(t){throw console.error("Error fetching current price:",t),t}})}updateSinglePrice(e,r,t,s,c){return i(this,null,function*(){try{let a=`${this.baseUrl}/banggia/bulk-update-prices`,y=c||this.getCurrentUserId()||"system";return yield n(this.http.post(a,{updates:[{banggiaId:e,sanphamId:r,newPrice:t,reason:s||"C\u1EADp nh\u1EADt gi\xE1 t\u1EEB b\u1EA3ng gi\xE1"}],userId:y},{headers:this.getHeaders()}))}catch(a){throw console.error("Error updating single price:",a),a}})}bulkUpdatePrices(e){return i(this,null,function*(){try{let r=e.userId||this.getCurrentUserId()||"system",t=`${this.baseUrl}/banggia/bulk-update-prices`;return yield n(this.http.post(t,u(p({},e),{userId:r}),{headers:this.getHeaders()}))}catch(r){throw console.error("Error bulk updating prices:",r),r}})}verifyOrderPrices(e){return i(this,null,function*(){try{let r=`${this.baseUrl}/donhang/verify-prices/${e}`;return yield n(this.http.get(r,{headers:this.getHeaders()}))}catch(r){throw console.error("Error verifying order prices:",r),r}})}getPriceAtDate(e,r,t){return i(this,null,function*(){try{let s=t.toISOString(),c=`${this.baseUrl}/donhang/price-at-date?banggiaId=${e}&sanphamId=${r}&date=${s}`;return yield n(this.http.get(c,{headers:this.getHeaders()}))}catch(s){throw console.error("Error fetching price at date:",s),s}})}static \u0275fac=function(r){return new(r||o)};static \u0275prov=h({token:o,factory:o.\u0275fac,providedIn:"root"})};export{I as a};
