import{a as n}from"./chunk-Q7E7WSHM.js";import{b as d}from"./chunk-ZKZQQDX4.js";import{c as p}from"./chunk-VF6Z3BLE.js";import{Ra as i,ja as h,oa as g}from"./chunk-TAKLKH4V.js";import{j as e}from"./chunk-WJTR2IJE.js";var l=class c{constructor(o,t){this._StorageService=o;this.router=t}ListBanggia=i([]);DetailBanggia=i({});banggiaId=i(null);setBanggiaId(o){this.banggiaId.set(o)}importBGKH(o){return e(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},r=yield fetch(`${n.APIURL}/banggia/importbgkh`,t);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);let a=yield r.json();r.ok||this.handleError(r.status),this.getAllBanggia()}catch(t){return console.error(t)}})}importSPBG(o){return e(this,null,function*(){try{let r=[];for(let a=0;a<o.length;a+=10)r.push(o.slice(a,a+10));for(let a of r){let y={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},s=yield fetch(`${n.APIURL}/banggia/importspbg`,y);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);let f=yield s.json();s.ok||this.handleError(s.status)}this.getAllBanggia()}catch(t){return console.error(t)}})}ImportBanggia(o){return e(this,null,function*(){console.log("bg",o);try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},r=yield fetch(`${n.APIURL}/banggia/import`,t);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);let a=yield r.json();r.ok||this.handleError(r.status),this.getAllBanggia()}catch(t){return console.error(t)}})}CreateBanggia(o){return e(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},r=yield fetch(`${n.APIURL}/banggia`,t);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);let a=yield r.json();r.ok||this.handleError(r.status),this.getAllBanggia(),this.banggiaId.set(a.id)}catch(t){return console.error(t)}})}getAllBanggia(){return e(this,null,function*(){try{let o={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},t=yield fetch(`${n.APIURL}/banggia`,o);t.ok||this.handleError(t.status);let r=yield t.json();return this.ListBanggia.set(r),r}catch(o){console.error(o)}})}getAllBGSP(){return e(this,null,function*(){try{let o={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},t=yield fetch(`${n.APIURL}/banggia/getbgsp`,o);return t.ok||this.handleError(t.status),yield t.json()}catch(o){console.error(o)}})}getAllBGKH(){return e(this,null,function*(){try{let o={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},t=yield fetch(`${n.APIURL}/banggia/getbgkh`,o);return t.ok||this.handleError(t.status),yield t.json()}catch(o){console.error(o)}})}handleError(o){let t="L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh";switch(o){case 401:t="Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i";break;case 403:t="B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp";break;case 500:t="L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau";break}let r=JSON.stringify({code:o,title:t});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}getBanggiaByid(o){return e(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},r=yield fetch(`${n.APIURL}/banggia/findid/${o}`,t);r.ok||this.handleError(r.status);let a=yield r.json();this.DetailBanggia.set(a)}catch(t){return console.error(t)}})}updateBanggia(o){return e(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},r=yield fetch(`${n.APIURL}/banggia/${o.id}`,t);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);let a=yield r.json();r.ok||this.handleError(r.status),this.getAllBanggia(),this.getBanggiaByid(o.id)}catch(t){return console.error(t)}})}DeleteBanggia(o){return e(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json"}},r=yield fetch(`${n.APIURL}/banggia/${o.id}`,t);r.ok||this.handleError(r.status),this.getAllBanggia()}catch(t){return console.error(t)}})}addKHtoBG(o){return e(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},r=yield fetch(`${n.APIURL}/banggia/addKHtoBG`,t);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);let a=yield r.json();r.ok,this.getBanggiaByid(o.banggiaId)}catch(t){return console.error(t)}})}removeKHfromBG(o){return e(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},r=yield fetch(`${n.APIURL}/banggia/removeKHfromBG`,t);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);let a=yield r.json();r.ok,this.getBanggiaByid(o.banggiaId)}catch(t){return console.error(t)}})}static \u0275fac=function(t){return new(t||c)(g(d),g(p))};static \u0275prov=h({token:c,factory:c.\u0275fac,providedIn:"root"})};export{l as a};
