import{a as c}from"./chunk-H7UDLENL.js";import{a as m}from"./chunk-5KB5OT22.js";import{a as p}from"./chunk-4YBUVQ6H.js";import{a as l,d as u}from"./chunk-E2JMEUOP.js";import{Ra as s,ja as g,pa as h,u as r}from"./chunk-ZVDIRTLG.js";import{j as a}from"./chunk-6DYNGEAS.js";var v=class o{http=h(u);storageService=h(m);snackBar=h(p);apiUrl=`${c.APIURL}/nhanvien`;ListNhanvien=s([]);DetailNhanvien=s(null);Statistics=s(null);total=s(0);page=s(1);limit=s(50);loading=s(!1);error=s(null);getHeaders(){let t=this.storageService.getItem("token");return new l({"Content-Type":"application/json",Authorization:`Bearer ${t}`})}getAllNhanvien(t){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let n=this.apiUrl,i=[];t?.phongbanId&&i.push(`phongbanId=${t.phongbanId}`),t?.trangThai&&i.push(`trangThai=${t.trangThai}`),t?.chucVu&&i.push(`chucVu=${t.chucVu}`),t?.search&&i.push(`search=${encodeURIComponent(t.search)}`),t?.page&&(i.push(`page=${t.page}`),this.page.set(t.page)),t?.limit&&(i.push(`limit=${t.limit}`),this.limit.set(t.limit)),i.length>0&&(n+="?"+i.join("&"));let e=yield r(this.http.get(n,{headers:this.getHeaders()}));return this.ListNhanvien.set(e.data),this.total.set(e.total),this.page.set(e.page),this.limit.set(e.limit),e}catch(n){throw this.error.set(n.message||"L\u1ED7i khi t\u1EA3i danh s\xE1ch nh\xE2n vi\xEAn"),this.snackBar.open("L\u1ED7i khi t\u1EA3i danh s\xE1ch nh\xE2n vi\xEAn","\u0110\xF3ng",{duration:3e3}),n}finally{this.loading.set(!1)}})}getStatistics(){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=yield r(this.http.get(`${this.apiUrl}/statistics`,{headers:this.getHeaders()}));return this.Statistics.set(t),t}catch(t){throw this.error.set(t.message||"L\u1ED7i khi t\u1EA3i th\u1ED1ng k\xEA"),this.snackBar.open("L\u1ED7i khi t\u1EA3i th\u1ED1ng k\xEA","\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}getNhanvienById(t){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let n=yield r(this.http.get(`${this.apiUrl}/${t}`,{headers:this.getHeaders()}));return this.DetailNhanvien.set(n),n}catch(n){throw this.error.set(n.message||"L\u1ED7i khi t\u1EA3i chi ti\u1EBFt nh\xE2n vi\xEAn"),this.snackBar.open("L\u1ED7i khi t\u1EA3i chi ti\u1EBFt nh\xE2n vi\xEAn","\u0110\xF3ng",{duration:3e3}),n}finally{this.loading.set(!1)}})}getNhanvienByMaNV(t){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let n=yield r(this.http.get(`${this.apiUrl}/ma/${t}`,{headers:this.getHeaders()}));return this.DetailNhanvien.set(n),n}catch(n){throw this.error.set(n.message||"L\u1ED7i khi t\u1EA3i nh\xE2n vi\xEAn"),this.snackBar.open("L\u1ED7i khi t\u1EA3i nh\xE2n vi\xEAn","\u0110\xF3ng",{duration:3e3}),n}finally{this.loading.set(!1)}})}createNhanvien(t){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let n=yield r(this.http.post(this.apiUrl,t,{headers:this.getHeaders()}));return this.snackBar.open("T\u1EA1o nh\xE2n vi\xEAn th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),yield this.getAllNhanvien({page:this.page(),limit:this.limit()}),n}catch(n){let i=n.error?.message||"L\u1ED7i khi t\u1EA1o nh\xE2n vi\xEAn";throw this.error.set(i),this.snackBar.open(i,"\u0110\xF3ng",{duration:3e3}),n}finally{this.loading.set(!1)}})}updateNhanvien(t,n){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let i=yield r(this.http.patch(`${this.apiUrl}/${t}`,n,{headers:this.getHeaders()}));return this.snackBar.open("C\u1EADp nh\u1EADt nh\xE2n vi\xEAn th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),yield this.getAllNhanvien({page:this.page(),limit:this.limit()}),i}catch(i){let e=i.error?.message||"L\u1ED7i khi c\u1EADp nh\u1EADt nh\xE2n vi\xEAn";throw this.error.set(e),this.snackBar.open(e,"\u0110\xF3ng",{duration:3e3}),i}finally{this.loading.set(!1)}})}deleteNhanvien(t){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let n=yield r(this.http.delete(`${this.apiUrl}/${t}`,{headers:this.getHeaders()}));return this.snackBar.open(n.message,"\u0110\xF3ng",{duration:3e3}),yield this.getAllNhanvien({page:this.page(),limit:this.limit()}),n}catch(n){let i=n.error?.message||"L\u1ED7i khi x\xF3a nh\xE2n vi\xEAn";throw this.error.set(i),this.snackBar.open(i,"\u0110\xF3ng",{duration:3e3}),n}finally{this.loading.set(!1)}})}linkToUser(t,n){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let i=yield r(this.http.post(`${this.apiUrl}/${t}/link-user`,{userId:n},{headers:this.getHeaders()}));return this.snackBar.open("Li\xEAn k\u1EBFt user th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),i}catch(i){let e=i.error?.message||"L\u1ED7i khi li\xEAn k\u1EBFt user";throw this.error.set(e),this.snackBar.open(e,"\u0110\xF3ng",{duration:3e3}),i}finally{this.loading.set(!1)}})}unlinkFromUser(t){return a(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let n=yield r(this.http.post(`${this.apiUrl}/${t}/unlink-user`,{},{headers:this.getHeaders()}));return this.snackBar.open("G\u1EE1 li\xEAn k\u1EBFt user th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),n}catch(n){let i=n.error?.message||"L\u1ED7i khi g\u1EE1 li\xEAn k\u1EBFt user";throw this.error.set(i),this.snackBar.open(i,"\u0110\xF3ng",{duration:3e3}),n}finally{this.loading.set(!1)}})}clearError(){this.error.set(null)}reset(){this.ListNhanvien.set([]),this.DetailNhanvien.set(null),this.Statistics.set(null),this.total.set(0),this.page.set(1),this.limit.set(50),this.loading.set(!1),this.error.set(null)}static \u0275fac=function(n){return new(n||o)};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};var L={NAM:"Nam",NU:"N\u1EEF",KHAC:"Kh\xE1c"};var w={DANGLAMVIEC:"\u0110ang l\xE0m vi\u1EC7c",NGHIPHEP:"Ngh\u1EC9 ph\xE9p",THUVIEC:"Th\u1EED vi\u1EC7c",DANGHIVIEC:"\u0110\xE3 ngh\u1EC9 vi\u1EC7c",TAMNGHI:"T\u1EA1m ngh\u1EC9",KHAC:"Kh\xE1c"};export{v as a,L as b,w as c};
