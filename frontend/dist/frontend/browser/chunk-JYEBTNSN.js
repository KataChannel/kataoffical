import{a as ua}from"./chunk-2NMEO3L3.js";import{a as ya,b as ba}from"./chunk-3Q66WHFX.js";import{a as fa}from"./chunk-TODKLCPX.js";import{a as ma}from"./chunk-IN7NPWNV.js";import{a as ha}from"./chunk-FV66D3ZF.js";import{a as ga}from"./chunk-O3OIKMNU.js";import{a as pa}from"./chunk-IEU6QYBN.js";import{a as da}from"./chunk-YDSGTERB.js";import{a as ca}from"./chunk-3Q6W5HH6.js";import{a as sa}from"./chunk-AB6HUXVO.js";import{a as la}from"./chunk-72A542WQ.js";import{a as Lt}from"./chunk-XMLZ6PTG.js";import{a as Ht,b as Gt,c as Yt,e as jt}from"./chunk-3UWFLLHB.js";import{a as Vt}from"./chunk-7LJKCYV5.js";import{a as Bt,b as Tt,c as Nt,h as ot}from"./chunk-4J6ZCWCD.js";import{a as F}from"./chunk-ZW44ZSN2.js";import{c as xt}from"./chunk-NQPXZ54S.js";import{d as Pt}from"./chunk-GERF6NZF.js";import{a as N}from"./chunk-H7UDLENL.js";import{a as tt,b as It}from"./chunk-QBYLGOXD.js";import{b as Ut,i as Wt,j as O}from"./chunk-35TLWMLN.js";import{a as ra,b as oa}from"./chunk-66AZYQUV.js";import{c as Qt,d as Xt,e as Jt,f as Zt,g as ta,h as aa,i as ea,j as ia,k as na}from"./chunk-PRZ4FM5C.js";import{b as Ot,r as qt}from"./chunk-54QBGQYY.js";import{b as Rt}from"./chunk-VD2IRGKJ.js";import{b as Mt,g as it,j as nt,n as rt,p as Ft,s as Kt,v as At,w as $t,z as zt}from"./chunk-VL6RTEXJ.js";import{a as Ia}from"./chunk-JNVUT6FC.js";import{a as at,b as et}from"./chunk-4RT4GPGM.js";import{a as J,e as Z}from"./chunk-6AENWPSP.js";import{_ as Dt}from"./chunk-M6F4RUXJ.js";import{c as wt}from"./chunk-WTFSQ7RX.js";import{l as W,m as Q,r as Ct,v as X}from"./chunk-7VKL64EC.js";import{Cc as $,Db as G,Dc as p,Ec as T,Fc as M,Gc as _t,Ic as z,Jc as R,Kb as w,Kc as V,Mc as U,Ra as D,Sc as gt,Ub as g,Uc as dt,Yb as St,Yc as ut,Zb as vt,ec as h,fc as c,gc as B,hc as mt,ic as pt,ja as H,kc as A,md as Et,oa as K,pa as C,pc as S,rb as m,rc as L,wb as ht,xc as Y,ya as f,yc as j,za as y,zc as q}from"./chunk-7UNLK7KO.js";import{a as d,b as v,g as Da,j as k}from"./chunk-6DYNGEAS.js";var st=class s{constructor(i,t,a,e){this._StorageService=i;this.router=t;this._ErrorLogService=a;this._sharedSocketService=e;this.socket=this._sharedSocketService.getSocket(),this.listenImportdataUpdates()}socket;_snackBar=C(tt);ListImportdata=D([]);DetailImportdata=D({});page=D(1);pageCount=D(1);total=D(0);pageSize=D(9999);importdataId=D(null);setImportdataId(i){this.importdataId.set(i)}CreateImportdata(i){return k(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(i)},a=yield fetch(`${N.APIURL}/importdata`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let e=yield a.json();this.getAllImportdata(this.pageSize()),this.importdataId.set(e.id)}catch(t){this._ErrorLogService.logError("Failed to CreateImportdata",t),console.error(t)}})}getAllImportdata(){return k(this,arguments,function*(i=this.pageSize(),t=!1){this.pageSize.set(i);try{let a={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},e=new URLSearchParams({page:this.page().toString(),limit:i.toString()}),n=yield fetch(`${N.APIURL}/importdata?${e}`,a);n.ok||this.handleError(n.status);let o=yield n.json();return this.ListImportdata.set(o.data),this.page.set(o.page||1),this.pageCount.set(o.pageCount||1),this.total.set(o.total||o.data.length),this.pageSize.set(i),o.data}catch(a){console.error(a)}})}getUpdatedCodeIds(){return k(this,null,function*(){try{let i={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},t=yield fetch(`${N.APIURL}/importdata/updateCodeIds`,i);t.ok||this.handleError(t.status);let a=yield t.json();return this.getAllImportdata(this.pageSize()),a.data}catch(i){this._ErrorLogService.logError("Failed to getUpdatedCodeIds",i),console.error(i)}})}listenImportdataUpdates(){this.socket.off("importdata-updated"),this.socket.on("importdata-updated",()=>k(this,null,function*(){console.log("\u{1F504} D\u1EEF li\u1EC7u s\u1EA3n ph\u1EA9m thay \u0111\u1ED5i, c\u1EADp nh\u1EADt l\u1EA1i cache..."),this._StorageService.removeItem("importdatas_updatedAt"),yield this.getAllImportdata()}))}getImportdataBy(a){return k(this,arguments,function*(i,t=this.pageSize()){this.pageSize.set(t);try{let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(v(d({},i),{page:this.page(),limit:t}))},n=yield fetch(`${N.APIURL}/importdata/findby`,e);n.ok||this.handleError(n.status);let o=yield n.json();i.isOne===!0?this.DetailImportdata.set(o):(this._StorageService.setItem("importdatas_updatedAt",new Date().toISOString()),this.ListImportdata.set(o.data),this.page.set(o.page||1),this.pageCount.set(o.pageCount||1),this.total.set(o.total||o.data.length),this.pageSize.set(t))}catch(e){console.error(e)}})}updateImportdata(i){return k(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(i)},a=yield fetch(`${N.APIURL}/importdata/${i.id}`,t);a.ok||this.handleError(a.status);let e=yield a.json();this.getAllImportdata(this.pageSize()),this.getImportdataBy({id:e.id,isOne:!0},this.pageSize())}catch(t){this._ErrorLogService.logError("Failed to updateImportdata",t),console.error(t)}})}DeleteImportdata(i){return k(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},a=yield fetch(`${N.APIURL}/importdata/${i.id}`,t);a.ok||this.handleError(a.status),this.getAllImportdata(this.pageSize())}catch(t){this._ErrorLogService.logError("Failed to DeleteImportdata",t),console.error(t)}})}handleError(i){let t="L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh";switch(i){case 400:t="Th\xF4ng tin \u0111\xE3 t\u1ED3n t\u1EA1i";break;case 401:case 404:t="Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i";break;case 403:t="B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp";break;case 500:t="L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau";break}this._snackBar.open(t,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}static \u0275fac=function(t){return new(t||s)(K(It),K(wt),K(Vt),K(sa))};static \u0275prov=H({token:s,factory:s.\u0275fac,providedIn:"root"})};var E=Da(Ia());function Ta(s,i){if(s&1&&(h(0,"li"),p(1),c()),s&2){let t=i.$implicit,a=L(2);m(),M(" ",a.getItemDisplayName(t)," ")}}function Na(s,i){if(s&1&&(h(0,"li",17),p(1),c()),s&2){let t=L(2);m(),M(" ... v\xE0 ",t.data.duplicateItems.length-5," m\u1EE5c kh\xE1c ")}}function Fa(s,i){if(s&1&&(h(0,"div",11)(1,"p",12)(2,"mat-icon",13),p(3,"error"),c(),p(4),c(),h(5,"ul",14),w(6,Ta,2,1,"li",15)(7,Na,2,1,"li",16),c()()),s&2){let t=L();m(4),M(" Ph\xE1t hi\u1EC7n ",t.data.duplicateItems.length," m\u1EE5c tr\xF9ng l\u1EB7p: "),m(2),g("ngForOf",t.data.duplicateItems.slice(0,5)),m(),g("ngIf",t.data.duplicateItems.length>5)}}function Ka(s,i){s&1&&(h(0,"div",23),p(1," \u26A0\uFE0F D\u1EEF li\u1EC7u c\u0169 s\u1EBD b\u1ECB thay th\u1EBF b\u1EDFi d\u1EEF li\u1EC7u m\u1EDBi "),c())}function Aa(s,i){s&1&&(h(0,"div",17),p(1," \u2139\uFE0F Ch\u1EC9 th\xEAm m\u1EDBi c\xE1c m\u1EE5c ch\u01B0a t\u1ED3n t\u1EA1i, b\u1ECF qua c\xE1c m\u1EE5c tr\xF9ng l\u1EB7p "),c())}function $a(s,i){if(s&1){let t=A();h(0,"div",18)(1,"mat-checkbox",19),V("ngModelChange",function(e){f(t);let n=L();return R(n.data.isOverwrite,e)||(n.data.isOverwrite=e),y(e)}),h(2,"span",20),p(3,"Ghi \u0111\xE8 l\xEAn d\u1EEF li\u1EC7u c\u0169 (c\xE1c m\u1EE5c tr\xF9ng l\u1EB7p s\u1EBD \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt)"),c()(),h(4,"div",21),w(5,Ka,2,0,"div",22)(6,Aa,2,0,"div",16),c()()}if(s&2){let t=L();m(),z("ngModel",t.data.isOverwrite),m(4),g("ngIf",t.data.isOverwrite),m(),g("ngIf",!t.data.isOverwrite)}}function za(s,i){s&1&&(h(0,"div",24)(1,"div",25)(2,"mat-icon",26),p(3,"check_circle"),c(),h(4,"span"),p(5,"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u tr\xF9ng l\u1EB7p. T\u1EA5t c\u1EA3 s\u1EBD \u0111\u01B0\u1EE3c th\xEAm m\u1EDBi."),c()()())}var lt=class s{constructor(i,t){this.dialogRef=i;this.data=t}getItemDisplayName(i){switch(this.data.dataType){case"S\u1EA3n Ph\u1EA9m":return`${i.masp} - ${i.title}`;case"Kh\xE1ch H\xE0ng":return`${i.makh} - ${i.name}`;case"Nh\xE0 Cung C\u1EA5p":return`${i.mancc} - ${i.name}`;case"B\u1EA3ng Gi\xE1":return`${i.mabanggia} - ${i.title}`;default:return i.name||i.title||i.id||"N/A"}}onConfirm(){this.dialogRef.close({confirmed:!0,overwrite:this.data.isOverwrite})}onCancel(){this.dialogRef.close({confirmed:!1,overwrite:!1})}static \u0275fac=function(t){return new(t||s)(ht(Bt),ht(Tt))};static \u0275cmp=G({type:s,selectors:[["app-import-confirmation-dialog"]],decls:31,vars:7,consts:[[1,"p-6","min-w-96"],[1,"flex","items-center","mb-4"],[1,"text-orange-500","mr-2"],[1,"text-lg","font-semibold"],[1,"mb-4","text-gray-700"],["class","mt-3",4,"ngIf"],["class","mb-6",4,"ngIf"],["class","mb-4 p-3 bg-green-50 border border-green-200 rounded",4,"ngIf"],[1,"flex","justify-end","space-x-3","mt-6"],["mat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"mt-3"],[1,"text-red-600","font-medium"],[1,"text-red-500","text-sm"],[1,"list-disc","list-inside","text-sm","text-gray-600","mt-2","max-h-32","overflow-y-auto"],[4,"ngFor","ngForOf"],["class","text-blue-600",4,"ngIf"],[1,"text-blue-600"],[1,"mb-6"],[1,"text-sm",3,"ngModelChange","ngModel"],[1,"ml-2"],[1,"mt-2","text-sm","text-gray-600"],["class","text-orange-600",4,"ngIf"],[1,"text-orange-600"],[1,"mb-4","p-3","bg-green-50","border","border-green-200","rounded"],[1,"flex","items-center","text-green-700"],[1,"text-green-500","mr-2"]],template:function(t,a){t&1&&(h(0,"div",0)(1,"div",1)(2,"mat-icon",2),p(3,"warning"),c(),h(4,"h2",3),p(5,"X\xE1c nh\u1EADn Import D\u1EEF li\u1EC7u"),c()(),h(6,"div",4)(7,"p")(8,"strong"),p(9,"Lo\u1EA1i d\u1EEF li\u1EC7u:"),c(),p(10),c(),h(11,"p")(12,"strong"),p(13,"D\u1EEF li\u1EC7u hi\u1EC7n t\u1EA1i:"),c(),p(14),c(),h(15,"p")(16,"strong"),p(17,"D\u1EEF li\u1EC7u m\u1EDBi:"),c(),p(18),c(),w(19,Fa,8,3,"div",5),c(),w(20,$a,7,3,"div",6)(21,za,6,0,"div",7),h(22,"div",8)(23,"button",9),S("click",function(){return a.onCancel()}),h(24,"mat-icon"),p(25,"cancel"),c(),p(26," H\u1EE7y b\u1ECF "),c(),h(27,"button",10),S("click",function(){return a.onConfirm()}),h(28,"mat-icon"),p(29,"file_upload"),c(),p(30),c()()()),t&2&&(m(10),M(" ",a.data.dataType,""),m(4),M(" ",a.data.existingCount," m\u1EE5c"),m(4),M(" ",a.data.newCount," m\u1EE5c"),m(),g("ngIf",a.data.duplicateItems.length>0),m(),g("ngIf",a.data.duplicateItems.length>0),m(),g("ngIf",a.data.duplicateItems.length===0),m(9),M(" ",a.data.duplicateItems.length>0?a.data.isOverwrite?"Import & Ghi \u0111\xE8":"Import & B\u1ECF qua tr\xF9ng l\u1EB7p":"Import"," "))},dependencies:[ot,Z,J,et,at,X,W,Q,ba,ya,rt,it,nt],encapsulation:2})};var b=class s{static checkDuplicates(i,t,a){let e=new Set(t.map(n=>n[a]));return i.filter(n=>e.has(n[a]))}static prepareSanphamData(i,t,a){if(a)return i;{let e=new Set(t.map(n=>n.masp));return i.filter(n=>!e.has(n.masp))}}static prepareKhachhangData(i,t,a){if(a)return i;{let e=new Set(t.map(n=>n.makh));return i.filter(n=>!e.has(n.makh))}}static prepareNhacungcapData(i,t,a){if(a)return i;{let e=new Set(t.map(n=>n.mancc));return i.filter(n=>!e.has(n.mancc))}}static prepareBanggiaData(i,t,a){if(a)return i;{let e=new Set(t.map(n=>n.mabanggia));return i.filter(n=>!e.has(n.mabanggia))}}static prepareKhoData(i,t,a){if(a)return i;{let e=new Set(t.map(n=>n.makho));return i.filter(n=>!e.has(n.makho))}}static prepareGenericData(i,t,a,e){if(e)return i;{let n=new Set(t.map(o=>o[a]));return i.filter(o=>!n.has(o[a]))}}static validateRequiredFields(i,t){let a=[],e=[];return i.forEach(n=>{let o=t.filter(l=>n[l]===void 0||n[l]===null||n[l]==="");o.length===0?a.push(n):e.push(v(d({},n),{_validationErrors:o.map(l=>`Missing required field: ${l}`)}))}),{valid:a,invalid:e}}static validateDataFormat(i,t){switch(t){case"sanpham":return this.validateSanphamFormat(i);case"khachhang":return this.validateKhachhangFormat(i);case"nhacungcap":return this.validateNhacungcapFormat(i);case"banggia":return this.validateBanggiaFormat(i);case"kho":return this.validateKhoFormat(i);default:return{valid:i,invalid:[]}}}static validateSanphamFormat(i){let t=[],a=[];return i.forEach(e=>{let n=[];(!e.masp||typeof e.masp!="string")&&n.push("Invalid product code (masp)"),e.giaban&&isNaN(Number(e.giaban))&&n.push("Invalid selling price (giaban)"),e.giagoc&&isNaN(Number(e.giagoc))&&n.push("Invalid cost price (giagoc)"),n.length===0?t.push(e):a.push(v(d({},e),{_validationErrors:n}))}),{valid:t,invalid:a}}static validateKhachhangFormat(i){let t=[],a=[];return i.forEach(e=>{let n=[];(!e.makh||typeof e.makh!="string")&&n.push("Invalid customer code (makh)"),(!e.name||typeof e.name!="string")&&n.push("Invalid customer name"),e.email&&!this.isValidEmail(e.email)&&n.push("Invalid email format"),n.length===0?t.push(e):a.push(v(d({},e),{_validationErrors:n}))}),{valid:t,invalid:a}}static validateNhacungcapFormat(i){let t=[],a=[];return i.forEach(e=>{let n=[];(!e.mancc||typeof e.mancc!="string")&&n.push("Invalid supplier code (mancc)"),(!e.name||typeof e.name!="string")&&n.push("Invalid supplier name"),n.length===0?t.push(e):a.push(v(d({},e),{_validationErrors:n}))}),{valid:t,invalid:a}}static validateBanggiaFormat(i){let t=[],a=[];return i.forEach(e=>{let n=[];(!e.mabanggia||typeof e.mabanggia!="string")&&n.push("Invalid price list code (mabanggia)"),n.length===0?t.push(e):a.push(v(d({},e),{_validationErrors:n}))}),{valid:t,invalid:a}}static validateKhoFormat(i){let t=[],a=[];return i.forEach(e=>{let n=[];(!e.makho||typeof e.makho!="string")&&n.push("Invalid warehouse code (makho)"),(!e.tenkho||typeof e.tenkho!="string")&&n.push("Invalid warehouse name (tenkho)"),n.length===0?t.push(e):a.push(v(d({},e),{_validationErrors:n}))}),{valid:t,invalid:a}}static isValidEmail(i){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)}static getValidationSummary(i,t,a,e){return`
      T\u1ED5ng s\u1ED1 d\xF2ng: ${i}
      D\u1EEF li\u1EC7u h\u1EE3p l\u1EC7: ${t}
      D\u1EEF li\u1EC7u kh\xF4ng h\u1EE3p l\u1EC7: ${a}
      D\u1EEF li\u1EC7u tr\xF9ng l\u1EB7p: ${e}
    `}static transformDataForImport(i,t){switch(t){case"sanpham":return this.transformSanphamData(i);case"khachhang":return this.transformKhachhangData(i);case"nhacungcap":return this.transformNhacungcapData(i);case"banggia":return this.transformBanggiaData(i);case"kho":return this.transformKhoData(i);default:return i}}static transformSanphamData(i){return i.map(t=>v(d({},t),{masp:t.masp?.toString().trim()||"",subtitle:F((t.title||"")+(t.title2||"")),title:t.title?.toString().trim()||"",title2:t.title2?.toString().trim()||"",giaban:Number(t.giaban)||Number(t.giagoc)||0,giagoc:Number(t.giagoc)||0,vat:Number(t.vat)||0,dvt:t.dvt?.toString().trim()||"",haohut:Number(t.haohut)||0,loadpoint:Number(t.loadpoint)||0,ghichu:t.ghichu?.toString().trim()||""}))}static transformKhachhangData(i){return i.map(t=>v(d({},t),{makh:t.makh?.toString().trim()||"",name:t.name?.toString().trim()||"",tenfile:F(t.tenfile?.toString()||t.name?.toString()||""),subtitle:F((t.name?.toString()||"")+(t.namenn?.toString()||"")),namenn:t.namenn?.toString().trim()||"",diachi:t.diachi?.toString().trim()||"",quan:t.quan?.toString().trim()||"",email:t.email?.toString().trim()||"",sdt:t.sdt?.toString().trim()||"",mst:t.mst?.toString().trim()||"",gionhanhang:t.gionhanhang?.toString().trim()||"",loaikh:t.loaikh?.toString().trim()||"khachsi",hiengia:t.hiengia,isshowvat:t.ishowvat,ghichu:t.ghichu?.toString().trim()||"",mabanggia:t.mabanggia?.toString().trim()||""}))}static transformNhacungcapData(i){return i.map(t=>v(d({},t),{mancc:t.mancc?.toString().trim()||"",name:t.name?.toString().trim()||"",tenfile:F(t.tenfile?.toString()||t.name?.toString()||""),diachi:t.diachi?.toString().trim()||"",email:t.email?.toString().trim()||"",sdt:t.sdt?.toString().trim()||"",ghichu:t.ghichu?.toString().trim()||""}))}static transformBanggiaData(i){return i.map(t=>v(d({},t),{mabanggia:t.mabanggia?.toString().trim()||"",title:t.title?.toString().trim()||"",type:t.type?.toString().trim()||"",ghichu:t.ghichu?.toString().trim()||"",status:t.status?.toString().trim()||"active"}))}static transformKhoData(i){return i.map(t=>v(d({},t),{makho:t.makho?.toString().trim()||"",tenkho:t.tenkho?.toString().trim()||"",diachi:t.diachi?.toString().trim()||"",ghichu:t.ghichu?.toString().trim()||"",status:t.status?.toString().trim()||"active"}))}static filterValidData(i,t){return i.filter(a=>t.every(e=>a[e]!==void 0&&a[e]!==null&&a[e]!==""))}static getRequiredFields(i){switch(i){case"sanpham":return["masp","title"];case"khachhang":return["makh","name"];case"nhacungcap":return["mancc","name"];case"banggia":return["mabanggia","title"];case"kho":return["makho","tenkho"];default:return[]}}static getUniqueField(i){switch(i){case"sanpham":return"masp";case"khachhang":return"makh";case"nhacungcap":return"mancc";case"banggia":return"mabanggia";case"kho":return"makho";default:return"id"}}static \u0275fac=function(t){return new(t||s)};static \u0275prov=H({token:s,factory:s.\u0275fac,providedIn:"root"})};var Ra=["drawer"],ka=()=>({standalone:!0}),Va=()=>[1,2,3,4,5];function Oa(s,i){if(s&1&&(h(0,"div",42)(1,"div",43),B(2,"mat-progress-spinner",44),h(3,"span",45),p(4),c()()()),s&2){let t=L();m(4),T(t.loadingMessage())}}function Ha(s,i){s&1&&(h(0,"span"),p(1,"T\u1EA3i Xu\u1ED1ng"),c())}function Ga(s,i){s&1&&(h(0,"span",46),B(1,"mat-progress-spinner",47),p(2," \u0110ang xu\u1EA5t... "),c())}function Ya(s,i){s&1&&(h(0,"mat-icon",48),p(1,"download"),c())}function ja(s,i){s&1&&(h(0,"span"),p(1,"T\u1EA3i L\xEAn"),c())}function qa(s,i){s&1&&(h(0,"span",46),B(1,"mat-progress-spinner",47),p(2," \u0110ang nh\u1EADp... "),c())}function Ua(s,i){s&1&&(h(0,"mat-icon",48),p(1,"upload"),c())}function Wa(s,i){if(s&1&&(h(0,"div",49)(1,"div",23),B(2,"mat-progress-spinner",50),h(3,"span",51),p(4),c()()()),s&2){let t=L();m(4),T(t.loadingMessage())}}function Qa(s,i){s&1&&(h(0,"mat-icon"),p(1,"check"),c())}function Xa(s,i){if(s&1){let t=A();h(0,"span",52),S("click",function(){let e=f(t).$implicit,n=L();return y(!n.isLoading()&&!n.isImporting()&&!n.isExporting()&&e.status&&n.toggleItem(e))}),w(1,Qa,2,0,"mat-icon",29),h(2,"span"),p(3),c()()}if(s&2){let t=i.$implicit,a=L();vt("",t.status?"":"hidden",` 
                   `,a.CheckItem(t)?"bg-blue-100":"",` 
                   `,a.isLoading()||a.isImporting()||a.isExporting()?"opacity-50 cursor-not-allowed":"cursor-pointer",` 
                   flex flex-row space-x-2 items-center p-4 rounded-lg border transition-all duration-200`),m(),g("ngIf",a.CheckItem(t)),m(2),T(t.title)}}function Ja(s,i){s&1&&(h(0,"div",55),B(1,"div",56)(2,"div",57)(3,"div",58),c())}function Za(s,i){s&1&&(mt(0),h(1,"div",53),w(2,Ja,4,0,"div",54),c(),pt()),s&2&&(m(2),g("ngForOf",U(1,Va)))}function te(s,i){if(s&1&&(h(0,"div")(1,"span",60),p(2),c(),h(3,"span"),p(4),c(),h(5,"span",61),p(6),c()()),s&2){let t=i.$implicit,a=L(3);St(`w-full flex flex-row space-x-2 items-center border p-4 rounded-lg
                    `,a.isImporting()||a.isExporting()?"opacity-50":"",""),m(2),T(t.type),m(2),T(t.title),m(2),T(t.description)}}function ae(s,i){if(s&1&&(mt(0),w(1,te,7,6,"div",59),pt()),s&2){let t=L(2);m(),g("ngForOf",t.ListImportdata())}}function ee(s,i){s&1&&(h(0,"div",62)(1,"span",63),p(2,"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),c()())}function ie(s,i){if(s&1&&w(0,ae,2,1,"ng-container",41)(1,ee,3,0,"ng-template",null,3,ut),s&2){let t=$(2),a=L();g("ngIf",a.ListImportdata().length>0)("ngIfElse",t)}}var Sa=class s{displayedColumns=[];ColumnName={stt:"#",codeId:"Code",name:"Ti\xEAu \u0110\u1EC1",group:"Nh\xF3m",description:"M\xF4 T\u1EA3",status:"Tr\u1EA1ng Th\xE1i",order:"Th\u1EE9 T\u1EF1",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("ImportdataColFilter")||"[]");Columns=[];paginator;sort;drawer;_BanggiaService=C(ca);_SanphamService=C(da);_KhachhangService=C(pa);_NhacungcapService=C(ga);_DonhangService=C(ma);_DathangService=C(ha);_PhieukhoService=C(ua);_UserService=C(Lt);_KhoService=C(fa);_ImportdataService=C(st);_GraphqlService=C(la);_dialog=C(Nt);_snackBar=C(tt);isLoading=D(!1);isImporting=D(!1);isExporting=D(!1);loadingMessage=D("");batdau=new Date;ketthuc=new Date;ListImportType=D([{id:1,title:"S\u1EA3n Ph\u1EA9m",value:"sanpham",status:!0},{id:2,title:"Kh\xE1ch H\xE0ng",value:"khachhang",status:!0},{id:3,title:"Nh\xE0 Cung C\u1EA5p",value:"nhacungcap",status:!0},{id:4,title:"B\u1EA3ng Gi\xE1",value:"banggia",status:!0},{id:5,title:"\u0110\u01A1n H\xE0ng",value:"donhang",status:!0},{id:6,title:"\u0110\u1EB7t H\xE0ng",value:"dathang",status:!0},{id:7,title:"B\u1EA3ng Gi\xE1 Kh\xE1ch H\xE0ng",value:"banggiakhachhang",status:!0},{id:8,title:"B\u1EA3ng Gi\xE1 S\u1EA3n Ph\u1EA9m",value:"banggiasanpham",status:!0},{id:9,title:"Nh\xE0 Cung C\u1EA5p S\u1EA3n Ph\u1EA9m",value:"nhacungcapsanpham",status:!0},{id:10,title:"Xu\u1EA5t Nh\u1EADp T\u1ED3n",value:"xuatnhapton",status:!0},{id:11,title:"Kho",value:"kho",status:!0}]);ListEdit=D([]);ListImportdata=this._ImportdataService.ListImportdata;TitleExport="export";rawListSP=[];rawListKH=[];rawListNCC=[];rawListBG=[];rawListDH=[];rawListDathang=[];rawListTonkho=[];rawListKho=[];constructor(){let i=new Date;this.ketthuc=new Date(i),this.batdau=new Date(i),Et(()=>k(this,null,function*(){this.isLoading.set(!0),this.loadingMessage.set("\u0110ang t\u1EA3i d\u1EEF li\u1EC7u...");try{yield this._ImportdataService.getAllImportdata(1e3,!0),yield this.loadDataWithDateRange(),this.loadingMessage.set("\u0110ang ki\u1EC3m tra quy\u1EC1n..."),yield this._UserService.getProfile();let t=this._UserService.profile()?.permissions?.map(a=>a.name)||[];this.ListImportType.update(a=>a.map(e=>v(d({},e),{status:t.includes("importdata."+e.value)})))}catch(t){console.error("Error loading data:",t),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi t\u1EA3i d\u1EEF li\u1EC7u","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.isLoading.set(!1),this.loadingMessage.set("")}}))}loadDataWithDateRange(){return k(this,null,function*(){try{let i={Batdau:this.batdau,Ketthuc:this.ketthuc,pageSize:9999};this.loadingMessage.set("\u0110ang t\u1EA3i danh s\xE1ch s\u1EA3n ph\u1EA9m..."),yield this._SanphamService.getSanphamBy({pageSize:99999}),this.rawListSP=this._SanphamService.ListSanpham(),this.loadingMessage.set("\u0110ang t\u1EA3i danh s\xE1ch kh\xE1ch h\xE0ng..."),yield this._KhachhangService.getKhachhangBy({pageSize:99999}),this.rawListKH=this._KhachhangService.ListKhachhang(),this.loadingMessage.set("\u0110ang t\u1EA3i danh s\xE1ch nh\xE0 cung c\u1EA5p...");let t=yield this._GraphqlService.findAll("nhacungcap",{take:99999,enableParallelFetch:!0,aggressiveCache:!0,select:{id:!0,name:!0,mancc:!0,Sanpham:{select:{masp:!0}}}});this.rawListNCC=t.data,this.loadingMessage.set("\u0110ang t\u1EA3i b\u1EA3ng gi\xE1..."),yield this._BanggiaService.getAllBanggia(),this.rawListBG=this._BanggiaService.ListBanggia(),this.loadingMessage.set("\u0110ang t\u1EA3i \u0111\u01A1n h\xE0ng..."),yield this._DonhangService.searchDonhang(i),this.rawListDH=this._DonhangService.ListDonhang(),this.loadingMessage.set("\u0110ang t\u1EA3i \u0111\u1EB7t h\xE0ng..."),yield this._DathangService.searchDathang(i),this.rawListDathang=this._DathangService.ListDathang(),this.loadingMessage.set("\u0110ang t\u1EA3i t\u1ED3n kho..."),yield this._KhoService.getTonKho("1","1000").then(a=>{this.rawListTonkho=a.data}),this.loadingMessage.set("\u0110ang t\u1EA3i danh s\xE1ch kho..."),yield this._KhoService.getAllKho(),this.rawListKho=this._KhoService.ListKho()}catch(i){throw console.error("Error loading data with date range:",i),i}})}onDateChange(){return k(this,null,function*(){if(!this.isLoading()){this.isLoading.set(!0),this.loadingMessage.set("\u0110ang c\u1EADp nh\u1EADt d\u1EEF li\u1EC7u theo ng\xE0y...");try{yield this.loadDataWithDateRange()}catch(i){console.error("Error updating data with new date range:",i),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi c\u1EADp nh\u1EADt d\u1EEF li\u1EC7u","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.isLoading.set(!1),this.loadingMessage.set("")}}})}applyDateFilter(){return k(this,null,function*(){yield this.onDateChange()})}setDateRange(i){return k(this,null,function*(){let t=new Date;switch(i){case"today":this.batdau=new Date(t),this.ketthuc=new Date(t);break;case"yesterday":let a=new Date(t);a.setDate(a.getDate()-1),this.batdau=new Date(a),this.ketthuc=new Date(a);break;case"last7days":this.ketthuc=new Date(t),this.batdau=new Date(t),this.batdau.setDate(this.batdau.getDate()-6);break;case"last30days":this.ketthuc=new Date(t),this.batdau=new Date(t),this.batdau.setDate(this.batdau.getDate()-29);break;case"thisMonth":this.batdau=new Date(t.getFullYear(),t.getMonth(),1),this.ketthuc=new Date(t);break;case"lastMonth":let e=new Date(t.getFullYear(),t.getMonth()-1,1);this.batdau=new Date(e),this.ketthuc=new Date(t.getFullYear(),t.getMonth(),0);break;case"thisWeek":let n=new Date(t);n.setDate(t.getDate()-t.getDay()),this.batdau=new Date(n),this.ketthuc=new Date(t);break}yield this.applyDateFilter()})}ngOnInit(){return k(this,null,function*(){this.loadDataWithDateRange()})}applyFilter(i){}toggleAll(){this.ListEdit().length===this.ListImportType().length?(this.ListEdit.set([]),this.TitleExport="export"):(this.ListEdit.set(this.ListImportType()),this.TitleExport="export_all")}toggleItem(i){this.ListEdit().findIndex(a=>a.id===i.id)===-1?(this.TitleExport+="_"+i.value,this.ListEdit.update(a=>[...a,i])):(this.TitleExport=this.TitleExport.replace("_"+i.value,""),this.ListEdit.update(a=>a.filter(e=>e.id!==i.id)))}CheckItem(i){return this.ListEdit().findIndex(a=>a.id===i.id)!==-1}ExportExcel(i){return k(this,null,function*(){if(!this.isExporting()){this.isExporting.set(!0),this.loadingMessage.set("\u0110ang chu\u1EA9n b\u1ECB d\u1EEF li\u1EC7u xu\u1EA5t theo kho\u1EA3ng th\u1EDDi gian...");try{let t=this.getFilteredExportData(),a=Array.isArray(t.ListSP)&&t.ListSP.length?t.ListSP.map(r=>({masp:r.masp,subtitle:r.subtitle,title:r.title,title2:r.title2,giaban:r.giaban,giagoc:r.giagoc,vat:r.vat,dvt:r.dvt,haohut:r.haohut,loadpoint:r.loadpoint,ghichu:r.ghichu})):[{masp:"",subtitle:"",title:"",title2:"",giaban:"",giagoc:"",vat:"",dvt:"",haohut:"",ghichu:""}],e=Array.isArray(t.ListKH)&&t.ListKH.length?t.ListKH.map(r=>({name:r.name?.trim()||"",tenfile:r.tenfile?.trim()||"",makh:r.makh?.trim()||"",namenn:r.namenn?.trim()||"",mabanggia:r.banggia?.mabanggia?.trim()||"",diachi:r.diachi?.trim()||"",quan:r.quan?.trim()||"",email:r.email?.trim()||"",sdt:r.sdt?.toString().trim()||"",mst:r.mst?.toString().trim()||"",gionhanhang:r.gionhanhang?.toString().trim()||"",loaikh:r.loaikh?.toString().trim()||"khachsi",hiengia:r.hiengia||!0,ishowvat:r.ishowvat||!1,ghichu:r.ghichu?.toString().trim()||""})):[{name:"",tenfile:"",makh:"",namenn:"",diachi:"",quan:"",email:"",sdt:"",mst:"",gionhanhang:"",loaikh:"khachsi",hiengia:!0,ishowvat:!1,ghichu:""}],n=Array.isArray(t.ListNCC)&&t.ListNCC.length>0?t.ListNCC.map(r=>({name:r.name?.trim()||"",tenfile:r.tenfile?.trim()||"",mancc:r.mancc?.trim()||"",diachi:r.diachi?.trim()||"",email:r.email?.trim()||"",sdt:r.sdt?.toString().trim()||"",ghichu:r.ghichu?.toString().trim()||""})):[{name:"",tenfile:"",mancc:"",diachi:"",email:"",sdt:"",ghichu:""}],o=Array.isArray(t.ListBG)&&t.ListBG.length>0?t.ListBG.map(r=>({title:r.title?.trim()||"",mabanggia:r.mabanggia?.trim()||"",type:r.type?.trim()||"",batdau:(0,E.default)(r.batdau).format("DD/MM/YYYY")||"",ketthuc:(0,E.default)(r.ketthuc).format("DD/MM/YYYY")||"",ghichu:r.ghichu?.trim()||"",status:r.status?.trim()||""})):[{title:"",mabanggia:"",type:"",batdau:"",ketthuc:"",ghichu:"",status:""}],l=Array.isArray(t.ListDH)&&t.ListDH.length>0?t.ListDH.flatMap(r=>Array.isArray(r.sanpham)?r.sanpham.map(u=>({ngaygiao:(0,E.default)(r.ngaygiao).format("DD/MM/YYYY"),makh:r.khachhang?.makh,name:r.khachhang?.name,mabanggia:r.khachhang?.banggia?.[0]?.mabanggia,masp:u.masp,tensp:u.title,sldat:u.sldat,slgiao:u.slgiao,slnhan:u.slnhan,ghichu:u.ghichu})):[]):[{ngaygiao:(0,E.default)().format("DD/MM/YYYY"),makh:"",mabanggia:"",masp:"",tensp:"",sldat:0,slgiao:0,slnhan:0,ghichu:""}],_=Array.isArray(t.ListDathang)&&t.ListDathang.length>0?t.ListDathang.flatMap(r=>Array.isArray(r.sanpham)?r.sanpham.map(u=>({ngaynhan:(0,E.default)(r.ngaynhan).format("DD/MM/YYYY"),mancc:r.nhacungcap?.mancc,name:r.nhacungcap?.name,mabanggia:r.banggia?.[0]?.mabanggia,masp:u.masp,tensp:u.title,sldat:Number(u.sldat)||0,slgiao:Number(u.slgiao)||0,slnhan:Number(u.slnhan)||0,ghichu:u.ghichu,makho:r?.kho?.makho||""})):[]):[{ngaynhan:(0,E.default)().format("DD/MM/YYYY"),mancc:"",name:"",mabanggia:"",masp:"",tensp:"",sldat:0,slgiao:0,slnhan:0,ghichu:"",makho:""}],I=this.convertBGSPToExport(t.ListBG,t.ListSP),P=t.ListKH.map(r=>({makh:r.makh||"",name:r.name||"",mabanggia:r.banggia?.mabanggia||""})),yt=t.ListSP.reduce((r,u)=>(u&&u.masp&&(r[u.masp]=""),r),{}),ct=t.ListNCC.map(r=>{let u={mancc:r.mancc||"",name:r.name||""},bt=1;for(let kt of Object.keys(yt))r.Sanpham?.some(wa=>wa.masp===kt)&&(u[bt]=kt,bt++);return u});console.log("dynamicKeys",yt),console.log("ListNCCSP1123",ct);let va=t.ListTonkho.map(r=>({masp:r.masp,title:r.title,dvt:r.dvt,slton:r.slton})),_a=Array.isArray(t.ListKho)&&t.ListKho.length?t.ListKho.map(r=>({makho:r.makho||"",tenkho:r.tenkho||"",diachi:r.diachi||"",ghichu:r.ghichu||"",status:r.status||"active"})):[{makho:"",tenkho:"",diachi:"",ghichu:"",status:"active"}],x={};if(this.ListEdit().some(r=>r.value==="sanpham")&&(x.sanpham={data:a}),this.ListEdit().some(r=>r.value==="khachhang")&&(x.khachhang={data:e}),this.ListEdit().some(r=>r.value==="nhacungcap")&&(x.nhacungcap={data:n}),this.ListEdit().some(r=>r.value==="banggia")&&(x.banggia={data:o}),this.ListEdit().some(r=>r.value==="donhang")&&(x.donhang={data:l}),this.ListEdit().some(r=>r.value==="dathang")&&(x.dathang={data:_}),this.ListEdit().some(r=>r.value==="banggiasanpham")&&(x.banggiasanpham={data:I}),this.ListEdit().some(r=>r.value==="banggiakhachhang")&&(x.banggiakhachhang={data:P}),this.ListEdit().some(r=>r.value==="nhacungcapsanpham")&&(x.nhacungcapsanpham={data:ct},console.log("ListNCCSP",ct)),this.ListEdit().some(r=>r.value==="xuatnhapton")&&(x.xuatnhapton={data:va}),this.ListEdit().some(r=>r.value==="kho")&&(x.kho={data:_a}),Object.keys(x).length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u \u0111\u1EC3 xu\u1EA5t","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}this.loadingMessage.set("\u0110ang t\u1EA1o file Excel...");let Ea=`${this.batdau.toLocaleDateString("vi-VN").replace(/\//g,"-")}_${this.ketthuc.toLocaleDateString("vi-VN").replace(/\//g,"-")}`,Ca=`${i}_${Ea}`;Ut(x,Ca),this._snackBar.open("Xu\u1EA5t d\u1EEF li\u1EC7u th\xE0nh c\xF4ng!","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch(t){console.error("Error exporting Excel:",t),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi xu\u1EA5t d\u1EEF li\u1EC7u","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.isExporting.set(!1),this.loadingMessage.set("")}}})}convertBGSPToExport(i,t){let a=new Set(i.map(e=>e.mabanggia));return t.map(e=>d({masp:e.masp,title:e.title,giaban:e.giaban.toString()},Array.from(a).reduce((n,o)=>(n[o]=e.giaban.toString(),n),{})))}convertBGSPToImport(i){return!i||i.length===0?[]:Object.keys(i[0]).filter(e=>!["masp","title","giagoc"].includes(e)).map(e=>({mabanggia:e,title:`B\u1EA3ng gi\xE1 ${e.replace("BG","")}`,sanpham:i.map(n=>({masp:n.masp?.toString().trim()||"",title:n.title?.toString().trim()||"",giagoc:n.giagoc||0,giaban:n[e]||0}))}))}convertNCCSPToImport(i){if(!i||i.length===0)return[];let t=Object.keys(i[0]).filter(a=>!["mancc","name"].includes(a));return i.forEach(a=>{a.Sanpham=[];for(let e of t)a[e]!==void 0&&a[e]!==null&&a[e]!==""&&a.Sanpham.push(a[e]),delete a[e]}),i}ImportExcel(i){return k(this,null,function*(){if(!this.isImporting()){this.isImporting.set(!0),this.loadingMessage.set("\u0110ang \u0111\u1ECDc file Excel...");try{let t=yield Wt(i);this.loadingMessage.set("\u0110ang x\u1EED l\xFD d\u1EEF li\u1EC7u..."),yield this.DoImportData(t)}catch(t){console.error("Error importing Excel:",t),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi \u0111\u1ECDc file Excel","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.isImporting.set(!1),this.loadingMessage.set("")}}})}showImportConfirmDialog(i,t,a,e){return k(this,null,function*(){return new Promise(n=>{let o={dataType:i,existingCount:t,newCount:a,duplicateItems:e,isOverwrite:!1};this._dialog.open(lt,{width:"500px",data:o,disableClose:!0}).afterClosed().subscribe(_=>{n(_||{confirmed:!1,overwrite:!1})})})})}DoImportData(i){return k(this,null,function*(){if(Object.keys(this.ListEdit()).length===0){this._snackBar.open("Ch\u01B0a Ch\u1ECDn Lo\u1EA1i D\u1EEF Li\u1EC7u","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}if(Object.keys(i).length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u \u0111\u1EC3 nh\u1EADp","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}if(i.sanpham&&i.sanpham.length>0&&this.ListEdit().some(t=>t.value==="sanpham")){let t=b.transformDataForImport(i.sanpham,"sanpham"),a=b.filterValidData(t,b.getRequiredFields("sanpham")),e=b.checkDuplicates(a,this.rawListSP,b.getUniqueField("sanpham")),n=yield this.showImportConfirmDialog("S\u1EA3n Ph\u1EA9m",this.rawListSP.length,a.length,e);if(!n.confirmed)return;let o=b.prepareSanphamData(a,this.rawListSP,n.overwrite);if(o.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let l=this._snackBar.open(`\u0110ang import ${o.length} s\u1EA3n ph\u1EA9m...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{yield this._SanphamService.ImportSanpham(o),l.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${o.length} s\u1EA3n ph\u1EA9m${n.overwrite?" (ghi \u0111\xE8)":" (th\xEAm m\u1EDBi)"}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{l.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import s\u1EA3n ph\u1EA9m","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(i.khachhang&&i.khachhang.length>0&&this.ListEdit().some(t=>t.value==="khachhang")){let t=b.transformDataForImport(i.khachhang,"khachhang"),a=b.filterValidData(t,b.getRequiredFields("khachhang")),e=b.checkDuplicates(a,this.rawListKH,b.getUniqueField("khachhang")),n=yield this.showImportConfirmDialog("Kh\xE1ch H\xE0ng",this.rawListKH.length,a.length,e);if(!n.confirmed)return;let o=b.prepareKhachhangData(a,this.rawListKH,n.overwrite);if(o.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let l=this._snackBar.open(`\u0110ang import ${o.length} kh\xE1ch h\xE0ng...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{yield this._KhachhangService.ImportKhachhang(o),l.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${o.length} kh\xE1ch h\xE0ng${n.overwrite?" (ghi \u0111\xE8)":" (th\xEAm m\u1EDBi)"}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{l.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import kh\xE1ch h\xE0ng","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(i.nhacungcap&&i.nhacungcap.length>0&&this.ListEdit().some(t=>t.value==="nhacungcap")){let t=(i.nhacungcap||[]).map(l=>({name:l.name,tenfile:F(l.tenfile.toString()||l.name||""),mancc:l.mancc,diachi:l.diachi,email:l.email,sdt:l.sdt.toString(),ghichu:l.ghichu})).filter(l=>l.mancc!==void 0&&l.mancc!==null&&l.mancc!==""),a=b.checkDuplicates(t,this.rawListNCC,"mancc"),e=yield this.showImportConfirmDialog("Nh\xE0 Cung C\u1EA5p",this.rawListNCC.length,t.length,a);if(!e.confirmed)return;let n=b.prepareNhacungcapData(t,this.rawListNCC,e.overwrite);if(n.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let o=this._snackBar.open(`\u0110ang import ${n.length} nh\xE0 cung c\u1EA5p...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{yield this._NhacungcapService.ImportNhacungcap(n),o.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${n.length} nh\xE0 cung c\u1EA5p${e.overwrite?" (ghi \u0111\xE8)":" (th\xEAm m\u1EDBi)"}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{o.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import nh\xE0 cung c\u1EA5p","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(i.banggia&&i.banggia.length>0&&this.ListEdit().some(t=>t.value==="banggia")){let t=(i.banggia||[]).map(l=>({title:"B\u1EA3ng Gi\xE1 "+l.mabanggia,mabanggia:l.mabanggia,type:l.type,batdau:(0,E.default)(O(l.batdau)).toDate(),ketthuc:(0,E.default)(O(l.ketthuc)).toDate(),ghichu:l.ghichu,status:l.status})).filter(l=>l.mabanggia!==void 0&&l.mabanggia!==null&&l.mabanggia!==""),a=b.checkDuplicates(t,this.rawListBG,"mabanggia"),e=yield this.showImportConfirmDialog("B\u1EA3ng Gi\xE1",this.rawListBG.length,t.length,a);if(!e.confirmed)return;let n=b.prepareBanggiaData(t,this.rawListBG,e.overwrite);if(n.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let o=this._snackBar.open(`\u0110ang import ${n.length} b\u1EA3ng gi\xE1...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{yield this._BanggiaService.ImportBanggia(n),o.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${n.length} b\u1EA3ng gi\xE1${e.overwrite?" (ghi \u0111\xE8)":" (th\xEAm m\u1EDBi)"}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{o.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import b\u1EA3ng gi\xE1","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(i.kho&&i.kho.length>0&&this.ListEdit().some(t=>t.value==="kho")){let t=(i.kho||[]).map(l=>({makho:l.makho?.toString().trim()||"",tenkho:l.tenkho?.toString().trim()||"",diachi:l.diachi?.toString().trim()||"",ghichu:l.ghichu?.toString().trim()||"",status:l.status?.toString().trim()||"active"})).filter(l=>l.makho!==void 0&&l.makho!==null&&l.makho!==""),a=b.checkDuplicates(t,this.rawListKho,"makho"),e=yield this.showImportConfirmDialog("Kho",this.rawListKho.length,t.length,a);if(!e.confirmed)return;let n=b.prepareKhoData(t,this.rawListKho,e.overwrite);if(n.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let o=this._snackBar.open(`\u0110ang import ${n.length} kho...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{let l=n.map(_=>k(this,null,function*(){let I=this.rawListKho.find(P=>P.makho===_.makho);if(I){let P=d(d({},I),_);yield this._KhoService.updateKho(P)}else yield this._KhoService.CreateKho(_)}));yield Promise.all(l),yield this._KhoService.getAllKho(),this.rawListKho=this._KhoService.ListKho(),o.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${n.length} kho${a.length>0?` (${a.length} tr\xF9ng l\u1EB7p)`:""}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{o.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import kho","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(i.donhang&&i.donhang.length>0&&this.ListEdit().some(t=>t.value==="donhang")){let t=(i.donhang||[]).map(e=>({ngay:e.ngay,makh:e.makh,mabangia:e.mabangia,masp:e.masp,sldat:Number(e.sldat),slgiao:Number(e.slgiao),slnhan:Number(e.slnhan),ghichu:e.ghichu})).filter(e=>e.makh!==void 0&&e.makh!==null&&e.makh!==""&&e.masp!==void 0&&e.masp!==null&&e.masp!==""),a=this._snackBar.open("\u0110ang import \u0110\u01A1n h\xE0ng...","",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});yield this._DonhangService.ImportDonhang(t),a.dismiss(),this._snackBar.open("Import \u0110\u01A1n h\xE0ng th\xE0nh c\xF4ng!","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(i.banggiasanpham&&i.banggiasanpham.length>0&&this.ListEdit().some(t=>t.value==="banggiasanpham")){let t=this.convertBGSPToImport(i.banggiasanpham),a=t.find(n=>n.mabanggia==="giaban");if(!a)return;let e=t.map(n=>{if(n.mabanggia==="giaban")return n;let o=n.sanpham.map(l=>{if(l.giaban==="0"){let _=a.sanpham.find(I=>I.masp===l.masp);return v(d({},l),{giaban:_?_.giaban:l.giaban})}return l});return v(d({},n),{sanpham:o})});yield this._BanggiaService.importSPBG(e)}if(i.banggiakhachhang&&i.banggiakhachhang.length>0&&this.ListEdit().some(t=>t.value==="banggiakhachhang")){console.log("Importing banggiakhachhang data:",i.banggiakhachhang);let t=(i.banggiakhachhang||[]).map(a=>({makh:a.makh,name:a.name,mabanggia:a.mabanggia})).filter(a=>a.mabanggia!==void 0&&a.mabanggia!==null&&a.mabanggia!=="");console.log("Importing ListBGKH data:",t),yield this._KhachhangService.ImportKhachhang(t),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(i.nhacungcapsanpham&&i.nhacungcapsanpham.length>0&&this.ListEdit().some(t=>t.value==="nhacungcapsanpham")){let t=this.convertNCCSPToImport(i.nhacungcapsanpham);console.log(t);let a=t.filter(n=>n?.Sanpham?.length>0).map(n=>v(d({},n),{Sanpham:n?.Sanpham?.map(o=>this.rawListSP.find(l=>l?.masp===o))})),e=this._snackBar.open("\u0110ang import Nh\xE0 cung c\u1EA5p s\u1EA3n ph\u1EA9m...","",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});console.log("ListNCCSP for import:",a),yield this._NhacungcapService.ImportNhacungcap(a),e.dismiss(),this._snackBar.open("Import Nh\xE0 cung c\u1EA5p s\u1EA3n ph\u1EA9m th\xE0nh c\xF4ng!","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(i.xuatnhapton&&i.xuatnhapton.length>0&&this.ListEdit().some(t=>t.value==="xuatnhapton")){let t=[],a=[];console.log("Processing xuatnhapton import data:",i.xuatnhapton.length,"items"),i.xuatnhapton.forEach(e=>{if(!e.masp||e.slton===void 0||e.slton===null){console.warn("Invalid xuatnhapton item:",e);return}let n=this.rawListTonkho.find(o=>o.masp===e.masp);if(n){let o=Number(e.slton)||0,l=Number(n.slton)||0,_=o-l;if(_>0){let I=this.rawListSP.find(P=>P.masp===e.masp);I&&I.id?t.push({sanphamId:I.id,soluong:_,ghichu:`\u0110i\u1EC1u ch\u1EC9nh t\u0103ng t\u1EEB ${l} l\xEAn ${o}`}):console.warn(`S\u1EA3n ph\u1EA9m kh\xF4ng t\xECm th\u1EA5y cho m\xE3: ${e.masp}`)}else if(_<0){let I=this.rawListSP.find(P=>P.masp===e.masp);I&&I.id?a.push({sanphamId:I.id,soluong:Math.abs(_),ghichu:`\u0110i\u1EC1u ch\u1EC9nh gi\u1EA3m t\u1EEB ${l} xu\u1ED1ng ${o}`}):console.warn(`S\u1EA3n ph\u1EA9m kh\xF4ng t\xECm th\u1EA5y cho m\xE3: ${e.masp}`)}}else console.warn(`T\u1ED3n kho kh\xF4ng t\xECm th\u1EA5y cho m\xE3 s\u1EA3n ph\u1EA9m: ${e.masp}`)}),console.log(`Phi\u1EBFu nh\u1EADp: ${t.length} items, Phi\u1EBFu xu\u1EA5t: ${a.length} items`);try{if(t.length>0){let e=t.filter(n=>!n.sanphamId);if(e.length>0)throw console.warn("Invalid phieuNhapDetails items:",e),new Error(`${e.length} s\u1EA3n ph\u1EA9m nh\u1EADp kh\xF4ng h\u1EE3p l\u1EC7`)}if(a.length>0){let e=a.filter(n=>!n.sanphamId);if(e.length>0)throw console.warn("Invalid phieuXuatDetails items:",e),new Error(`${e.length} s\u1EA3n ph\u1EA9m xu\u1EA5t kh\xF4ng h\u1EE3p l\u1EC7`)}if(t.length>0){console.log("Creating phieu nhap with details:",t);let e={title:`\u0110i\u1EC1u Ch\u1EC9nh Nh\u1EADp Kho ${(0,E.default)().format("DD/MM/YYYY")}`,type:"nhap",sanpham:t,ghichu:`C\u1EADp nh\u1EADt t\u1ED3n kho t\u0103ng l\xFAc ${(0,E.default)().format("HH:mm:ss DD/MM/YYYY")}`,ngay:(0,E.default)().toDate(),khoId:"4cc01811-61f5-4bdc-83de-a493764e9258",isActive:!0};yield this._PhieukhoService.CreatePhieukho(e),this._snackBar.open(`T\u1EA1o phi\u1EBFu nh\u1EADp th\xE0nh c\xF4ng v\u1EDBi ${t.length} s\u1EA3n ph\u1EA9m`,"",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),yield new Promise(n=>setTimeout(n,2e3))}if(a.length>0){console.log("Creating phieu xuat with details:",a);let e={title:`\u0110i\u1EC1u Ch\u1EC9nh Xu\u1EA5t Kho ${(0,E.default)().format("DD/MM/YYYY")}`,type:"xuat",sanpham:a,ghichu:`C\u1EADp nh\u1EADt t\u1ED3n kho gi\u1EA3m l\xFAc ${(0,E.default)().format("HH:mm:ss DD/MM/YYYY")}`,ngay:(0,E.default)().toDate(),khoId:"4cc01811-61f5-4bdc-83de-a493764e9258",isActive:!0};yield this._PhieukhoService.CreatePhieukho(e),this._snackBar.open(`T\u1EA1o phi\u1EBFu xu\u1EA5t th\xE0nh c\xF4ng v\u1EDBi ${a.length} s\u1EA3n ph\u1EA9m`,"",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}t.length===0&&a.length===0&&this._snackBar.open("Kh\xF4ng c\xF3 thay \u0111\u1ED5i t\u1ED3n kho n\xE0o c\u1EA7n x\u1EED l\xFD","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-info"]})}catch(e){console.error("Error creating phieukho during xuatnhapton import:",e),this._snackBar.open(`L\u1ED7i khi t\u1EA1o phi\u1EBFu kho: ${e?.message||"Unknown error"}`,"",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(i.dathang&&this.ListEdit().some(t=>t.value==="dathang")){let t=(i.dathang||[]).filter(e=>e.mancc&&e.masp).map(e=>({ngaynhan:(0,E.default)(O(e.ngaynhan)).toDate(),mancc:e.mancc,mabanggia:e.mabanggia,masp:e.masp,sldat:Number(e.sldat),slgiao:Number(e.sldat),slnhan:Number(e.sldat),ghichu:e.ghichu})),a=this._snackBar.open("\u0110ang import \u0110\u1EB7t h\xE0ng...","",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});yield this._DathangService.ImportDathang(t),a.dismiss(),this._snackBar.open("Import \u0110\u1EB7t h\xE0ng th\xE0nh c\xF4ng!","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(i.donhang&&this.ListEdit().some(t=>t.value==="donhang")){let t=(i.donhang||[]).filter(e=>e.makh&&e.masp).map(e=>({ngaygiao:(0,E.default)(O(e.ngaygiao)).toDate(),makh:e.makh,mabanggia:e.mabangia,masp:e.masp,sldat:Number(e.sldat),slgiao:Number(e.slgiao),slnhan:Number(e.slnhan),ghichu:e.ghichu})),a=this._snackBar.open("\u0110ang import \u0110\u01A1n h\xE0ng...","",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});yield this._DonhangService.ImportDonhang(t),a.dismiss(),this._snackBar.open("Import \u0110\u01A1n h\xE0ng th\xE0nh c\xF4ng!","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}})}trackByFn(i,t){return t.id||i}filterDataByDateRange(i,t="createdAt"){if(!i||!Array.isArray(i))return[];let a=new Date(this.batdau);a.setHours(0,0,0,0);let e=new Date(this.ketthuc);return e.setHours(23,59,59,999),i.filter(n=>{if(!n[t])return!0;let o;if(typeof n[t]=="string")o=new Date(n[t]);else if(n[t]instanceof Date)o=n[t];else return!0;return o>=a&&o<=e})}getFilteredExportData(){let i={batdau:this.batdau,ketthuc:this.ketthuc,dateRange:`${this.batdau.toLocaleDateString("vi-VN")} - ${this.ketthuc.toLocaleDateString("vi-VN")}`};return{ListSP:this.rawListSP,ListKH:this.rawListKH,ListNCC:this.rawListNCC,ListBG:this.rawListBG,ListDH:this.filterDataByDateRange(this.rawListDH,"ngaygiao"),ListDathang:this.filterDataByDateRange(this.rawListDathang,"ngaynhan"),ListTonkho:this.filterDataByDateRange(this.rawListTonkho,"createdAt"),ListKho:this.filterDataByDateRange(this.rawListKho,"createdAt"),dateInfo:i}}static \u0275fac=function(t){return new(t||s)};static \u0275cmp=G({type:s,selectors:[["app-listimportdata"]],viewQuery:function(t,a){if(t&1&&(Y(Ht,5),Y(Yt,5),Y(Ra,7)),t&2){let e;j(e=q())&&(a.paginator=e.first),j(e=q())&&(a.sort=e.first),j(e=q())&&(a.drawer=e.first)}},decls:73,vars:42,consts:[["dateRangePicker",""],["uploadfile",""],["dataContent",""],["noData",""],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",4,"ngIf"],[1,"col-span-full","mb-6","p-6","bg-white","rounded-lg","shadow-sm","border"],[1,"flex","flex-col","items-center","gap-4"],[1,"flex","flex-col","lg:flex-row","lg:items-center","gap-4"],[1,"flex","flex-col","lg:flex-row","items-center","gap-2"],["appearance","outline","subscriptSizing","dynamic",1,"w-full","lg:w-auto"],[3,"rangePicker"],["matStartDate","","placeholder","T\u1EEB ng\xE0y",3,"ngModelChange","dateChange","ngModel","ngModelOptions","disabled"],["matEndDate","","placeholder","\u0110\u1EBFn ng\xE0y",3,"ngModelChange","dateChange","ngModel","ngModelOptions","disabled"],["matIconSuffix","",3,"for"],["mat-button","","matDatepickerCancel",""],["mat-raised-button","","color","primary","matDatepickerApply","",3,"click"],["mat-raised-button","","color","primary",1,"h-14",3,"click","disabled"],[1,"mr-2"],[1,"flex","flex-wrap","gap-2"],[1,"text-sm","text-gray-600","mr-2","self-center"],["mat-button","",1,"text-sm",3,"click","disabled"],[1,"mt-4","p-3","bg-blue-50","rounded-lg","border","border-blue-200"],[1,"flex","items-center","space-x-2"],[1,"text-blue-600"],[1,"text-blue-700","font-medium"],[1,"flex","flex-col","space-y-2","p-8"],[1,"flex","flex-row","space-x-2","items-center"],["mat-flat-button","","color","primary",3,"click","disabled"],[4,"ngIf"],["class","flex items-center",4,"ngIf"],["class","ml-1",4,"ngIf"],["type","file","accept",".xlsx,.xls",1,"hidden",3,"change","disabled"],["class","w-full p-4 bg-blue-50 rounded-lg border border-blue-200",4,"ngIf"],[1,"grid","grid-cols-3","gap-4"],[3,"class","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"w-full","flex","flex-col","space-y-2","p-8"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"keyup","disabled"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"bg-white","p-6","rounded-lg","shadow-lg","flex","flex-col","items-center","space-y-4"],["diameter","50","mode","indeterminate"],[1,"text-lg","font-medium"],[1,"flex","items-center"],["diameter","20","mode","indeterminate",1,"mr-2"],[1,"ml-1"],[1,"w-full","p-4","bg-blue-50","rounded-lg","border","border-blue-200"],["diameter","20","mode","indeterminate"],[1,"text-blue-700"],[3,"click"],[1,"w-full","flex","flex-col","space-y-2"],["class","w-full flex flex-row space-x-2 items-center border p-4 rounded-lg bg-gray-100 animate-pulse",4,"ngFor","ngForOf"],[1,"w-full","flex","flex-row","space-x-2","items-center","border","p-4","rounded-lg","bg-gray-100","animate-pulse"],[1,"rounded-lg","p-2","bg-gray-300","w-16","h-8"],[1,"bg-gray-300","h-4","w-1/3","rounded"],[1,"bg-gray-300","h-3","w-1/2","rounded"],[3,"class",4,"ngFor","ngForOf"],[1,"rounded-lg","p-2","bg-blue-100"],[1,"text-sm","text-gray-600"],[1,"w-full","flex","flex-row","items-center","justify-center","border","p-4","rounded-lg","bg-gray-100"],[1,"text-gray-600"]],template:function(t,a){if(t&1){let e=A();h(0,"div",4),w(1,Oa,5,1,"div",5),h(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9)(6,"mat-form-field",10)(7,"mat-label"),p(8,"Ch\u1ECDn kho\u1EA3ng th\u1EDDi gian"),c(),h(9,"mat-date-range-input",11)(10,"input",12),V("ngModelChange",function(o){return f(e),R(a.batdau,o)||(a.batdau=o),y(o)}),S("dateChange",function(){return f(e),y(a.onDateChange())}),c(),h(11,"input",13),V("ngModelChange",function(o){return f(e),R(a.ketthuc,o)||(a.ketthuc=o),y(o)}),S("dateChange",function(){return f(e),y(a.onDateChange())}),c()(),B(12,"mat-datepicker-toggle",14),h(13,"mat-date-range-picker",null,0)(15,"mat-datepicker-actions")(16,"button",15),p(17,"H\u1EE7y"),c(),h(18,"button",16),S("click",function(){return f(e),y(a.applyDateFilter())}),p(19,"\xC1p d\u1EE5ng"),c()()()(),h(20,"button",17),S("click",function(){return f(e),y(a.applyDateFilter())}),h(21,"mat-icon",18),p(22,"refresh"),c(),p(23," L\xE0m m\u1EDBi "),c()()(),h(24,"div",19)(25,"span",20),p(26,"Ch\u1ECDn nhanh:"),c(),h(27,"button",21),S("click",function(){return f(e),y(a.setDateRange("today"))}),p(28," H\xF4m nay "),c(),h(29,"button",21),S("click",function(){return f(e),y(a.setDateRange("yesterday"))}),p(30," H\xF4m qua "),c(),h(31,"button",21),S("click",function(){return f(e),y(a.setDateRange("last7days"))}),p(32," 7 ng\xE0y qua "),c(),h(33,"button",21),S("click",function(){return f(e),y(a.setDateRange("last30days"))}),p(34," 30 ng\xE0y qua "),c(),h(35,"button",21),S("click",function(){return f(e),y(a.setDateRange("thisMonth"))}),p(36," Th\xE1ng n\xE0y "),c(),h(37,"button",21),S("click",function(){return f(e),y(a.setDateRange("lastMonth"))}),p(38," Th\xE1ng tr\u01B0\u1EDBc "),c()()(),h(39,"div",22)(40,"div",23)(41,"mat-icon",24),p(42,"date_range"),c(),h(43,"span",25),p(44),gt(45,"date"),gt(46,"date"),c()()()(),h(47,"div",26)(48,"div",27)(49,"button",28),S("click",function(){return f(e),y(a.ExportExcel(a.TitleExport))}),w(50,Ha,2,0,"span",29)(51,Ga,3,0,"span",30)(52,Ya,2,0,"mat-icon",31),c(),h(53,"button",28),S("click",function(){f(e);let o=$(60);return y(o.click())}),w(54,ja,2,0,"span",29)(55,qa,3,0,"span",30)(56,Ua,2,0,"mat-icon",31),c(),h(57,"button",28),S("click",function(){return f(e),y(a.toggleAll())}),p(58," Ch\u1ECDn T\u1EA5t C\u1EA3 "),c(),h(59,"input",32,1),S("change",function(o){return f(e),y(a.ImportExcel(o))}),c()(),w(61,Wa,5,1,"div",33),h(62,"div",34),w(63,Xa,4,7,"span",35),c()(),h(64,"div",36)(65,"div",37)(66,"input",38),S("keyup",function(o){return f(e),y(a.applyFilter(o))}),c(),h(67,"div",39)(68,"span",40),p(69,"search"),c()()(),w(70,Za,3,2,"ng-container",41)(71,ie,3,2,"ng-template",null,2,ut),c()()}if(t&2){let e=$(14),n=$(72);m(),g("ngIf",a.isLoading()||a.isImporting()||a.isExporting()),m(8),g("rangePicker",e),m(),z("ngModel",a.batdau),g("ngModelOptions",U(40,ka))("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(),z("ngModel",a.ketthuc),g("ngModelOptions",U(41,ka))("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(),g("for",e),m(8),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(7),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(2),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(2),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(2),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(2),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(2),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(7),_t(" \u0110ang hi\u1EC3n th\u1ECB d\u1EEF li\u1EC7u t\u1EEB ",dt(45,34,a.batdau,"dd/MM/yyyy")," \u0111\u1EBFn ",dt(46,37,a.ketthuc,"dd/MM/yyyy")," "),m(5),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(),g("ngIf",!a.isExporting()),m(),g("ngIf",a.isExporting()),m(),g("ngIf",!a.isExporting()),m(),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(),g("ngIf",!a.isImporting()),m(),g("ngIf",a.isImporting()),m(),g("ngIf",!a.isImporting()),m(),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(2),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(2),g("ngIf",a.isLoading()),m(2),g("ngForOf",a.ListImportType())("ngForTrackBy",a.trackByFn),m(3),g("disabled",a.isLoading()||a.isImporting()||a.isExporting()),m(4),g("ngIf",a.isLoading())("ngIfElse",n)}},dependencies:[$t,At,Ft,Kt,zt,qt,jt,Gt,Pt,xt,et,at,Z,J,Rt,X,W,Q,Ct,rt,Mt,it,nt,Ot,ot,oa,ra,na,Qt,Xt,Jt,Zt,ta,ia,ea,aa,Dt],encapsulation:2,changeDetection:0})};export{st as a,Sa as b};
