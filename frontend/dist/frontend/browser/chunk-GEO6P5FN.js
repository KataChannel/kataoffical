import{a as de}from"./chunk-ZEYFBF7A.js";import{a as ce}from"./chunk-2THUL5RA.js";import{a as me}from"./chunk-AJ5JTY7X.js";import{a as ue}from"./chunk-UCPSMH2E.js";import{a as pe}from"./chunk-XRNIFLBZ.js";import{a as Ot,b as $t,c as Rt,k as zt}from"./chunk-36PUUB2Q.js";import{e as le,f as se}from"./chunk-EHGCZ4C4.js";import{a as re}from"./chunk-H3TTFDG6.js";import{a as Kt,b as Ht,c as A,d as Qt,e as O,f as Wt,g as qt,h as Gt,i as Jt,j as jt,k as Zt,l as Ut,m as Yt,n as Xt,o as te,p as ee,q as ie,r as ae,s as ne,t as oe}from"./chunk-AYBK3TLN.js";import{b as Bt,d as Pt,e as At}from"./chunk-3F7BKIWY.js";import{a as gt,b as _t,c as ht}from"./chunk-QR3VZXMW.js";import{b as Nt}from"./chunk-OCCYRB3G.js";import{a as Ce}from"./chunk-JNVUT6FC.js";import{a as St,b as yt,c as xt,d as wt}from"./chunk-5NUPTYVB.js";import{a as ft,b as Ct}from"./chunk-WCQZDYIS.js";import{b as Dt,g as vt,j as Mt,n as Tt,p as Et,q as bt,r as kt,u as Ft,v as Lt,x as It,y as Vt}from"./chunk-2G4G76BL.js";import{a as dt}from"./chunk-LCSHMLYS.js";import{a as ct,c as pt,e as ut}from"./chunk-M4K2YFJY.js";import{y as st,z as mt}from"./chunk-INKYKFQH.js";import{b as rt,c as lt}from"./chunk-4TLJXXI3.js";import{k as et,l as it,m as at,r as nt,t as ot}from"./chunk-4KYRHQES.js";import{Cc as T,Dc as p,Eb as W,Ec as L,Fc as C,Gc as Y,Ic as I,Jc as V,Kc as N,Lb as D,Mc as E,Rc as X,Sc as B,Uc as P,Vb as d,Yb as q,Zb as G,_b as R,ac as J,bc as z,cc as K,dc as n,ec as r,fc as v,gc as j,gd as tt,hc as Z,jc as M,oa as S,oc as f,qc as c,rb as l,uc as U,wc as b,xa as g,xc as k,ya as _,yc as F}from"./chunk-6QR2UCJZ.js";import{a as $,g as fe,j as w}from"./chunk-6DYNGEAS.js";var H=fe(Ce());var Se=["drawer"],Q=()=>({standalone:!0}),ye=()=>[10,25,100],xe=(a,i,t,e,o)=>({"text-blue-500":a,"text-yellow-500":i,"text-green-500":t,"text-purple-500":e,"text-red-500":o}),we=(a,i)=>i.key;function De(a,i){if(a&1){let t=M();n(0,"button",36),f("click",function(o){let m=g(t).$implicit;return c().toggleColumn(m),_(o.stopPropagation())}),n(1,"mat-icon"),p(2),r(),n(3,"span"),p(4),r()()}if(a&2){let t=i.$implicit;l(2),L(t.isShow?"check_box":"check_box_outline_blank"),l(2),L(t.value)}}function ve(a,i){if(a&1){let t=M();n(0,"mat-form-field",39)(1,"mat-label"),p(2),r(),n(3,"input",40),f("keyup",function(){g(t);let o=c(2);return _(o.applyFilter())}),N("ngModelChange",function(o){let m=g(t).$implicit,s=c(2);return V(s.filterValues[m],o)||(s.filterValues[m]=o),_(o)}),r()()}if(a&2){let t=i.$implicit,e=c(2);l(2),L(e.ColumnName[t]),l(),U("placeholder","Vui l\xF2ng Nh\u1EADp ",t,""),I("ngModel",e.filterValues[t]),d("ngModelOptions",E(5,Q))}}function Me(a,i){if(a&1&&(n(0,"div",37),D(1,ve,4,6,"mat-form-field",38),r()),a&2){let t=c();l(),d("ngForOf",t.displayedColumns)}}function Te(a,i){if(a&1&&(n(0,"th",43)(1,"span",44),p(2),r()()),a&2){let t=c().$implicit,e=c();l(2),C(" ",e.ColumnName[t]," ")}}function Ee(a,i){if(a&1&&(n(0,"span",46),p(1),r()),a&2){let t=c().index;l(),C(" ",t+1," ")}}function be(a,i){if(a&1&&(n(0,"span",46),p(1),r()),a&2){let t=c().$implicit,e=c().$implicit;l(),C(" ",t[e].length," ")}}function ke(a,i){if(a&1&&(n(0,"span",46),p(1),r()),a&2){let t=c().$implicit,e=c().$implicit;l(),Y(" (",t[e].mancc,") ",t[e].name," ")}}function Fe(a,i){if(a&1&&(n(0,"span",46),p(1),B(2,"date"),r()),a&2){let t=c().$implicit,e=c().$implicit;l(),C(" ",P(2,1,t[e],"dd/MM/yyyy")," ")}}function Le(a,i){if(a&1&&(n(0,"span",46),p(1),B(2,"date"),r()),a&2){let t=c().$implicit,e=c().$implicit;l(),C(" ",P(2,1,t[e],"dd/MM/yyyy")," ")}}function Ie(a,i){if(a&1&&(n(0,"span",47),p(1),r()),a&2){let t=c().$implicit,e=c().$implicit,o=c();d("ngClass",X(2,xe,t[e]==="dadat",t[e]==="dagiao",t[e]==="danhan",t[e]==="hoanthanh",t[e]==="huy")),l(),C(" ",o.Trangthaidon[t[e]]," ")}}function Ve(a,i){a&1&&(n(0,"mat-icon",48),p(1,"check_circle"),r())}function Ne(a,i){a&1&&(n(0,"mat-icon",49),p(1,"cancel"),r())}function Be(a,i){if(a&1&&(n(0,"span",46),D(1,Ve,2,0,"mat-icon",48)(2,Ne,2,0,"mat-icon",49),r()),a&2){let t=c().$implicit,e=c().$implicit;l(),R(t[e]?1:2)}}function Pe(a,i){if(a&1&&(n(0,"span",46),p(1),B(2,"date"),r()),a&2){let t=c().$implicit,e=c().$implicit;l(),C(" ",P(2,1,t[e],"dd/MM/yyyy")," ")}}function Ae(a,i){if(a&1&&(n(0,"span",46),p(1),r()),a&2){let t=c().$implicit,e=c().$implicit;l(),C(" ",t[e]," ")}}function Oe(a,i){if(a&1&&(n(0,"td",45),D(1,Ee,2,1,"span",46)(2,be,2,1,"span",46)(3,ke,2,2,"span",46)(4,Fe,3,4,"span",46)(5,Le,3,4,"span",46)(6,Ie,2,8,"span",47)(7,Be,3,1,"span",46)(8,Pe,3,4,"span",46)(9,Ae,2,1,"span",46),r()),a&2){let t,e=c().$implicit;l(),R((t=e)==="STT"?1:t==="sanpham"?2:t==="nhacungcap"?3:t==="ngaynhan"?4:t==="createdAt"?5:t==="status"?6:t==="isActive"?7:t==="updatedAt"?8:9)}}function $e(a,i){if(a&1&&(j(0,31),D(1,Te,3,1,"th",41)(2,Oe,10,1,"td",42),Z()),a&2){let t=i.$implicit;d("matColumnDef",t)}}function Re(a,i){a&1&&v(0,"tr",50)}function ze(a,i){if(a&1){let t=M();n(0,"tr",51),f("click",function(){let o=g(t).$implicit,m=c();return _(m.goToDetail(o))}),r()}if(a&2){let t=i.$implicit,e=c();G("hover:bg-slate-100 ",e.dathangId()==t.id?"!bg-slate-200":"","")}}function Ke(a,i){a&1&&(n(0,"tr",52)(1,"td",53),p(2,"Kh\xF4ng t\xECm th\u1EA5y"),r()())}var ge=class a{Detail={};displayedColumns=["STT","madncc","nhacungcap","sanpham","ngaynhan","status","ghichu","createdAt","updatedAt"];ColumnName={STT:"STT",madncc:"M\xE3 \u0110\u01A1n Nh\u1EADp",nhacungcap:"Nh\xE0 Cung C\u1EA5p",sanpham:"S\u1EA3n Ph\u1EA9m",ngaynhan:"Ng\xE0y Nh\u1EADn",status:"Tr\u1EA1ng Th\xE1i",ghichu:"Ghi Ch\xFA",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("DathangColFilter")||"[]");Columns=[];isFilter=!1;Trangthaidon=de;paginator;sort;drawer;filterValues={};_DathangService=S(ce);_breakpointObserver=S(st);_GoogleSheetService=S(re);_NhacungcapService=S(pe);_SanphamService=S(ue);_BanggiaService=S(me);_router=S(lt);Listdathang=this._DathangService.ListDathang;dataSource=tt(()=>{let i=new oe(this.Listdathang());return i.filterPredicate=this.createFilter(),i.paginator=this.paginator,i.sort=this.sort,i});dathangId=this._DathangService.dathangId;_snackBar=S(dt);CountItem=0;SearchParams={Batdau:(0,H.default)().toDate(),Ketthuc:(0,H.default)().toDate(),pageSize:10,pageNumber:1};constructor(){this.displayedColumns.forEach(i=>{this.filterValues[i]=""})}createFilter(){return(i,t)=>{let e=JSON.parse(t),o=!0;return this.displayedColumns.forEach(m=>{if(e[m]){let s=i[m]?i[m].toString().toLowerCase():"";o=o&&s.includes(e[m].toLowerCase())}}),o}}applyFilter(){this.dataSource().filter=JSON.stringify(this.filterValues)}onDateChange(i){this.ngOnInit()}ngOnInit(){return w(this,null,function*(){yield this._DathangService.searchDathang(this.SearchParams),this.CountItem=this.Listdathang().length,this.initializeColumns(),this.setupDrawer(),this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i"})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(i=>({key:i,value:this.ColumnName[i],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("DathangColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(i=>i.isShow).map(i=>i.key),this.ColumnName=this.FilterColumns.reduce((i,t)=>(t.isShow&&(i[t.key]=t.value),i),{})}setupDrawer(){this._breakpointObserver.observe([mt.Handset]).subscribe(i=>{i.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}toggleColumn(i){let t=this.FilterColumns.find(e=>e.key===i.key);t&&(t.isShow=!t.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(i=>i.isShow).map(i=>i.key),this.ColumnName=this.FilterColumns.reduce((i,t)=>(t.isShow&&(i[t.key]=t.value),i),{}),localStorage.setItem("DathangColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(i){let t=i.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(e=>e.value.toLowerCase().includes(t))}create(){this.drawer.open(),this._router.navigate(["admin/dathang",0])}goToDetail(i){this._DathangService.setDathangId(i.id),this.drawer.open(),this._router.navigate(["admin/dathang",i.id])}LoadDrive(){return w(this,null,function*(){let i={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"SPImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},t=yield this._GoogleSheetService.getDrive(i),e=Bt(t.values);console.log(e),this.DoImportData(e)})}DoImportData(i){console.log(i);let e=i.map(u=>({title:u.title?.trim()||"",masp:u.masp?.trim()||"",slug:`${Pt(u?.title?.trim()||"")}_${At(5,!1)}`,giagoc:Number(u.giagoc)||0,dvt:u.dvt||"",soluong:Number(u.soluong)||0,soluongkho:Number(u.soluongkho)||0,ghichu:u.ghichu||"",order:Number(u.order)||0})).filter((u,y,x)=>y===x.findIndex(he=>he.masp===u.masp)),o=e.map(u=>u.masp),m=this._DathangService.ListDathang().map(u=>u.masp),s=o.filter(u=>!m.includes(u)),h=e.map(u=>w(this,null,function*(){let y=this._DathangService.ListDathang().find(x=>x.masp===u.masp);if(y){let x=$($({},y),u);yield this._DathangService.updateDathang(x)}else yield this._DathangService.CreateDathang(u)})),_e=s.map(u=>w(this,null,function*(){let y=this._DathangService.ListDathang().find(x=>x.masp===u);y.isActive=!1,yield this._DathangService.updateDathang(y)}));Promise.all([...h,..._e]).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ImporExcel(i){return w(this,null,function*(){let t=yield se(i);this.DoImportData(t)})}ExportExcel(i,t){return w(this,null,function*(){yield this._NhacungcapService.getAllNhacungcap(),yield this._SanphamService.getAllSanpham(),yield this._BanggiaService.getAllBanggia();let e=yield this._SanphamService.getNhucau();console.log(e);let o=this._NhacungcapService.ListNhacungcap().map(h=>({manccold:h.manccold,name:h.name,mancc:h.mancc})),m=this._SanphamService.ListSanpham().map(h=>({subtitle:h.subtitle,masp:h.masp,title:h.title,dvt:h.dvt})),s=this._BanggiaService.ListBanggia().map(h=>({mabanggia:h.mabanggia,title:h.title}));le({SP:m,NCC:o,BG:s},t)})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=W({type:a,selectors:[["app-listdathang"]],viewQuery:function(t,e){if(t&1&&(b(A,5),b(O,5),b(Se,7)),t&2){let o;k(o=F())&&(e.paginator=o.first),k(o=F())&&(e.sort=o.first),k(o=F())&&(e.drawer=o.first)}},decls:65,vars:26,consts:[["drawer",""],["menu","matMenu"],["uploadfile",""],["pickerBatdau",""],["pickerKetthuc",""],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[1,"cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","p-2","bg-white","rounded-lg"],[1,"flex","flex-row","space-x-2","items-center"],["matTooltip","Th\xEAm m\u1EDBi","mat-flat-button","",1,"flex","flex-row","items-center","btn-primary",3,"click"],[1,"whitespace-nowrap"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","B\u1ED9 L\u1ECDc","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i l\xEAn file excel","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],["matTooltip","T\u1EA3i d\u1EEF li\u1EC7u t\u1EEB drive","color","primary","mat-icon-button","",3,"click"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],["class","w-full grid grid-cols-2 gap-2 lg:flex lg:flex-row lg:space-x-2 items-center",4,"ngIf"],[3,"appearance","subscriptSizing"],["matInput","",3,"dateChange","ngModelChange","matDatepicker","ngModel","ngModelOptions"],["matIconSuffix","",3,"for"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"class","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],[1,"w-full","grid","grid-cols-2","gap-2","lg:flex","lg:flex-row","lg:space-x-2","items-center"],["appearance","outline","subscriptSizing","dynamic",4,"ngFor","ngForOf"],["appearance","outline","subscriptSizing","dynamic"],["matInput","",3,"keyup","ngModelChange","ngModel","ngModelOptions","placeholder"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","font-bold",3,"ngClass"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,e){if(t&1){let o=M();n(0,"mat-drawer-container",5)(1,"mat-drawer",6,0),v(3,"router-outlet"),r(),n(4,"div",7)(5,"div",8)(6,"div",9)(7,"button",10),f("click",function(){return g(o),_(e.create())}),n(8,"mat-icon"),p(9,"add_circle"),r(),n(10,"span",11),p(11,"T\u1EA1o M\u1EDBi"),r()(),n(12,"button",12)(13,"mat-icon"),p(14,"tune"),r()(),n(15,"mat-menu",null,1)(17,"div",13)(18,"mat-form-field",14)(19,"input",15),f("input",function(s){return g(o),_(e.doFilterColumns(s))})("click",function(s){return g(o),_(s.stopPropagation())}),r(),n(20,"mat-icon",16),p(21,"search"),r()()(),n(22,"div",17),z(23,De,5,2,"button",18,we),r()(),n(25,"button",19),f("click",function(){return g(o),_(e.isFilter=!e.isFilter)}),n(26,"mat-icon"),p(27,"filter_list"),r()(),n(28,"button",20),f("click",function(){return g(o),_(e.ExportExcel(e.Listdathang(),"Dathang"))}),n(29,"mat-icon"),p(30,"file_download"),r()(),n(31,"button",21),f("click",function(){g(o);let s=T(35);return _(s.click())}),n(32,"mat-icon"),p(33,"file_upload"),r()(),n(34,"input",22,2),f("change",function(s){return g(o),_(e.ImporExcel(s))}),r(),n(36,"button",23),f("click",function(){return g(o),_(e.LoadDrive())}),n(37,"mat-icon"),p(38,"cloud_download"),r()(),n(39,"span",24),p(40),r()()(),D(41,Me,2,1,"div",25),n(42,"div",9)(43,"mat-form-field",26)(44,"mat-label"),p(45,"B\u1EAFt \u0110\u1EA7u"),r(),n(46,"input",27),f("dateChange",function(s){return g(o),_(e.onDateChange(s))}),N("ngModelChange",function(s){return g(o),V(e.SearchParams.Batdau,s)||(e.SearchParams.Batdau=s),_(s)}),r(),v(47,"mat-datepicker-toggle",28)(48,"mat-datepicker",null,3),r(),n(50,"mat-form-field",26)(51,"mat-label"),p(52,"K\u1EBFt Th\xFAc"),r(),n(53,"input",27),f("dateChange",function(s){return g(o),_(e.onDateChange(s))}),N("ngModelChange",function(s){return g(o),V(e.SearchParams.Ketthuc,s)||(e.SearchParams.Ketthuc=s),_(s)}),r(),v(54,"mat-datepicker-toggle",28)(55,"mat-datepicker",null,4),r()(),n(57,"div",29)(58,"table",30),z(59,$e,3,1,"ng-container",31,J),D(61,Re,1,0,"tr",32)(62,ze,1,3,"tr",33)(63,Ke,3,0,"tr",34),r()(),v(64,"mat-paginator",35),r()()}if(t&2){let o=T(16),m=T(49),s=T(56);l(),d("position","end"),l(11),d("matMenuTriggerFor",o),l(11),K(e.FilterColumns),l(2),q(e.isFilter?"!bg-slate-200":""),l(15),C(" ",e.CountItem," \u0110\u01A1n \u0110\u1EB7t H\xE0ng "),l(),d("ngIf",e.isFilter),l(2),d("appearance","outline")("subscriptSizing","dynamic"),l(3),d("matDatepicker",m),I("ngModel",e.SearchParams.Batdau),d("ngModelOptions",E(23,Q)),l(),d("for",m),l(3),d("appearance","outline")("subscriptSizing","dynamic"),l(3),d("matDatepicker",s),I("ngModel",e.SearchParams.Ketthuc),d("ngModelOptions",E(24,Q)),l(),d("for",s),l(4),d("dataSource",e.dataSource()),l(),K(e.displayedColumns),l(2),d("matHeaderRowDef",e.displayedColumns),l(),d("matRowDefColumns",e.displayedColumns),l(2),d("pageSizeOptions",E(25,ye))}},dependencies:[Lt,Ft,Et,bt,kt,Vt,It,ne,Gt,jt,Xt,Zt,Jt,te,Ut,Yt,ee,ie,ae,qt,O,Wt,Qt,A,wt,yt,St,xt,ht,gt,_t,rt,Ct,ft,ut,ct,pt,Nt,ot,et,it,at,nt,Tt,Dt,vt,Mt,Ht,Kt,zt,Ot,$t,Rt],encapsulation:2})};export{ge as a};
