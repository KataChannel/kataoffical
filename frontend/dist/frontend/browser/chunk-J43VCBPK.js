import{a as n}from"./chunk-Q7E7WSHM.js";import{b as d}from"./chunk-QYNNMSGC.js";import{c as p}from"./chunk-73ZEMMRK.js";import{Ta as i,ka as h,pa as g}from"./chunk-JNMBO34G.js";import{j as e}from"./chunk-6DYNGEAS.js";var l=class c{constructor(r,t){this._StorageService=r;this.router=t}ListBanggia=i([]);DetailBanggia=i({});banggiaId=i(null);setBanggiaId(r){this.banggiaId.set(r)}importBGKH(r){return e(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},o=yield fetch(`${n.APIURL}/banggia/importbgkh`,t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let a=yield o.json();o.ok||this.handleError(o.status),this.getAllBanggia()}catch(t){return console.error(t)}})}importSPBG(r){return e(this,null,function*(){try{let o=[];for(let a=0;a<r.length;a+=10)o.push(r.slice(a,a+10));for(let a of o){let y={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},s=yield fetch(`${n.APIURL}/banggia/importspbg`,y);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);let f=yield s.json();s.ok||this.handleError(s.status)}this.getAllBanggia()}catch(t){return console.error(t)}})}ImportBanggia(r){return e(this,null,function*(){console.log("bg",r);try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},o=yield fetch(`${n.APIURL}/banggia/import`,t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let a=yield o.json();o.ok||this.handleError(o.status),this.getAllBanggia()}catch(t){return console.error(t)}})}CreateBanggia(r){return e(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},o=yield fetch(`${n.APIURL}/banggia`,t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let a=yield o.json();o.ok||this.handleError(o.status),this.getAllBanggia(),this.banggiaId.set(a.id)}catch(t){return console.error(t)}})}getAllBanggia(){return e(this,null,function*(){try{let r={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},t=yield fetch(`${n.APIURL}/banggia`,r);t.ok||this.handleError(t.status);let o=yield t.json();return this.ListBanggia.set(o),o}catch(r){console.error(r)}})}getAllBGSP(){return e(this,null,function*(){try{let r={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},t=yield fetch(`${n.APIURL}/banggia/getbgsp`,r);return t.ok||this.handleError(t.status),yield t.json()}catch(r){console.error(r)}})}getAllBGKH(){return e(this,null,function*(){try{let r={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},t=yield fetch(`${n.APIURL}/banggia/getbgkh`,r);return t.ok||this.handleError(t.status),yield t.json()}catch(r){console.error(r)}})}handleError(r){let t="L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh";switch(r){case 401:t="Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i";break;case 403:t="B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp";break;case 500:t="L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau";break}let o=JSON.stringify({code:r,title:t});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}getBanggiaByid(r){return e(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},o=yield fetch(`${n.APIURL}/banggia/findid/${r}`,t);o.ok||this.handleError(o.status);let a=yield o.json();this.DetailBanggia.set(a)}catch(t){return console.error(t)}})}updateBanggia(r){return e(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},o=yield fetch(`${n.APIURL}/banggia/${r.id}`,t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let a=yield o.json();o.ok||this.handleError(o.status),this.getAllBanggia(),this.getBanggiaByid(r.id)}catch(t){return console.error(t)}})}DeleteBanggia(r){return e(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json"}},o=yield fetch(`${n.APIURL}/banggia/${r.id}`,t);o.ok||this.handleError(o.status),this.getAllBanggia()}catch(t){return console.error(t)}})}addKHtoBG(r){return e(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},o=yield fetch(`${n.APIURL}/banggia/addKHtoBG`,t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let a=yield o.json();o.ok,this.getBanggiaByid(r.banggiaId)}catch(t){return console.error(t)}})}removeKHfromBG(r){return e(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},o=yield fetch(`${n.APIURL}/banggia/removeKHfromBG`,t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let a=yield o.json();o.ok,this.getBanggiaByid(r.banggiaId)}catch(t){return console.error(t)}})}static \u0275fac=function(t){return new(t||c)(g(d),g(p))};static \u0275prov=h({token:c,factory:c.\u0275fac,providedIn:"root"})};export{l as a};
