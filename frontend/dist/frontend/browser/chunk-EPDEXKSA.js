import{a as Vt,b as qt}from"./chunk-GTN5WOSG.js";import{a as Rt}from"./chunk-3CZUXAA7.js";import{a as Ut}from"./chunk-4TQCSZLS.js";import{a as Yt}from"./chunk-E3NTFF7U.js";import{a as Gt}from"./chunk-HUM6PFW2.js";import{a as $t}from"./chunk-3XKS5YCM.js";import{a as jt}from"./chunk-QZXTDKRT.js";import{a as Ot}from"./chunk-SNJ2T5K4.js";import{a as Ht}from"./chunk-66TNAYWZ.js";import{a as ft}from"./chunk-DH3BZ7AE.js";import{a as Lt}from"./chunk-4ZVJO4SQ.js";import{b as Nt,g as Ft,h as F}from"./chunk-ZJWFFP6L.js";import{a as zt}from"./chunk-HBRAORIW.js";import{b as xt,c as Bt,d as Pt,e as Tt,g as At,w as Mt}from"./chunk-QDEULWY5.js";import{a as Dt}from"./chunk-7VE7GFYV.js";import{a as kt,b as _t,c as wt,h as X}from"./chunk-CUQ6QKAF.js";import{a as it}from"./chunk-ZW44ZSN2.js";import{c as St}from"./chunk-ZDGAGPNI.js";import{b as vt}from"./chunk-DCE357X5.js";import{a as Kt}from"./chunk-FGZC2PIB.js";import{a as aa}from"./chunk-JNVUT6FC.js";import{d as yt}from"./chunk-L6E4ZXPP.js";import{a as q,b as Q}from"./chunk-ZJKHI5OQ.js";import{g as bt,j as Ct,n as J,v as Et,y as It}from"./chunk-MZSAWWIW.js";import{a as D}from"./chunk-VUZTNYK4.js";import{a as V,b as dt}from"./chunk-7U2T4VS7.js";import{a as R,e as U}from"./chunk-I4ICTC7O.js";import{y as ut}from"./chunk-UN7UZB5W.js";import{c as H}from"./chunk-WDMWHZJL.js";import{l as Y,m as j,u as G}from"./chunk-XQ7FWWG3.js";import{Ac as $,Eb as z,Ec as at,Fc as p,Gc as N,Hc as B,Kc as ct,Lb as k,Lc as mt,Mc as pt,Ra as C,Vb as y,Yc as lt,_b as rt,fc as m,gc as c,ia as ot,ic as st,jc as ht,lc as M,ld as gt,na as A,oa as f,qc as _,rb as l,sc as w,wb as tt,xa as v,ya as L,yc as K,zc as O}from"./chunk-OSJESZB6.js";import{a as x,b as P,g as ta,j as d}from"./chunk-6DYNGEAS.js";var W=class h{constructor(a,t,i,e){this._StorageService=a;this.router=t;this._ErrorLogService=i;this._sharedSocketService=e;this.socket=this._sharedSocketService.getSocket(),this.listenImportdataUpdates()}socket;_snackBar=f(V);ListImportdata=C([]);DetailImportdata=C({});page=C(1);pageCount=C(1);total=C(0);pageSize=C(10);importdataId=C(null);initDB(){return d(this,null,function*(){return yield Lt("ImportdataDB",4,{upgrade(a,t){t<1&&a.createObjectStore("importdatas",{keyPath:"id"}),t<3&&(a.objectStoreNames.contains("importdatas")&&a.deleteObjectStore("importdatas"),a.objectStoreNames.contains("pagination")&&a.deleteObjectStore("pagination"),a.createObjectStore("importdatas",{keyPath:"id"})),t<4}})})}saveImportdatas(a,t){return d(this,null,function*(){let e=(yield this.initDB()).transaction("importdatas","readwrite"),n=e.objectStore("importdatas");yield n.clear(),yield n.put({id:"data",importdatas:a,pagination:t}),yield e.done})}getCachedData(){return d(this,null,function*(){let t=yield(yield this.initDB()).get("importdatas","data");return t&&t.importdatas?{importdatas:t.importdatas,pagination:t.pagination||{page:1,pageCount:1,total:t.importdatas.length,pageSize:10}}:{importdatas:[],pagination:{page:1,pageCount:1,total:0,pageSize:10}}})}setImportdataId(a){this.importdataId.set(a)}CreateImportdata(a){return d(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(a)},i=yield fetch(`${D.APIURL}/importdata`,t);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);let e=yield i.json();this.getAllImportdata(this.pageSize()),this.importdataId.set(e.id)}catch(t){this._ErrorLogService.logError("Failed to CreateImportdata",t),console.error(t)}})}getAllImportdata(){return d(this,arguments,function*(a=this.pageSize(),t=!1){this.pageSize.set(a);let i=yield this.getCachedData(),e=this._StorageService.getItem("importdatas_updatedAt")||"0";if(!t&&i.importdatas.length>0&&Date.now()-new Date(e).getTime()<5*60*1e3)return this.ListImportdata.set(i.importdatas),this.page.set(i.pagination.page),this.pageCount.set(i.pagination.pageCount),this.total.set(i.pagination.total),this.pageSize.set(i.pagination.pageSize),i.importdatas;try{let n={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}};if(!t){let I=yield fetch(`${D.APIURL}/importdata/lastupdated`,n);if(!I.ok)return this.handleError(I.status),this.ListImportdata.set(i.importdatas),this.page.set(i.pagination.page),this.pageCount.set(i.pagination.pageCount),this.total.set(i.pagination.total),this.pageSize.set(i.pagination.pageSize),i.importdatas;let{updatedAt:T}=yield I.json();if(T<=e)return this.ListImportdata.set(i.importdatas),this.page.set(i.pagination.page),this.pageCount.set(i.pagination.pageCount),this.total.set(i.pagination.total),this.pageSize.set(i.pagination.pageSize),i.importdatas}let s=new URLSearchParams({page:this.page().toString(),limit:a.toString()}),r=yield fetch(`${D.APIURL}/importdata?${s}`,n);if(!r.ok)return this.handleError(r.status),this.ListImportdata.set(i.importdatas),this.page.set(i.pagination.page),this.pageCount.set(i.pagination.pageCount),this.total.set(i.pagination.total),this.pageSize.set(i.pagination.pageSize),i.importdatas;let u=yield r.json();if(yield this.saveImportdatas(u.data,{page:u.page||1,pageCount:u.pageCount||1,total:u.total||u.data.length,pageSize:a}),t)this._StorageService.setItem("importdatas_updatedAt",new Date().toISOString());else{let I=yield fetch(`${D.APIURL}/importdata/lastupdated`,n),{updatedAt:T}=yield I.json();this._StorageService.setItem("importdatas_updatedAt",T)}return this.ListImportdata.set(u.data),this.page.set(u.page||1),this.pageCount.set(u.pageCount||1),this.total.set(u.total||u.data.length),this.pageSize.set(a),u.data}catch(n){return this._ErrorLogService.logError("Failed to getAllImportdata",n),console.error(n),this.ListImportdata.set(i.importdatas),this.page.set(i.pagination.page),this.pageCount.set(i.pagination.pageCount),this.total.set(i.pagination.total),this.pageSize.set(i.pagination.pageSize),i.importdatas}})}getUpdatedCodeIds(){return d(this,null,function*(){try{let a={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},t=yield fetch(`${D.APIURL}/importdata/updateCodeIds`,a);t.ok||this.handleError(t.status);let i=yield t.json();return this.getAllImportdata(this.pageSize()),i.data}catch(a){this._ErrorLogService.logError("Failed to getUpdatedCodeIds",a),console.error(a)}})}listenImportdataUpdates(){this.socket.off("importdata-updated"),this.socket.on("importdata-updated",()=>d(this,null,function*(){console.log("\u{1F504} D\u1EEF li\u1EC7u s\u1EA3n ph\u1EA9m thay \u0111\u1ED5i, c\u1EADp nh\u1EADt l\u1EA1i cache..."),this._StorageService.removeItem("importdatas_updatedAt"),yield this.getAllImportdata()}))}getImportdataBy(i){return d(this,arguments,function*(a,t=this.pageSize()){this.pageSize.set(t);try{let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(P(x({},a),{page:this.page(),limit:t}))},n=yield fetch(`${D.APIURL}/importdata/findby`,e);n.ok||this.handleError(n.status);let s=yield n.json();a.isOne===!0?this.DetailImportdata.set(s):(yield this.saveImportdatas(s.data,{page:s.page||1,pageCount:s.pageCount||1,total:s.total||s.data.length,pageSize:t}),this._StorageService.setItem("importdatas_updatedAt",new Date().toISOString()),this.ListImportdata.set(s.data),this.page.set(s.page||1),this.pageCount.set(s.pageCount||1),this.total.set(s.total||s.data.length),this.pageSize.set(t))}catch(e){this._ErrorLogService.logError("Failed to getImportdataBy",e),console.error(e);let n=yield this.getCachedData();a.isOne||(this.ListImportdata.set(n.importdatas),this.page.set(n.pagination.page),this.pageCount.set(n.pagination.pageCount),this.total.set(n.pagination.total),this.pageSize.set(n.pagination.pageSize))}})}updateImportdata(a){return d(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(a)},i=yield fetch(`${D.APIURL}/importdata/${a.id}`,t);i.ok||this.handleError(i.status);let e=yield i.json();this.getAllImportdata(this.pageSize()),this.getImportdataBy({id:e.id,isOne:!0},this.pageSize())}catch(t){this._ErrorLogService.logError("Failed to updateImportdata",t),console.error(t)}})}DeleteImportdata(a){return d(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`}},i=yield fetch(`${D.APIURL}/importdata/${a.id}`,t);i.ok||this.handleError(i.status),this.getAllImportdata(this.pageSize())}catch(t){this._ErrorLogService.logError("Failed to DeleteImportdata",t),console.error(t)}})}handleError(a){let t="L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh";switch(a){case 400:t="Th\xF4ng tin \u0111\xE3 t\u1ED3n t\u1EA1i";break;case 401:case 404:t="Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i";break;case 403:t="B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp";break;case 500:t="L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau";break}this._snackBar.open(t,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}static \u0275fac=function(t){return new(t||h)(A(dt),A(H),A(Dt),A(Ot))};static \u0275prov=ot({token:h,factory:h.\u0275fac,providedIn:"root"})};var S=ta(aa());function ra(h,a){if(h&1&&(m(0,"li"),p(1),c()),h&2){let t=a.$implicit,i=w(2);l(),B(" ",i.getItemDisplayName(t)," ")}}function sa(h,a){if(h&1&&(m(0,"li",17),p(1),c()),h&2){let t=w(2);l(),B(" ... v\xE0 ",t.data.duplicateItems.length-5," m\u1EE5c kh\xE1c ")}}function ha(h,a){if(h&1&&(m(0,"div",11)(1,"p",12)(2,"mat-icon",13),p(3,"error"),c(),p(4),c(),m(5,"ul",14),k(6,ra,2,1,"li",15)(7,sa,2,1,"li",16),c()()),h&2){let t=w();l(4),B(" Ph\xE1t hi\u1EC7n ",t.data.duplicateItems.length," m\u1EE5c tr\xF9ng l\u1EB7p: "),l(2),y("ngForOf",t.data.duplicateItems.slice(0,5)),l(),y("ngIf",t.data.duplicateItems.length>5)}}function ca(h,a){h&1&&(m(0,"div",23),p(1," \u26A0\uFE0F D\u1EEF li\u1EC7u c\u0169 s\u1EBD b\u1ECB thay th\u1EBF b\u1EDFi d\u1EEF li\u1EC7u m\u1EDBi "),c())}function ma(h,a){h&1&&(m(0,"div",17),p(1," \u2139\uFE0F Ch\u1EC9 th\xEAm m\u1EDBi c\xE1c m\u1EE5c ch\u01B0a t\u1ED3n t\u1EA1i, b\u1ECF qua c\xE1c m\u1EE5c tr\xF9ng l\u1EB7p "),c())}function pa(h,a){if(h&1){let t=M();m(0,"div",18)(1,"mat-checkbox",19),pt("ngModelChange",function(e){v(t);let n=w();return mt(n.data.isOverwrite,e)||(n.data.isOverwrite=e),L(e)}),m(2,"span",20),p(3,"Ghi \u0111\xE8 l\xEAn d\u1EEF li\u1EC7u c\u0169 (c\xE1c m\u1EE5c tr\xF9ng l\u1EB7p s\u1EBD \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt)"),c()(),m(4,"div",21),k(5,ca,2,0,"div",22)(6,ma,2,0,"div",16),c()()}if(h&2){let t=w();l(),ct("ngModel",t.data.isOverwrite),l(4),y("ngIf",t.data.isOverwrite),l(),y("ngIf",!t.data.isOverwrite)}}function la(h,a){h&1&&(m(0,"div",24)(1,"div",25)(2,"mat-icon",26),p(3,"check_circle"),c(),m(4,"span"),p(5,"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u tr\xF9ng l\u1EB7p. T\u1EA5t c\u1EA3 s\u1EBD \u0111\u01B0\u1EE3c th\xEAm m\u1EDBi."),c()()())}var Z=class h{constructor(a,t){this.dialogRef=a;this.data=t}getItemDisplayName(a){switch(this.data.dataType){case"S\u1EA3n Ph\u1EA9m":return`${a.masp} - ${a.title}`;case"Kh\xE1ch H\xE0ng":return`${a.makh} - ${a.name}`;case"Nh\xE0 Cung C\u1EA5p":return`${a.mancc} - ${a.name}`;case"B\u1EA3ng Gi\xE1":return`${a.mabanggia} - ${a.title}`;default:return a.name||a.title||a.id||"N/A"}}onConfirm(){this.dialogRef.close({confirmed:!0,overwrite:this.data.isOverwrite})}onCancel(){this.dialogRef.close({confirmed:!1,overwrite:!1})}static \u0275fac=function(t){return new(t||h)(tt(kt),tt(_t))};static \u0275cmp=z({type:h,selectors:[["app-import-confirmation-dialog"]],decls:31,vars:7,consts:[[1,"p-6","min-w-96"],[1,"flex","items-center","mb-4"],[1,"text-orange-500","mr-2"],[1,"text-lg","font-semibold"],[1,"mb-4","text-gray-700"],["class","mt-3",4,"ngIf"],["class","mb-6",4,"ngIf"],["class","mb-4 p-3 bg-green-50 border border-green-200 rounded",4,"ngIf"],[1,"flex","justify-end","space-x-3","mt-6"],["mat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"mt-3"],[1,"text-red-600","font-medium"],[1,"text-red-500","text-sm"],[1,"list-disc","list-inside","text-sm","text-gray-600","mt-2","max-h-32","overflow-y-auto"],[4,"ngFor","ngForOf"],["class","text-blue-600",4,"ngIf"],[1,"text-blue-600"],[1,"mb-6"],[1,"text-sm",3,"ngModelChange","ngModel"],[1,"ml-2"],[1,"mt-2","text-sm","text-gray-600"],["class","text-orange-600",4,"ngIf"],[1,"text-orange-600"],[1,"mb-4","p-3","bg-green-50","border","border-green-200","rounded"],[1,"flex","items-center","text-green-700"],[1,"text-green-500","mr-2"]],template:function(t,i){t&1&&(m(0,"div",0)(1,"div",1)(2,"mat-icon",2),p(3,"warning"),c(),m(4,"h2",3),p(5,"X\xE1c nh\u1EADn Import D\u1EEF li\u1EC7u"),c()(),m(6,"div",4)(7,"p")(8,"strong"),p(9,"Lo\u1EA1i d\u1EEF li\u1EC7u:"),c(),p(10),c(),m(11,"p")(12,"strong"),p(13,"D\u1EEF li\u1EC7u hi\u1EC7n t\u1EA1i:"),c(),p(14),c(),m(15,"p")(16,"strong"),p(17,"D\u1EEF li\u1EC7u m\u1EDBi:"),c(),p(18),c(),k(19,ha,8,3,"div",5),c(),k(20,pa,7,3,"div",6)(21,la,6,0,"div",7),m(22,"div",8)(23,"button",9),_("click",function(){return i.onCancel()}),m(24,"mat-icon"),p(25,"cancel"),c(),p(26," H\u1EE7y b\u1ECF "),c(),m(27,"button",10),_("click",function(){return i.onConfirm()}),m(28,"mat-icon"),p(29,"file_upload"),c(),p(30),c()()()),t&2&&(l(10),B(" ",i.data.dataType,""),l(4),B(" ",i.data.existingCount," m\u1EE5c"),l(4),B(" ",i.data.newCount," m\u1EE5c"),l(),y("ngIf",i.data.duplicateItems.length>0),l(),y("ngIf",i.data.duplicateItems.length>0),l(),y("ngIf",i.data.duplicateItems.length===0),l(9),B(" ",i.data.duplicateItems.length>0?i.data.isOverwrite?"Import & Ghi \u0111\xE8":"Import & B\u1ECF qua tr\xF9ng l\u1EB7p":"Import"," "))},dependencies:[X,U,R,Q,q,G,Y,j,qt,Vt,J,bt,Ct],encapsulation:2})};var ga=["drawer"];function ua(h,a){h&1&&(m(0,"mat-icon"),p(1,"check"),c())}function da(h,a){if(h&1){let t=M();m(0,"span",16),_("click",function(){let e=v(t).$implicit,n=w();return L(n.toggleItem(e))}),k(1,ua,2,0,"mat-icon",17),m(2,"span"),p(3),c()()}if(h&2){let t=a.$implicit,i=w();rt("",t.status?"":"hidden"," ",i.CheckItem(t)?"bg-blue-100":""," cursor-pointer flex flex-row space-x-2 items-center p-4 rounded-lg border"),l(),y("ngIf",i.CheckItem(t)),l(2),N(t.title)}}function fa(h,a){if(h&1&&(m(0,"div",19)(1,"span",20),p(2),c(),m(3,"span"),p(4),c(),m(5,"span",21),p(6),c()()),h&2){let t=a.$implicit;l(2),N(t.type),l(2),N(t.title),l(2),N(t.description)}}function Sa(h,a){if(h&1&&(st(0),k(1,fa,7,3,"div",18),ht()),h&2){let t=w();l(),y("ngForOf",t.ListImportdata())}}function ya(h,a){h&1&&(m(0,"div",22)(1,"span",23),p(2,"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),c()())}var E=class{static checkDuplicates(a,t,i){let e=new Set(t.map(n=>n[i]));return a.filter(n=>e.has(n[i]))}static prepareSanphamData(a,t,i){if(i)return a;{let e=new Set(t.map(n=>n.masp));return a.filter(n=>!e.has(n.masp))}}static prepareKhachhangData(a,t,i){if(i)return a;{let e=new Set(t.map(n=>n.makh));return a.filter(n=>!e.has(n.makh))}}static prepareNhacungcapData(a,t,i){if(i)return a;{let e=new Set(t.map(n=>n.mancc));return a.filter(n=>!e.has(n.mancc))}}static prepareBanggiaData(a,t,i){if(i)return a;{let e=new Set(t.map(n=>n.mabanggia));return a.filter(n=>!e.has(n.mabanggia))}}},Jt=class h{displayedColumns=[];ColumnName={stt:"#",codeId:"Code",name:"Ti\xEAu \u0110\u1EC1",group:"Nh\xF3m",description:"M\xF4 T\u1EA3",status:"Tr\u1EA1ng Th\xE1i",order:"Th\u1EE9 T\u1EF1",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("ImportdataColFilter")||"[]");Columns=[];paginator;sort;drawer;_BanggiaService=f($t);_SanphamService=f(Ht);_KhachhangService=f(jt);_NhacungcapService=f(Gt);_DonhangService=f(Kt);_DathangService=f(Yt);_PhieukhoService=f(Rt);_UserService=f(ft);_KhoService=f(Ut);_ImportdataService=f(W);_breakpointObserver=f(ut);_GoogleSheetService=f(zt);_router=f(H);_dialog=f(wt);_snackBar=f(V);ListImportType=C([{id:1,title:"S\u1EA3n Ph\u1EA9m",value:"sanpham",status:!0},{id:2,title:"Kh\xE1ch H\xE0ng",value:"khachhang",status:!0},{id:3,title:"Nh\xE0 Cung C\u1EA5p",value:"nhacungcap",status:!0},{id:4,title:"B\u1EA3ng Gi\xE1",value:"banggia",status:!0},{id:5,title:"\u0110\u01A1n H\xE0ng",value:"donhang",status:!0},{id:6,title:"\u0110\u1EB7t H\xE0ng",value:"dathang",status:!0},{id:7,title:"B\u1EA3ng Gi\xE1 Kh\xE1ch H\xE0ng",value:"banggiakhachhang",status:!0},{id:8,title:"B\u1EA3ng Gi\xE1 S\u1EA3n Ph\u1EA9m",value:"banggiasanpham",status:!0},{id:9,title:"Nh\xE0 Cung C\u1EA5p S\u1EA3n Ph\u1EA9m",value:"nhacungcapsanpham",status:!0},{id:10,title:"Xu\u1EA5t Nh\u1EADp T\u1ED3n",value:"xuatnhapton",status:!0}]);ListEdit=C([]);ListImportdata=this._ImportdataService.ListImportdata;TitleExport="export";rawListSP=[];rawListKH=[];rawListNCC=[];rawListBG=[];rawListDH=[];rawListDathang=[];rawListTonkho=[];constructor(){gt(()=>d(this,null,function*(){yield this._ImportdataService.getAllImportdata(100,!0),yield this._SanphamService.getAllSanpham({pageSize:9999},!0),this.rawListSP=this._SanphamService.ListSanpham(),yield this._KhachhangService.getAllKhachhang({pageSize:9999},!0),this.rawListKH=this._KhachhangService.ListKhachhang(),yield this._NhacungcapService.getAllNhacungcap(),this.rawListNCC=this._NhacungcapService.ListNhacungcap(),yield this._BanggiaService.getAllBanggia(),this.rawListBG=this._BanggiaService.ListBanggia(),yield this._DonhangService.getAllDonhang(),this.rawListDH=this._DonhangService.ListDonhang(),yield this._DathangService.getAllDathang(),this.rawListDathang=this._DathangService.ListDathang(),yield this._KhoService.getTonKho("1","1000").then(t=>{this.rawListTonkho=t.data}),yield this._UserService.getProfile();let a=this._UserService.profile()?.permissions?.map(t=>t.name)||[];this.ListImportType.update(t=>t.map(i=>P(x({},i),{status:a.includes("importdata."+i.value)}))),console.log("ListImportType:",this.ListImportType()),console.log("permissions:",a),console.log("this._UserService.profile():",this._UserService.profile())}))}ngOnInit(){return d(this,null,function*(){yield this._ImportdataService.getAllImportdata(100,!0),yield this._SanphamService.getAllSanpham(),this.rawListSP=this._SanphamService.ListSanpham(),yield this._KhachhangService.getAllKhachhang(),this.rawListKH=this._KhachhangService.ListKhachhang(),yield this._NhacungcapService.getAllNhacungcap(),this.rawListNCC=this._NhacungcapService.ListNhacungcap(),yield this._BanggiaService.getAllBanggia(),this.rawListBG=this._BanggiaService.ListBanggia(),yield this._DonhangService.getAllDonhang(),this.rawListDH=this._DonhangService.ListDonhang(),yield this._DathangService.getAllDathang(),this.rawListDathang=this._DathangService.ListDathang(),yield this._KhoService.getTonKho("1","1000").then(a=>{this.rawListTonkho=a.data})})}applyFilter(a){}toggleAll(){this.ListEdit().length===this.ListImportType().length?(this.ListEdit.set([]),this.TitleExport="export"):(this.ListEdit.set(this.ListImportType()),this.TitleExport="export_all")}toggleItem(a){this.ListEdit().findIndex(i=>i.id===a.id)===-1?(this.TitleExport+="_"+a.value,this.ListEdit.update(i=>[...i,a])):(this.TitleExport=this.TitleExport.replace("_"+a.value,""),this.ListEdit.update(i=>i.filter(e=>e.id!==a.id)))}CheckItem(a){return this.ListEdit().findIndex(i=>i.id===a.id)!==-1}ExportExcel(a){return d(this,null,function*(){let t=Array.isArray(this.rawListSP)&&this.rawListSP.length?this.rawListSP.map(o=>({masp:o.masp,subtitle:o.subtitle,title:o.title,title2:o.title2,giaban:o.giaban,giagoc:o.giagoc,dvt:o.dvt,haohut:o.haohut,ghichu:o.ghichu})):[{masp:"",subtitle:"",title:"",title2:"",giaban:"",giagoc:"",dvt:"",haohut:"",ghichu:""}],i=Array.isArray(this.rawListKH)&&this.rawListKH.length?this.rawListKH.map(o=>({name:o.name?.trim()||"",makh:o.makh?.trim()||"",namenn:o.namenn?.trim()||"",mabanggia:o.banggia?.mabanggia?.trim()||"",diachi:o.diachi?.trim()||"",quan:o.quan?.trim()||"",email:o.email?.trim()||"",sdt:o.sdt?.toString().trim()||"",mst:o.mst?.toString().trim()||"",gionhanhang:o.gionhanhang?.toString().trim()||"",loaikh:o.loaikh?.toString().trim()||"khachsi",hiengia:o.hiengia||!0,ghichu:o.ghichu?.toString().trim()||""})):[{name:"",makh:"",namenn:"",diachi:"",quan:"",email:"",sdt:"",mst:"",gionhanhang:"",loaikh:"khachsi",hiengia:!0,ghichu:""}],e=Array.isArray(this.rawListNCC)&&this.rawListNCC.length>0?this.rawListNCC.map(o=>({name:o.name?.trim()||"",mancc:o.mancc?.trim()||"",diachi:o.diachi?.trim()||"",email:o.email?.trim()||"",sdt:o.sdt?.toString().trim()||"",ghichu:o.ghichu?.toString().trim()||""})):[{name:"",mancc:"",diachi:"",email:"",sdt:"",ghichu:""}],n=Array.isArray(this.rawListBG)&&this.rawListBG.length>0?this.rawListBG.map(o=>({title:o.title?.trim()||"",mabanggia:o.mabanggia?.trim()||"",type:o.type?.trim()||"",batdau:(0,S.default)(o.batdau).format("DD/MM/YYYY")||"",ketthuc:(0,S.default)(o.ketthuc).format("DD/MM/YYYY")||"",ghichu:o.ghichu?.trim()||"",status:o.status?.trim()||""})):[{title:"",mabanggia:"",type:"",batdau:"",ketthuc:"",ghichu:"",status:""}],s=Array.isArray(this.rawListDH)&&this.rawListDH.length>0?this.rawListDH.flatMap(o=>Array.isArray(o.sanpham)?o.sanpham.map(g=>({ngaygiao:(0,S.default)(o.ngaygiao).format("DD/MM/YYYY"),makh:o.khachhang?.makh,name:o.khachhang?.name,mabanggia:o.khachhang?.banggia?.[0]?.mabanggia,masp:g.masp,tensp:g.title,sldat:g.sldat,slgiao:g.slgiao,slnhan:g.slnhan,ghichu:g.ghichu})):[]):[{ngaygiao:(0,S.default)().format("DD/MM/YYYY"),makh:"",mabanggia:"",masp:"",tensp:"",sldat:0,slgiao:0,slnhan:0,ghichu:""}],r=Array.isArray(this.rawListDathang)&&this.rawListDathang.length>0?this.rawListDathang.flatMap(o=>Array.isArray(o.sanpham)?o.sanpham.map(g=>({ngaynhan:(0,S.default)(o.ngaynhan).format("DD/MM/YYYY"),mancc:o.nhacungcap?.mancc,name:o.nhacungcap?.name,mabanggia:o.banggia?.[0]?.mabanggia,masp:g.masp,tensp:g.title,sldat:Number(g.sldat)||0,slgiao:Number(g.slgiao)||0,slnhan:Number(g.slnhan)||0,ghichu:g.ghichu})):[]):[{ngaynhan:(0,S.default)().format("DD/MM/YYYY"),mancc:"",name:"",mabanggia:"",masp:"",tensp:"",sldat:0,slgiao:0,slnhan:0,ghichu:""}],u=this.convertBGSPToExport(this.rawListBG,this.rawListSP),I=this.rawListKH.map(o=>({makh:o.makh||"",name:o.name||"",mabanggia:o.banggia?.mabanggia||""})),T=this.rawListSP.reduce((o,g)=>(g&&g.masp&&(o[g.masp]=""),o),{}),Xt=this.rawListNCC.map(o=>{let g={mancc:o.mancc||"",name:o.name||""},et=1;for(let nt of Object.keys(T))o.Sanpham?.some(Zt=>Zt.masp===nt)&&(g[et]=nt,et++);return g}),Wt=this.rawListTonkho.map(o=>({masp:o.masp,title:o.title,dvt:o.dvt,slton:o.slton})),b={};if(this.ListEdit().some(o=>o.value==="sanpham")&&(b.sanpham={data:t}),this.ListEdit().some(o=>o.value==="khachhang")&&(b.khachhang={data:i}),this.ListEdit().some(o=>o.value==="nhacungcap")&&(b.nhacungcap={data:e}),this.ListEdit().some(o=>o.value==="banggia")&&(b.banggia={data:n}),this.ListEdit().some(o=>o.value==="donhang")&&(b.donhang={data:s}),this.ListEdit().some(o=>o.value==="dathang")&&(b.dathang={data:r}),this.ListEdit().some(o=>o.value==="banggiasanpham")&&(b.banggiasanpham={data:u}),this.ListEdit().some(o=>o.value==="banggiakhachhang")&&(b.banggiakhachhang={data:I}),this.ListEdit().some(o=>o.value==="nhacungcapsanpham")&&(b.nhacungcapsanpham={data:Xt}),this.ListEdit().some(o=>o.value==="xuatnhapton")&&(b.xuatnhapton={data:Wt}),Object.keys(b).length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u \u0111\u1EC3 xu\u1EA5t","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]});return}Nt(b,a)})}convertBGSPToExport(a,t){let i=new Set(a.map(e=>e.mabanggia));return t.map(e=>x({masp:e.masp,title:e.title,giaban:e.giaban.toString()},Array.from(i).reduce((n,s)=>(n[s]=e.giaban.toString(),n),{})))}convertBGSPToImport(a){return!a||a.length===0?[]:Object.keys(a[0]).filter(e=>!["masp","title","giagoc"].includes(e)).map(e=>({mabanggia:e,title:`B\u1EA3ng gi\xE1 ${e.replace("BG","")}`,sanpham:a.map(n=>({masp:n.masp?.toString().trim()||"",title:n.title?.toString().trim()||"",giagoc:n.giagoc||0,giaban:n[e]||0}))}))}convertNCCSPToImport(a){if(!a||a.length===0)return[];let t=Object.keys(a[0]).filter(i=>!["mancc","name"].includes(i));return a.forEach(i=>{i.Sanpham=[];for(let e of t)i[e]!==void 0&&i[e]!==null&&i[e]!==""&&i.Sanpham.push(i[e]),delete i[e]}),a}ImportExcel(a){return d(this,null,function*(){let t=yield Ft(a);this.DoImportData(t)})}showImportConfirmDialog(a,t,i,e){return d(this,null,function*(){return new Promise(n=>{let s={dataType:a,existingCount:t,newCount:i,duplicateItems:e,isOverwrite:!1};this._dialog.open(Z,{width:"500px",data:s,disableClose:!0}).afterClosed().subscribe(u=>{n(u||{confirmed:!1,overwrite:!1})})})})}DoImportData(a){return d(this,null,function*(){if(Object.keys(this.ListEdit()).length===0){this._snackBar.open("Ch\u01B0a Ch\u1ECDn Lo\u1EA1i D\u1EEF Li\u1EC7u","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]});return}if(Object.keys(a).length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u \u0111\u1EC3 nh\u1EADp","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]});return}if(a.sanpham&&a.sanpham.length>0&&this.ListEdit().some(t=>t.value==="sanpham")){let t=(a.sanpham||[]).map(r=>({masp:r.masp,subtitle:it((r.title||"")+(r.title2||"")),title:r.title,title2:r.title2,giaban:Number(r.giaban)||Number(r.giagoc)||0,giagoc:Number(r.giagoc)||0,dvt:r.dvt,haohut:Number(r.haohut)||0,ghichu:r.ghichu})).filter(r=>r.masp!==void 0&&r.masp!==null&&r.masp!==""),i=E.checkDuplicates(t,this.rawListSP,"masp"),e=yield this.showImportConfirmDialog("S\u1EA3n Ph\u1EA9m",this.rawListSP.length,t.length,i);if(!e.confirmed)return;let n=E.prepareSanphamData(t,this.rawListSP,e.overwrite);if(n.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let s=this._snackBar.open(`\u0110ang import ${n.length} s\u1EA3n ph\u1EA9m...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{yield this._SanphamService.ImportSanpham(n),s.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${n.length} s\u1EA3n ph\u1EA9m${e.overwrite?" (ghi \u0111\xE8)":" (th\xEAm m\u1EDBi)"}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{s.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import s\u1EA3n ph\u1EA9m","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(a.khachhang&&a.khachhang.length>0&&this.ListEdit().some(t=>t.value==="khachhang")){let t=(a.khachhang||[]).map(r=>({name:r.name.toString(),makh:r.makh,subtitle:it((r.name.toString()||"")+(r.namenn.toString()||"")),namenn:r.namenn.toString(),diachi:r.diachi,quan:r.quan,email:r.email,sdt:r.sdt.toString(),mst:r.mst.toString(),gionhanhang:r.gionhanhang.toString(),loaikh:r.loaikh,ghichu:r.ghichu,hiengia:r.hiengia,mabanggia:r.mabanggia})).filter(r=>r.makh!==void 0&&r.makh!==null&&r.makh!==""),i=E.checkDuplicates(t,this.rawListKH,"makh"),e=yield this.showImportConfirmDialog("Kh\xE1ch H\xE0ng",this.rawListKH.length,t.length,i);if(!e.confirmed)return;let n=E.prepareKhachhangData(t,this.rawListKH,e.overwrite);if(n.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let s=this._snackBar.open(`\u0110ang import ${n.length} kh\xE1ch h\xE0ng...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{yield this._KhachhangService.ImportKhachhang(n),s.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${n.length} kh\xE1ch h\xE0ng${e.overwrite?" (ghi \u0111\xE8)":" (th\xEAm m\u1EDBi)"}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{s.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import kh\xE1ch h\xE0ng","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(a.nhacungcap&&a.nhacungcap.length>0&&this.ListEdit().some(t=>t.value==="nhacungcap")){let t=(a.nhacungcap||[]).map(r=>({name:r.name,mancc:r.mancc,diachi:r.diachi,email:r.email,sdt:r.sdt.toString(),ghichu:r.ghichu})).filter(r=>r.mancc!==void 0&&r.mancc!==null&&r.mancc!==""),i=E.checkDuplicates(t,this.rawListNCC,"mancc"),e=yield this.showImportConfirmDialog("Nh\xE0 Cung C\u1EA5p",this.rawListNCC.length,t.length,i);if(!e.confirmed)return;let n=E.prepareNhacungcapData(t,this.rawListNCC,e.overwrite);if(n.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let s=this._snackBar.open(`\u0110ang import ${n.length} nh\xE0 cung c\u1EA5p...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{yield this._NhacungcapService.ImportNhacungcap(n),s.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${n.length} nh\xE0 cung c\u1EA5p${e.overwrite?" (ghi \u0111\xE8)":" (th\xEAm m\u1EDBi)"}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{s.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import nh\xE0 cung c\u1EA5p","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(a.banggia&&a.banggia.length>0&&this.ListEdit().some(t=>t.value==="banggia")){let t=(a.banggia||[]).map(r=>({title:"B\u1EA3ng Gi\xE1 "+r.mabanggia,mabanggia:r.mabanggia,type:r.type,batdau:(0,S.default)(F(r.batdau)).toDate(),ketthuc:(0,S.default)(F(r.ketthuc)).toDate(),ghichu:r.ghichu,status:r.status})).filter(r=>r.mabanggia!==void 0&&r.mabanggia!==null&&r.mabanggia!==""),i=E.checkDuplicates(t,this.rawListBG,"mabanggia"),e=yield this.showImportConfirmDialog("B\u1EA3ng Gi\xE1",this.rawListBG.length,t.length,i);if(!e.confirmed)return;let n=E.prepareBanggiaData(t,this.rawListBG,e.overwrite);if(n.length===0){this._snackBar.open("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u m\u1EDBi \u0111\u1EC3 import","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let s=this._snackBar.open(`\u0110ang import ${n.length} b\u1EA3ng gi\xE1...`,"",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{yield this._BanggiaService.ImportBanggia(n),s.dismiss(),this._snackBar.open(`Import th\xE0nh c\xF4ng ${n.length} b\u1EA3ng gi\xE1${e.overwrite?" (ghi \u0111\xE8)":" (th\xEAm m\u1EDBi)"}!`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{s.dismiss(),this._snackBar.open("C\xF3 l\u1ED7i x\u1EA3y ra khi import b\u1EA3ng gi\xE1","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}if(a.donhang&&a.donhang.length>0&&this.ListEdit().some(t=>t.value==="donhang")){let t=(a.donhang||[]).map(e=>({ngay:e.ngay,makh:e.makh,mabangia:e.mabangia,masp:e.masp,sldat:Number(e.sldat),slgiao:Number(e.slgiao),slnhan:Number(e.slnhan),ghichu:e.ghichu})).filter(e=>e.makh!==void 0&&e.makh!==null&&e.makh!==""&&e.masp!==void 0&&e.masp!==null&&e.masp!==""),i=this._snackBar.open("\u0110ang import \u0110\u01A1n h\xE0ng...","",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});yield this._DonhangService.ImportDonhang(t),i.dismiss(),this._snackBar.open("Import \u0110\u01A1n h\xE0ng th\xE0nh c\xF4ng!","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(a.banggiasanpham&&a.banggiasanpham.length>0&&this.ListEdit().some(t=>t.value==="banggiasanpham")){let t=this.convertBGSPToImport(a.banggiasanpham),i=t.find(n=>n.mabanggia==="giaban");if(!i)return;let e=t.map(n=>{if(n.mabanggia==="giaban")return n;let s=n.sanpham.map(r=>{if(r.giaban==="0"){let u=i.sanpham.find(I=>I.masp===r.masp);return P(x({},r),{giaban:u?u.giaban:r.giaban})}return r});return P(x({},n),{sanpham:s})});yield this._BanggiaService.importSPBG(e)}if(a.banggiakhachhang&&a.banggiakhachhang.length>0&&this.ListEdit().some(t=>t.value==="banggiakhachhang")){console.log("Importing banggiakhachhang data:",a.banggiakhachhang);let t=(a.banggiakhachhang||[]).map(i=>({makh:i.makh,name:i.name,mabanggia:i.mabanggia})).filter(i=>i.mabanggia!==void 0&&i.mabanggia!==null&&i.mabanggia!=="");console.log("Importing ListBGKH data:",t),yield this._KhachhangService.ImportKhachhang(t),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(a.nhacungcapsanpham&&a.nhacungcapsanpham.length>0&&this.ListEdit().some(t=>t.value==="nhacungcapsanpham")){let t=this.convertNCCSPToImport(a.nhacungcapsanpham);console.log(t);let i=t.filter(n=>n?.Sanpham?.length>0).map(n=>P(x({},n),{Sanpham:n?.Sanpham?.map(s=>this.rawListSP.find(r=>r?.masp===s))})),e=this._snackBar.open("\u0110ang import Nh\xE0 cung c\u1EA5p s\u1EA3n ph\u1EA9m...","",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});yield this._NhacungcapService.ImportNhacungcap(i),e.dismiss(),this._snackBar.open("Import Nh\xE0 cung c\u1EA5p s\u1EA3n ph\u1EA9m th\xE0nh c\xF4ng!","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(a.xuatnhapton&&a.xuatnhapton.length>0&&this.ListEdit().some(t=>t.value==="xuatnhapton")){let t=[],i=[];a.xuatnhapton.forEach(e=>{let n=this.rawListTonkho.find(s=>s.masp===e.masp);n&&(e.slton>n.slton?t.push({sanphamId:this.rawListSP.find(s=>s.masp===e.masp).id,soluong:e.slton-n.slton}):e.slton<n.slton&&i.push({sanphamId:this.rawListSP.find(s=>s.masp===e.masp).id,soluong:n.slton-e.slton}))}),t.length>0&&(yield this._PhieukhoService.CreatePhieukho({title:`\u0110i\u1EC1u Ch\u1EC9nh Kho Ng\xE0y ${(0,S.default)().format("DD/MM/YYYY ")}`,type:"nhap",sanpham:t,ghichu:`C\u1EADp nh\u1EADt t\u1ED3n kho l\xFAc ${(0,S.default)().format("HH:mm:ss DD/MM/YYYY ")}`,ngay:(0,S.default)()}),this._snackBar.open("C\u1EADp nh\u1EADt t\u1ED3n kho th\xE0nh c\xF4ng Th\xEAm phi\u1EBFu Nh\u1EADp Kho","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})),i.length>0&&(yield this._PhieukhoService.CreatePhieukho({title:`\u0110i\u1EC1u Ch\u1EC9nh Kho Ng\xE0y ${(0,S.default)().format("DD/MM/YYYY ")}`,type:"xuat",sanpham:i,ghichu:`C\u1EADp nh\u1EADt t\u1ED3n kho l\xFAc ${(0,S.default)().format("HH:mm:ss DD/MM/YYYY ")}`,ngay:(0,S.default)()}),this._snackBar.open("C\u1EADp nh\u1EADt t\u1ED3n kho th\xE0nh c\xF4ng Th\xEAm phi\u1EBFu Xu\u1EA5t Kho","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})),t.length===0&&i.length===0&&this._snackBar.open("Kho kh\xF4ng thay \u0111\u1ED5i","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(a.dathang&&this.ListEdit().some(t=>t.value==="dathang")){let t=(a.dathang||[]).filter(e=>e.mancc&&e.masp).map(e=>({ngaynhan:(0,S.default)(F(e.ngaynhan)).toDate(),mancc:e.mancc,mabanggia:e.mabanggia,masp:e.masp,sldat:Number(e.sldat),slgiao:Number(e.sldat),slnhan:Number(e.sldat),ghichu:e.ghichu}));console.log(t);let i=this._snackBar.open("\u0110ang import \u0110\u1EB7t h\xE0ng...","",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});yield this._DathangService.ImportDathang(t),i.dismiss(),this._snackBar.open("Import \u0110\u1EB7t h\xE0ng th\xE0nh c\xF4ng!","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}if(a.donhang&&this.ListEdit().some(t=>t.value==="donhang")){let t=(a.donhang||[]).filter(e=>e.makh&&e.masp).map(e=>({ngaygiao:(0,S.default)(F(e.ngaygiao)).toDate(),makh:e.makh,mabanggia:e.mabanggia,masp:e.masp,sldat:Number(e.sldat),slgiao:Number(e.slgiao),slnhan:Number(e.slnhan),ghichu:e.ghichu})),i=this._snackBar.open("\u0110ang import \u0110\u01A1n h\xE0ng...","",{horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});yield this._DonhangService.ImportDonhang(t),i.dismiss(),this._snackBar.open("Import \u0110\u01A1n h\xE0ng th\xE0nh c\xF4ng!","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}})}trackByFn(a,t){return t.id}static \u0275fac=function(t){return new(t||h)};static \u0275cmp=z({type:h,selectors:[["app-listimportdata"]],viewQuery:function(t,i){if(t&1&&(K(Bt,5),K(Tt,5),K(ga,7)),t&2){let e;O(e=$())&&(i.paginator=e.first),O(e=$())&&(i.sort=e.first),O(e=$())&&(i.drawer=e.first)}},decls:26,vars:4,consts:[["uploadfile",""],["noData",""],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4"],[1,"flex","flex-col","space-y-2","p-8"],[1,"flex","flex-row","space-x-2","items-center"],["mat-flat-button","","color","primary",3,"click"],[1,"ml-1"],["type","file",1,"hidden",3,"change"],[1,"grid","grid-cols-3","gap-4"],[3,"class","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"w-full","flex","flex-col","space-y-2","p-8"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[4,"ngIf","ngIfElse"],[3,"click"],[4,"ngIf"],["class","w-full flex flex-row space-x-2 items-center border p-4 rounded-lg",4,"ngFor","ngForOf"],[1,"w-full","flex","flex-row","space-x-2","items-center","border","p-4","rounded-lg"],[1,"rounded-lg","p-2","bg-blue-100"],[1,"text-sm","text-gray-600"],[1,"w-full","flex","flex-row","items-center","justify-center","border","p-4","rounded-lg","bg-gray-100"],[1,"text-gray-600"]],template:function(t,i){if(t&1){let e=M();m(0,"div",2)(1,"div",3)(2,"div",4)(3,"button",5),_("click",function(){return v(e),L(i.ExportExcel(i.TitleExport))}),p(4," T\u1EA3i Xu\u1ED1ng "),m(5,"mat-icon",6),p(6,"download"),c()(),m(7,"button",5),_("click",function(){v(e);let s=at(14);return L(s.click())}),p(8," T\u1EA3i L\xEAn "),m(9,"mat-icon",6),p(10,"upload"),c()(),m(11,"button",5),_("click",function(){return v(e),L(i.toggleAll())}),p(12," Ch\u1ECDn T\u1EA5t C\u1EA3 "),c(),m(13,"input",7,0),_("change",function(s){return v(e),L(i.ImportExcel(s))}),c()(),m(15,"div",8),k(16,da,4,6,"span",9),c()(),m(17,"div",10)(18,"div",11)(19,"input",12),_("keyup",function(s){return v(e),L(i.applyFilter(s))}),c(),m(20,"div",13)(21,"span",14),p(22,"search"),c()()(),k(23,Sa,2,1,"ng-container",15)(24,ya,3,0,"ng-template",null,1,lt),c()()}if(t&2){let e=at(25);l(16),y("ngForOf",i.ListImportType())("ngForTrackBy",i.trackByFn),l(7),y("ngIf",i.ListImportdata().length>0)("ngIfElse",e)}},dependencies:[Et,It,Mt,At,Pt,yt,St,Q,q,U,R,vt,G,Y,j,J,xt,X],encapsulation:2,changeDetection:0})};export{W as a,Jt as b};
