import{a as ot}from"./chunk-MODK773E.js";import{a as ct}from"./chunk-WWXMZIA6.js";import{a as lt}from"./chunk-474ILIJ5.js";import{a as st}from"./chunk-MFWWAZX7.js";import"./chunk-EOEI42HP.js";import{a as et,b as tt}from"./chunk-QHQ5N4IW.js";import"./chunk-ZW44ZSN2.js";import{a as Ue,b as Ye}from"./chunk-SXROZ6BE.js";import{a as _t}from"./chunk-EF567M4M.js";import{a as Ze}from"./chunk-KMC6YJQG.js";import{a as dt}from"./chunk-XAZDEATK.js";import{a as it,b as nt,c as at,k as rt}from"./chunk-DSQX4ICN.js";import"./chunk-HVTWWBOW.js";import{h as Be}from"./chunk-M7GYQRQN.js";import{c as Le,d as Ae,e as R,f as Ke,g as Pe,h as Re,i as Ne,j as He,k as We,l as Oe,m as $e,n as Ge,o as je,p as ze,q as qe,r as Qe,s as Je,t as Xe}from"./chunk-VI7HWDVN.js";import{b as De,c as ye,d as be}from"./chunk-O6GU2XPG.js";import"./chunk-2I3TB2TD.js";import{a as ee,b as Te}from"./chunk-4E3GGNR6.js";import{b as Fe,d as Ie,e as Ve}from"./chunk-3F7BKIWY.js";import{a as J,b as Ce}from"./chunk-72H44DAN.js";import{b as Se,g as X,j as Z,n as we,p as U,r as Ee,u as Y,v as ve,x as ke,y as Me}from"./chunk-PWKF6HJW.js";import"./chunk-6VBKEBL2.js";import{a as xe}from"./chunk-P2TVDSXO.js";import"./chunk-IS4Q6JDM.js";import"./chunk-KQ24563A.js";import"./chunk-GVCEWXG2.js";import"./chunk-VUZTNYK4.js";import"./chunk-L7VABIY7.js";import{a as q,b as Q,d as fe}from"./chunk-5BOITJA3.js";import"./chunk-T3Q3DASN.js";import{fa as z}from"./chunk-JEFJKKLA.js";import{a as ue,c as he}from"./chunk-SUP3LE6Q.js";import"./chunk-YT2LR5DX.js";import{l as pe,m as j,p as _e,q as de}from"./chunk-QQTUBYZ4.js";import{$b as a,Ac as u,Ec as w,Fc as B,Gb as f,Gc as E,Ic as v,Kc as se,Na as T,Nb as oe,Nc as K,Ob as le,Pc as P,Qb as g,Wb as ce,Yb as W,Zb as F,_b as I,ac as o,bc as M,bd as me,cc as V,dc as L,dd as ge,fc as C,kc as d,la as y,mc as m,nb as c,sc as O,tc as $,ua as p,uc as G,va as _,xc as D,yc as s,zb as re,zc as A}from"./chunk-4AKE6FQX.js";import{a as H,g as ae,j as x}from"./chunk-XXD5T5ZZ.js";var te=ae(_t());var gt=ae(dt());var ut=()=>[Y,U,X,Z,J,q,Q,ee,z,pe,j,_e,R,Ke,Re,He,Ge,We,Ne,je,Oe,$e,ze,qe,Qe,De,ye],N=()=>({standalone:!0}),ht=()=>({id:1,title:"B\xE1n S\u1EC9",value:"bansi"}),ft=()=>({id:2,title:"B\xE1n L\u1EBB",value:"banle"}),xt=(r,i)=>[r,i],Ct=(r,i)=>i.id;function Dt(r,i){if(r&1){let t=C();a(0,"button",8),d("click",function(){p(t);let e=m();return _(e.handleBanggiaAction())}),a(1,"mat-icon"),s(2,"save"),o()()}}function yt(r,i){if(r&1){let t=C();a(0,"button",8),d("click",function(){p(t);let e=m();return _(e.toggleEdit())}),a(1,"mat-icon"),s(2,"edit"),o()()}}function bt(r,i){if(r&1){let t=C();V(0),a(1,"div",16)(2,"div",17),s(3,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),o(),a(4,"div",18)(5,"button",19),d("click",function(){p(t);let e=m();return _(e.DeleteData())}),s(6,"\u0110\u1ED3ng \xDD"),o(),a(7,"button",20),d("click",function(){p(t);let e=m();return _(e.toggleDelete())}),s(8,"Hu\u1EF7 B\u1ECF"),o()()(),L()}}function St(r,i){if(r&1&&(a(0,"mat-option",27),s(1),o()),r&2){let t=i.$implicit;g("value",t.value),c(),A(t.title)}}function wt(r,i){if(r&1&&(a(0,"mat-option",27),s(1),o()),r&2){let t=i.$implicit;g("value",t.value),c(),A(t.title)}}function Bt(r,i){r&1&&(a(0,"mat-option",33),s(1,"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),o())}function Et(r,i){r&1&&(a(0,"span",59),s(1,"check"),o())}function vt(r,i){if(r&1){let t=C();a(0,"div",57),d("click",function(){let e=p(t).$implicit,l=m(3);return _(l.ChosenItem(e))}),f(1,Et,2,0,"span",58),s(2),o()}if(r&2){let t=i.$implicit,n=m(3);c(),g("ngIf",n.CheckItem(t)),c(),u(" ",t.title," ")}}function kt(r,i){r&1&&(a(0,"span",59),s(1,"check"),o())}function Mt(r,i){if(r&1){let t=C();a(0,"div",57),d("click",function(){let e=p(t).$implicit,l=m(3);return _(l.ChosenKhachhang(e))}),f(1,kt,2,0,"span",58),s(2),o()}if(r&2){let t=i.$implicit,n=m(3);c(),g("ngIf",n.CheckKhachhang(t)),c(),u(" ",t.name," ")}}function Tt(r,i){if(r&1&&(a(0,"th",62)(1,"span",63),s(2),o()()),r&2){let t=m().$implicit,n=m(3);c(2),u(" ",n.ColumnName[t]," ")}}function Ft(r,i){if(r&1){let t=C();a(0,"span",65)(1,"span"),s(2),o(),a(3,"button",50),d("click",function(){p(t);let e=m().$implicit,l=m(4);return _(l.RemoveSanpham(e))}),a(4,"mat-icon"),s(5,"delete"),o()()()}if(r&2){let t=m().index,n=m(4);c(2),u("",t+1," "),c(),g("disabled",!n.isEdit())}}function It(r,i){if(r&1){let t=C();a(0,"div",70),d("keydown.enter",function(e){p(t);let l=m(2),h=l.$implicit,b=l.index,S=m(4);return _(S.updateValue(e,b,h,"giaban","number"))}),s(1),K(2,"number"),o()}if(r&2){let t=m(2).$implicit,n=m().$implicit;g("contentEditable",!0),c(),u(" ",P(2,2,t[n]||0,"1.0-2")," ")}}function Vt(r,i){if(r&1&&(a(0,"span",66),s(1),K(2,"number"),o()),r&2){let t=m(2).$implicit,n=m().$implicit;c(),u(" ",P(2,1,t[n],"1.0-2")," ")}}function Lt(r,i){if(r&1&&f(0,It,3,5,"div",68)(1,Vt,3,4,"span",69),r&2){let t=m(5);g("ngIf",t.isEdit()),c(),g("ngIf",!t.isEdit())}}function At(r,i){if(r&1&&(a(0,"span",66),s(1),K(2,"number"),o()),r&2){let t=m().$implicit,n=m().$implicit;c(),u(" ",P(2,1,t[n],"1.0-2")," ")}}function Kt(r,i){if(r&1&&(a(0,"span",67),s(1),o()),r&2){let t=m().$implicit,n=m().$implicit;c(),u(" ",t[n]," ")}}function Pt(r,i){if(r&1&&(a(0,"td",64),f(1,Ft,6,2,"span",65)(2,Lt,2,2)(3,At,3,4,"span",66)(4,Kt,2,1,"span",67),o()),r&2){let t,n=m().$implicit;c(),ce((t=n)==="STT"?1:t==="giaban"?2:t==="giagoc"?3:4)}}function Rt(r,i){if(r&1&&(V(0,53),f(1,Tt,3,1,"th",60)(2,Pt,5,1,"td",61),L()),r&2){let t=i.$implicit;g("matColumnDef",t)}}function Nt(r,i){r&1&&M(0,"tr",71)}function Ht(r,i){r&1&&M(0,"tr",72)}function Wt(r,i){r&1&&(a(0,"tr",73)(1,"td",74),s(2,"Kh\xF4ng t\xECm th\u1EA5y"),o()())}function Ot(r,i){if(r&1){let t=C();a(0,"div",30)(1,"div",10)(2,"mat-form-field",31)(3,"mat-label"),s(4,"T\xECnh Tr\u1EA1ng"),o(),a(5,"mat-select",32),E("ngModelChange",function(e){p(t);let l=m(2);return B(l.DetailBanggia().status,e)||(l.DetailBanggia().status=e),_(e)}),F(6,wt,2,2,"mat-option",27,W,!1,Bt,2,0,"mat-option",33),o()(),a(9,"button",34,2),s(11),o(),a(12,"mat-menu",null,3)(14,"div",35),d("click",function(e){return p(t),_(e.stopPropagation())}),a(15,"div",36)(16,"input",37),d("keyup",function(e){p(t);let l=m(2);return _(l.doFilterSanpham(e))}),o(),a(17,"div",38)(18,"span",39),s(19,"search"),o()()(),a(20,"div",40)(21,"div",10)(22,"span",41),d("click",function(){p(t);let e=m(2);return _(e.ChosenAll(e.filterSanpham))}),s(23),o(),a(24,"span",41),d("click",function(){p(t);let e=m(2);return _(e.EmptyFiter())}),s(25,"Xo\xE1"),o()(),a(26,"span",41),d("click",function(){p(t);let e=m(2);return _(e.ResetFilter())}),s(27,"Reset"),o()(),a(28,"div",42),f(29,vt,3,2,"div",43),o(),a(30,"div",44)(31,"button",20),d("click",function(){p(t);let e=D(10);return _(e.closeMenu())}),s(32,"\u0110\xF3ng"),o(),a(33,"button",19),d("click",function(){p(t);let e=D(10),l=m(2);return _(l.ApplyFilterColum(e))}),s(34,"\xC1p D\u1EE5ng"),o()()()(),a(35,"button",45,4),s(37),o(),a(38,"mat-menu",null,5)(40,"div",35),d("click",function(e){return p(t),_(e.stopPropagation())}),a(41,"div",36)(42,"input",37),d("keyup",function(e){p(t);let l=m(2);return _(l.doFilterKhachhang(e))}),o(),a(43,"div",38)(44,"span",39),s(45,"search"),o()()(),a(46,"div",42),f(47,Mt,3,2,"div",43),o(),a(48,"div",44)(49,"button",20),d("click",function(){p(t);let e=D(36);return _(e.closeMenu())}),s(50,"\u0110\xF3ng"),o(),a(51,"button",19),d("click",function(){p(t);let e=D(36),l=m(2);return _(l.ApplyKhachhang(e))}),s(52,"\xC1p D\u1EE5ng"),o()()()(),a(53,"button",46),d("click",function(){p(t);let e=m(2);return _(e.ExportExcel(e.dataSource(),"Banggia"))}),a(54,"mat-icon"),s(55,"file_download"),o()(),a(56,"button",47),d("click",function(){p(t);let e=D(60);return _(e.click())}),a(57,"mat-icon"),s(58,"file_upload"),o()(),a(59,"input",48,6),d("change",function(e){p(t);let l=m(2);return _(l.ImporExcel(e))}),o(),a(61,"button",49),d("click",function(){p(t);let e=m(2);return _(e.LoadDrive())}),a(62,"mat-icon"),s(63,"cloud_download"),o()(),a(64,"button",50),d("click",function(){p(t);let e=m(2);return _(e.EmptyCart())}),a(65,"mat-icon"),s(66,"delete"),o()()()(),a(67,"div",51)(68,"table",52),F(69,Rt,3,1,"ng-container",53,W),f(71,Nt,1,0,"tr",54)(72,Ht,1,0,"tr",55)(73,Wt,3,0,"tr",56),o()()}if(r&2){let t=D(13),n=D(39),e=m(2);c(5),g("disabled",!e.isEdit()),w("ngModel",e.DetailBanggia().status),g("ngModelOptions",v(22,N)),c(),I(e.ListStatus),c(3),g("disabled",!e.isEdit())("matMenuTriggerFor",t),c(2),u(" ",e.ListFilter.length," S\u1EA3n Ph\u1EA9m "),c(12),u("Ch\u1ECDn T\u1EA5t C\u1EA3 ",e.ListFilter.length,""),c(6),g("ngForOf",e.filterSanpham)("ngForTrackBy",e.trackByFn),c(6),g("disabled",!e.isEdit())("matMenuTriggerFor",n),c(2),u(" ",e.CheckListKhachhang.length," Kh\xE1ch H\xE0ng "),c(10),g("ngForOf",e.ListKhachhang)("ngForTrackBy",e.trackByFn),c(6),g("disabled",!e.isEdit()),c(3),g("disabled",!e.isEdit()),c(5),g("disabled",!e.isEdit()),c(3),g("disabled",!e.isEdit()),c(4),g("dataSource",e.dataSource()),c(),I(e.displayedColumns),c(2),g("matHeaderRowDef",e.displayedColumns),c(),g("matRowDefColumns",e.displayedColumns)}}function $t(r,i){if(r&1){let t=C();V(0)(1),a(2,"div",21)(3,"mat-form-field",22)(4,"mat-label"),s(5,"Ti\xEAu \u0110\u1EC1"),o(),a(6,"input",23),E("ngModelChange",function(e){p(t);let l=m();return B(l.DetailBanggia().title,e)||(l.DetailBanggia().title=e),_(e)}),d("input",function(){p(t);let e=m();return _(e.FillSlug())}),o()(),a(7,"mat-form-field",22)(8,"mat-label"),s(9,"Lo\u1EA1i"),o(),a(10,"mat-select",24),E("ngModelChange",function(e){p(t);let l=m();return B(l.DetailBanggia().type,e)||(l.DetailBanggia().type=e),_(e)}),a(11,"div",25)(12,"div",26),F(13,St,2,2,"mat-option",27,Ct),o()()()(),a(15,"mat-form-field",22)(16,"mat-label"),s(17,"B\u1EAFt \u0110\u1EA7u"),o(),a(18,"input",28),E("ngModelChange",function(e){p(t);let l=m();return B(l.DetailBanggia().batdau,e)||(l.DetailBanggia().batdau=e),_(e)}),o(),M(19,"mat-datepicker-toggle",29)(20,"mat-datepicker",null,0),o(),a(22,"mat-form-field",22)(23,"mat-label"),s(24,"K\u1EBFt Th\xFAc"),o(),a(25,"input",28),E("ngModelChange",function(e){p(t);let l=m();return B(l.DetailBanggia().ketthuc,e)||(l.DetailBanggia().ketthuc=e),_(e)}),o(),M(26,"mat-datepicker-toggle",29)(27,"mat-datepicker",null,1),o()(),f(29,Ot,74,23),oe(30,29,ut),le(),L()()}if(r&2){let t=D(21),n=D(28),e=m();c(6),w("ngModel",e.DetailBanggia().title),g("disabled",!e.isEdit()),c(4),w("ngModel",e.DetailBanggia().type),g("ngModelOptions",v(15,N))("disabled",!e.isEdit()),c(3),I(se(18,xt,v(16,ht),v(17,ft))),c(5),g("matDatepicker",t),w("ngModel",e.DetailBanggia().batdau),g("ngModelOptions",v(21,N))("disabled",!e.isEdit()),c(),g("for",t),c(6),g("matDatepicker",n),w("ngModel",e.DetailBanggia().ketthuc),g("ngModelOptions",v(22,N))("disabled",!e.isEdit()),c(),g("for",n)}}var mt=class r{_ListbanggiaComponent=y(ct);_BanggiaService=y(lt);_SanphamService=y(ot);_KhachhangService=y(st);_GoogleSheetService=y(Ze);_route=y(ue);_router=y(he);_snackBar=y(xe);paginator;sort;displayedColumns=["STT","title","masp","dvt","giaban"];ColumnName={STT:"STT",title:"Ti\xEAu \u0110\u1EC1",masp:"M\xE3 SP",dvt:"\u0110\u01A1n V\u1ECB T\xEDnh",giaban:"Gi\xE1 B\xE1n"};dataSource=T(new Xe([]));CountItem=me(()=>this.dataSource().data.length);filterSanpham=[];ListStatus=[{value:"baogia",title:"B\xE1o Gi\xE1"},{value:"dangban",title:"\u0110ang B\xE1n"},{value:"ngungban",title:"Ng\u1EEBng B\xE1n"}];ListKhachhang=[];CheckListKhachhang=[];constructor(){this._route.paramMap.subscribe(i=>x(this,null,function*(){let t=i.get("id");this._BanggiaService.setBanggiaId(t),yield this._SanphamService.getAllSanpham(),this.filterSanpham=this._SanphamService.ListSanpham(),yield this._KhachhangService.getAllKhachhang(),this.ListKhachhang=this._KhachhangService.ListKhachhang().filter(n=>n.isActive)})),ge(()=>x(this,null,function*(){let i=this._BanggiaService.banggiaId();i||(this._router.navigate(["/admin/banggia"]),this._ListbanggiaComponent.drawer.close()),i==="0"?(this.DetailBanggia.set({title:Ve(8,!1),status:"baogia",type:"bansi",batdau:(0,te.default)().startOf("month").toDate(),ketthuc:(0,te.default)().endOf("month").toDate()}),this._ListbanggiaComponent.drawer.open(),this.isEdit.update(t=>!t),this._router.navigate(["/admin/banggia","0"])):(yield this._BanggiaService.getBanggiaByid(i),this.dataSource().data=this.DetailBanggia().sanpham,this.CheckListKhachhang=this.DetailBanggia().khachhang,this.ListFilter=this.DetailBanggia().sanpham,this._ListbanggiaComponent.drawer.open(),this._router.navigate(["/admin/banggia",i]))}))}DetailBanggia=this._BanggiaService.DetailBanggia;isEdit=T(!1);isDelete=T(!1);banggiaId=this._BanggiaService.banggiaId;ngAfterViewInit(){setTimeout(()=>{this.paginator&&(this.dataSource().sort=this.sort)},300)}handleBanggiaAction(){return x(this,null,function*(){this.DetailBanggia.update(i=>(i.sanpham?.forEach(t=>{t.sanphamId=t.id}),i)),this.banggiaId()==="0"?yield this.createBanggia():yield this.updateBanggia()})}createBanggia(){return x(this,null,function*(){try{yield this._BanggiaService.CreateBanggia(this.DetailBanggia()),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(i=>!i)}catch(i){console.error("L\u1ED7i khi t\u1EA1o banggia:",i)}})}updateBanggia(){return x(this,null,function*(){try{yield this._BanggiaService.updateBanggia(this.DetailBanggia()),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(i=>!i)}catch(i){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt banggia:",i)}})}DeleteData(){return x(this,null,function*(){try{yield this._BanggiaService.DeleteBanggia(this.DetailBanggia()),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["/admin/banggia"])}catch(i){console.error("L\u1ED7i khi x\xF3a banggia:",i)}})}goBack(){this._router.navigate(["/admin/banggia"]),this._ListbanggiaComponent.drawer.close()}trackByFn(i,t){return t.id}toggleEdit(){this.isEdit.update(i=>!i)}toggleDelete(){this.isDelete.update(i=>!i)}FillSlug(){this.DetailBanggia.update(i=>(i.slug=Ie(i.title),i))}updateValue(i,t,n,e,l){let h=l==="number"?Number(i.target.innerText.trim().replace(/[^0-9]/g,""))||0:i.target.innerText.trim(),b=i;if(b.key==="Enter"&&!b.shiftKey&&i.preventDefault(),l==="number"){let S=["Backspace","Delete","ArrowLeft","ArrowRight","Tab"];!/^\d$/.test(b.key)&&!S.includes(b.key)&&i.preventDefault()}this.DetailBanggia.update(S=>{if(t!==null){if(e==="giaban"){S.sanpham[t][e]=h;let pt=document.querySelectorAll(".giaban-input");if(t<this.dataSource().filteredData.length-1){let k=pt[t+1];k&&(k instanceof HTMLInputElement&&(k.focus(),k.select()),setTimeout(()=>{if(document.createRange&&window.getSelection){let ie=document.createRange();ie.selectNodeContents(k);let ne=window.getSelection();ne?.removeAllRanges(),ne?.addRange(ie)}},10))}}}else S[e]=h;return S}),console.log(n,e,h),console.log("D\u1EEF li\u1EC7u \u0111\xE3 c\u1EADp nh\u1EADt:",this.DetailBanggia())}LoadDrive(){return x(this,null,function*(){let i={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"BGImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},t=yield this._GoogleSheetService.getDrive(i),n=Fe(t.values);this.DoImportData(n)})}AddSanpham(){}EmptyCart(){this.DetailBanggia.update(i=>(i.sanpham=[],i)),this.dataSource().data=this.DetailBanggia().sanpham,this.dataSource().sort=this.sort,this.reloadfilter()}reloadfilter(){console.log(this.DetailBanggia().sanpham),console.log(this._SanphamService.ListSanpham()),this.filterSanpham=this._SanphamService.ListSanpham().filter(i=>!this.DetailBanggia().sanpham.some(t=>t.id===i.id)),console.log(this.filterSanpham)}SelectSanpham(i){let t=i.value,n=this._SanphamService.ListSanpham().find(e=>e.id===t);console.log(n),this.DetailBanggia.update(e=>(e.sanpham||(e.sanpham=[]),e.sanpham.push(n),this.reloadfilter(),e)),this.dataSource().data=this.DetailBanggia().sanpham,this.dataSource().sort=this.sort}RemoveSanpham(i){this.DetailBanggia.update(t=>(t.sanpham=t.sanpham.filter(n=>n.id!==i.id),this.reloadfilter(),t)),this.dataSource().data=this.DetailBanggia().sanpham,this.dataSource().sort=this.sort}DoFindSanpham(i){let t=i.target.value;this.filterSanpham=this._SanphamService.ListSanpham().filter(n=>n.title.toLowerCase().includes(t.toLowerCase()))}CoppyDon(){this._snackBar.open("\u0110ang Coppy \u0110\u01A1n H\xE0ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]}),this.DetailBanggia.update(i=>(delete i.id,i.title=`${i.title} - Coppy`,i)),this._BanggiaService.CreateBanggia(this.DetailBanggia()).then(i=>{this._snackBar.open("Coppy \u0110\u01A1n H\xE0ng Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["/admin/banggia",this.banggiaId()])})}printContent(){let i=document.getElementById("printContent");i&&(0,gt.default)(i,{scale:2}).then(t=>{let n=t.toDataURL("image/png"),e=window.open("","_blank");e&&(e.document.write(`
            <html>
              <head>
                <title>${this.DetailBanggia()?.title}</title>
              </head>
              <body style="text-align: center;">
                <img src="${n}" style="max-width: 100%;"/>
                <script>
                  window.onload = function() {
                    window.print();
                    window.onafterprint = function() { window.close(); };
                  };
                <\/script>
              </body>
            </html>
          `),e.document.close())})}doFilterKhachhang(i){let t=i.target.value;this.ListKhachhang=this._KhachhangService.ListKhachhang().filter(n=>n.name.toLowerCase().includes(t.toLowerCase()))}ChosenKhachhang(i){this.CheckListKhachhang.find(n=>n.id===i.id)?this.CheckListKhachhang=this.CheckListKhachhang.filter(n=>n.id!==i.id):this.CheckListKhachhang.push(i)}ApplyKhachhang(i){return x(this,null,function*(){let t={banggiaId:this.banggiaId(),khachhangIds:this.DetailBanggia().khachhang.map(h=>h.id)},n=yield this._BanggiaService.removeKHfromBG(t),e={banggiaId:this.banggiaId(),khachhangIds:this.CheckListKhachhang.map(h=>h.id)},l=yield this._BanggiaService.addKHtoBG(e);Promise.all([n,l]).then(()=>{i.closeMenu()})})}CheckKhachhang(i){return!!this.CheckListKhachhang.find(t=>t.id===i.id)}ImporExcel(i){return x(this,null,function*(){let t=yield Ye(i);this.DoImportData(t)})}ExportExcel(i,t){let n=i.data.map(e=>({masp:e.masp?.trim()||"",giaban:Number(e.giaban)||0}));Ue(n,t)}DoImportData(i){let t=i.map(n=>({masp:n.masp?.trim()||"",giaban:Number(n.giaban)||0}));this.DetailBanggia.update(n=>{let e=t.map(l=>{l.masp=l.masp?.trim()||"",l.giaban=Number(l.giaban)||0;let h=this._SanphamService.ListSanpham().find(b=>b.masp===l.masp);return h?H(H({},h),l):l});return n.sanpham=e,this.reloadfilter(),n}),this.dataSource().data=this.DetailBanggia().sanpham,this.dataSource().sort=this.sort,this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}doFilterSanpham(i){this.dataSource().filteredData=this.filterSanpham.filter(n=>n.title.toLowerCase().includes(i.target.value.toLowerCase()));let t=i.target.value.toLowerCase()}ListFilter=[];ChosenItem(i){console.log(i);let t=this.filterSanpham.filter(e=>e.id===i.id);this.ListFilter.filter(e=>e.id===i.id).length>0?this.ListFilter=this.ListFilter.filter(e=>e.id!==i.id):this.ListFilter=[...this.ListFilter,...t]}ChosenAll(i){this.ListFilter=i}ResetFilter(){this.ListFilter=this.filterSanpham,this.dataSource().data=this.filterSanpham,this.dataSource().sort=this.sort}EmptyFiter(){this.ListFilter=[]}CheckItem(i){return!!this.ListFilter.find(t=>t.id===i.id)}ApplyFilterColum(i){this.dataSource().data=this.filterSanpham.filter(t=>this.ListFilter.some(n=>n.id===t.id)),this.dataSource().sort=this.sort,i.closeMenu()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=re({type:r,selectors:[["app-detailbanggia"]],viewQuery:function(t,n){if(t&1&&(O(Le,5),O(R,5)),t&2){let e;$(e=G())&&(n.paginator=e.first),$(e=G())&&(n.sort=e.first)}},decls:23,vars:9,consts:[["pickerbatdau",""],["pickerketthuc",""],["menuTrigger","matMenuTrigger"],["menu","matMenu"],["menuTrigger1","matMenuTrigger"],["menu1","matMenu"],["uploadfile",""],[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"p-2","min-w-28","font-bold","focus:border","focus:rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"blur","contentEditable"],[1,"flex","flex-row","space-x-2","items-center"],[3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","warn",3,"click"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[4,"ngIf"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"w-full","flex","flex-row","space-x-2","items-center"],["appearance","outline","subscriptsizing","dynamic",1,"w-full"],["matInput","","placeholder","Vui l\xF2ng nh\u1EADp Ti\xEAu \u0110\u1EC1",3,"ngModelChange","input","ngModel","disabled"],[3,"ngModelChange","ngModel","ngModelOptions","disabled"],[1,"w-full","flex","flex-col"],[1,"overflow-y-auto","max-h-44"],[3,"value"],["matInput","",3,"ngModelChange","matDatepicker","ngModel","ngModelOptions","disabled"],["matIconSuffix","",3,"for"],[1,"cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","p-2","bg-white","rounded-lg"],["appearance","outline","subscriptSizing","dynamic"],[3,"ngModelChange","disabled","ngModel","ngModelOptions"],["disabled",""],["mat-flat-button","","color","primary",3,"disabled","matMenuTriggerFor"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"flex","flex-row","space-x-2","items-center","justify-between"],[1,"text-xs","text-blue-600","underline",3,"click"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],["class","flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],["mat-flat-button","","color","primary",1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200",3,"disabled","matMenuTriggerFor"],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click","disabled"],["matTooltip","T\u1EA3i l\xEAn file excel","color","primary","mat-icon-button","",3,"click","disabled"],["type","file",1,"hidden",3,"change"],["matTooltip","T\u1EA3i d\u1EEF li\u1EC7u t\u1EEB drive","color","primary","mat-icon-button","",3,"click","disabled"],["mat-icon-button","","color","warn",3,"click","disabled"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-20","line-clamp-4","flex","flex-row","items-center"],[1,"max-w-20","line-clamp-4"],[1,"max-w-40","line-clamp-4"],["class","giaban-input p-2 min-w-28 bg-slate-200 focus:border rounded-lg focus:border-blue-600 focus:bg-slate-100 focus:outline-none",3,"contentEditable","keydown.enter",4,"ngIf"],["class","max-w-20 line-clamp-4",4,"ngIf"],[1,"giaban-input","p-2","min-w-28","bg-slate-200","focus:border","rounded-lg","focus:border-blue-600","focus:bg-slate-100","focus:outline-none",3,"keydown.enter","contentEditable"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,n){if(t&1&&(a(0,"div",7)(1,"button",8),d("click",function(){return n.goBack()}),a(2,"mat-icon"),s(3,"arrow_back"),o()(),a(4,"div",9),d("blur",function(l){return n.updateValue(l,null,n.DetailBanggia(),"title","string")}),s(5),o(),a(6,"div",10)(7,"mat-slide-toggle",11),E("ngModelChange",function(l){return B(n.DetailBanggia().isActive,l)||(n.DetailBanggia().isActive=l),l}),s(8),o(),a(9,"button",8),d("click",function(){return n.CoppyDon()}),a(10,"mat-icon"),s(11,"content_copy"),o()(),a(12,"button",8),d("click",function(){return n.printContent()}),a(13,"mat-icon"),s(14,"print"),o()(),f(15,Dt,3,0,"button",12)(16,yt,3,0,"button",12),a(17,"button",13),d("click",function(){return n.toggleDelete()}),a(18,"mat-icon"),s(19,"delete"),o()()()(),a(20,"div",14),f(21,bt,9,0,"ng-container",15)(22,$t,32,23,"ng-container",15),o()),t&2){let e;c(4),g("contentEditable",!0),c(),u(" ",((e=n.DetailBanggia())==null?null:e.title)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"," "),c(2),w("ngModel",n.DetailBanggia().isActive),g("disabled",!n.isEdit()),c(),A(n.DetailBanggia().isActive?"Hi\u1EC3n Th\u1ECB":"\u1EA8n"),c(7),g("ngIf",n.isEdit()),c(),g("ngIf",!n.isEdit()),c(5),g("ngIf",n.isDelete()),c(),g("ngIf",!n.isDelete())}},dependencies:[ve,Y,U,Ee,Me,ke,we,Se,X,Z,Ce,J,fe,q,Q,Te,ee,z,Be,de,j,tt,et,rt,it,nt,at,Pe,Ae,Je,be],encapsulation:2})};export{mt as DetailBanggiaComponent};
