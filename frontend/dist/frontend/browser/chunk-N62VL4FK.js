import{a as x}from"./chunk-P7PTBZX5.js";import{a as g}from"./chunk-JNVUT6FC.js";import{g as d}from"./chunk-6DYNGEAS.js";var f=d(g()),a=d(x());function L(o,s){let e={Sheets:{},SheetNames:[]};Object.keys(o).forEach(t=>{let{data:l,headers:c=[],mapping:i={}}=o[t],h=c.length>0&&Object.keys(i).length>0?l.map(y=>{let S={};return c.forEach(m=>{let p=Object.keys(i).find(X=>i[X]===m),k=p?y[p]:null;S[m]=k===0?0:k||null}),S}):l,n=a.utils.json_to_sheet(h);e.SheetNames.push(t),e.Sheets[t]=n}),e.SheetNames.length===0&&(e.SheetNames.push("EmptySheet"),e.Sheets.EmptySheet=a.utils.aoa_to_sheet([[]]));let r=a.write(e,{bookType:"xlsx",type:"array"});u(r,`${s}_${(0,f.default)().format("DD_MM_YYYY")}`)}function w(o,s,e=[],r={}){let t=o.map(n=>{let y={};return e.forEach(S=>{let m=Object.keys(r).find(p=>r[p]===S);y[S]=m&&n[m]||null}),y}),l=e.length>0&&Object.keys(r).length>0?t:o,i={Sheets:{Sheet1:a.utils.json_to_sheet(l)},SheetNames:["Sheet1"]},h=a.write(i,{bookType:"xlsx",type:"array"});u(h,`${s}_${(0,f.default)().format("DD_MM_YYYY")}`)}function _(o,s="Excel_Export"){let e={Sheets:{},SheetNames:[]};Object.keys(o).forEach(t=>{let l=a.utils.json_to_sheet(o[t]);e.SheetNames.push(t),e.Sheets[t]=l});let r=a.write(e,{bookType:"xlsx",type:"array"});u(r,`${s}_${(0,f.default)().format("DD_MM_YYYY")}`)}function E(o,s="Excel_Export"){let e={Sheets:{},SheetNames:[]};Object.keys(o).forEach(n=>{let y=a.utils.json_to_sheet(o[n]);e.SheetNames.push(n),e.Sheets[n]=y});let r=[["ngay","makhold","makh","tenkh","mabangia","masp","tensp","sldat","slgiao","slnhan"],["Ng\xE0y","M\xE3 C\u0169","M\xE3 M\u1EDBi","T\xEAn Kh\xE1ch H\xE0ng","B\u1EA3ng Gi\xE1","M\xE3 S\u1EA3n Ph\u1EA9m","T\xEAn S\u1EA3n Ph\u1EA9m","SL \u0110\u1EB7t","SL Giao","SL Nh\u1EADn"],[(0,f.default)().format("DD/MM/YYYY"),"C100755","","","","I100001","","1","",""],["","","","","","","","",""]],t=a.utils.aoa_to_sheet(r),l={font:{color:{rgb:"FF0000"}}};[{cell:"C3",formula:"VLOOKUP(B3,KH!A:D,3,0)",type:"s"},{cell:"D3",formula:"VLOOKUP(B3,KH!A:D,2,0)",type:"s"},{cell:"G3",formula:"VLOOKUP(F3,SP!B:D,2,0)",type:"s"},{cell:"I3",formula:"H3",type:"n"},{cell:"J3",formula:"H3",type:"n"}].forEach(({cell:n,formula:y,type:S})=>{t[n]={f:y,t:S,s:l}});let i="Donhang";e.SheetNames.push(i),e.Sheets[i]=t;let h=a.write(e,{bookType:"xlsx",type:"array"});u(h,`${s}_${(0,f.default)().format("DD_MM_YYYY")}`)}function D(o,s="Excel_Export"){let e={Sheets:{},SheetNames:[]};Object.keys(o).forEach(n=>{let y=a.utils.json_to_sheet(o[n]);e.SheetNames.push(n),e.Sheets[n]=y});let r=[["ngay","manccold","mancc","name","mabangia","masp","tensp","sldat","slgiao","slnhan"],["Ng\xE0y","M\xE3 C\u0169","M\xE3 M\u1EDBi","T\xEAn Nh\xE0 Cung C\u1EA5p","B\u1EA3ng Gi\xE1","M\xE3 S\u1EA3n Ph\u1EA9m","T\xEAn S\u1EA3n Ph\u1EA9m","SL \u0110\u1EB7t","SL Giao","SL Nh\u1EADn"],[(0,f.default)().format("DD/MM/YYYY"),"V100049","","","","I100001","","1","",""],["","","","","","","","",""]],t=a.utils.aoa_to_sheet(r),l={font:{color:{rgb:"FF0000"}}};[{cell:"C3",formula:"VLOOKUP(B3,NCC!A:D,3,0)",type:"s"},{cell:"D3",formula:"VLOOKUP(B3,NCC!A:D,2,0)",type:"s"},{cell:"G3",formula:"VLOOKUP(F3,SP!B:D,2,0)",type:"s"},{cell:"I3",formula:"H3",type:"n"},{cell:"J3",formula:"H3",type:"n"}].forEach(({cell:n,formula:y,type:S})=>{t[n]={f:y,t:S,s:l}});let i="Dathang";e.SheetNames.push(i),e.Sheets[i]=t;let h=a.write(e,{bookType:"xlsx",type:"array"});u(h,`${s}_${(0,f.default)().format("DD_MM_YYYY")}`)}function u(o,s){let e=new Blob([o],{type:"application/octet-stream"}),r=window.URL.createObjectURL(e),t=document.createElement("a");t.href=r,t.download=`${s}.xlsx`,t.click(),window.URL.revokeObjectURL(r),t.remove()}function Y(o,s){return new Promise((e,r)=>{let t=new Worker(new URL("worker-RWYKXG65.js",import.meta.url),{type:"module"}),l=o.target?.files?.[0]||o;t.postMessage({file:l,sheetName:s}),t.onmessage=c=>{c.data.result?e(c.data.result):r(c.data.error),t.terminate()},t.onerror=c=>{r(c),t.terminate()}})}function b(o,s){return new Promise((e,r)=>{let t=o.target?.files?.[0]||o;if(!t){r("No file provided");return}let l=new FileReader;l.onload=c=>{try{let i=new Uint8Array(c.target.result),h=a.read(i,{type:"array"}),n;if(s&&h.SheetNames.includes(s))n=a.utils.sheet_to_json(h.Sheets[s],{defval:""});else{let y=h.SheetNames[0];n=a.utils.sheet_to_json(h.Sheets[y],{defval:""})}e(n)}catch(i){r(i)}},l.onerror=c=>r(c),l.readAsArrayBuffer(t)})}function M(o,s){return new Promise((e,r)=>{let t=o.target?.files?.[0]||o;if(!t){r("No file provided");return}let l=new FileReader;l.onload=c=>{try{let i=new Uint8Array(c.target.result),h=a.read(i,{type:"array"}),n;s&&h.SheetNames.includes(s)?n=a.utils.sheet_to_json(h.Sheets[s],{defval:""}):(n={},h.SheetNames.forEach(y=>{n[y]=a.utils.sheet_to_json(h.Sheets[y],{defval:""})})),e(n)}catch(i){r(i)}},l.onerror=c=>r(c),l.readAsArrayBuffer(t)})}function O(o){let t=(o-25569)*864e5;return new Date(t)}export{L as a,w as b,_ as c,E as d,D as e,Y as f,b as g,M as h,O as i};
