import{a as ve}from"./chunk-OMRSPEVO.js";import{a as y}from"./chunk-ALZZUY7O.js";import{a as ne}from"./chunk-VTCQHFRM.js";import{a as ee}from"./chunk-I6J3RZ7R.js";import{a as ie}from"./chunk-2WG5LI7W.js";import{a as Gt}from"./chunk-WY75HJKE.js";import{a as Zt}from"./chunk-45RCKGLZ.js";import{a as te}from"./chunk-HYJYWSS7.js";import{a as jt,b as Ut}from"./chunk-NULFSBS2.js";import{d as qt,g as Wt}from"./chunk-ESCBPH3J.js";import{a as V,b as It,c as P,d as Lt,e as Vt}from"./chunk-DCFSAVWL.js";import{c as xt,d as ft,e as gt,f as Ct,g as yt,h as St}from"./chunk-PYADMCOB.js";import{a as bt}from"./chunk-ZW44ZSN2.js";import{a as rt,b as lt,c as st}from"./chunk-AQE4NBKO.js";import{a as pt,b as ut,c as dt,d as ht}from"./chunk-6KT4XQ7E.js";import{a as Ee}from"./chunk-L5GX4ZSB.js";import{a as Ce,b as ye,c as Se,k as Jt}from"./chunk-SL7ME4PY.js";import{a as Me}from"./chunk-YGTKRZ2Q.js";import{a as Mt,b as Ft,c as Pt,d as Bt,e as $t,g as Xt,h as At,j as Nt,k as Yt,m as Rt,n as Ht,p as zt,q as Ot,r as Kt,s as Qt}from"./chunk-4GW65WCG.js";import{b as Tt}from"./chunk-IZCFLW2T.js";import{b as he,g as _e,j as xe,n as _t,p as fe,r as Et,s as ge,v as vt,w as wt,y as Dt,z as kt}from"./chunk-OAFA7HHQ.js";import{a as mt,b as ct}from"./chunk-UOMYPXRQ.js";import{a as ot}from"./chunk-NX6TSR5R.js";import{a as it,c as nt,e as at}from"./chunk-MJAN2OV6.js";import{y as tt,z as et}from"./chunk-FYUVDT4C.js";import{b as Z,c as de}from"./chunk-VF6Z3BLE.js";import{k as J,l as j,m as U,r as pe,t as ue,v as G}from"./chunk-CNCZQRZQ.js";import{$b as M,Cc as D,Db as K,Dc as l,Ec as u,Fc as f,Ic as oe,Jc as re,Ka as me,Kb as g,Kc as le,Mc as Y,Rc as R,Sc as k,Tb as ce,Ub as _,Uc as T,Xc as H,bc as Q,cc as X,dc as A,ec as i,fc as o,gc as v,hc as q,ic as W,kc as w,nb as $,pa as C,pc as x,rb as m,rc as c,vc as N,xc as F,ya as d,yc as I,za as h,zc as L}from"./chunk-TAKLKH4V.js";import{g as be,h as B,j as E}from"./chunk-WJTR2IJE.js";var se=be(Me());var Oe=["drawer"],Ke=()=>[10,25,100],we=(r,e,t,n,a)=>({"text-blue-500":r,"text-yellow-500":e,"text-green-500":t,"text-purple-500":n,"text-red-500":a}),Qe=(r,e)=>e.key;function qe(r,e){if(r&1){let t=w();i(0,"button",28),x("click",function(a){let s=d(t).$implicit;return c().toggleColumn(s),h(a.stopPropagation())}),i(1,"mat-icon"),l(2),o(),i(3,"span"),l(4),o()()}if(r&2){let t=e.$implicit;m(2),u(t.isShow?"check_box":"check_box_outline_blank"),m(2),u(t.value)}}function We(r,e){r&1&&(i(0,"span",45),l(1,"check"),o())}function Je(r,e){if(r&1&&(i(0,"span"),l(1),k(2,"date"),o()),r&2){let t=c().$implicit,n=c(2).$implicit;m(),u(T(2,1,t[n],"dd/MM/yyyy"))}}function je(r,e){if(r&1&&(i(0,"span"),l(1),k(2,"date"),o()),r&2){let t=c().$implicit,n=c(2).$implicit;m(),u(T(2,1,t[n],"dd/MM/yyyy"))}}function Ue(r,e){if(r&1&&(i(0,"span"),l(1),o()),r&2){let t=c().$implicit,n=c(2).$implicit;m(),f("",t[n],"%")}}function Ge(r,e){if(r&1&&(i(0,"span"),l(1),o()),r&2){let t=c().$implicit,n=c(2).$implicit;m(),f(" ",t[n]||"Tr\u1ED1ng","")}}function Ze(r,e){if(r&1){let t=w();i(0,"div",43),x("click",function(){let a=d(t).$implicit,s=c(2).$implicit,p=c();return h(p.ChosenItem(a,s))}),g(1,We,2,0,"span",44)(2,Je,3,4,"span")(3,je,3,4,"span")(4,Ue,2,1,"span")(5,Ge,2,1,"span"),o()}if(r&2){let t,n=e.$implicit,a=c(2).$implicit,s=c();m(),_("ngIf",s.CheckItem(n)),m(),M((t=a)==="createdAt"?2:t==="updatedAt"?3:t==="haohut"?4:5)}}function ti(r,e){if(r&1){let t=w();i(0,"th",31)(1,"span",32),l(2),o(),i(3,"span",33,4),l(5," filter_alt "),o(),i(6,"mat-menu",null,1)(8,"div",34),x("click",function(a){return d(t),h(a.stopPropagation())}),i(9,"div",35)(10,"input",10),x("keyup",function(a){d(t);let s=c().$implicit,p=c();return h(p.doFilterHederColumn(a,s))}),o(),i(11,"div",11)(12,"span",12),l(13,"search"),o()()(),i(14,"div",36)(15,"div",8)(16,"span",37),x("click",function(){d(t);let a=c().$implicit,s=c();return h(s.ChosenAll(s.FilterHederColumn(s.dataSource.filteredData,a)))}),l(17),o(),i(18,"span",37),x("click",function(){d(t);let a=c(2);return h(a.EmptyFiter())}),l(19,"Xo\xE1"),o()(),i(20,"span",37),x("click",function(){d(t);let a=c(2);return h(a.ResetFilter())}),l(21,"Reset"),o()(),i(22,"div",38),g(23,Ze,6,2,"div",39),o(),i(24,"div",40)(25,"button",41),x("click",function(){d(t);let a=D(4);return h(a.closeMenu())}),l(26,"\u0110\xF3ng"),o(),i(27,"button",42),x("click",function(){d(t);let a=D(4),s=c(2);return h(s.ApplyFilterColum(a))}),l(28,"\xC1p D\u1EE5ng"),o()()()()()}if(r&2){let t=D(7),n=c().$implicit,a=c();m(2),f(" ",a.ColumnName[n]," "),m(),_("matMenuTriggerFor",t),m(14),f("Ch\u1ECDn T\u1EA5t C\u1EA3 ",a.FilterHederColumn(a.dataSource.filteredData,n).length||0,""),m(6),_("ngForOf",a.FilterHederColumn(a.dataSource.filteredData,n))("ngForTrackBy",a.trackByFn)}}function ei(r,e){if(r&1&&(i(0,"span",47),l(1),o()),r&2){let t=c().index;m(),f(" ",t+1," ")}}function ii(r,e){if(r&1){let t=w();i(0,"span",53),x("click",function(){d(t);let a=c(2).$implicit,s=c(2),p=D(35);return h(s.XemDathang(a,p))}),l(1),k(2,"number"),o()}if(r&2){let t=c(2).$implicit,n=c().$implicit;m(),f(" + ",T(2,1,t[n],"1.0-2")," ")}}function ni(r,e){if(r&1&&(l(0),k(1,"number")),r&2){let t=c(2).$implicit,n=c().$implicit;f(" ",T(1,1,t[n],"1.0-2")," ")}}function ai(r,e){if(r&1&&(i(0,"span",48)(1,"span",51),g(2,ii,3,4,"span")(3,ni,2,4),i(4,"span",52),l(5),k(6,"number"),o()()()),r&2){let t=c().$implicit,n=c().$implicit;m(2),M(t[n]>0?2:3),m(3),f("(",T(6,2,t==null?null:t.slchonhaptt,"1.0-2"),")")}}function oi(r,e){if(r&1){let t=w();i(0,"span",53),x("click",function(){d(t);let a=c(2).$implicit,s=c(2),p=D(37);return h(s.XemDonhang(a,p))}),l(1),k(2,"number"),o()}if(r&2){let t=c(2).$implicit,n=c().$implicit;m(),f("",T(2,1,t[n],"1.0-2")," ")}}function ri(r,e){if(r&1&&(l(0),k(1,"number")),r&2){let t=c(2).$implicit,n=c().$implicit;f(" ",T(1,1,t[n],"1.0-2")," ")}}function li(r,e){if(r&1&&(i(0,"span",49)(1,"span",51),g(2,oi,3,4,"span")(3,ri,2,4),i(4,"span",52),l(5),k(6,"number"),o()()()),r&2){let t=c().$implicit,n=c().$implicit;m(2),M(t[n]>0?2:3),m(3),f("(",T(6,2,t==null?null:t.slchogiaott,"1.0-2"),")")}}function si(r,e){if(r&1&&(i(0,"span",50),l(1),k(2,"date"),o()),r&2){let t=c().$implicit,n=c().$implicit;m(),f(" ",T(2,1,t[n],"HH:mm:ss dd/MM/yyyy")," ")}}function mi(r,e){r&1&&(i(0,"mat-icon",54),l(1,"check_circle"),o())}function ci(r,e){r&1&&(i(0,"mat-icon",55),l(1,"cancel"),o())}function pi(r,e){if(r&1&&(i(0,"span",47),g(1,mi,2,0,"mat-icon",54)(2,ci,2,0,"mat-icon",55),o()),r&2){let t=c().$implicit,n=c().$implicit;m(),M(t[n]?1:2)}}function ui(r,e){if(r&1&&(i(0,"span",50),l(1),k(2,"date"),o()),r&2){let t=c().$implicit,n=c().$implicit;m(),f(" ",T(2,1,t[n],"HH:mm:ss dd/MM/yyyy")," ")}}function di(r,e){if(r&1&&(i(0,"span",47),l(1),o()),r&2){let t=c().$implicit,n=c().$implicit;m(),f(" ",t[n]," ")}}function hi(r,e){if(r&1&&(i(0,"td",46),g(1,ei,2,1,"span",47)(2,ai,7,5,"span",48)(3,li,7,5,"span",49)(4,si,3,4,"span",50)(5,pi,3,1,"span",47)(6,ui,3,4,"span",50)(7,di,2,1,"span",47),o()),r&2){let t,n=c().$implicit;m(),M((t=n)==="STT"?1:t==="slchonhap"?2:t==="slchogiao"?3:t==="ngaygiao"?4:t==="isActive"?5:t==="updatedAt"?6:7)}}function _i(r,e){if(r&1&&(q(0,23),g(1,ti,29,5,"th",29)(2,hi,8,1,"td",30),W()),r&2){let t=e.$implicit;_("matColumnDef",t)}}function xi(r,e){r&1&&v(0,"tr",56)}function fi(r,e){r&1&&v(0,"tr",57)}function gi(r,e){r&1&&(i(0,"tr",58)(1,"td",59),l(2,"Kh\xF4ng t\xECm th\u1EA5y"),o()())}function Ci(r,e){if(r&1&&(i(0,"tr",71)(1,"td",68),l(2),o(),i(3,"td",72)(4,"a",73),l(5),o()(),i(6,"td",68)(7,"span",74),l(8),o()(),i(9,"td",68),l(10),o(),i(11,"td",68),l(12),o(),i(13,"td",68),l(14),o(),i(15,"td",68),l(16),o(),i(17,"td",68),l(18),k(19,"date"),o()()),r&2){let t=e.$implicit,n=c(2);m(2),u(t.title),m(2),N("href","/admin/dathang/",t.id,"",$),m(),f(" ",t.madncc," "),m(2),_("ngClass",R(14,we,t.status==="dadat",t.status==="dagiao",t.status==="danhan",t.status==="hoanthanh",t.status==="huy")),m(),f(" ",n.Trangthaidon[t.status]," "),m(2),u(t.nhacungcap.name),m(2),u(t.sanpham.sanpham.title),m(2),u(t.sanpham.sldat),m(2),u(t.sanpham.slnhan),m(2),u(T(19,11,t.createdAt,"dd/MM/yyyy"))}}function yi(r,e){if(r&1&&(i(0,"h2",60),l(1,"Chi Ti\u1EBFt \u0110\u1EB7t H\xE0ng"),o(),i(2,"mat-dialog-content",61)(3,"table",62)(4,"thead")(5,"tr",63)(6,"th",64),l(7,"Ti\xEAu \u0111\u1EC1"),o(),i(8,"th",64),l(9,"M\xE3 \u0110\u1EB7t"),o(),i(10,"th",64),l(11,"Tr\u1EA1ng th\xE1i"),o(),i(12,"th",64),l(13,"Nh\xE0 Cung C\u1EA5p"),o(),i(14,"th",64),l(15,"T\xEAn S\u1EA3n Ph\u1EA9m"),o(),i(16,"th",64),l(17,"S\u1ED1 L\u01B0\u1EE3ng \u0110\u1EB7t"),o(),i(18,"th",64),l(19,"S\u1ED1 L\u01B0\u1EE3ng Nh\u1EADn"),o(),i(20,"th",64),l(21,"Ng\xE0y"),o()()(),i(22,"tbody"),g(23,Ci,20,20,"tr",65),i(24,"tr",66)(25,"td",67),l(26,"T\u1ED5ng c\u1ED9ng:"),o(),i(27,"td",68),l(28),o(),i(29,"td",68),l(30),o(),v(31,"td",68),o()()()(),i(32,"mat-dialog-actions",69)(33,"button",70),l(34,"\u0110\xF3ng"),o()()),r&2){let t=c();m(23),_("ngForOf",t.ListDathang),m(5),u(t.TinhTong(t.ListDathang,"sldat")),m(2),u(t.TinhTong(t.ListDathang,"slnhan"))}}function Si(r,e){if(r&1&&(i(0,"tr",71)(1,"td",68),l(2),o(),i(3,"td",72)(4,"a",73),l(5),o()(),i(6,"td",68)(7,"span",74),l(8),o()(),i(9,"td",68),l(10),o(),i(11,"td",68),l(12),o(),i(13,"td",68),l(14),o(),i(15,"td",68),l(16),o(),i(17,"td",68),l(18),k(19,"date"),o()()),r&2){let t=e.$implicit,n=c(2);m(2),u(t.title),m(2),N("href","/admin/donhang/",t.id,"",$),m(),f(" ",t.madonhang," "),m(2),_("ngClass",R(14,we,t.status==="dadat",t.status==="dagiao",t.status==="danhan",t.status==="hoanthanh",t.status==="huy")),m(),f(" ",n.Trangthaidon[t.status]," "),m(2),u(t.khachhang.name),m(2),u(t.sanpham.sanpham.title),m(2),u(t.sanpham.sldat),m(2),u(t.sanpham.slnhan),m(2),u(T(19,11,t.createdAt,"dd/MM/yyyy"))}}function Ei(r,e){if(r&1&&(i(0,"h2",60),l(1,"Chi Ti\u1EBFt \u0110\u01A1n H\xE0ng"),o(),i(2,"mat-dialog-content",61)(3,"table",62)(4,"thead")(5,"tr",63)(6,"th",64),l(7,"Ti\xEAu \u0111\u1EC1"),o(),i(8,"th",64),l(9,"M\xE3 \u0110\u01A1n"),o(),i(10,"th",64),l(11,"Tr\u1EA1ng th\xE1i"),o(),i(12,"th",64),l(13,"Nh\xE0 Cung C\u1EA5p"),o(),i(14,"th",64),l(15,"T\xEAn S\u1EA3n Ph\u1EA9m"),o(),i(16,"th",64),l(17,"S\u1ED1 L\u01B0\u1EE3ng \u0110\u1EB7t"),o(),i(18,"th",64),l(19,"S\u1ED1 L\u01B0\u1EE3ng Nh\u1EADn"),o(),i(20,"th",64),l(21,"Ng\xE0y"),o()()(),i(22,"tbody"),g(23,Si,20,20,"tr",65),i(24,"tr",66)(25,"td",67),l(26,"T\u1ED5ng c\u1ED9ng:"),o(),i(27,"td",68),l(28),o(),i(29,"td",68),l(30),o(),v(31,"td",68),o()()()(),i(32,"mat-dialog-actions",69)(33,"button",70),l(34,"\u0110\xF3ng"),o()()),r&2){let t=c();m(23),_("ngForOf",t.ListDonhang),m(5),u(t.TinhTong(t.ListDonhang,"sldat")),m(2),u(t.TinhTong(t.ListDonhang,"slnhan"))}}var z=class z{DexuatEmit=new me;Detail={};displayedColumns=["title","masp","dvt","slton","slchogiao","slchonhap","haohut","goiy"];ColumnName={title:"T\xEAn s\u1EA3n ph\u1EA9m",masp:"M\xE3 s\u1EA3n ph\u1EA9m",dvt:"\u0110\u01A1n v\u1ECB t\xEDnh",slton:"SL t\u1ED3n",slchogiao:"SL ch\u1EDD giao",slchonhap:"SL ch\u1EDD nh\u1EADp",haohut:"Hao h\u1EE5t",goiy:"G\u1EE3i \xFD"};FilterColumns=JSON.parse(localStorage.getItem("TonkhoColFilter")||"[]");Columns=[];isFilter=!1;paginator;sort;drawer;filterValues={};_PhieukhoService=C(ee);_SanphamService=C(te);_DathangService=C(Gt);_DonhangService=C(Zt);_KhoService=C(ie);_breakpointObserver=C(tt);Xuatnhapton=this._PhieukhoService.ListPhieukho;dataSource=new Qt([]);_snackBar=C(ot);CountItem=0;SearchParams={Batdau:y.format(y.now(),"YYYY-MM-DD"),Ketthuc:y.format(y.add(y.now(),1,"day"),"YYYY-MM-DD"),Type:"donsi"};ListDate=[{id:1,Title:"1 Ng\xE0y",value:"day"},{id:2,Title:"1 Tu\u1EA7n",value:"week"},{id:3,Title:"1 Th\xE1ng",value:"month"},{id:4,Title:"1 N\u0103m",value:"year"}];Chonthoigian="day";isSearch=!1;ListKho=[];constructor(){this.displayedColumns.forEach(e=>{this.filterValues[e]=""})}createFilter(){return(e,t)=>{let n=JSON.parse(t),a=!0;return this.displayedColumns.forEach(s=>{if(n[s]){let p=e[s]?e[s].toString().toLowerCase():"";a=a&&p.includes(n[s].toLowerCase())}}),a}}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource?.paginator?.firstPage()}LoadDondathang(){return E(this,null,function*(){let e=yield this._DonhangService.getSLChogiao(this.SearchParams),t=yield this._DathangService.getSLChonhap(this.SearchParams);this.dataSource.data.forEach(n=>{let a=e.find(p=>p.idSP===n.sanphamId);a?n.slchogiaott=a.slchogiaott:n.slchogiaott=0;let s=t.find(p=>p.idSP===n.sanphamId);s?n.slchonhaptt=s.slchonhaptt:n.slchonhaptt=0}),this.dataSource.data=this.dataSource.data.filter(n=>n.slchogiaott>0||n.slchonhaptt>0),this.dataSource.sort=this.sort})}ngOnInit(){return E(this,null,function*(){yield this._SanphamService.getAllSanpham(),this._KhoService.getTonKho("1","1000").then(e=>{this.Xuatnhapton.set(e.data),this.dataSource.data=this.Xuatnhapton(),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.initializeColumns(),this.setupDrawer(),this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i"}),this.CountItem=this.Xuatnhapton().length})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(e=>({key:e,value:this.ColumnName[e],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("TonkhoColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{})}setupDrawer(){this._breakpointObserver.observe([et.Handset]).subscribe(e=>{e.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}toggleColumn(e){let t=this.FilterColumns.find(n=>n.key===e.key);t&&(t.isShow=!t.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{}),localStorage.setItem("TonkhoColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(e){let t=e.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(n=>n.value.toLowerCase().includes(t))}FilterHederColumn(e,t){return e.filter((a,s,p)=>s===p.findIndex(S=>S[t]===a[t]))}doFilterHederColumn(e,t){let n=e.target.value.toLowerCase();console.log(n),console.log(t),this.dataSource.filteredData=this.Xuatnhapton().filter(a=>bt(a[t]).includes(n)||a[t].toLowerCase().includes(n))}trackByFn(e,t){return t.id}ListFilter=[];ChosenItem(e,t){let n=this.dataSource.filteredData.filter(s=>s[t]===e[t]);this.ListFilter.filter(s=>s[t]===e[t]).length>0?this.ListFilter=this.ListFilter.filter(s=>s[t]!==e[t]):this.ListFilter=[...this.ListFilter,...n]}ChosenAll(e){e.forEach(t=>{!!this.ListFilter.find(a=>a.id===t.id)?this.ListFilter=this.ListFilter.filter(a=>a.id!==a.id):this.ListFilter.push(t)})}ResetFilter(){this.ListFilter=this.Xuatnhapton(),this.dataSource.data=this.Xuatnhapton(),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}EmptyFiter(){this.ListFilter=[]}CheckItem(e){return!!this.ListFilter.find(t=>t.id===e.id)}ApplyFilterColum(e){this.dataSource.data=this.Xuatnhapton().filter(t=>this.ListFilter.some(n=>n.id===t.id)),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,e.closeMenu()}ExportExcel(e,t){return E(this,null,function*(){yield this._SanphamService.getAllSanpham();let n=this._SanphamService.ListSanpham().map(s=>({subtitle:s.subtitle,masp:s.masp,title:s.title,dvt:s.dvt})),a=this.Xuatnhapton().map(s=>({masp:s.masp,title:s.title,dvt:s.dvt,slton:s.slton}));qt({SP:n,XNT:a},t)})}ImporExcel(e){return E(this,null,function*(){let t=Array.from(e.target.files),n=yield Wt(t[0],"XNT"),a=[],s=[];n.forEach(p=>{let S=this.Xuatnhapton().find(b=>b.masp===p.masp);S&&(p.slton>S.slton?a.push({sanphamId:this._SanphamService.ListSanpham().find(b=>b.masp===p.masp).id,soluong:p.slton-S.slton}):p.slton<S.slton&&s.push({sanphamId:this._SanphamService.ListSanpham().find(b=>b.masp===p.masp).id,soluong:S.slton-p.slton}))}),a.length>0&&this._PhieukhoService.CreatePhieukho({title:`\u0110i\u1EC1u Ch\u1EC9nh Kho Ng\xE0y ${y.format(y.now(),"DD/MM/YYYY ")}`,type:"nhap",sanpham:a,ghichu:`C\u1EADp nh\u1EADt t\u1ED3n kho l\xFAc ${y.format(y.now(),"HH:mm:ss DD/MM/YYYY ")}`,ngay:y.now()}),s.length>0&&this._PhieukhoService.CreatePhieukho({title:`\u0110i\u1EC1u Ch\u1EC9nh Kho Ng\xE0y ${y.format(y.now(),"DD/MM/YYYY ")}`,type:"xuat",sanpham:s,ghichu:`C\u1EADp nh\u1EADt t\u1ED3n kho l\xFAc ${y.format(y.now(),"HH:mm:ss DD/MM/YYYY ")}`,ngay:y.now()}),a.length>0&&this._snackBar.open(`\u0110i\u1EC1u ch\u1EC9nh nh\u1EADp kho v\u1EDBi ${a.length} s\u1EA3n ph\u1EA9m`,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),s.length>0&&this._snackBar.open(`\u0110i\u1EC1u ch\u1EC9nh xu\u1EA5t kho v\u1EDBi ${s.length} s\u1EA3n ph\u1EA9m`,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),a.length===0&&s.length===0&&this._snackBar.open("Kho kh\xF4ng thay \u0111\u1ED5i","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}_dialog=C(xt);Trangthaidon=ne;ListDathang=[];ListDonhang=[];XemDathang(e,t){return E(this,null,function*(){this.ListDathang=yield this._DathangService.findbysanpham(e.sanphamId),console.log(this.ListDathang),this._dialog.open(t,{hasBackdrop:!0,disableClose:!0}).afterClosed().subscribe(a=>{})})}XemDonhang(e,t){return E(this,null,function*(){this.ListDonhang=yield this._DonhangService.findbysanpham(e.sanphamId),console.log(this.ListDonhang),this._dialog.open(t,{hasBackdrop:!0,disableClose:!0}).afterClosed().subscribe(a=>{})})}TinhTong(e,t){return e?.reduce((n,a)=>n+(Number(a?.sanpham[t])||0),0)||0}gotoDexuat(){this.DexuatEmit.emit(!1)}static \u0275fac=function(t){return new(t||z)};static \u0275cmp=K({type:z,selectors:[["app-detaildexuat"]],viewQuery:function(t,n){if(t&1&&(F(V,5),F(P,5),F(Oe,7)),t&2){let a;I(a=L())&&(n.paginator=a.first),I(a=L())&&(n.sort=a.first),I(a=L())&&(n.drawer=a.first)}},outputs:{DexuatEmit:"DexuatEmit"},decls:38,vars:7,consts:[["drawer",""],["menu","matMenu"],["DathangDialog",""],["DonhangDialog",""],["menuTrigger","matMenuTrigger"],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-14","w-full","p-2"],[1,"flex","flex-row","space-x-2","items-center"],[1,"relative"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"cursor-pointer","p-2","rounded-lg","border","hover:bg-slate-50",3,"click"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"excelstyle","!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],[1,"z-10","material-symbols-outlined","text-gray-500",3,"matMenuTriggerFor"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],[1,"flex","flex-row","space-x-2","items-center","justify-between"],[1,"text-xs","text-blue-600","underline",3,"click"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],["class","flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","text-green-700","font-bold"],[1,"max-w-40","line-clamp-4","text-red-700","font-bold"],[1,"max-w-40","line-clamp-4","text-xs"],[1,"flex","items-center","justify-between"],[1,"text-xs","text-gray-500"],[3,"click"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"],["mat-dialog-title",""],[1,"mat-typography"],[1,"w-full","border-collapse","border","border-gray-300"],[1,"bg-gray-100"],[1,"border","border-gray-300","px-4","py-2","text-left"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"bg-gray-100","font-bold"],["colspan","5",1,"border","border-gray-300","px-4","py-2"],[1,"border","border-gray-300","px-4","py-2"],["align","end"],["mat-button","","mat-dialog-close",""],[1,"hover:bg-gray-50"],[1,"border","px-4","py-2","font-bold"],["target","_blank",1,"text-blue-500",3,"href"],[1,"max-w-40","line-clamp-4","font-bold",3,"ngClass"]],template:function(t,n){if(t&1){let a=w();i(0,"mat-drawer-container",5)(1,"mat-drawer",6,0),v(3,"router-outlet"),o(),i(4,"div",7)(5,"div",8)(6,"div",9)(7,"input",10),x("keyup",function(p){return d(a),h(n.applyFilter(p))}),o(),i(8,"div",11)(9,"span",12),l(10,"search"),o()()(),i(11,"span",13),x("click",function(){return d(a),h(n.gotoDexuat())}),l(12,"Xu\u1EA5t Nh\u1EADp T\xF4n Theo Ng\xE0y"),o(),i(13,"button",14)(14,"mat-icon"),l(15,"tune"),o()(),i(16,"mat-menu",null,1)(18,"div",15)(19,"mat-form-field",16)(20,"input",17),x("input",function(p){return d(a),h(n.doFilterColumns(p))})("click",function(p){return d(a),h(p.stopPropagation())}),o(),i(21,"mat-icon",18),l(22,"search"),o()()(),i(23,"div",19),X(24,qe,5,2,"button",20,Qe),o()()(),i(26,"div",21)(27,"table",22),X(28,_i,3,1,"ng-container",23,Q),g(30,xi,1,0,"tr",24)(31,fi,1,0,"tr",25)(32,gi,3,0,"tr",26),o()(),v(33,"mat-paginator",27),o()(),g(34,yi,35,3,"ng-template",null,2,H)(36,Ei,35,3,"ng-template",null,3,H)}if(t&2){let a=D(17);m(),_("position","end"),m(12),_("matMenuTriggerFor",a),m(11),A(n.FilterColumns),m(3),_("dataSource",n.dataSource),m(),A(n.displayedColumns),m(2),_("matHeaderRowDef",n.displayedColumns),m(),_("matRowDefColumns",n.displayedColumns),m(2),_("pageSizeOptions",Y(6,Ke))}},dependencies:[wt,vt,Et,kt,Dt,Kt,Pt,$t,Yt,Xt,Bt,Rt,At,Nt,Ht,zt,Ot,Vt,P,Lt,It,V,ht,ut,pt,dt,st,rt,lt,Z,ct,mt,at,it,nt,Tt,G,J,j,U,ue,pe,_t,Ft,Mt,Jt,St,ft,gt,yt,Ct],encapsulation:2})};B([jt()],z.prototype,"FilterHederColumn",1),B([Ut(300)],z.prototype,"doFilterHederColumn",1);var ae=z;var vi=["drawer"],De=()=>({standalone:!0}),wi=()=>[10,25,50,100],Te=(r,e,t,n,a)=>({"text-blue-500":r,"text-yellow-500":e,"text-green-500":t,"text-purple-500":n,"text-red-500":a}),Di=(r,e)=>e.key;function ki(r,e){if(r&1){let t=w();i(0,"app-detaildexuat",11),x("DexuatEmit",function(a){d(t);let s=c();return h(s.isDexuat=a)}),o()}}function Ti(r,e){if(r&1){let t=w();i(0,"button",39),x("click",function(a){let s=d(t).$implicit;return c(2).toggleColumn(s),h(a.stopPropagation())}),i(1,"mat-icon"),l(2),o(),i(3,"span"),l(4),o()()}if(r&2){let t=e.$implicit;m(2),u(t.isShow?"check_box":"check_box_outline_blank"),m(2),u(t.value)}}function bi(r,e){r&1&&(i(0,"span",56),l(1,"check"),o())}function Mi(r,e){if(r&1&&(i(0,"span"),l(1),o()),r&2){let t=c().$implicit,n=c(3).$implicit,a=c(2);m(),u(a.formatDate(t[n]))}}function Fi(r,e){if(r&1&&(i(0,"span"),l(1),o()),r&2){let t=c().$implicit,n=c(3).$implicit;m(),f(" ",t[n]||"Tr\u1ED1ng","")}}function Ii(r,e){if(r&1){let t=w();i(0,"div",54),x("click",function(){let a=d(t).$implicit,s=c(3).$implicit,p=c(2);return h(p.ChosenItem(a,s))}),g(1,bi,2,0,"span",55)(2,Mi,2,1,"span")(3,Fi,2,1,"span"),o()}if(r&2){let t,n=e.$implicit,a=c(3).$implicit,s=c(2);m(),_("ngIf",s.CheckItem(n)),m(),M((t=a)==="ngay"?2:3)}}function Li(r,e){if(r&1){let t=w();i(0,"span",44,6),l(2," filter_alt "),o(),i(3,"mat-menu",null,7)(5,"div",45),x("click",function(a){return d(t),h(a.stopPropagation())}),i(6,"div",46)(7,"input",14),x("keyup",function(a){d(t);let s=c(2).$implicit,p=c(2);return h(p.doFilterHederColumn(a,s))}),o(),i(8,"div",15)(9,"span",16),l(10,"search"),o()()(),i(11,"div",47)(12,"div",12)(13,"span",48),x("click",function(){d(t);let a=c(2).$implicit,s=c(2);return h(s.ChosenAll(s.FilterHederColumn(s.dataSource.filteredData,a)))}),l(14),o(),i(15,"span",48),x("click",function(){d(t);let a=c(4);return h(a.EmptyFiter())}),l(16,"Xo\xE1"),o()(),i(17,"span",48),x("click",function(){d(t);let a=c(4);return h(a.ResetFilter())}),l(18,"Reset"),o()(),i(19,"div",49),g(20,Ii,4,2,"div",50),o(),i(21,"div",51)(22,"button",52),x("click",function(){d(t);let a=D(1);return h(a.closeMenu())}),l(23,"\u0110\xF3ng"),o(),i(24,"button",53),x("click",function(){d(t);let a=D(1),s=c(4);return h(s.ApplyFilterColum(a))}),l(25,"\xC1p D\u1EE5ng"),o()()()()}if(r&2){let t=D(4),n=c(2).$implicit,a=c(2);_("matMenuTriggerFor",t),m(14),f("Ch\u1ECDn T\u1EA5t C\u1EA3 ",a.FilterHederColumn(a.dataSource.filteredData,n).length||0,""),m(6),_("ngForOf",a.FilterHederColumn(a.dataSource.filteredData,n))("ngForTrackBy",a.trackByFn)}}function Vi(r,e){if(r&1&&(i(0,"th",42)(1,"span",43),l(2),o(),g(3,Li,26,4),o()),r&2){let t=c().$implicit,n=c(2);m(2),f(" ",n.ColumnName[t]," "),m(),M(t!=="STT"&&t!=="actions"?3:-1)}}function Pi(r,e){if(r&1&&(i(0,"span",58),l(1),o()),r&2){let t=c().index;m(),f(" ",t+1," ")}}function Bi(r,e){if(r&1&&(i(0,"span",59),l(1),o()),r&2){let t=c().$implicit;m(),f(" ",t.title," ")}}function $i(r,e){if(r&1&&(i(0,"span",60),l(1),o()),r&2){let t=c().$implicit,n=c(3);m(),f(" ",n.formatDateTime(t.ngay)," ")}}function Xi(r,e){if(r&1){let t=w();i(0,"div",61)(1,"button",62),x("click",function(){d(t);let a=c().$implicit,s=c(3);return h(s.viewChotkhoDetail(a))}),i(2,"mat-icon"),l(3,"visibility"),o()(),i(4,"button",63),x("click",function(){d(t);let a=c().$implicit,s=c(3);return h(s.editChotkho(a))}),i(5,"mat-icon"),l(6,"edit"),o()(),i(7,"button",64),x("click",function(){d(t);let a=c().$implicit,s=c(3);return h(s.deleteChotkho(a))}),i(8,"mat-icon"),l(9,"delete"),o()()()}}function Ai(r,e){if(r&1&&(i(0,"span",58),l(1),o()),r&2){let t=c().$implicit,n=c().$implicit;m(),f(" ",t[n]," ")}}function Ni(r,e){if(r&1&&(i(0,"td",57),g(1,Pi,2,1,"span",58)(2,Bi,2,1,"span",59)(3,$i,2,1,"span",60)(4,Xi,10,0,"div",61)(5,Ai,2,1,"span",58),o()),r&2){let t,n=c().$implicit;m(),M((t=n)==="STT"?1:t==="title"?2:t==="ngay"?3:t==="actions"?4:5)}}function Yi(r,e){if(r&1&&(q(0,34),g(1,Vi,4,2,"th",40)(2,Ni,6,1,"td",41),W()),r&2){let t=e.$implicit;_("matColumnDef",t)}}function Ri(r,e){r&1&&v(0,"tr",65)}function Hi(r,e){if(r&1){let t=w();i(0,"tr",66),x("click",function(){let a=d(t).$implicit,s=c(2);return h(s.viewChotkhoDetail(a))}),o()}}function zi(r,e){if(r&1&&(i(0,"tr",67)(1,"td",68)(2,"div",69)(3,"mat-icon",70),l(4,"inventory_2"),o(),i(5,"p",71),l(6,"Kh\xF4ng t\xECm th\u1EA5y d\u1EEF li\u1EC7u ch\u1ED1t kho"),o(),i(7,"p",72),l(8,"Th\u1EED thay \u0111\u1ED5i b\u1ED9 l\u1ECDc ho\u1EB7c t\u1EA1o ch\u1ED1t kho m\u1EDBi"),o()()()()),r&2){let t=c(2);m(),ce("colspan",t.displayedColumns.length)}}function Oi(r,e){if(r&1){let t=w();i(0,"div",12)(1,"div",13)(2,"input",14),x("keyup",function(a){d(t);let s=c();return h(s.applyFilter(a))}),o(),i(3,"div",15)(4,"span",16),l(5,"search"),o()()(),i(6,"span",17),x("click",function(){d(t);let a=c();return h(a.isDexuat=!a.isDexuat)}),l(7,"\u0110\u1EC1 Xu\u1EA5t"),o(),i(8,"a",18),l(9,"T\u1EA1o Ch\u1ED1t Kho"),o(),i(10,"button",19)(11,"mat-icon"),l(12,"tune"),o()(),i(13,"mat-menu",null,3)(15,"div",20)(16,"mat-form-field",21)(17,"input",22),x("input",function(a){d(t);let s=c();return h(s.doFilterColumns(a))})("click",function(a){return d(t),h(a.stopPropagation())}),o(),i(18,"mat-icon",23),l(19,"search"),o()()(),i(20,"div",24),X(21,Ti,5,2,"button",25,Di),o()()(),i(23,"div",26)(24,"mat-form-field",27)(25,"mat-label"),l(26,"B\u1EAFt \u0110\u1EA7u"),o(),i(27,"input",28),le("ngModelChange",function(a){d(t);let s=c();return re(s.SearchParams.startDate,a)||(s.SearchParams.startDate=a),h(a)}),o(),v(28,"mat-datepicker-toggle",29)(29,"mat-datepicker",null,4),o(),i(31,"mat-form-field",27)(32,"mat-label"),l(33,"K\u1EBFt Th\xFAc"),o(),i(34,"input",28),le("ngModelChange",function(a){d(t);let s=c();return re(s.SearchParams.endDate,a)||(s.SearchParams.endDate=a),h(a)}),o(),v(35,"mat-datepicker-toggle",29)(36,"mat-datepicker",null,5),o(),i(38,"button",30),x("click",function(){d(t);let a=c();return h(a.LoadDondathang())}),i(39,"mat-icon"),l(40,"search"),o()(),i(41,"button",31),x("click",function(){d(t);let a=c();return h(a.ngOnInit())}),i(42,"mat-icon"),l(43,"cached"),o()()(),i(44,"div",32)(45,"table",33),X(46,Yi,3,1,"ng-container",34,Q),g(48,Ri,1,0,"tr",35)(49,Hi,1,0,"tr",36)(50,zi,9,1,"tr",37),o()(),v(51,"mat-paginator",38)}if(r&2){let t=D(14),n=D(30),a=D(37),s=c();m(10),_("matMenuTriggerFor",t),m(11),A(s.FilterColumns),m(3),_("appearance","outline")("subscriptSizing","dynamic"),m(3),_("matDatepicker",n),oe("ngModel",s.SearchParams.startDate),_("ngModelOptions",Y(18,De)),m(),_("for",n),m(3),_("appearance","outline")("subscriptSizing","dynamic"),m(3),_("matDatepicker",a),oe("ngModel",s.SearchParams.endDate),_("ngModelOptions",Y(19,De)),m(),_("for",a),m(10),_("dataSource",s.dataSource),m(),A(s.displayedColumns),m(2),_("matHeaderRowDef",s.displayedColumns),m(),_("matRowDefColumns",s.displayedColumns),m(2),_("pageSizeOptions",Y(20,wi))("showFirstLastButtons",!0)}}function Ki(r,e){if(r&1&&(i(0,"tr",84)(1,"td",81),l(2),o(),i(3,"td",85)(4,"a",86),l(5),o()(),i(6,"td",81)(7,"span",87),l(8),o()(),i(9,"td",81),l(10),o(),i(11,"td",81),l(12),o(),i(13,"td",81),l(14),o(),i(15,"td",81),l(16),o(),i(17,"td",81),l(18),o()()),r&2){let t=e.$implicit,n=c(2);m(2),u(t.title),m(2),N("href","/admin/dathang/",t.id,"",$),m(),f(" ",t.madncc," "),m(2),_("ngClass",R(11,Te,t.status==="dadat",t.status==="dagiao",t.status==="danhan",t.status==="hoanthanh",t.status==="huy")),m(),f(" ",n.Trangthaidon[t.status]," "),m(2),u(t.nhacungcap.name),m(2),u(t.sanpham.sanpham.title),m(2),u(t.sanpham.sldat),m(2),u(t.sanpham.slnhan),m(2),u(n.formatDate(t.createdAt))}}function Qi(r,e){if(r&1&&(i(0,"h2",73),l(1,"Chi Ti\u1EBFt \u0110\u1EB7t H\xE0ng"),o(),i(2,"mat-dialog-content",74)(3,"table",75)(4,"thead")(5,"tr",76)(6,"th",77),l(7,"Ti\xEAu \u0111\u1EC1"),o(),i(8,"th",77),l(9,"M\xE3 \u0110\u1EB7t"),o(),i(10,"th",77),l(11,"Tr\u1EA1ng th\xE1i"),o(),i(12,"th",77),l(13,"Nh\xE0 Cung C\u1EA5p"),o(),i(14,"th",77),l(15,"T\xEAn S\u1EA3n Ph\u1EA9m"),o(),i(16,"th",77),l(17,"S\u1ED1 L\u01B0\u1EE3ng \u0110\u1EB7t"),o(),i(18,"th",77),l(19,"S\u1ED1 L\u01B0\u1EE3ng Nh\u1EADn"),o(),i(20,"th",77),l(21,"Ng\xE0y"),o()()(),i(22,"tbody"),g(23,Ki,19,17,"tr",78),i(24,"tr",79)(25,"td",80),l(26,"T\u1ED5ng c\u1ED9ng:"),o(),i(27,"td",81),l(28),o(),i(29,"td",81),l(30),o(),v(31,"td",81),o()()()(),i(32,"mat-dialog-actions",82)(33,"button",83),l(34,"\u0110\xF3ng"),o()()),r&2){let t=c();m(23),_("ngForOf",t.ListDathang),m(5),u(t.TinhTong(t.ListDathang,"sldat")),m(2),u(t.TinhTong(t.ListDathang,"slnhan"))}}function qi(r,e){if(r&1&&(i(0,"tr",84)(1,"td",81),l(2),o(),i(3,"td",85)(4,"a",86),l(5),o()(),i(6,"td",81)(7,"span",87),l(8),o()(),i(9,"td",81),l(10),o(),i(11,"td",81),l(12),o(),i(13,"td",81),l(14),o(),i(15,"td",81),l(16),o(),i(17,"td",81),l(18),o()()),r&2){let t=e.$implicit,n=c(2);m(2),u(t.title),m(2),N("href","/admin/donhang/",t.id,"",$),m(),f(" ",t.madonhang," "),m(2),_("ngClass",R(11,Te,t.status==="dadat",t.status==="dagiao",t.status==="danhan",t.status==="hoanthanh",t.status==="huy")),m(),f(" ",n.Trangthaidon[t.status]," "),m(2),u(t.khachhang.name),m(2),u(t.sanpham.sanpham.title),m(2),u(t.sanpham.sldat),m(2),u(t.sanpham.slnhan),m(2),u(n.formatDate(t.createdAt))}}function Wi(r,e){if(r&1&&(i(0,"h2",73),l(1,"Chi Ti\u1EBFt \u0110\u01A1n H\xE0ng"),o(),i(2,"mat-dialog-content",74)(3,"table",75)(4,"thead")(5,"tr",76)(6,"th",77),l(7,"Ti\xEAu \u0111\u1EC1"),o(),i(8,"th",77),l(9,"M\xE3 \u0110\u01A1n"),o(),i(10,"th",77),l(11,"Tr\u1EA1ng th\xE1i"),o(),i(12,"th",77),l(13,"Nh\xE0 Cung C\u1EA5p"),o(),i(14,"th",77),l(15,"T\xEAn S\u1EA3n Ph\u1EA9m"),o(),i(16,"th",77),l(17,"S\u1ED1 L\u01B0\u1EE3ng \u0110\u1EB7t"),o(),i(18,"th",77),l(19,"S\u1ED1 L\u01B0\u1EE3ng Nh\u1EADn"),o(),i(20,"th",77),l(21,"Ng\xE0y"),o()()(),i(22,"tbody"),g(23,qi,19,17,"tr",78),i(24,"tr",79)(25,"td",80),l(26,"T\u1ED5ng c\u1ED9ng:"),o(),i(27,"td",81),l(28),o(),i(29,"td",81),l(30),o(),v(31,"td",81),o()()()(),i(32,"mat-dialog-actions",82)(33,"button",83),l(34,"\u0110\xF3ng"),o()()),r&2){let t=c();m(23),_("ngForOf",t.ListDonhang),m(5),u(t.TinhTong(t.ListDonhang,"sldat")),m(2),u(t.TinhTong(t.ListDonhang,"slnhan"))}}var O=class O{isDexuat=!0;Detail={};displayedColumns=["STT","title","ngay","actions"];ColumnName={STT:"STT",title:"Ti\xEAu \u0111\u1EC1 ch\u1ED1t kho",ngay:"Ng\xE0y ch\u1ED1t",actions:"Thao t\xE1c"};FilterColumns=JSON.parse(localStorage.getItem("ChotkhoColFilter")||"[]");Columns=[];isFilter=!1;paginator;sort;drawer;filterValues={};_PhieukhoService=C(ee);_SanphamService=C(te);_DathangService=C(Gt);_DonhangService=C(Zt);_KhoService=C(ie);_ChotkhoService=C(ve);_timezoneService=C(Ee);_breakpointObserver=C(tt);_router=C(de);Xuatnhapton=this._ChotkhoService.ListChotkho;ListChotkho=this._ChotkhoService.ListChotkho;dataSource=new Qt([]);_snackBar=C(ot);CountItem=0;SearchParams={startDate:(0,se.default)().subtract(7,"days").format("YYYY-MM-DD"),endDate:(0,se.default)().format("YYYY-MM-DD"),page:1,limit:20};ListDate=[{id:1,Title:"1 Ng\xE0y",value:"day"},{id:2,Title:"1 Tu\u1EA7n",value:"week"},{id:3,Title:"1 Th\xE1ng",value:"month"},{id:4,Title:"1 N\u0103m",value:"year"}];Chonthoigian="week";isSearch=!1;ListKho=[];constructor(){this.displayedColumns.forEach(e=>{this.filterValues[e]=""})}createFilter(){return(e,t)=>{let n=JSON.parse(t),a=!0;return this.displayedColumns.forEach(s=>{if(n[s]){let p=e[s]?e[s].toString().toLowerCase():"";a=a&&p.includes(n[s].toLowerCase())}}),a}}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource?.paginator?.firstPage()}LoadDondathang(){return E(this,null,function*(){try{let e=yield this._ChotkhoService.getChotkhoByDateRange(this.SearchParams);console.log("Chot kho result:",e),e&&e.data&&(this.ListChotkho.set(e.data),this.dataSource.data=e.data,this.CountItem=e.total||e.data.length,this.paginator&&(this.paginator.length=e.total||e.data.length,this.paginator.pageIndex=(e.page||1)-1,this.paginator.pageSize=e.limit||20)),this.dataSource.sort=this.sort}catch(e){console.error("Error loading chot kho data:",e),this._snackBar.open("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u ch\u1ED1t kho","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}ngOnInit(){return E(this,null,function*(){try{let e=yield this._ChotkhoService.getChotkhoByDateRange(this.SearchParams);console.log("Initial chot kho result:",e),e&&e.data&&(this.ListChotkho.set(e.data),this.dataSource.data=e.data,this.CountItem=e.total||e.data.length),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.initializeColumns(),this.setupDrawer(),this.paginator&&(this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i")}catch(e){console.error("Error in ngOnInit:",e),this._snackBar.open("L\u1ED7i khi kh\u1EDFi t\u1EA1o d\u1EEF li\u1EC7u","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}createchotkho(){this.drawer.open(),this._router.navigate(["admin/xuatnhapton","new"])}viewChotkhoDetail(e){this.drawer.open(),window.location.href=`/admin/xuatnhapton/${this._timezoneService.formatForDisplay(e.ngay,"YYYY-MM-DD")}`}editChotkho(e){this.drawer.open(),window.location.href=`/admin/xuatnhapton/${this._timezoneService.formatForDisplay(e.ngay,"YYYY-MM-DD")}`}deleteChotkho(e){return E(this,null,function*(){try{yield this._ChotkhoService.DeleteChotkho(e),this._snackBar.open("X\xF3a ch\u1ED1t kho th\xE0nh c\xF4ng","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch(t){console.error("Error deleting chot kho:",t),this._snackBar.open("L\u1ED7i khi x\xF3a ch\u1ED1t kho","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(e=>({key:e,value:this.ColumnName[e],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("ChotkhoColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{})}setupDrawer(){this._breakpointObserver.observe([et.Handset]).subscribe(e=>{e.matches?(this.drawer.mode="over",this.paginator&&(this.paginator.hidePageSize=!0)):this.drawer.mode="side"})}toggleColumn(e){let t=this.FilterColumns.find(n=>n.key===e.key);t&&(t.isShow=!t.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{}),localStorage.setItem("ChotkhoColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(e){let t=e.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(n=>n.value.toLowerCase().includes(t))}FilterHederColumn(e,t){return e.filter((a,s,p)=>s===p.findIndex(S=>S[t]===a[t]))}doFilterHederColumn(e,t){let n=e.target.value.toLowerCase();console.log(n),console.log(t),this.dataSource.filteredData=this.ListChotkho().filter(a=>bt(a[t]?.toString()||"").includes(n)||(a[t]?.toString()||"").toLowerCase().includes(n))}trackByFn(e,t){return t.id}ListFilter=[];ChosenItem(e,t){let n=this.dataSource.filteredData.filter(s=>s[t]===e[t]);this.ListFilter.filter(s=>s[t]===e[t]).length>0?this.ListFilter=this.ListFilter.filter(s=>s[t]!==e[t]):this.ListFilter=[...this.ListFilter,...n]}ChosenAll(e){e.forEach(t=>{!!this.ListFilter.find(a=>a.id===t.id)?this.ListFilter=this.ListFilter.filter(a=>a.id!==a.id):this.ListFilter.push(t)})}ResetFilter(){this.ListFilter=this.ListChotkho(),this.dataSource.data=this.ListChotkho(),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}EmptyFiter(){this.ListFilter=[]}CheckItem(e){return!!this.ListFilter.find(t=>t.id===e.id)}ApplyFilterColum(e){this.dataSource.data=this.ListChotkho().filter(t=>this.ListFilter.some(n=>n.id===t.id)),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,e.closeMenu()}ExportExcel(e,t){return E(this,null,function*(){yield this._SanphamService.getAllSanpham();let n=this._SanphamService.ListSanpham().map(s=>({subtitle:s.subtitle,masp:s.masp,title:s.title,dvt:s.dvt})),a=this.Xuatnhapton().map(s=>({masp:s.masp,title:s.title,dvt:s.dvt,slton:s.slton}));qt({SP:n,XNT:a},t)})}ImporExcel(e){return E(this,null,function*(){let t=Array.from(e.target.files),n=yield Wt(t[0],"XNT"),a=[],s=[];n.forEach(p=>{let S=this.Xuatnhapton().find(b=>b.masp===p.masp);S&&(p.slton>S.slton?a.push({sanphamId:this._SanphamService.ListSanpham().find(b=>b.masp===p.masp).id,soluong:p.slton-S.slton}):p.slton<S.slton&&s.push({sanphamId:this._SanphamService.ListSanpham().find(b=>b.masp===p.masp).id,soluong:S.slton-p.slton}))}),a.length>0&&this._PhieukhoService.CreatePhieukho({title:`\u0110i\u1EC1u Ch\u1EC9nh Kho Ng\xE0y ${this._timezoneService.nowLocal("DD/MM/YYYY ")}`,type:"nhap",sanpham:a,ghichu:`C\u1EADp nh\u1EADt t\u1ED3n kho l\xFAc ${this._timezoneService.nowLocal("HH:mm:ss DD/MM/YYYY ")}`,ngay:new Date}),s.length>0&&this._PhieukhoService.CreatePhieukho({title:`\u0110i\u1EC1u Ch\u1EC9nh Kho Ng\xE0y ${this._timezoneService.nowLocal("DD/MM/YYYY ")}`,type:"xuat",sanpham:s,ghichu:`C\u1EADp nh\u1EADt t\u1ED3n kho l\xFAc ${this._timezoneService.nowLocal("HH:mm:ss DD/MM/YYYY ")}`,ngay:new Date}),a.length>0&&this._snackBar.open(`\u0110i\u1EC1u ch\u1EC9nh nh\u1EADp kho v\u1EDBi ${a.length} s\u1EA3n ph\u1EA9m`,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),s.length>0&&this._snackBar.open(`\u0110i\u1EC1u ch\u1EC9nh xu\u1EA5t kho v\u1EDBi ${s.length} s\u1EA3n ph\u1EA9m`,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),a.length===0&&s.length===0&&this._snackBar.open("Kho kh\xF4ng thay \u0111\u1ED5i","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}_dialog=C(xt);Trangthaidon=ne;ListDathang=[];ListDonhang=[];XemDathang(e,t){return E(this,null,function*(){this.ListDathang=yield this._DathangService.findbysanpham(e.sanphamId),console.log(this.ListDathang),this._dialog.open(t,{hasBackdrop:!0,disableClose:!0}).afterClosed().subscribe(a=>{})})}XemDonhang(e,t){return E(this,null,function*(){this.ListDonhang=yield this._DonhangService.findbysanpham(e.sanphamId),console.log(this.ListDonhang),this._dialog.open(t,{hasBackdrop:!0,disableClose:!0}).afterClosed().subscribe(a=>{})})}TinhTong(e,t){return e?.reduce((n,a)=>n+(Number(a?.sanpham[t])||0),0)||0}formatDate(e,t="DD/MM/YYYY"){return e?this._timezoneService.formatForDisplay(e,t):""}formatDateTime(e){return e?this._timezoneService.formatForDisplay(e,"DD/MM/YYYY HH:mm"):""}formatDateTimeSeconds(e){return e?this._timezoneService.formatForDisplay(e,"HH:mm:ss DD/MM/YYYY"):""}static \u0275fac=function(t){return new(t||O)};static \u0275cmp=K({type:O,selectors:[["app-xuatnhapton"]],viewQuery:function(t,n){if(t&1&&(F(V,5),F(P,5),F(vi,7)),t&2){let a;I(a=L())&&(n.paginator=a.first),I(a=L())&&(n.sort=a.first),I(a=L())&&(n.drawer=a.first)}},decls:11,vars:2,consts:[["drawer",""],["DathangDialog",""],["DonhangDialog",""],["menu","matMenu"],["pickerBatdau",""],["pickerKetthuc",""],["menuTrigger","matMenuTrigger"],["filterMenu","matMenu"],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[3,"DexuatEmit"],[1,"flex","flex-row","space-x-2","items-center"],[1,"relative"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"cursor-pointer","p-2","rounded-lg","border","hover:bg-slate-50",3,"click"],["href","/admin/xuatnhapton/new",1,"cursor-pointer","p-2","rounded-lg","border","hover:bg-slate-50"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],[1,"flex","flex-row","gap-2","items-center","w-full"],[3,"appearance","subscriptSizing"],["matInput","",3,"ngModelChange","matDatepicker","ngModel","ngModelOptions"],["matIconSuffix","",3,"for"],["matTooltip","T\xECm Ki\u1EBFm","color","primary","mat-icon-button","",3,"click"],["color","primary","mat-icon-button","",3,"click"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"excelstyle","!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 cursor-pointer",3,"click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions","showFirstLastButtons"],["mat-menu-item","",3,"click"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],[1,"z-10","material-symbols-outlined","text-gray-500",3,"matMenuTriggerFor"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],[1,"flex","flex-row","space-x-2","items-center","justify-between"],[1,"text-xs","text-blue-600","underline",3,"click"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],["class","flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","font-medium","text-gray-900"],[1,"max-w-40","line-clamp-4","text-sm","text-gray-600"],[1,"flex","space-x-2"],["mat-icon-button","","color","primary","matTooltip","Xem chi ti\u1EBFt",3,"click"],["mat-icon-button","","color","accent","matTooltip","Ch\u1EC9nh s\u1EEDa",3,"click"],["mat-icon-button","","color","warn","matTooltip","X\xF3a",3,"click"],["mat-header-row",""],["mat-row","",1,"hover:bg-gray-50","cursor-pointer",3,"click"],[1,"mat-row"],[1,"mat-cell","p-4"],[1,"text-center","py-8"],[1,"text-gray-400","text-4xl"],[1,"mt-2","text-gray-500"],[1,"text-sm","text-gray-400"],["mat-dialog-title",""],[1,"mat-typography"],[1,"w-full","border-collapse","border","border-gray-300"],[1,"bg-gray-100"],[1,"border","border-gray-300","px-4","py-2","text-left"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"bg-gray-100","font-bold"],["colspan","5",1,"border","border-gray-300","px-4","py-2"],[1,"border","border-gray-300","px-4","py-2"],["align","end"],["mat-button","","mat-dialog-close",""],[1,"hover:bg-gray-50"],[1,"border","px-4","py-2","font-bold"],["target","_blank",1,"text-blue-500",3,"href"],[1,"max-w-40","line-clamp-4","font-bold",3,"ngClass"]],template:function(t,n){t&1&&(i(0,"mat-drawer-container",8)(1,"mat-drawer",9,0),v(3,"router-outlet"),o(),i(4,"div",10),g(5,ki,1,0,"app-detaildexuat")(6,Oi,52,21),o()(),g(7,Qi,35,3,"ng-template",null,1,H)(9,Wi,35,3,"ng-template",null,2,H)),t&2&&(m(),_("position","end"),m(4),M(n.isDexuat?5:6))},dependencies:[wt,vt,fe,Et,ge,kt,Dt,Kt,Pt,$t,Yt,Xt,Bt,Rt,At,Nt,Ht,zt,Ot,Vt,P,Lt,It,V,ht,ut,pt,dt,st,rt,lt,Z,ct,mt,at,it,nt,Tt,G,J,j,U,_t,he,_e,xe,Ft,Mt,Jt,Ce,ye,Se,St,ft,gt,yt,Ct,ae],encapsulation:2})};B([jt()],O.prototype,"FilterHederColumn",1),B([Ut(300)],O.prototype,"doFilterHederColumn",1);var ke=O;export{ke as a};
