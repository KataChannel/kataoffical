import{a as Te}from"./chunk-4EMRUDMX.js";import{a as M,b as _e}from"./chunk-R6LBO2DX.js";import{a as b,b as Ce,c as De}from"./chunk-CNJR64C4.js";import{b as R,c as se}from"./chunk-STTHC4C4.js";import{a as Y,b as Z,c as ee}from"./chunk-NBRWFLNC.js";import{d as ie}from"./chunk-NJTM6TIW.js";import{b as G,c as T}from"./chunk-3ULLR243.js";import{a as u}from"./chunk-H7UDLENL.js";import{a as X}from"./chunk-2QVTWX3V.js";import{a as le,b as ce,c as me,e as ue,f as pe,h as de,i as he,k as fe,l as ge,n as ye,o as ve,p as we,q as Se}from"./chunk-DFQ3WBEG.js";import{c as ne}from"./chunk-XBYFTIM3.js";import{C as oe,s as ae}from"./chunk-5PCRWSUQ.js";import{a as te,b as re}from"./chunk-Q4HMHGF2.js";import{c as K,e as W}from"./chunk-VA3CEBIV.js";import{y as Q,z as U}from"./chunk-G22JNWMU.js";import{x as H,z}from"./chunk-HUFFEFIS.js";import{Bc as J,Cc as d,Db as j,Ec as D,Kb as y,Lc as F,Ra as k,Ub as m,Wa as N,_b as E,ac as A,bc as q,cc as B,dc as s,ec as l,fc as v,gc as $,hc as V,ja as O,jc as I,oa as h,oc as w,pa as P,qc as p,rb as n,wb as x,wc as S,xc as _,ya as f,yc as C,za as g}from"./chunk-5IRI5K5U.js";import{j as c}from"./chunk-6DYNGEAS.js";var L=class a{constructor(r,t,e){this._StorageService=r;this.platformId=t;this.router=e;this.isBrowser=z(this.platformId)}_authenticated=!1;APIURL=u.APIURL;isBrowser;ListDanhmuc=k([]);Danhmuc=k({});getDanhmucDrive(r){return c(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},i=yield(yield fetch(`https://sheets.googleapis.com/v4/spreadsheets/${r.IdSheet}/values/${r.SheetName}?key=${r.ApiKey}`,t)).json();return console.log(i),i}catch(t){return console.error(t)}})}getAllDanhmuc(){return c(this,null,function*(){try{let r={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},t=yield fetch(`${u.APIURL}/danhmucs`,r);t.ok;let e=yield t.json();return this.ListDanhmuc.set(e),e}catch(r){return console.error(r)}})}SearchDanhmuc(r){return c(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},e=yield fetch(`${u.APIURL}/setting/search`,t);if(!e.ok)if(e.status===401){let o=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else if(e.status===403){let o=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else if(e.status===500){let o=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else{let o=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}let i=yield e.json();return this.Danhmuc.set(i.items),i}catch(t){return console.error(t)}})}getDanhmucByid(r){return c(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},e=yield fetch(`${u.APIURL}/danhmucs/${r}`,t);if(!e.ok)if(e.status===401){let o=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else if(e.status===403){let o=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else if(e.status===500){let o=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else{let o=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}let i=yield e.json();this.Danhmuc.set(i)}catch(t){return console.error(t)}})}updateOneDanhmuc(r){return c(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(r)},e=yield fetch(`${u.APIURL}/danhmucs/${r.id}`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let i=yield e.json();return e.ok,this.getAllDanhmuc(),i}catch(t){return console.error(t)}})}DeleteDanhmuc(r){return c(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},e=yield fetch(`${u.APIURL}/danhmucs/${r.id}`,t);if(!e.ok)if(e.status===401){let i=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(e.status===403){let i=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(e.status===500){let i=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else{let i=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}return this.getAllDanhmuc(),yield e.json()}catch(t){return console.error(t)}})}static \u0275fac=function(t){return new(t||a)(h(X),h(N),h(T))};static \u0275prov=O({token:a,factory:a.\u0275fac,providedIn:"root"})};var ke=["drawer"],xe=()=>[5,10,25,100];function Ie(a,r){}function Re(a,r){if(a&1&&(s(0,"th",22),d(1),l()),a&2){let t=p().$implicit,e=p();n(),D("",e.ColumnName[t]," ")}}function Oe(a,r){if(a&1&&(s(0,"td",23),d(1),l()),a&2){let t=r.$implicit,e=r.index,i=p().$implicit;n(),D(" ",i==="STT"?e+1:t[i]," ")}}function Ne(a,r){if(a&1&&($(0,15),y(1,Re,2,1,"th",20)(2,Oe,2,1,"td",21),V()),a&2){let t=r.$implicit;m("matColumnDef",t)}}function je(a,r){a&1&&v(0,"tr",24)}function Ee(a,r){if(a&1){let t=I();s(0,"tr",25),w("click",function(){let i=f(t).$implicit,o=p();return g(o.goToDetail(i))}),l()}}function Ae(a,r){if(a&1&&(s(0,"tr",26)(1,"td",27),d(2),l()()),a&2){p();let t=J(10);n(2),D('Kh\xF4ng t\xECm th\u1EA5y "',t.value,'"')}}var Me=class a{constructor(r,t){this._breakpointObserver=r;this._router=t}Detail={};dataSource;displayedColumns=["STT","Title","Slug","CreatedAt"];ColumnName={STT:"STT",Title:"Ti\xEAu \u0110\u1EC1",Slug:"\u0110\u01B0\u1EDDng D\u1EABn",CreatedAt:"Ng\xE0y T\u1EA1o"};ListDanhmuc=[];_GoogleSheetService=P(Te);paginator;sort;drawer;_DanhmucsService=P(L);isDownloadDrive=!1;ngOnInit(){return c(this,null,function*(){let r=JSON.parse(localStorage.getItem("ListSheets")||"[]");if(console.log(r),r.length>0){let t=r.find(e=>e.SheetName==="Danhmuc");t&&this._GoogleSheetService.getDrive(t).then(e=>{e.values.length>0&&(this.displayedColumns=e.values[0].map(i=>i),this.ColumnName=se(e.values),this.dataSource=new Se(R(e.values)),this.ListDanhmuc=R(e.values),console.log(this.ListDanhmuc),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)})}this.Detail.id?this.drawer.open():this.drawer.close(),this._breakpointObserver.observe([U.Handset]).subscribe(t=>{t.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})})}GetDrive(){return c(this,null,function*(){})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i",this.paginator.pageSize=30}applyFilter(r){let t=r.target.value;this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}Create(){this.drawer.open(),this._router.navigate(["admin/danhmuc",0])}goToDetail(r){this.drawer.open(),this.Detail=r,this._router.navigate(["admin/danhmuc",r.id])}static \u0275fac=function(t){return new(t||a)(x(Q),x(T))};static \u0275cmp=j({type:a,selectors:[["app-listdanhmuc"]],viewQuery:function(t,e){if(t&1&&(S(M,5),S(b,5),S(ke,7)),t&2){let i;_(i=C())&&(e.paginator=i.first),_(i=C())&&(e.sort=i.first),_(i=C())&&(e.drawer=i.first)}},decls:26,vars:7,consts:[["drawer",""],["input",""],["autosize","",1,"w-full","h-full"],[1,"flex","flex-col","lg:!w-1/3","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","justify-between","p-2"],[1,"flex","flex-col","space-y-2","w-full","p-2"],[1,"cursor-pointer","w-full","relative","grid","lg:grid-cols-2","gap-2","justify-between","items-center"],[1,"w-full","flex","flex-row","space-x-2","items-center"],[1,"relative"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],["mat-icon-button","","color","primary",3,"click"],[1,"w-full"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of danhmucs",3,"pageSizeOptions"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","whitespace-nowrap","mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],["mat-cell","",1,"whitespace-nowrap"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,e){if(t&1){let i=I();s(0,"mat-drawer-container",2)(1,"mat-drawer",3,0),v(3,"router-outlet"),l(),s(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"input",9,1),w("keyup",function(be){return f(i),g(e.applyFilter(be))}),l(),s(11,"div",10)(12,"span",11),d(13,"search"),l()()(),s(14,"button",12),w("click",function(){return f(i),g(e.Create())}),s(15,"mat-icon"),d(16,"add_circle"),l()()()(),y(17,Ie,0,0),s(18,"div",13)(19,"table",14),q(20,Ne,3,1,"ng-container",15,A),y(22,je,1,0,"tr",16)(23,Ee,1,0,"tr",17)(24,Ae,3,1,"tr",18),l(),v(25,"mat-paginator",19),l()()()()}t&2&&(n(),m("position","end"),n(16),E(e.isDownloadDrive?17:-1),n(2),m("dataSource",e.dataSource),n(),B(e.displayedColumns),n(2),m("matHeaderRowDef",e.displayedColumns),n(),m("matRowDefColumns",e.displayedColumns),n(2),m("pageSizeOptions",F(6,xe)))},dependencies:[oe,ne,we,le,me,he,ue,ce,fe,pe,de,ge,ye,ve,De,b,Ce,_e,M,ie,ee,Y,Z,G,re,te,W,K,ae,H],encapsulation:2})};export{Me as a};
