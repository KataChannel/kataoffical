import{a as lt}from"./chunk-XK2GJYFF.js";import{a as ct}from"./chunk-AJ5JTY7X.js";import{a as pt}from"./chunk-GPXTOZIJ.js";import{a as dt}from"./chunk-UCPSMH2E.js";import{a as ut}from"./chunk-WMRWIS4U.js";import{a as at}from"./chunk-DO444VEW.js";import{c as X,h as U}from"./chunk-6T5DLZAF.js";import{a as mt,g as ht,h as D}from"./chunk-CQ7JER2D.js";import{a as gt}from"./chunk-H3TTFDG6.js";import{b as it,c as et,d as nt,e as rt,g as ot,s as st}from"./chunk-AYBK3TLN.js";import{c as $}from"./chunk-QR3VZXMW.js";import{b as tt}from"./chunk-OCCYRB3G.js";import{a as Et}from"./chunk-JNVUT6FC.js";import{d as z}from"./chunk-5NUPTYVB.js";import{a as j,b as J}from"./chunk-WCQZDYIS.js";import{n as W,v as Y,y as Z}from"./chunk-2G4G76BL.js";import{a as Q}from"./chunk-LCSHMLYS.js";import{a as R,e as q}from"./chunk-M4K2YFJY.js";import{y as O}from"./chunk-INKYKFQH.js";import{c as V}from"./chunk-4TLJXXI3.js";import{l as H,m as P,t as K}from"./chunk-4KYRHQES.js";import{Cc as N,Dc as c,Eb as A,Ec as G,Lb as I,Ra as C,Vb as w,Zb as v,dc as s,ec as h,id as F,jc as x,oa as o,oc as d,qc as B,rb as S,wc as b,xa as p,xc as _,ya as u,yc as k}from"./chunk-6QR2UCJZ.js";import{a as T,g as Lt,j as f}from"./chunk-6DYNGEAS.js";var M=Lt(Et());var Ct=["drawer"];function It(l,e){l&1&&(s(0,"mat-icon"),c(1,"check"),h())}function wt(l,e){if(l&1){let i=x();s(0,"span",8),d("click",function(){let n=p(i).$implicit,r=B();return u(r.toggleItem(n))}),I(1,It,2,0,"mat-icon",9),s(2,"span"),c(3),h()()}if(l&2){let i=e.$implicit,t=B();v("",t.CheckItem(i)?"bg-blue-100":""," cursor-pointer flex flex-row space-x-2 items-center p-4 rounded-lg border"),S(),w("ngIf",t.CheckItem(i)),S(2),G(i.title)}}var ft=class l{displayedColumns=[];ColumnName={stt:"#",codeId:"Code",name:"Ti\xEAu \u0110\u1EC1",group:"Nh\xF3m",description:"M\xF4 T\u1EA3",status:"Tr\u1EA1ng Th\xE1i",order:"Th\u1EE9 T\u1EF1",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("ImportdataColFilter")||"[]");Columns=[];paginator;sort;drawer;_BanggiaService=o(ct);_SanphamService=o(dt);_KhachhangService=o(pt);_NhacungcapService=o(ut);_DonhangService=o(at);_DathangService=o(lt);_breakpointObserver=o(O);_GoogleSheetService=o(gt);_router=o(V);_dialog=o(X);_snackBar=o(Q);ListImportdata=C([{id:1,title:"S\u1EA3n Ph\u1EA9m",value:"sanpham",status:!0},{id:2,title:"Kh\xE1ch H\xE0ng",value:"khachhang",status:!0},{id:3,title:"Nh\xE0 Cung C\u1EA5p",value:"nhacungcap",status:!0},{id:4,title:"B\u1EA3ng Gi\xE1",value:"banggia",status:!0},{id:5,title:"\u0110\u01A1n H\xE0ng",value:"donhang",status:!0},{id:6,title:"\u0110\u1EB7t H\xE0ng",value:"dathang",status:!0},{id:7,title:"B\u1EA3ng Gi\xE1 Kh\xE1ch H\xE0ng",value:"banggiakhachhang",status:!0},{id:8,title:"B\u1EA3ng Gi\xE1 S\u1EA3n Ph\u1EA9m",value:"banggiasanpham",status:!0},{id:9,title:"B\u1EA3ng Gi\xE1 Nh\xE0 Cung C\u1EA5p",value:"banggianhacungcap",status:!0},{id:10,title:"B\u1EA3ng Gi\xE1 \u0110\u01A1n H\xE0ng",value:"banggiadonhang",status:!0},{id:11,title:"B\u1EA3ng Gi\xE1 \u0110\u1EB7t H\xE0ng",value:"banggiadathang",status:!0},{id:12,title:"B\u1EA3ng Gi\xE1 \u0110\u01A1n H\xE0ng Kh\xE1ch H\xE0ng",value:"banggiadonhangkhachhang",status:!0},{id:13,title:"B\u1EA3ng Gi\xE1 \u0110\u1EB7t H\xE0ng Kh\xE1ch H\xE0ng",value:"banggiadathangkhachhang",status:!0},{id:14,title:"B\u1EA3ng Gi\xE1 \u0110\u01A1n H\xE0ng Nh\xE0 Cung C\u1EA5p",value:"banggiadonhangnhacungcap",status:!0},{id:15,title:"B\u1EA3ng Gi\xE1 \u0110\u1EB7t H\xE0ng Nh\xE0 Cung C\u1EA5p",value:"banggiadathangnhacungcap",status:!0}]);ListEdit=C([]);TitleExport="export";constructor(){F(()=>{this.ListImportdata.set})}ngOnInit(){return f(this,null,function*(){})}applyFilter(e){}toggleAll(){this.ListEdit().length===this.ListImportdata().length?(this.ListEdit.set([]),this.TitleExport="export"):(this.ListEdit.set(this.ListImportdata()),this.TitleExport="export_all")}toggleItem(e){this.ListEdit().findIndex(t=>t.id===e.id)===-1?(this.TitleExport+="_"+e.value,this.ListEdit.update(t=>[...t,e])):(this.TitleExport=this.TitleExport.replace("_"+e.value,""),this.ListEdit.update(t=>t.filter(n=>n.id!==e.id))),console.log(e),console.log(this.ListEdit())}CheckItem(e){return this.ListEdit().findIndex(t=>t.id===e.id)!==-1}ExportExcel(e){return f(this,null,function*(){yield this._SanphamService.getAllSanpham();let i=this._SanphamService.ListSanpham(),t=Array.isArray(i)&&i.length?i.map(a=>({masp:a.masp,subtitle:a.subtitle,title:a.title,title2:a.title2,giaban:a.giaban,giagoc:a.giagoc,dvt:a.dvt,haohut:a.haohut,ghichu:a.ghichu})):[{masp:"",subtitle:"",title:"",title2:"",giaban:"",giagoc:"",dvt:"",haohut:"",ghichu:""}];yield this._KhachhangService.getAllKhachhang();let n=this._KhachhangService.ListKhachhang(),r=Array.isArray(n)&&n.length?n.map(a=>({name:a.name?.trim()||"",makh:a.makh?.trim()||"",namenn:a.namenn?.trim()||"",diachi:a.diachi?.trim()||"",quan:a.quan?.trim()||"",email:a.email?.trim()||"",sdt:a.sdt?.toString().trim()||"",mst:a.mst?.toString().trim()||"",gionhanhang:a.gionhanhang?.toString().trim()||"",loaikh:a.loaikh?.toString().trim()||"khachsi",hiengia:a.hiengia||!0,ghichu:a.ghichu?.toString().trim()||""})):[{name:"",makh:"",namenn:"",diachi:"",quan:"",email:"",sdt:"",mst:"",gionhanhang:"",loaikh:"khachsi",hiengia:!0,ghichu:""}];yield this._NhacungcapService.getAllNhacungcap();let g=this._NhacungcapService.ListNhacungcap(),yt=Array.isArray(g)&&g.length?g.map(a=>({name:a.name?.trim()||"",mancc:a.mancc?.trim()||"",diachi:a.diachi?.trim()||"",email:a.email?.trim()||"",sdt:a.sdt?.toString().trim()||"",ghichu:a.ghichu?.toString().trim()||""})):[{name:"",mancc:"",diachi:"",email:"",sdt:"",ghichu:""}];yield this._BanggiaService.getAllBanggia();let y=this._BanggiaService.ListBanggia(),St=Array.isArray(y)&&y.length?y.map(a=>({title:a.title?.trim()||"",mabanggia:a.mabanggia?.trim()||"",type:a.type?.trim()||"",batdau:a.batdau?.trim()||"",ketthuc:a.ketthuc?.trim()||"",ghichu:a.ghichu?.trim()||"",status:a.status?.trim()||""})):[{title:"",mabanggia:"",type:"",batdau:"",ketthuc:"",ghichu:"",status:""}];yield this._DonhangService.getAllDonhang();let L=this._DonhangService.ListDonhang(),bt=Array.isArray(L)&&L.length?L.map(a=>({madonhang:a.madonhang?.trim()||"",makh:a.makh?.trim()||"",mancc:a.mancc?.trim()||"",masp:a.masp?.trim()||"",soluong:a.soluong?.trim()||"",giaban:a.giaban?.trim()||"",ghichu:a.ghichu?.trim()||""})):[{madonhang:"",makh:"",mancc:"",masp:"",soluong:"",giaban:"",ghichu:""}];yield this._DathangService.getAllDathang();let E=this._DathangService.ListDathang(),_t=Array.isArray(E)&&E.length?E.map(a=>({madathang:a.madathang?.trim()||"",makh:a.makh?.trim()||"",mancc:a.mancc?.trim()||"",masp:a.masp?.trim()||"",soluong:a.soluong?.trim()||"",giaban:a.giaban?.trim()||"",ghichu:a.ghichu?.trim()||""})):[{madathang:"",makh:"",mancc:"",masp:"",soluong:"",giaban:"",ghichu:""}],kt=this.convertBGSPToExport(y,i),m={};this.ListEdit().some(a=>a.value==="sanpham")&&(m.sanpham={data:t}),this.ListEdit().some(a=>a.value==="khachhang")&&(m.khachhang={data:r}),this.ListEdit().some(a=>a.value==="nhacungcap")&&(m.nhacungcap={data:yt}),this.ListEdit().some(a=>a.value==="banggia")&&(m.banggia={data:St}),this.ListEdit().some(a=>a.value==="donhang")&&(m.donhang={data:bt}),this.ListEdit().some(a=>a.value==="dathang")&&(m.dathang={data:_t}),this.ListEdit().some(a=>a.value==="banggiasanpham")&&(m.banggiasanpham={data:kt}),mt(m,e)})}convertBGSPToExport(e,i){let t=new Set(e.map(n=>n.mabanggia));return i.map(n=>T({masp:n.masp,title:n.title,giaban:n.giaban.toString()},Array.from(t).reduce((r,g)=>(r[g]=n.giaban.toString(),r),{})))}convertBGSPToImport(e){return!e||e.length===0?[]:Object.keys(e[0]).filter(n=>!["masp","title","giagoc"].includes(n)).map(n=>({mabanggia:n,title:`B\u1EA3ng gi\xE1 ${n.replace("BG","")}`,sanpham:e.map(r=>({masp:r.masp,title:r.title,giagoc:r.giagoc,giaban:r[n]||0}))}))}ImportExcel(e){return f(this,null,function*(){let i=yield ht(e);this.DoImportData(i)})}DoImportData(e){return f(this,null,function*(){if(e.sanpham&&e.sanpham.length>0&&this.ListEdit().some(i=>i.value==="sanpham")){let i=(e.sanpham||[]).map(t=>({masp:t.masp,subtitle:t.subtitle,title:t.title,title2:t.title2,giaban:t.giaban,giagoc:t.giagoc,dvt:t.dvt,haohut:t.haohut,ghichu:t.ghichu})).filter(t=>t.masp!==void 0&&t.masp!==null&&t.masp!=="");yield this._SanphamService.ImportSanpham(i)}if(e.khachhang&&e.khachhang.length>0&&this.ListEdit().some(i=>i.value==="khachhang")){let i=(e.khachhang||[]).map(t=>({name:t.name,makh:t.makh,namenn:t.namenn,diachi:t.diachi,quan:t.quan,email:t.email,sdt:t.sdt.toString(),mst:t.mst.toString(),gionhanhang:t.gionhanhang.toString(),loaikh:t.loaikh,ghichu:t.ghichu})).filter(t=>t.makh!==void 0&&t.makh!==null&&t.makh!=="");yield this._KhachhangService.ImportKhachhang(i)}if(e.nhacungcap&&e.nhacungcap.length>0&&this.ListEdit().some(i=>i.value==="nhacungcap")){let i=(e.nhacungcap||[]).map(t=>({name:t.name,mancc:t.mancc,diachi:t.diachi,email:t.email,sdt:t.sdt,ghichu:t.ghichu})).filter(t=>t.mancc!==void 0&&t.mancc!==null&&t.mancc!=="");yield this._NhacungcapService.ImportNhacungcap(i)}if(e.banggia&&e.banggia.length>0&&this.ListEdit().some(i=>i.value==="banggia")){let i=(e.banggia||[]).map(t=>({title:"B\u1EA3ng Gi\xE1 "+t.mabanggia,mabanggia:t.mabanggia,type:t.type,batdau:(0,M.default)(D(t.batdau)).toDate(),ketthuc:(0,M.default)(D(t.ketthuc)).toDate(),ghichu:t.ghichu,status:t.status})).filter(t=>t.mabanggia!==void 0&&t.mabanggia!==null&&t.mabanggia!=="");yield this._BanggiaService.ImportBanggia(i)}if(e.donhang&&e.donhang.length>0&&this.ListEdit().some(i=>i.value==="donhang")){let i=(e.donhang||[]).map(t=>({ngay:t.ngay,makh:t.makh,mabangia:t.mabangia,masp:t.masp,sldat:t.sldat,slgiao:t.slgiao,slnhan:t.slnhan,ghichu:t.ghichu})).filter(t=>t.makh!==void 0&&t.makh!==null&&t.makh!==""&&t.masp!==void 0&&t.masp!==null&&t.masp!=="");yield this._DonhangService.ImportDonhang(i)}if(e.banggiasanpham&&e.banggiasanpham.length>0&&this.ListEdit().some(i=>i.value==="banggiasanpham")){let i=this.convertBGSPToImport(e.banggiasanpham);yield this._BanggiaService.importSPBG(i)}})}trackByFn(e,i){return i.id}static \u0275fac=function(i){return new(i||l)};static \u0275cmp=A({type:l,selectors:[["app-listimportdata"]],viewQuery:function(i,t){if(i&1&&(b(et,5),b(rt,5),b(Ct,7)),i&2){let n;_(n=k())&&(t.paginator=n.first),_(n=k())&&(t.sort=n.first),_(n=k())&&(t.drawer=n.first)}},decls:16,vars:2,consts:[["uploadfile",""],[1,"flex","flex-col","space-y-2","p-8"],[1,"flex","flex-row","space-x-2","items-center"],["mat-flat-button","","color","primary",3,"click"],[1,"ml-1"],["type","file",1,"hidden",3,"change"],[1,"grid","grid-cols-3","gap-4"],[3,"class","click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[4,"ngIf"]],template:function(i,t){if(i&1){let n=x();s(0,"div",1)(1,"div",2)(2,"button",3),d("click",function(){return p(n),u(t.ExportExcel(t.TitleExport))}),c(3," T\u1EA3i Xu\u1ED1ng T\u1EA5t C\u1EA3 "),s(4,"mat-icon",4),c(5,"download"),h()(),s(6,"button",3),d("click",function(){p(n);let g=N(13);return u(g.click())}),c(7," T\u1EA3i L\xEAn T\u1EA5t C\u1EA3 "),s(8,"mat-icon",4),c(9,"upload"),h()(),s(10,"button",3),d("click",function(){return p(n),u(t.toggleAll())}),c(11," Ch\u1ECDn T\u1EA5t C\u1EA3 "),h(),s(12,"input",5,0),d("change",function(g){return p(n),u(t.ImportExcel(g))}),h()(),s(14,"div",6),I(15,wt,4,5,"span",7),h()()}i&2&&(S(15),w("ngForOf",t.ListImportdata())("ngForTrackBy",t.trackByFn))},dependencies:[Y,Z,st,ot,nt,z,$,J,j,q,R,tt,K,H,P,W,it,U],encapsulation:2,changeDetection:0})};export{ft as a};
