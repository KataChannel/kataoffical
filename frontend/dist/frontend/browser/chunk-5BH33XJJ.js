import{a as fe}from"./chunk-UK2TDSXW.js";import{a as _e}from"./chunk-HYJYWSS7.js";import"./chunk-QPN3VMX3.js";import{b as de}from"./chunk-45R2NGF5.js";import{c as se,f as ce}from"./chunk-ESCBPH3J.js";import{a as Wt,b as Ut,c as z,d as jt,e as Kt}from"./chunk-DCFSAVWL.js";import{c as Pt,d as Nt,f as It,h as Lt}from"./chunk-PYADMCOB.js";import{e as Yt}from"./chunk-SUUFLDBI.js";import{a as xt,b as Ct,c as yt}from"./chunk-AQE4NBKO.js";import{a as Dt,b as St,c as kt,d as vt}from"./chunk-6KT4XQ7E.js";import"./chunk-Q7E7WSHM.js";import{a as ge}from"./chunk-L5GX4ZSB.js";import"./chunk-AZMUMNOS.js";import{a as ue,b as pe,c as me,k as he}from"./chunk-SL7ME4PY.js";import"./chunk-YGTKRZ2Q.js";import{a as Ht,b as qt,c as Qt,d as Xt,e as Jt,g as Zt,h as te,j as ee,k as ne,m as ae,n as ie,p as oe,q as re,r as le,s as j}from"./chunk-4GW65WCG.js";import{b as Rt}from"./chunk-IZCFLW2T.js";import{b as Mt,g as Et,j as Tt,n as Ft,p as Vt,r as Ot,s as Gt,v as At,w as Bt,y as $t,z as zt}from"./chunk-OAFA7HHQ.js";import"./chunk-AW6ETFJX.js";import{a as bt,b as wt}from"./chunk-UOMYPXRQ.js";import{a as ft}from"./chunk-NX6TSR5R.js";import"./chunk-BXRNUIMR.js";import"./chunk-76RCOOPK.js";import"./chunk-2PPFUFFT.js";import{a as dt,c as gt,e as _t}from"./chunk-MJAN2OV6.js";import{_ as ht,y as pt,z as mt}from"./chunk-FYUVDT4C.js";import{b as ct,c as ut}from"./chunk-VF6Z3BLE.js";import"./chunk-HB5OTZ3Y.js";import{l as ot,m as rt,t as lt,v as st}from"./chunk-CNCZQRZQ.js";import{$b as F,Cc as y,Db as Q,Dc as c,Ec as C,Fc as x,Gc as U,Hc as et,Ic as A,Jc as B,Kb as D,Kc as $,Mc as nt,Sc as b,Tb as X,Ub as _,Uc as w,Wb as L,Xc as at,bc as J,cc as H,dc as q,ec as o,fc as l,gc as E,hc as Z,ic as tt,kc as P,ld as it,pa as v,pc as g,rb as p,rc as s,vc as W,xc as V,ya as h,yc as O,za as d,zc as G}from"./chunk-TAKLKH4V.js";import{a as I,b as K,h as Y,j as M}from"./chunk-WJTR2IJE.js";var ye=["drawer"],be=()=>({standalone:!0}),we=(i,n)=>n.key;function De(i,n){i&1&&(o(0,"div",37),c(1," \u26A0\uFE0F C\xF3 thay \u0111\u1ED5i ng\xE0y ch\u01B0a \u0111\u01B0\u1EE3c \xE1p d\u1EE5ng "),l())}function Se(i,n){if(i&1){let e=P();o(0,"button",65),g("click",function(a){let u=h(e).$implicit;return s().toggleColumn(u),d(a.stopPropagation())}),o(1,"mat-icon"),c(2),l(),o(3,"span"),c(4),l()()}if(i&2){let e=n.$implicit;p(2),C(e.isShow?"check_box":"check_box_outline_blank"),p(2),C(e.value)}}function ke(i,n){if(i&1&&(o(0,"span",48),c(1),l()),i&2){let e=s();p(),U(" \u{1F4C5} ",e.formatDateForDisplay(e.batdau,"DD/MM")," - ",e.formatDateForDisplay(e.ketthuc,"DD/MM")," ")}}function ve(i,n){i&1&&(o(0,"span",85),c(1,"check"),l())}function Me(i,n){i&1&&E(0,"span",86)}function Ee(i,n){if(i&1&&(o(0,"span"),c(1),l()),i&2){let e=s().$implicit,t=s(2).$implicit,a=s();p(),C(a.formatDateForDisplay(e[t],"DD/MM/YYYY"))}}function Te(i,n){if(i&1&&(o(0,"span"),c(1),l()),i&2){let e=s().$implicit,t=s(2).$implicit,a=s();p(),C(a.formatDateForDisplay(e[t],"DD/MM/YYYY"))}}function Fe(i,n){if(i&1&&(o(0,"span"),c(1),l()),i&2){let e=s().$implicit,t=s(2).$implicit,a=s();p(),C(a.formatDateForDisplay(e[t],"DD/MM/YYYY"))}}function Pe(i,n){if(i&1&&(o(0,"span"),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s(2).$implicit;p(),C(w(2,1,e[t],"1.0-0"))}}function Ne(i,n){if(i&1&&(o(0,"span"),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s(2).$implicit;p(),C(w(2,1,e[t],"1.0-0"))}}function Ie(i,n){if(i&1&&(o(0,"span"),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s(2).$implicit;p(),C(w(2,1,e[t],"1.0-0"))}}function Le(i,n){if(i&1&&(o(0,"span"),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s(2).$implicit;p(),C(w(2,1,e[t],"1.0-0"))}}function Ve(i,n){if(i&1&&(o(0,"span"),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s(2).$implicit;p(),C(w(2,1,e[t],"1.0-0"))}}function Oe(i,n){if(i&1&&(o(0,"span"),c(1),l()),i&2){let e=s().$implicit,t=s(3);p(),C(t.GetGoiy(e))}}function Ge(i,n){if(i&1&&(o(0,"span"),c(1),l()),i&2){let e=s().$implicit,t=s(2).$implicit;p(),C(e[t]||"Tr\u1ED1ng")}}function Ae(i,n){if(i&1){let e=P();o(0,"div",82),g("click",function(){let a=h(e).$implicit,u=s(2).$implicit,r=s();return d(r.ChosenItem(a,u))}),D(1,ve,2,0,"span",83)(2,Me,1,0,"span",84)(3,Ee,2,1,"span")(4,Te,2,1,"span")(5,Fe,2,1,"span")(6,Pe,3,4,"span")(7,Ne,3,4,"span")(8,Ie,3,4,"span")(9,Le,3,4,"span")(10,Ve,3,4,"span")(11,Oe,2,1,"span")(12,Ge,2,1,"span"),l()}if(i&2){let e,t=n.$implicit,a=s(2).$implicit,u=s();p(),_("ngIf",u.CheckItem(t)),p(),_("ngIf",!u.CheckItem(t)),p(),F((e=a)==="createdAt"?3:e==="updatedAt"?4:e==="ngaynhan"?5:e==="slton"?6:e==="slchogiao"?7:e==="slchonhap"?8:e==="SLDat"?9:e==="SLGiao"?10:e==="goiy"?11:12)}}function Be(i,n){if(i&1){let e=P();o(0,"th",68)(1,"div",25)(2,"span",69),c(3),l(),o(4,"span",70,7),c(6," filter_alt "),l()(),o(7,"mat-menu",71,10)(9,"div",72),g("click",function(a){return h(e),d(a.stopPropagation())}),o(10,"div",73)(11,"input",74),g("keyup",function(a){h(e);let u=s().$implicit,r=s();return d(r.doFilterHederColumn(a,u))}),l(),o(12,"div",18)(13,"span",19),c(14,"search"),l()()(),o(15,"div",75)(16,"div",76)(17,"span",77),g("click",function(){h(e);let a=s().$implicit,u=s();return d(u.ChosenAll(u.getCurrentFilteredData(a)))}),c(18),l(),o(19,"span",77),g("click",function(){h(e);let a=s(2);return d(a.EmptyFiter())}),c(20,"Xo\xE1"),l()(),o(21,"span",77),g("click",function(){h(e);let a=s(2);return d(a.ResetFilter())}),c(22,"Reset"),l()(),o(23,"div",78),D(24,Ae,13,3,"div",79),l(),o(25,"div",80)(26,"button",81),g("click",function(){h(e);let a=y(5);return d(a.closeMenu())}),c(27,"\u0110\xF3ng"),l(),o(28,"button",62),g("click",function(){h(e);let a=y(5),u=s(2);return d(u.ApplyFilterColum(a))}),c(29,"\xC1p D\u1EE5ng"),l()()()()()}if(i&2){let e=y(8),t=s().$implicit,a=s();p(3),x(" ",a.ColumnName[t]," "),p(),W("matTooltip","Filter ",a.ColumnName[t],""),_("matMenuTriggerFor",e),p(7),W("placeholder","T\xECm ki\u1EBFm ",a.ColumnName[t],"..."),p(7),x(" Ch\u1ECDn T\u1EA5t C\u1EA3 (",a.getCurrentFilteredData(t).length||0,") "),p(6),_("ngForOf",a.getCurrentFilteredData(t))("ngForTrackBy",a.trackByFn)}}function $e(i,n){if(i&1&&(o(0,"span",88),c(1),l()),i&2){let e=s().index;p(),x(" ",e+1," ")}}function ze(i,n){if(i&1&&(o(0,"span",89),c(1),l()),i&2){let e=s().$implicit,t=s().$implicit;_("matTooltip",e[t]),p(),x(" ",e[t]," ")}}function Re(i,n){if(i&1&&(o(0,"span",90),c(1),l()),i&2){let e=s().$implicit,t=s().$implicit;p(),x(" ",e[t]," ")}}function Ye(i,n){if(i&1&&(o(0,"span",100),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s().$implicit;L("text-red-600",e[t]<=0)("text-green-600",e[t]>0),p(),x(" ",w(2,5,e[t],"1.0-0")," ")}}function He(i,n){if(i&1&&(o(0,"span",92),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s().$implicit;p(),x(" ",w(2,1,e[t],"1.0-0")," ")}}function qe(i,n){if(i&1&&(o(0,"span",93),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s().$implicit;p(),x(" ",w(2,1,e[t],"1.0-0")," ")}}function We(i,n){if(i&1&&(o(0,"span",94),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s().$implicit;p(),x(" ",w(2,1,e[t],"1.0-0")," ")}}function Ue(i,n){if(i&1&&(o(0,"span",95),c(1),b(2,"number"),l()),i&2){let e=s().$implicit,t=s().$implicit;p(),x(" ",w(2,1,e[t],"1.0-0")," ")}}function je(i,n){if(i&1&&(o(0,"span",101),c(1),l()),i&2){let e=s().$implicit,t=s(2);L("text-red-600",t.parseFloat(t.GetGoiy(e))>0)("text-gray-400",t.parseFloat(t.GetGoiy(e))==0),p(),x(" ",t.GetGoiy(e)," ")}}function Ke(i,n){if(i&1&&(o(0,"span",97),c(1),l()),i&2){let e=s().$implicit,t=s().$implicit,a=s();p(),x(" ",a.formatDateForDisplay(e[t],"DD/MM/YYYY")," ")}}function Qe(i,n){if(i&1&&(o(0,"span",97),c(1),l()),i&2){let e=s().$implicit,t=s().$implicit,a=s();p(),x(" ",a.formatDateForDisplay(e[t],"DD/MM/YYYY")," ")}}function Xe(i,n){if(i&1&&(o(0,"span",97),c(1),l()),i&2){let e=s().$implicit,t=s().$implicit,a=s();p(),x(" ",a.formatDateForDisplay(e[t],"DD/MM/YYYY")," ")}}function Je(i,n){i&1&&(o(0,"mat-icon",102),c(1,"check_circle"),l())}function Ze(i,n){i&1&&(o(0,"mat-icon",103),c(1,"cancel"),l())}function tn(i,n){if(i&1&&(o(0,"span",98),D(1,Je,2,0,"mat-icon",102)(2,Ze,2,0,"mat-icon",103),l()),i&2){let e=s().$implicit,t=s().$implicit;p(),F(e[t]?1:2)}}function en(i,n){if(i&1&&(o(0,"span",99),c(1),l()),i&2){let e=s().$implicit,t=s().$implicit;_("matTooltip",e[t]),p(),x(" ",e[t]," ")}}function nn(i,n){if(i&1&&(o(0,"td",87),D(1,$e,2,1,"span",88)(2,ze,2,2,"span",89)(3,Re,2,1,"span",90)(4,Ye,3,8,"span",91)(5,He,3,4,"span",92)(6,qe,3,4,"span",93)(7,We,3,4,"span",94)(8,Ue,3,4,"span",95)(9,je,2,5,"span",96)(10,Ke,2,1,"span",97)(11,Qe,2,1,"span",97)(12,Xe,2,1,"span",97)(13,tn,3,1,"span",98)(14,en,2,2,"span",99),l()),i&2){let e,t=s().$implicit;p(),F((e=t)==="STT"?1:e==="title"?2:e==="masp"?3:e==="slton"?4:e==="slchogiao"?5:e==="slchonhap"?6:e==="SLDat"?7:e==="SLGiao"?8:e==="goiy"?9:e==="createdAt"?10:e==="updatedAt"?11:e==="ngaynhan"?12:e==="isActive"?13:14)}}function an(i,n){if(i&1&&(Z(0,51),D(1,Be,30,9,"th",66)(2,nn,15,1,"td",67),tt()),i&2){let e=n.$implicit;_("matColumnDef",e)}}function on(i,n){i&1&&E(0,"tr",104)}function rn(i,n){if(i&1){let e=P();o(0,"tr",105),g("click",function(){let a=h(e).$implicit,u=s();return d(u.AddToEdit(a))}),l()}if(i&2){let e=n.$implicit,t=s();L("bg-slate-200",t.CheckItemInEdit(e))}}function ln(i,n){if(i&1&&(o(0,"tr",106)(1,"td",107)(2,"div",108)(3,"mat-icon",109),c(4,"search_off"),l(),o(5,"span"),c(6,"Kh\xF4ng t\xECm th\u1EA5y d\u1EEF li\u1EC7u"),l()()()()),i&2){let e=s();p(),X("colspan",e.displayedColumns.length)}}function sn(i,n){i&1&&(o(0,"mat-dialog-content")(1,"div",110)(2,"div",111),c(3,"X\xE1c Nh\u1EADn"),l(),o(4,"div"),c(5,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),l(),o(6,"div",112)(7,"button",113),c(8,"\u0110\u1ED3ng \xDD"),l(),o(9,"button",114),c(10,"Hu\u1EF7 B\u1ECF"),l()()()())}var N=class N{displayedColumns=["title","masp","dvt","mancc","name","slchonhap","SLDat","goiy","slchogiao","SLGiao","sltontt","slton","kho1","kho2","kho3","kho4","kho5","kho6","haohut","slhaohut"];ColumnName={title:"T\xEAn S\u1EA3n Ph\u1EA9m",masp:"M\xE3 S\u1EA3n Ph\u1EA9m",dvt:"\u0110VT",mancc:"M\xE3 NCC",name:"T\xEAn Nh\xE0 Cung C\u1EA5p",slchonhap:"SL \u0110\u1EB7t (Ch\u1EDD Nh\u1EADp)",SLDat:"SL \u0110\u1EB7t (Nh\xE0 CC)",goiy:"SL C\u1EA7n \u0110\u1EB7t (G\u1EE3i \xDD)",slchogiao:"SL B\xE1n (Ch\u1EDD Giao)",SLGiao:"SL Giao (Kh\xE1ch)",sltontt:"T\u1ED3n Kho (Th\u1EF1c T\u1EBF)",slton:"T\u1ED3n Kho",kho1:"TG-LONG AN",kho2:"B\u1ED5 Sung",kho3:"TG-\u0110\xC0 L\u1EA0T",kho4:"KHO T\u1ED4NG - HCM",kho5:"SG1",kho6:"SG2",haohut:"T\u1EC9 L\u1EC7 Hao H\u1EE5t",slhaohut:"SL Hao H\u1EE5t"};FilterColumns=JSON.parse(localStorage.getItem("NhucauColFilter")||"[]");Columns=[];totalItems=0;pageSize=10;currentPage=1;totalPages=1;paginator;sort;drawer;_SanphamService=v(_e);_breakpointObserver=v(pt);_GraphqlService=v(fe);_router=v(ut);_dialog=v(Pt);_timezoneService=v(ge);_snackBar=v(ft);Listsanpham=this._SanphamService.ListSanpham;TonghopsFinal=[];EditList=[];dataSource=new j;ListFilter=[];ListDathang=[];isSubmit=!1;quickFilter="all";globalFilterValue="";batdau=new Date;ketthuc=new Date;isDateRangeEnabled=!1;hasUnappliedDateChanges=!1;constructor(){it(()=>{let n=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.dataSource.data=n,this.totalItems=n.length,this.calculateTotalPages()})}ngOnInit(){return M(this,null,function*(){let n=new Date;this.batdau=new Date(n),this.ketthuc=new Date(n),this.updateDisplayData(),this.loadDonhangWithRelations(),yield this._SanphamService.getNhucau(),this.dataSource=new j(this.Listsanpham()),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource.sortingDataAccessor=(e,t)=>{switch(t){case"slton":case"slchogiao":case"slchonhap":case"SLDat":case"SLGiao":case"kho1":case"kho2":case"kho3":case"kho4":case"kho5":case"kho6":case"haohut":case"slhaohut":return Number(e[t])||0;case"goiy":return parseFloat(this.GetGoiy(e));case"title":case"masp":case"dvt":case"mancc":case"name":case"makho":case"namekho":return e[t]?.toLowerCase()||"";default:return e[t]?.toString().toLowerCase()||""}},this.initializeColumns(),this.setupDrawer()})}GetGoiy(n){let e=n.slton||0,t=n.slchogiao||0,a=n.slchonhap||0,u=n.SLGiao||0;return Math.max(0,u+t-e-a).toFixed(0)}loadDonhangWithRelations(){return M(this,null,function*(){try{let n,e;if(this.isDateRangeEnabled&&this.batdau&&this.ketthuc){let m=this._timezoneService.getAPIDateRange(this.batdau,this.ketthuc);n=m.Batdau,e=m.Ketthuc}else{let m=new Date,f=this._timezoneService.getAPIDateRange(m,m);n=f.Batdau,e=f.Ketthuc}console.log(`Fetching data from ${n} to ${e}`);let[t,a,u]=yield Promise.all([this._GraphqlService.findAll("donhang",{enableParallelFetch:!0,batchSize:1e3,take:999999,aggressiveCache:!0,orderBy:{createdAt:"desc"},where:{ngaygiao:{gte:n,lte:e}},select:{id:!0,madonhang:!0,ngaygiao:!0,sanpham:{select:{giaban:!0,sldat:!0,slgiao:!0,slnhan:!0,sanpham:{select:{masp:!0}}}}}}),this._GraphqlService.findAll("dathang",{enableParallelFetch:!0,batchSize:1e3,take:999999,aggressiveCache:!0,orderBy:{createdAt:"desc"},where:{ngaynhan:{gte:n,lte:e}},select:{id:!0,madncc:!0,ngaynhan:!0,nhacungcap:{select:{name:!0,mancc:!0}},sanpham:{select:{sldat:!0,slgiao:!0,slnhan:!0,sanpham:{select:{masp:!0}}}},kho:{select:{name:!0,makho:!0}}}}),this._GraphqlService.findAll("tonkho",{enableParallelFetch:!0,aggressiveCache:!0,batchSize:1e3,take:999999,select:{id:!0,sanphamId:!0,slton:!0,slchogiao:!0,slchonhap:!0,sanpham:{select:{title:!0,masp:!0,dvt:!0,haohut:!0}}}})]);console.log("Donhangs:",t),console.log("Dathangs:",a),console.log("Tonkhos:",u);let r=t.data.flatMap(m=>m.sanpham.map(f=>({type:"donhang",madonhang:m.madonhang,ngaygiao:m.ngaygiao,masp:f.sanpham.masp,giaban:Number(f.giaban)||0,sldat:Number(f.sldat)||0,slgiao:Number(f.slgiao)||0,slnhan:Number(f.slnhan)||0}))),S=a.data.flatMap(m=>m.sanpham.map(f=>({type:"dathang",madncc:m.madncc,mancc:m.nhacungcap.mancc,name:m.nhacungcap.name,ngaynhan:m.ngaynhan,masp:f.sanpham.masp,sldat:Number(f.sldat)||0,slgiao:Number(f.slgiao)||0,slnhan:Number(f.slnhan)||0,makho:m.kho.makho,namekho:m.kho.name}))),k=u.data.map(m=>({type:"tonkho",masp:m.sanpham.masp,title:m.sanpham.title,dvt:m.sanpham.dvt,haohut:m.sanpham.haohut||0,slton:Number(m.slton)||0,slchogiao:Number(m.slchogiao)||0,slchonhap:Number(m.slchonhap)||0}));console.log("Tonkhos",k);let T=new Map;k.forEach(m=>{T.set(m.masp,{id:Yt(8,!1),ngaynhan:m.ngaynhan,mancc:m.mancc,name:m.name,masp:m.masp,title:m.title,dvt:m.dvt,haohut:m.haohut||0,slton:m.slton,slchogiao:m.slchogiao,slchonhap:m.slchonhap,SLDat:0,SLGiao:0})}),S.forEach(m=>{if(T.has(m.masp)){let f=T.get(m.masp);f.SLDat+=m.slnhan,f.ngaynhan=m.ngaynhan,f.mancc=m.mancc,f.name=m.name,f.makho=m.makho,f.namekho=m.namekho}}),r.forEach(m=>{if(T.has(m.masp)){let f=T.get(m.masp);f.SLGiao+=m.slnhan}});let R=Array.from(T.values());this.TonghopsFinal=this.convertData(R),this.dataSource.data=this.convertData(R),this.totalItems=R.length,console.log("TonghopsFinal:",this.TonghopsFinal),this.calculateTotalPages(),this.updateDisplayData()}catch(n){console.error("Error loading data:",n),this._snackBar.open("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}refresh(){return M(this,null,function*(){yield this._SanphamService.getAllSanpham(),yield this.loadDonhangWithRelations()})}applyFilter(n){let e=n.target.value;this.dataSource.filter=e.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(n=>({key:n,value:this.ColumnName[n],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("NhucauColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(n=>n.isShow).map(n=>n.key),this.ColumnName=this.FilterColumns.reduce((n,e)=>(e.isShow&&(n[e.key]=e.value),n),{})}setupDrawer(){this._breakpointObserver.observe([mt.Handset]).subscribe(n=>{n.matches?this.drawer.mode="over":this.drawer.mode="side"})}toggleColumn(n){let e=this.FilterColumns.find(t=>t.key===n.key);e&&(e.isShow=!e.isShow,this.updateDisplayedColumns())}doFilterHederColumn(n,e){let t=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.dataSource.filteredData=t.filter(a=>a[e]?.toString().toLowerCase().includes(n.target.value.toLowerCase()))}applyAdvancedColumnFilter(n,e){let t=n.target.value.toLowerCase();if(!t){this.getCurrentFilteredData(e);return}let u=(this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham()).filter(r=>r[e]?.toString().toLowerCase().includes(t));this.dataSource.filteredData=u}ChosenItem(n,e){let t=this.dataSource.filteredData.filter(u=>u[e]===n[e]);this.ListFilter.filter(u=>u[e]===n[e]).length>0?this.ListFilter=this.ListFilter.filter(u=>u[e]!==n[e]):this.ListFilter=[...this.ListFilter,...t]}ChosenAll(n){n.forEach(e=>{this.ListFilter.find(a=>a.id===e.id)?this.ListFilter=this.ListFilter.filter(a=>a.id!==e.id):this.ListFilter.push(e)})}ResetFilter(){let n=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.ListFilter=n,this.dataSource.data=n,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}EmptyFiter(){this.ListFilter=[]}CheckItem(n){return!!this.ListFilter.find(e=>e.masp===n.masp||e.id===n.id)}ApplyFilterColum(n){let e=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.dataSource.data=e.filter(t=>this.ListFilter.some(a=>a.masp===t.masp)),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,n.closeMenu()}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(n=>n.isShow).map(n=>n.key),this.ColumnName=this.FilterColumns.reduce((n,e)=>(e.isShow&&(n[e.key]=e.value),n),{}),localStorage.setItem("NhucauColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(n){let e=n.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(t=>t.value.toLowerCase().includes(e))}AddToEdit(n){this.EditList.find(t=>t.masp===n.masp||t.id===n.id)?this.EditList=this.EditList.filter(t=>t.masp!==n.masp&&t.id!==n.id):this.EditList.push(n)}ChoseAllEdit(){let n=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.EditList=n}CheckItemInEdit(n){return this.EditList.some(e=>e.masp===n.masp||e.id===n.id)}onListDathangChange(n){this.isSubmit=n.isSubmit,this.ListDathang=n.ListDathang}ImporExcel(n){return M(this,null,function*(){let t=(yield ce(n)).map(r=>({title:r.title?.trim()||"",masp:r.masp?.trim()||"",giagoc:Number(r.giagoc)||0,dvt:r.dvt?.trim()||"",soluong:Number(r.soluong)||0,soluongkho:Number(r.soluongkho)||0,haohut:Number(r.haohut)||0,ghichu:r.ghichu?.trim()||""})),a=Array.from(new Map(t.map(r=>[r.masp,r])).values()),u=this._SanphamService.ListSanpham();yield Promise.all(a.map(r=>M(this,null,function*(){let S=u.find(k=>k.masp===r.masp);if(S){let k=I(I({},S),r);yield this._SanphamService.updateSanpham(k)}else yield this._SanphamService.CreateSanpham(r)}))),yield Promise.all(u.filter(r=>!a.some(S=>S.masp===r.masp)).map(r=>this._SanphamService.updateSanpham(K(I({},r),{isActive:!1})))),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ExportExcel(n,e){return M(this,null,function*(){let t=n.map(r=>({title:r.title||"",masp:r.masp||"",mancc:r.mancc||"",name:r.name||"",makho:r.makho||"",namekho:r.namekho||"",slton:r.slton||0,slchogiao:r.slchogiao||0,slchonhap:r.slchonhap||0,SLDat:r.SLDat||0,SLGiao:r.SLGiao||0,goiy:r.goiy||0})),a={title:"T\xEAn S\u1EA3n Ph\u1EA9m",masp:"M\xE3 S\u1EA3n Ph\u1EA9m",dvt:"\u0110VT",mancc:"M\xE3 NCC",name:"T\xEAn Nh\xE0 Cung C\u1EA5p",slchonhap:"SL \u0110\u1EB7t (Ch\u1EDD Nh\u1EADp)",goiy:"SL C\u1EA7n \u0110\u1EB7t (G\u1EE3i \xDD)",slchogiao:"SL B\xE1n (Ch\u1EDD Giao)",sltontt:"T\u1ED3n Kho (Th\u1EF1c T\u1EBF)",slton:"T\u1ED3n Kho",kho1:"TG-LONG AN",kho2:"B\u1ED5 Sung",kho3:"TG-\u0110\xC0 L\u1EA0T",kho4:"KHO T\u1ED4NG - HCM",kho5:"SG1",kho6:"SG2",haohut:"T\u1EC9 L\u1EC7 Hao H\u1EE5t",slhaohut:"SL Hao H\u1EE5t"},u=this.convertData(t);se(u,e,Object.values(a),a)})}convertData(n){let e=[{name:"kho1",label:"TG-LONG AN"},{name:"kho2",label:"B\u1ED5 Sung"},{name:"kho3",label:"TG-\u0110\xC0 L\u1EA0T"},{name:"kho4",label:"KHO T\u1ED4NG - HCM"},{name:"kho5",label:"SG1"},{name:"kho6",label:"SG2"}];return n.map(t=>{let a=I({},t);e.forEach(r=>{a[r.name]="0"});let u=e.find(r=>r.label===t.namekho);return u&&(a[u.name]=t.slchonhap||"0"),a})}trackByFn(n,e){return e.masp||e.id}calculateTotalPages(){this.totalPages=Math.ceil(this.totalItems/this.pageSize)}onPageSizeChange(n,e){let t=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();n>t.length?(this.pageSize=t.length,this._snackBar.open(`S\u1ED1 l\u01B0\u1EE3ng t\u1ED1i \u0111a ${t.length}`,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})):this.pageSize=n,this.currentPage=1,this.calculateTotalPages(),this.updateDisplayData(),e.closeMenu()}onPreviousPage(){this.currentPage>1&&(this.currentPage--,this.updateDisplayData())}onNextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.updateDisplayData())}updateDisplayData(){let n=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham(),e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize,a=n.slice(e,t);this.dataSource.data=a}getCurrentFilteredData(n){let e=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham(),t=new Map;return e.forEach(a=>{let u=a[n];t.has(u)||t.set(u,a)}),Array.from(t.values())}parseFloat(n){return parseFloat(n)||0}applyQuickFilter(n){this.quickFilter=n;let e=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();switch(n){case"lowStock":e=e.filter(t=>(t.slton||0)<=10);break;case"needOrder":e=e.filter(t=>parseFloat(this.GetGoiy(t))>0);break;case"pendingDelivery":e=e.filter(t=>(t.slchogiao||0)>0);break;case"all":default:break}this.globalFilterValue&&(e=this.applyGlobalFilterToData(e,this.globalFilterValue)),this.dataSource.data=e,this.totalItems=e.length,this.calculateTotalPages(),this.currentPage=1,this.updateDisplayData()}applyGlobalFilter(n){let e=n.target.value;this.globalFilterValue=e;let t=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();if(this.quickFilter!=="all"){this.applyQuickFilter(this.quickFilter);return}e&&(t=this.applyGlobalFilterToData(t,e)),this.dataSource.data=t,this.totalItems=t.length,this.calculateTotalPages(),this.currentPage=1,this.updateDisplayData()}applyGlobalFilterToData(n,e){let t=e.trim().toLowerCase();return n.filter(a=>a.title?.toLowerCase().includes(t)||a.masp?.toLowerCase().includes(t)||a.name?.toLowerCase().includes(t)||a.mancc?.toLowerCase().includes(t))}sortData(n){let e=this.dataSource.data.slice();if(!n.active||n.direction===""){this.dataSource.data=e;return}this.dataSource.data=e.sort((t,a)=>{let u=n.direction==="asc";switch(n.active){case"title":case"masp":return this.compareStrings(t[n.active],a[n.active],u);case"slton":case"slchogiao":case"slchonhap":case"SLDat":case"SLGiao":return this.compareNumbers(Number(t[n.active])||0,Number(a[n.active])||0,u);case"goiy":return this.compareNumbers(parseFloat(this.GetGoiy(t)),parseFloat(this.GetGoiy(a)),u);default:return this.compareStrings(t[n.active],a[n.active],u)}})}compareStrings(n,e,t){return(n<e?-1:1)*(t?1:-1)}compareNumbers(n,e,t){return(n-e)*(t?1:-1)}clearAllFilters(){this.quickFilter="all",this.globalFilterValue="",this.ListFilter=[];let n=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.dataSource.data=n,this.totalItems=n.length,this.calculateTotalPages(),this.currentPage=1,this.updateDisplayData(),document.querySelectorAll('input[type="text"]').forEach(t=>{t.placeholder.includes("T\xECm ki\u1EBFm")&&(t.value="")})}toggleDateRangeFilter(){if(this.isDateRangeEnabled=!this.isDateRangeEnabled,this.hasUnappliedDateChanges=!1,this.isDateRangeEnabled){let n=new Date;this.batdau=new Date(n),this.ketthuc=new Date(n),this.loadDonhangWithRelations()}else this.loadDonhangWithRelations()}applyDateFilter(n){if(this.isDateRangeEnabled||(this.isDateRangeEnabled=!0),!this.batdau||!this.ketthuc){this._snackBar.open("Vui l\xF2ng ch\u1ECDn kho\u1EA3ng th\u1EDDi gian h\u1EE3p l\u1EC7","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]});return}if(this.batdau>this.ketthuc){this._snackBar.open("Ng\xE0y b\u1EAFt \u0111\u1EA7u kh\xF4ng th\u1EC3 sau ng\xE0y k\u1EBFt th\xFAc","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]});return}this.hasUnappliedDateChanges=!1,this.loadDonhangWithRelations(),this._snackBar.open("\u0110\xE3 \xE1p d\u1EE5ng b\u1ED9 l\u1ECDc ng\xE0y","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),n.closeMenu()}onStartDateChange(n){this.batdau=n.value,this.batdau>this.ketthuc&&(this.ketthuc=new Date(this.batdau)),this.hasUnappliedDateChanges=!0}onEndDateChange(n){this.ketthuc=n.value,this.ketthuc<this.batdau&&(this.batdau=new Date(this.ketthuc)),this.hasUnappliedDateChanges=!0}setToday(n){let e=new Date;this.batdau=new Date(e),this.ketthuc=new Date(e),this.applyDateFilter(n)}setThisWeek(n){let e=new Date,t=new Date(e);t.setDate(e.getDate()-e.getDay());let a=new Date(t);a.setDate(t.getDate()+6),this.batdau=new Date(t),this.ketthuc=new Date(a),this.applyDateFilter(n)}setThisMonth(n){let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0);this.batdau=new Date(t),this.ketthuc=new Date(a),this.applyDateFilter(n)}clearDateFilter(){this.isDateRangeEnabled=!1,this.hasUnappliedDateChanges=!1;let n=new Date;this.batdau=new Date(n),this.ketthuc=new Date(n),this.loadDonhangWithRelations(),this._snackBar.open("\u0110\xE3 x\xF3a b\u1ED9 l\u1ECDc ng\xE0y","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}formatDateForDisplay(n,e="DD/MM/YYYY"){return this._timezoneService.formatForDisplay(n,e)}convertFormDateToUTC(n){return this._timezoneService.formDateToUTC(n)}parseUserDateInput(n,e="YYYY-MM-DD"){try{return this._timezoneService.parseUserInputToUTC(n,e)}catch(t){return console.error("Invalid date format:",t),""}}static \u0275fac=function(e){return new(e||N)};static \u0275cmp=Q({type:N,selectors:[["app-nhucaudathang"]],viewQuery:function(e,t){if(e&1&&(V(Wt,5),V(z,5),V(ye,7)),e&2){let a;O(a=G())&&(t.paginator=a.first),O(a=G())&&(t.sort=a.first),O(a=G())&&(t.drawer=a.first)}},decls:118,vars:35,consts:[["drawer",""],["dateMenuTrigger","matMenuTrigger"],["dateMenu","matMenu"],["startPicker",""],["endPicker",""],["menu","matMenu"],["uploadfile",""],["menuTrigger","matMenuTrigger"],["menuHienthi","matMenu"],["DeleteDialog",""],["filterMenu","matMenu"],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","lg:!w-1/2","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-16","w-full","p-2"],[1,"border","p-1","cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","bg-white","rounded-lg"],[1,"w-full","flex","flex-row","space-x-2","items-center"],[1,"relative"],["type","text","placeholder","T\xECm ki\u1EBFm s\u1EA3n ph\u1EA9m, m\xE3 s\u1EA3n ph\u1EA9m...",1,"block","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["matTooltip","L\u1ECDc theo ng\xE0y","mat-icon-button","","color","primary","aria-label","Date filter menu",3,"matMenuTriggerFor"],[1,"date-filter-menu"],[1,"p-4",3,"click"],[1,"flex","flex-col","space-y-4"],[1,"flex","items-center","justify-between"],[1,"font-semibold"],[1,"flex","flex-col","space-y-3"],["appearance","outline","subscriptSizing","dynamic"],["matInput","","readonly","","placeholder","Ch\u1ECDn ng\xE0y b\u1EAFt \u0111\u1EA7u",3,"ngModelChange","dateChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","readonly","","placeholder","Ch\u1ECDn ng\xE0y k\u1EBFt th\xFAc",3,"ngModelChange","dateChange","matDatepicker","ngModel"],[1,"flex","flex-wrap","gap-2"],["mat-stroked-button","","color","primary",1,"text-xs",3,"click"],["mat-stroked-button","","color","warn",1,"text-xs",3,"click"],[1,"flex","justify-center"],["mat-raised-button","",1,"w-full",3,"click","color"],[1,"text-xs","text-orange-600","bg-orange-50","p-2","rounded","text-center"],[1,"text-sm","text-gray-600","bg-gray-50","p-2","rounded"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200",3,"click"],[1,"ml-2","px-2","py-1","bg-blue-100","text-blue-800","rounded","text-xs"],[1,"border","rounded-lg","w-full","h-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","hover:bg-slate-100 transition-colors duration-200",3,"bg-slate-200","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"cursor-pointer","border","rounded-lg","px-3","p-1","flex","flex-row","space-x-2","items-center","justify-between"],[1,"w-full","flex","lg:p-0","p-2","lg:flex-row","lg:space-x-2","lg:items-center","lg:justify-between","flex-col","justify-center"],[1,"w-full","text-center"],[1,"w-full","flex","flex-row","space-x-2","items-center","lg:justify-end","justify-center"],[1,"font-bold","text-blue-600",3,"matMenuTriggerFor"],[1,"w-full","flex","flex-col","space-y-2","p-4",3,"click"],["matInput","","placeholder","Vui l\xF2ng Nh\u1EADp S\u1ED1 L\u01B0\u1EE3ng",3,"ngModelChange","ngModel","ngModelOptions"],["mat-flat-button","","color","primary",3,"click"],[1,"pagination-controls"],["mat-icon-button","","color","primary",3,"click","disabled"],["mat-menu-item","",3,"click"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","cursor-pointer",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-32","line-clamp-2","me-2"],[1,"z-10","material-symbols-outlined","text-gray-500","cursor-pointer",3,"matMenuTriggerFor","matTooltip"],[1,"filter-menu"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],["type","text",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup","placeholder"],[1,"flex","flex-row","space-x-2","items-center","justify-between"],[1,"flex","flex-row","space-x-2","items-center"],[1,"text-xs","text-blue-600","underline","cursor-pointer",3,"click"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],["class","flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100 cursor-pointer",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],["mat-flat-button","","color","warn",3,"click"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100","cursor-pointer",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],["class","w-6",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"],[1,"w-6"],["mat-cell","",1,"cursor-pointer"],[1,"max-w-16","line-clamp-1"],[1,"max-w-48","line-clamp-2",3,"matTooltip"],[1,"max-w-32","line-clamp-1","font-mono","text-sm"],[1,"max-w-20","line-clamp-1","text-end","font-semibold",3,"text-red-600","text-green-600"],[1,"max-w-20","line-clamp-1","text-end","text-orange-600","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","text-blue-600","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","text-purple-600","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","text-indigo-600","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","font-bold",3,"text-red-600","text-gray-400"],[1,"max-w-28","line-clamp-1","text-sm"],[1,"max-w-16","line-clamp-1","text-center"],[1,"max-w-32","line-clamp-2",3,"matTooltip"],[1,"max-w-20","line-clamp-1","text-end","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","font-bold"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-slate-100","transition-colors","duration-200",3,"click"],[1,"mat-row"],[1,"mat-cell","p-8","text-center","text-gray-500"],[1,"flex","flex-col","items-center","space-y-2"],[1,"text-4xl","text-gray-300"],[1,"flex","flex-col","space-y-8","items-center","justify-center"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary","mat-dialog-close","true"],["mat-flat-button","","color","warn","mat-dialog-close","false"]],template:function(e,t){if(e&1){let a=P();o(0,"mat-drawer-container",11)(1,"mat-drawer",12,0),E(3,"router-outlet"),l(),o(4,"div",13)(5,"div",14)(6,"div",15)(7,"div",16)(8,"input",17),g("keyup",function(r){return h(a),d(t.applyGlobalFilter(r))}),l(),o(9,"div",18)(10,"span",19),c(11,"search"),l()()(),o(12,"button",20)(13,"mat-icon"),c(14,"tune"),l()(),o(15,"button",21,1)(17,"mat-icon"),c(18,"date_range"),l()(),o(19,"mat-menu",22,2)(21,"div",23),g("click",function(r){return h(a),d(r.stopPropagation())}),o(22,"div",24)(23,"div",25)(24,"span",26),c(25,"L\u1ECDc theo kho\u1EA3ng th\u1EDDi gian"),l()(),o(26,"div",27)(27,"mat-form-field",28)(28,"mat-label"),c(29,"T\u1EEB ng\xE0y"),l(),o(30,"input",29),$("ngModelChange",function(r){return h(a),B(t.batdau,r)||(t.batdau=r),d(r)}),g("dateChange",function(r){return h(a),d(t.onStartDateChange(r))}),l(),E(31,"mat-datepicker-toggle",30)(32,"mat-datepicker",null,3),l(),o(34,"mat-form-field",28)(35,"mat-label"),c(36,"\u0110\u1EBFn ng\xE0y"),l(),o(37,"input",31),$("ngModelChange",function(r){return h(a),B(t.ketthuc,r)||(t.ketthuc=r),d(r)}),g("dateChange",function(r){return h(a),d(t.onEndDateChange(r))}),l(),E(38,"mat-datepicker-toggle",30)(39,"mat-datepicker",null,4),l(),o(41,"div",32)(42,"button",33),g("click",function(){h(a);let r=y(16);return d(t.setToday(r))}),c(43," H\xF4m nay "),l(),o(44,"button",33),g("click",function(){h(a);let r=y(16);return d(t.setThisWeek(r))}),c(45," Tu\u1EA7n n\xE0y "),l(),o(46,"button",33),g("click",function(){h(a);let r=y(16);return d(t.setThisMonth(r))}),c(47," Th\xE1ng n\xE0y "),l(),o(48,"button",34),g("click",function(){return h(a),d(t.clearDateFilter())}),c(49," X\xF3a l\u1ECDc "),l()(),o(50,"div",35)(51,"button",36),g("click",function(){h(a);let r=y(16);return d(t.applyDateFilter(r))}),o(52,"mat-icon"),c(53),l(),c(54),l()(),D(55,De,2,0,"div",37),o(56,"div",38)(57,"strong"),c(58,"Kho\u1EA3ng th\u1EDDi gian:"),l(),E(59,"br"),c(60),l()()()()(),o(61,"mat-menu",null,5)(63,"div",39)(64,"mat-form-field",40)(65,"input",41),g("input",function(r){return h(a),d(t.doFilterColumns(r))})("click",function(r){return h(a),d(r.stopPropagation())}),l(),o(66,"mat-icon",42),c(67,"search"),l()()(),o(68,"div",43),H(69,Se,5,2,"button",44,we),l()(),o(71,"button",45),g("click",function(){return h(a),d(t.ExportExcel(t.TonghopsFinal,"Tonghop"))}),o(72,"mat-icon"),c(73,"file_download"),l()(),o(74,"input",46,6),g("change",function(r){return h(a),d(t.ImporExcel(r))}),l(),o(76,"span",47),g("click",function(){return h(a),t.pageSize=t.TonghopsFinal.length,d(t.updateDisplayData())}),c(77),D(78,ke,2,2,"span",48),l()()(),o(79,"div",49)(80,"table",50),H(81,an,3,1,"ng-container",51,J),D(83,on,1,0,"tr",52)(84,rn,1,2,"tr",53)(85,ln,7,1,"tr",54),l()(),o(86,"div",55)(87,"div",56)(88,"span",57),c(89,"\u0110ang Xem "),o(90,"strong"),c(91),l(),c(92," - "),o(93,"strong"),c(94),l(),c(95),l(),o(96,"div",58)(97,"span",59,7),c(99),l(),o(100,"mat-menu",null,8)(102,"div",60),g("click",function(r){return h(a),d(r.stopPropagation())}),o(103,"span"),c(104,"S\u1ED1 L\u01B0\u1EE3ng"),l(),o(105,"mat-form-field",28)(106,"input",61),$("ngModelChange",function(r){return h(a),B(t.pageSize,r)||(t.pageSize=r),d(r)}),l()(),o(107,"button",62),g("click",function(){h(a);let r=y(101);return d(t.onPageSizeChange(t.pageSize,r))}),c(108,"\xC1p D\u1EE5ng"),l()()(),o(109,"div",63)(110,"button",64),g("click",function(){return h(a),d(t.onPreviousPage())}),o(111,"mat-icon"),c(112,"keyboard_arrow_left"),l()(),o(113,"button",64),g("click",function(){return h(a),d(t.onNextPage())}),o(114,"mat-icon"),c(115,"keyboard_arrow_right"),l()()()()()()()(),D(116,sn,11,0,"ng-template",null,9,at)}if(e&2){let a=y(20),u=y(33),r=y(40),S=y(62),k=y(101);p(),_("position","end"),p(11),_("matMenuTriggerFor",S),p(3),_("matMenuTriggerFor",a),p(2),L("text-blue-600",t.isDateRangeEnabled),p(13),_("matDatepicker",u),A("ngModel",t.batdau),p(),_("for",u),p(6),_("matDatepicker",r),A("ngModel",t.ketthuc),p(),_("for",r),p(13),_("color",t.hasUnappliedDateChanges?"warn":"primary"),p(2),C(t.hasUnappliedDateChanges?"pending":"filter_alt"),p(),x(" ",t.hasUnappliedDateChanges?"C\xF3 thay \u0111\u1ED5i - \xC1p d\u1EE5ng":"\xC1p d\u1EE5ng l\u1ECDc"," "),p(),F(t.hasUnappliedDateChanges?55:-1),p(5),U(" ",t.formatDateForDisplay(t.batdau,"DD/MM/YYYY")," - ",t.formatDateForDisplay(t.ketthuc,"DD/MM/YYYY")," "),p(9),q(t.FilterColumns),p(8),x(" ",t.TonghopsFinal.length>0?t.TonghopsFinal.length:t.Listsanpham().length," S\u1EA3n Ph\u1EA9m "),p(),F(t.isDateRangeEnabled?78:-1),p(2),_("dataSource",t.dataSource),p(),q(t.displayedColumns),p(2),_("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),p(),_("matRowDefColumns",t.displayedColumns),p(7),C((t.currentPage-1)*t.pageSize+1),p(3),C(t.currentPage*t.pageSize>t.totalItems?t.totalItems:t.currentPage*t.pageSize),p(),et(" trong s\u1ED1 ",t.totalItems," m\u1EE5c, ",t.currentPage,"/",t.totalPages," Trang"),p(2),_("matMenuTriggerFor",k),p(2),x("Hi\u1EC7n Th\u1ECB : ",t.pageSize," m\u1EE5c"),p(7),A("ngModel",t.pageSize),_("ngModelOptions",nt(34,be)),p(4),_("disabled",t.currentPage===1),p(3),_("disabled",t.currentPage===t.totalPages)}},dependencies:[Bt,At,Vt,Ot,Gt,zt,$t,le,Qt,Jt,ne,Zt,Xt,ae,te,ee,ie,oe,re,Kt,z,jt,Ut,vt,St,Dt,kt,yt,xt,Ct,ct,wt,bt,_t,dt,gt,Rt,st,ot,rt,lt,Ft,Mt,Et,Tt,qt,Ht,Lt,Nt,It,he,ue,pe,me,ht,de],styles:[".mat-mdc-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.mat-mdc-header-cell[_ngcontent-%COMP%]{padding:8px 12px;position:sticky;top:0;background:#f8fafc;border-bottom:2px solid #e2e8f0;font-weight:600;z-index:10}.mat-mdc-cell[_ngcontent-%COMP%]{padding:8px 12px;border-bottom:1px solid #e2e8f0;vertical-align:middle}.mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#f1f5f9;transition:background-color .2s ease}.quick-filter-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;align-items:center}.quick-filter-button[_ngcontent-%COMP%]{padding:4px 12px;font-size:12px;min-height:32px;border-radius:16px}.quick-filter-button.active[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.filter-menu[_ngcontent-%COMP%]{max-width:400px}.date-filter-menu[_ngcontent-%COMP%]{max-width:350px}.date-filter-menu[_ngcontent-%COMP%]   .mat-mdc-menu-content[_ngcontent-%COMP%]{padding:0!important}.date-range-indicator[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 8px;background-color:#dbeafe;color:#1e40af;border-radius:12px;font-size:11px;font-weight:500;margin-left:8px}.mat-mdc-form-field.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{background-color:#fff}.date-range-status[_ngcontent-%COMP%]{background-color:#f1f5f9;border:1px solid #e2e8f0;border-radius:6px;padding:8px;font-size:12px;color:#475569}.quick-date-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px}.quick-date-buttons[_ngcontent-%COMP%]   .mat-mdc-button[_ngcontent-%COMP%]{font-size:11px;min-width:auto;padding:4px 8px;height:28px;line-height:20px}.filter-menu[_ngcontent-%COMP%]   .mat-mdc-menu-content[_ngcontent-%COMP%]{padding:0}.filter-search-input[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px}.filter-search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f61a}.filter-options[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}.filter-option[_ngcontent-%COMP%]{padding:8px 12px;cursor:pointer;display:flex;align-items:center;gap:8px;border-radius:4px;margin:2px 4px}.filter-option[_ngcontent-%COMP%]:hover{background-color:#f1f5f9}.filter-option.selected[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1d4ed8}.column-filter-icon[_ngcontent-%COMP%]{opacity:.6;transition:opacity .2s ease;cursor:pointer}.column-filter-icon[_ngcontent-%COMP%]:hover{opacity:1;color:#3b82f6}@media (max-width: 768px){.mat-mdc-header-cell[_ngcontent-%COMP%], .mat-mdc-cell[_ngcontent-%COMP%]{padding:6px 8px;font-size:13px}.quick-filter-buttons[_ngcontent-%COMP%]{gap:4px}.quick-filter-button[_ngcontent-%COMP%]{padding:3px 8px;font-size:11px;min-height:28px}}.status-low-stock[_ngcontent-%COMP%]{color:#dc2626;font-weight:600}.status-normal-stock[_ngcontent-%COMP%]{color:#059669;font-weight:600}.status-pending[_ngcontent-%COMP%]{color:#d97706;font-weight:600}.status-suggestion[_ngcontent-%COMP%]{color:#7c3aed;font-weight:600}.mat-mdc-row[_ngcontent-%COMP%]{transition:all .2s ease}.mat-mdc-row.filtered-out[_ngcontent-%COMP%]{opacity:.5;transform:scale(.98)}.search-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#6b7280;z-index:1}.search-input[_ngcontent-%COMP%]{padding-left:40px}.pagination-info[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 4px}.filter-badge[_ngcontent-%COMP%]{position:absolute;top:-2px;right:-2px;background:#dc2626;color:#fff;border-radius:50%;width:16px;height:16px;font-size:10px;display:flex;align-items:center;justify-content:center}.filter-options[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.filter-options[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.filter-options[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.filter-options[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}"]})};Y([Ce(300)],N.prototype,"doFilterHederColumn",1),Y([Ce(300)],N.prototype,"applyAdvancedColumnFilter",1);var xe=N;function Ce(i=300){return function(n,e,t){let a=t.value,u;return t.value=function(...r){clearTimeout(u),u=setTimeout(()=>{a.apply(this,r)},i)},t}}export{xe as NhucaudathangComponent};
