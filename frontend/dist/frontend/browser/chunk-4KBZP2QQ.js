import{a as p}from"./chunk-H7UDLENL.js";import{a as d}from"./chunk-2QVTWX3V.js";import{a as u}from"./chunk-FDTVQONQ.js";import{a as g,d as c}from"./chunk-M7LBCJDI.js";import{Ra as r,ja as l,pa as h,u as a}from"./chunk-5IRI5K5U.js";import{j as n}from"./chunk-6DYNGEAS.js";var v=class o{http=h(c);storageService=h(d);snackBar=h(u);apiUrl=`${p.APIURL}/nhanvien`;ListNhanvien=r([]);DetailNhanvien=r(null);Statistics=r(null);total=r(0);page=r(1);limit=r(50);loading=r(!1);error=r(null);getHeaders(){let e=this.storageService.getItem("token");return new g({"Content-Type":"application/json",Authorization:`Bearer ${e}`})}getAllNhanvien(e){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=this.apiUrl,i=[];e?.phongbanId&&i.push(`phongbanId=${e.phongbanId}`),e?.trangThai&&i.push(`trangThai=${e.trangThai}`),e?.chucVu&&i.push(`chucVu=${e.chucVu}`),e?.search&&i.push(`search=${encodeURIComponent(e.search)}`),e?.page&&(i.push(`page=${e.page}`),this.page.set(e.page)),e?.limit&&(i.push(`limit=${e.limit}`),this.limit.set(e.limit)),i.length>0&&(t+="?"+i.join("&"));let s=yield a(this.http.get(t,{headers:this.getHeaders()}));return this.ListNhanvien.set(s.data),this.total.set(s.total),this.page.set(s.page),this.limit.set(s.limit),s}catch(t){throw this.error.set(t.message||"L\u1ED7i khi t\u1EA3i danh s\xE1ch nh\xE2n vi\xEAn"),this.snackBar.open("L\u1ED7i khi t\u1EA3i danh s\xE1ch nh\xE2n vi\xEAn","\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}getStatistics(){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let e=yield a(this.http.get(`${this.apiUrl}/statistics`,{headers:this.getHeaders()}));return this.Statistics.set(e),e}catch(e){throw this.error.set(e.message||"L\u1ED7i khi t\u1EA3i th\u1ED1ng k\xEA"),this.snackBar.open("L\u1ED7i khi t\u1EA3i th\u1ED1ng k\xEA","\u0110\xF3ng",{duration:3e3}),e}finally{this.loading.set(!1)}})}getNhanvienById(e){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=yield a(this.http.get(`${this.apiUrl}/${e}`,{headers:this.getHeaders()}));return this.DetailNhanvien.set(t),t}catch(t){throw this.error.set(t.message||"L\u1ED7i khi t\u1EA3i chi ti\u1EBFt nh\xE2n vi\xEAn"),this.snackBar.open("L\u1ED7i khi t\u1EA3i chi ti\u1EBFt nh\xE2n vi\xEAn","\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}getNhanvienByMaNV(e){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=yield a(this.http.get(`${this.apiUrl}/ma/${e}`,{headers:this.getHeaders()}));return this.DetailNhanvien.set(t),t}catch(t){throw this.error.set(t.message||"L\u1ED7i khi t\u1EA3i nh\xE2n vi\xEAn"),this.snackBar.open("L\u1ED7i khi t\u1EA3i nh\xE2n vi\xEAn","\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}createNhanvien(e){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=yield a(this.http.post(this.apiUrl,e,{headers:this.getHeaders()}));return this.snackBar.open("T\u1EA1o nh\xE2n vi\xEAn th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),yield this.getAllNhanvien({page:this.page(),limit:this.limit()}),t}catch(t){let i=t.error?.message||"L\u1ED7i khi t\u1EA1o nh\xE2n vi\xEAn";throw this.error.set(i),this.snackBar.open(i,"\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}updateNhanvien(e,t){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let i=yield a(this.http.patch(`${this.apiUrl}/${e}`,t,{headers:this.getHeaders()}));return this.snackBar.open("C\u1EADp nh\u1EADt nh\xE2n vi\xEAn th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),yield this.getAllNhanvien({page:this.page(),limit:this.limit()}),i}catch(i){let s=i.error?.message||"L\u1ED7i khi c\u1EADp nh\u1EADt nh\xE2n vi\xEAn";throw this.error.set(s),this.snackBar.open(s,"\u0110\xF3ng",{duration:3e3}),i}finally{this.loading.set(!1)}})}deleteNhanvien(e){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=yield a(this.http.delete(`${this.apiUrl}/${e}`,{headers:this.getHeaders()}));return this.snackBar.open(t.message,"\u0110\xF3ng",{duration:3e3}),yield this.getAllNhanvien({page:this.page(),limit:this.limit()}),t}catch(t){let i=t.error?.message||"L\u1ED7i khi x\xF3a nh\xE2n vi\xEAn";throw this.error.set(i),this.snackBar.open(i,"\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}linkToUser(e,t){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let i=yield a(this.http.post(`${this.apiUrl}/${e}/link-user`,{userId:t},{headers:this.getHeaders()}));return this.snackBar.open("Li\xEAn k\u1EBFt user th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),i}catch(i){let s=i.error?.message||"L\u1ED7i khi li\xEAn k\u1EBFt user";throw this.error.set(s),this.snackBar.open(s,"\u0110\xF3ng",{duration:3e3}),i}finally{this.loading.set(!1)}})}unlinkFromUser(e){return n(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=yield a(this.http.post(`${this.apiUrl}/${e}/unlink-user`,{},{headers:this.getHeaders()}));return this.snackBar.open("G\u1EE1 li\xEAn k\u1EBFt user th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),t}catch(t){let i=t.error?.message||"L\u1ED7i khi g\u1EE1 li\xEAn k\u1EBFt user";throw this.error.set(i),this.snackBar.open(i,"\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}clearError(){this.error.set(null)}reset(){this.ListNhanvien.set([]),this.DetailNhanvien.set(null),this.Statistics.set(null),this.total.set(0),this.page.set(1),this.limit.set(50),this.loading.set(!1),this.error.set(null)}static \u0275fac=function(t){return new(t||o)};static \u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})};export{v as a};
