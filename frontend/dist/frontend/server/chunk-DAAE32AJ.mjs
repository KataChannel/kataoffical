import './polyfills.server.mjs';
import{a as L,b as ge}from"./chunk-W5HARB3C.mjs";import{a as b,b as _e,c as ve}from"./chunk-M7Y3TVWF.mjs";import{a as X,b as Y,c as Z}from"./chunk-45GC2APK.mjs";import{d as te}from"./chunk-6DBP2US7.mjs";import{b as z,d as M}from"./chunk-BH2HSQOL.mjs";import{a as ae,b as ne,c as oe,e as se,f as le,h as ue,i as ce,k as pe,l as me,n as fe,o as de,p as ye,q as he}from"./chunk-LXJF2ENL.mjs";import{a as W}from"./chunk-5Z34U3BE.mjs";import{a as m}from"./chunk-6EFOJMAD.mjs";import{c as re}from"./chunk-UYCQ6AC2.mjs";import{C as ie}from"./chunk-PZLAASAT.mjs";import{b as ee}from"./chunk-XDVOMTEU.mjs";import{e as K}from"./chunk-VNDW64SF.mjs";import{y as U,z as G}from"./chunk-DY3FLVM4.mjs";import{C as J,z as H}from"./chunk-DDYTIRWA.mjs";import{Ac as S,Bc as C,Cc as T,Fb as Q,Fc as V,Gc as p,Ic as h,Mb as f,Pc as $,Ra as q,Wa as R,Yb as c,cc as O,ec as A,fc as j,gc as N,hc as l,ic as s,ja as D,jc as y,kc as F,lc as B,nc as k,oa as g,pa as I,pb as E,sc as w,tb as o,uc as d,ya as _,yb as P,za as v}from"./chunk-J2JCPQ23.mjs";import{j as u}from"./chunk-RIAI3ORJ.mjs";var x=class r{constructor(i,t,e){this._StorageService=i;this.platformId=t;this.router=e;this.isBrowser=J(this.platformId)}_authenticated=!1;APIURL=m.APIURL;isBrowser;ListQuanlyfile=q([]);Quanlyfile=q({});getAllQuanlyfile(){return u(this,null,function*(){try{let i={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},t=yield fetch(`${m.APIURL}/upload`,i);t.ok;let e=yield t.json();return this.ListQuanlyfile.set(e),e}catch(i){return console.error(i)}})}SearchQuanlyfile(i){return u(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},e=yield fetch(`${m.APIURL}/setting/search`,t);if(!e.ok)if(e.status===401){let n=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else if(e.status===403){let n=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else if(e.status===500){let n=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else{let n=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}let a=yield e.json();return this.Quanlyfile.set(a.items),a}catch(t){return console.error(t)}})}getQuanlyfileByid(i){return u(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},e=yield fetch(`${m.APIURL}/upload/${i}`,t);if(!e.ok)if(e.status===401){let n=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else if(e.status===403){let n=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else if(e.status===500){let n=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else{let n=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}let a=yield e.json();this.Quanlyfile.set(a)}catch(t){return console.error(t)}})}updateOneQuanlyfile(i){return u(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(i)},e=yield fetch(`${m.APIURL}/upload/${i.id}`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let a=yield e.json();return e.ok,this.getAllQuanlyfile(),a}catch(t){return console.error(t)}})}DeleteQuanlyfile(i){return u(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},e=yield fetch(`${m.APIURL}/upload/${i.id}`,t);if(!e.ok)if(e.status===401){let a=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(e.status===403){let a=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(e.status===500){let a=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else{let a=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}return this.getAllQuanlyfile(),yield e.json()}catch(t){return console.error(t)}})}static \u0275fac=function(t){return new(t||r)(g(W),g(R),g(M))};static \u0275prov=D({token:r,factory:r.\u0275fac,providedIn:"root"})};var Me=["drawer"],Le=()=>[5,10,25,100];function be(r,i){if(r&1&&(l(0,"th",22),p(1),s()),r&2){let t=d().$implicit,e=d();o(),h("",e.ColumnName[t]," ")}}function xe(r,i){if(r&1&&(l(0,"td",21),p(1),s()),r&2){let t=i.$implicit;o(),h(" ",t.Metadata.mimetype," ")}}function qe(r,i){r&1&&f(0,xe,2,1,"td",23)}function Pe(r,i){if(r&1&&(l(0,"td",21),y(1,"img",24),s()),r&2){let t=i.$implicit;o(),c("src","https://sandbox.Rau S\u1EA1ch Tr\u1EA7n Gia.com/"+t.Lienket,E)}}function ke(r,i){r&1&&f(0,Pe,2,1,"td",23)}function De(r,i){if(r&1&&(l(0,"td",21),p(1),s()),r&2){let t=i.$implicit,e=i.index,a=d(2).$implicit;o(),h(" ",a==="STT"?e+1:t[a]," ")}}function Ie(r,i){r&1&&f(0,De,2,1,"td",23)}function Re(r,i){if(r&1&&(F(0,15),f(1,be,2,1,"th",20)(2,qe,1,0,"td",21)(3,ke,1,0,"td",21)(4,Ie,1,0,"td",21),B()),r&2){let t,e=i.$implicit;c("matColumnDef",e),o(2),O((t=e)==="Metadata"?2:t==="Hinhanh"?3:4)}}function Ee(r,i){r&1&&y(0,"tr",25)}function Qe(r,i){if(r&1){let t=k();l(0,"tr",26),w("click",function(){let a=_(t).$implicit,n=d();return v(n.goToDetail(a))}),s()}}function Oe(r,i){if(r&1&&(l(0,"tr",27)(1,"td",28),p(2),s()()),r&2){d();let t=V(10);o(2),h('Kh\xF4ng t\xECm th\u1EA5y "',t.value,'"')}}var we=class r{constructor(i,t){this._breakpointObserver=i;this._router=t}Detail={};dataSource;displayedColumns=["STT","Title","Hinhanh","Type","Metadata","CreateAt"];ColumnName={STT:"STT",Title:"Ti\xEAu \u0110\u1EC1",Hinhanh:"H\xECnh \u1EA2nh",Type:"Lo\u1EA1i l\u01B0u tr\u1EEF",Metadata:"Th\xF4ng Tin",CreateAt:"Ng\xE0y T\u1EA1o"};paginator;sort;drawer;_QuanlyfilesService=I(x);ListFile=[];ngOnInit(){return u(this,null,function*(){yield this._QuanlyfilesService.getAllQuanlyfile().then(i=>{this.ListFile=i,this.dataSource=new he(i),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}),this.Detail.id?this.drawer.open():this.drawer.close(),this._breakpointObserver.observe([G.Handset]).subscribe(i=>{i.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i",this.paginator.pageSize=30}applyFilter(i){let t=i.target.value;this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}Create(){this.drawer.open(),this._router.navigate(["admin/quanlyfiles",0])}goToDetail(i){this.drawer.open(),this.Detail=i,this._router.navigate(["admin/quanlyfiles",i.id])}static \u0275fac=function(t){return new(t||r)(P(U),P(M))};static \u0275cmp=Q({type:r,selectors:[["app-listquanlyfile"]],viewQuery:function(t,e){if(t&1&&(S(L,5),S(b,5),S(Me,7)),t&2){let a;C(a=T())&&(e.paginator=a.first),C(a=T())&&(e.sort=a.first),C(a=T())&&(e.drawer=a.first)}},decls:24,vars:6,consts:[["drawer",""],["input",""],["autosize","",1,"w-full","h-full"],[1,"flex","flex-col","lg:!w-1/3","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","justify-between","p-2"],[1,"flex","flex-col","space-y-2","w-full","p-2"],[1,"cursor-pointer","w-full","relative","grid","lg:grid-cols-2","gap-2","justify-between","items-center"],[1,"w-full","flex","flex-row","space-x-2","items-center"],[1,"relative"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"cursor-pointer","material-symbols-outlined","p-2","rounded-lg","hover:bg-slate-100",3,"click"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",1,"whitespace-nowrap"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],["class","whitespace-nowrap","mat-cell","",4,"matCellDef"],[1,"h-10",3,"src"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,e){if(t&1){let a=k();l(0,"mat-drawer-container",2)(1,"mat-drawer",3,0),y(3,"router-outlet"),s(),l(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"input",9,1),w("keyup",function(Se){return _(a),v(e.applyFilter(Se))}),s(),l(11,"div",10)(12,"span",11),p(13,"search"),s()()(),l(14,"span",12),w("click",function(){return _(a),v(e.Create())}),p(15,"add_circle"),s()()(),l(16,"div",13)(17,"table",14),j(18,Re,5,2,"ng-container",15,A),f(20,Ee,1,0,"tr",16)(21,Qe,1,0,"tr",17)(22,Oe,3,1,"tr",18),s(),y(23,"mat-paginator",19),s()()()()}t&2&&(o(),c("position","end"),o(16),c("dataSource",e.dataSource),o(),N(e.displayedColumns),o(2),c("matHeaderRowDef",e.displayedColumns),o(),c("matRowDefColumns",e.displayedColumns),o(2),c("pageSizeOptions",$(5,Le)))},dependencies:[ie,re,ye,ae,oe,ce,se,ne,pe,le,ue,me,fe,de,ve,b,_e,ge,L,te,Z,X,Y,z,ee,K,H],encapsulation:2})};export{we as a};
