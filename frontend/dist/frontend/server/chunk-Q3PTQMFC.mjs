import './polyfills.server.mjs';
import{a as ue}from"./chunk-QYU3KARV.mjs";import{a as me}from"./chunk-ZZRFJP6C.mjs";import{a as ce}from"./chunk-TEYX35NL.mjs";import{a as pe}from"./chunk-R5S372T6.mjs";import{a as se}from"./chunk-T3J52R4W.mjs";import{a as ne,b as oe,c as re,k as le}from"./chunk-5YXSSTHO.mjs";import{e as ee,f as ie}from"./chunk-BM52I7TD.mjs";import{a as ae}from"./chunk-YYU6LYJN.mjs";import{a as fe}from"./chunk-MGIVCIKU.mjs";import{a as Ot,b as zt,c as A,d as $t,e as O,f as Rt,g as Kt,h as Ht,i as Qt,j as Wt,k as qt,l as Gt,m as Jt,n as jt,o as Zt,p as Ut,q as Yt,r as Xt,s as te,t as z}from"./chunk-SKEHUX7C.mjs";import{b as Bt,d as Pt,e as At}from"./chunk-SWDJOT3A.mjs";import{a as gt,b as ht,c as _t}from"./chunk-TCWGG2PM.mjs";import{b as Nt}from"./chunk-SYCFVQT2.mjs";import{a as St,b as yt,c as wt,d as xt}from"./chunk-THAZQ5AD.mjs";import{a as ft,b as Ct}from"./chunk-NYSZM65K.mjs";import{b as Dt,g as vt,j as Mt,n as Tt,p as Et,q as bt,r as kt,u as Ft,v as Lt,x as It,y as Vt}from"./chunk-5BXQX6MQ.mjs";import{a as dt}from"./chunk-RPGBM2UL.mjs";import{a as ct,c as pt,e as ut}from"./chunk-HCRD2IJL.mjs";import{y as st,z as mt}from"./chunk-2ZIMTT3U.mjs";import{b as rt,d as lt}from"./chunk-UZGPNQIQ.mjs";import{m as et,n as it,o as at,t as nt,w as ot}from"./chunk-ICYBRMQ6.mjs";import{Ac as b,Bc as k,Cc as F,Gb as q,Gc as T,Hc as p,Ic as L,Jc as C,Kc as X,Mc as I,Nb as D,Nc as V,Oc as N,Qc as E,Vc as tt,Wc as B,Yc as P,Zb as d,ac as G,bc as J,cc as R,ec as j,fc as K,gc as H,hc as n,ic as r,jc as v,kc as Z,lc as U,nc as M,oa as S,sc as _,tb as s,uc as c,xa as g,ya as h,yc as Y}from"./chunk-GWTCN232.mjs";import{a as $,g as _e,j as y}from"./chunk-RIAI3ORJ.mjs";var Q=_e(fe());var Ce=["drawer"],W=()=>({standalone:!0}),Se=()=>[10,25,100],ye=(a,i,t,e,o)=>({"text-blue-500":a,"text-yellow-500":i,"text-green-500":t,"text-purple-500":e,"text-red-500":o}),we=(a,i)=>i.key;function xe(a,i){if(a&1){let t=M();n(0,"button",36),_("click",function(o){let m=g(t).$implicit;return c().toggleColumn(m),h(o.stopPropagation())}),n(1,"mat-icon"),p(2),r(),n(3,"span"),p(4),r()()}if(a&2){let t=i.$implicit;s(2),L(t.isShow?"check_box":"check_box_outline_blank"),s(2),L(t.value)}}function De(a,i){if(a&1){let t=M();n(0,"mat-form-field",39)(1,"mat-label"),p(2),r(),n(3,"input",40),_("keyup",function(){g(t);let o=c(2);return h(o.applyFilter())}),N("ngModelChange",function(o){let m=g(t).$implicit,l=c(2);return V(l.filterValues[m],o)||(l.filterValues[m]=o),h(o)}),r()()}if(a&2){let t=i.$implicit,e=c(2);s(2),L(e.ColumnName[t]),s(),Y("placeholder","Vui l\xF2ng Nh\u1EADp ",t,""),I("ngModel",e.filterValues[t]),d("ngModelOptions",E(5,W))}}function ve(a,i){if(a&1&&(n(0,"div",37),D(1,De,4,6,"mat-form-field",38),r()),a&2){let t=c();s(),d("ngForOf",t.displayedColumns)}}function Me(a,i){if(a&1&&(n(0,"th",43)(1,"span",44),p(2),r()()),a&2){let t=c().$implicit,e=c();s(2),C(" ",e.ColumnName[t]," ")}}function Te(a,i){if(a&1&&(n(0,"span",46),p(1),r()),a&2){let t=c().index;s(),C(" ",t+1," ")}}function Ee(a,i){if(a&1&&(n(0,"span",46),p(1),r()),a&2){let t=c().$implicit,e=c().$implicit;s(),C(" ",t[e].length," ")}}function be(a,i){if(a&1&&(n(0,"span",46),p(1),r()),a&2){let t=c().$implicit,e=c().$implicit;s(),X(" (",t[e].mancc,") ",t[e].name," ")}}function ke(a,i){if(a&1&&(n(0,"span",46),p(1),B(2,"date"),r()),a&2){let t=c().$implicit,e=c().$implicit;s(),C(" ",P(2,1,t[e],"dd/MM/yyyy")," ")}}function Fe(a,i){if(a&1&&(n(0,"span",46),p(1),B(2,"date"),r()),a&2){let t=c().$implicit,e=c().$implicit;s(),C(" ",P(2,1,t[e],"dd/MM/yyyy")," ")}}function Le(a,i){if(a&1&&(n(0,"span",47),p(1),r()),a&2){let t=c().$implicit,e=c().$implicit,o=c();d("ngClass",tt(2,ye,t[e]==="dadat",t[e]==="dagiao",t[e]==="danhan",t[e]==="hoanthanh",t[e]==="huy")),s(),C(" ",o.Trangthaidon[t[e]]," ")}}function Ie(a,i){a&1&&(n(0,"mat-icon",48),p(1,"check_circle"),r())}function Ve(a,i){a&1&&(n(0,"mat-icon",49),p(1,"cancel"),r())}function Ne(a,i){if(a&1&&(n(0,"span",46),D(1,Ie,2,0,"mat-icon",48)(2,Ve,2,0,"mat-icon",49),r()),a&2){let t=c().$implicit,e=c().$implicit;s(),R(t[e]?1:2)}}function Be(a,i){if(a&1&&(n(0,"span",46),p(1),B(2,"date"),r()),a&2){let t=c().$implicit,e=c().$implicit;s(),C(" ",P(2,1,t[e],"dd/MM/yyyy")," ")}}function Pe(a,i){if(a&1&&(n(0,"span",46),p(1),r()),a&2){let t=c().$implicit,e=c().$implicit;s(),C(" ",t[e]," ")}}function Ae(a,i){if(a&1&&(n(0,"td",45),D(1,Te,2,1,"span",46)(2,Ee,2,1,"span",46)(3,be,2,2,"span",46)(4,ke,3,4,"span",46)(5,Fe,3,4,"span",46)(6,Le,2,8,"span",47)(7,Ne,3,1,"span",46)(8,Be,3,4,"span",46)(9,Pe,2,1,"span",46),r()),a&2){let t,e=c().$implicit;s(),R((t=e)==="STT"?1:t==="sanpham"?2:t==="nhacungcap"?3:t==="ngaynhan"?4:t==="createdAt"?5:t==="status"?6:t==="isActive"?7:t==="updatedAt"?8:9)}}function Oe(a,i){if(a&1&&(Z(0,31),D(1,Me,3,1,"th",41)(2,Ae,10,1,"td",42),U()),a&2){let t=i.$implicit;d("matColumnDef",t)}}function ze(a,i){a&1&&v(0,"tr",50)}function $e(a,i){if(a&1){let t=M();n(0,"tr",51),_("click",function(){let o=g(t).$implicit,m=c();return h(m.goToDetail(o))}),r()}if(a&2){let t=i.$implicit,e=c();J("hover:bg-slate-100 ",e.dathangId()==t.id?"!bg-slate-200":"","")}}function Re(a,i){a&1&&(n(0,"tr",52)(1,"td",53),p(2,"Kh\xF4ng t\xECm th\u1EA5y"),r()())}var de=class a{Detail={};displayedColumns=["STT","madncc","nhacungcap","sanpham","ngaynhan","status","ghichu","createdAt","updatedAt"];ColumnName={STT:"STT",madncc:"M\xE3 \u0110\u01A1n Nh\u1EADp",nhacungcap:"Nh\xE0 Cung C\u1EA5p",sanpham:"S\u1EA3n Ph\u1EA9m",ngaynhan:"Ng\xE0y Nh\u1EADn",status:"Tr\u1EA1ng Th\xE1i",ghichu:"Ghi Ch\xFA",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("DathangColFilter")||"[]");Columns=[];isFilter=!1;Trangthaidon=ue;paginator;sort;drawer;filterValues={};_DathangService=S(me);_breakpointObserver=S(st);_GoogleSheetService=S(ae);_NhacungcapService=S(ce);_SanphamService=S(pe);_BanggiaService=S(se);_router=S(lt);Listdathang=this._DathangService.ListDathang;dataSource=new z([]);dathangId=this._DathangService.dathangId;_snackBar=S(dt);CountItem=0;SearchParams={Batdau:(0,Q.default)().toDate(),Ketthuc:(0,Q.default)().toDate(),pageSize:10,pageNumber:1};pageSize=10;totalItems=0;constructor(){this.displayedColumns.forEach(i=>{this.filterValues[i]=""})}createFilter(){return(i,t)=>{let e=JSON.parse(t),o=!0;return this.displayedColumns.forEach(m=>{if(e[m]){let l=i[m]?i[m].toString().toLowerCase():"";o=o&&l.includes(e[m].toLowerCase())}}),o}}applyFilter(){this.dataSource.filter=JSON.stringify(this.filterValues)}onPageChange(i){return y(this,null,function*(){console.log("Page changed:",i),this.SearchParams.pageSize=i.pageSize,this.SearchParams.pageNumber=i.pageIndex+1,this.pageSize=i.pageSize;let t=yield this._DathangService.getAllDathang();this.CountItem=this.Listdathang().length,this.totalItems=t.length,this.dataSource=new z(t),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}onDateChange(i){this.ngOnInit()}ngOnInit(){return y(this,null,function*(){yield this._DathangService.getAllDathang().then(i=>{i&&(this.CountItem=this.Listdathang().length,this.dataSource=new z(i),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.totalItems=i.length,this.initializeColumns(),this.setupDrawer(),this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i")})})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(i=>({key:i,value:this.ColumnName[i],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("DathangColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(i=>i.isShow).map(i=>i.key),this.ColumnName=this.FilterColumns.reduce((i,t)=>(t.isShow&&(i[t.key]=t.value),i),{})}setupDrawer(){this._breakpointObserver.observe([mt.Handset]).subscribe(i=>{i.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}toggleColumn(i){let t=this.FilterColumns.find(e=>e.key===i.key);t&&(t.isShow=!t.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(i=>i.isShow).map(i=>i.key),this.ColumnName=this.FilterColumns.reduce((i,t)=>(t.isShow&&(i[t.key]=t.value),i),{}),localStorage.setItem("DathangColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(i){let t=i.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(e=>e.value.toLowerCase().includes(t))}create(){this.drawer.open(),this._router.navigate(["admin/dathang",0])}goToDetail(i){this._DathangService.setDathangId(i.id),this.drawer.open(),this._router.navigate(["admin/dathang",i.id])}LoadDrive(){return y(this,null,function*(){let i={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"SPImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},t=yield this._GoogleSheetService.getDrive(i),e=Bt(t.values);console.log(e),this.DoImportData(e)})}DoImportData(i){console.log(i);let e=i.map(u=>({title:u.title?.trim()||"",masp:u.masp?.trim()||"",slug:`${Pt(u?.title?.trim()||"")}_${At(5,!1)}`,giagoc:Number(u.giagoc)||0,dvt:u.dvt||"",soluong:Number(u.soluong)||0,soluongkho:Number(u.soluongkho)||0,ghichu:u.ghichu||"",order:Number(u.order)||0})).filter((u,w,x)=>w===x.findIndex(he=>he.masp===u.masp)),o=e.map(u=>u.masp),m=this._DathangService.ListDathang().map(u=>u.masp),l=o.filter(u=>!m.includes(u)),f=e.map(u=>y(this,null,function*(){let w=this._DathangService.ListDathang().find(x=>x.masp===u.masp);if(w){let x=$($({},w),u);yield this._DathangService.updateDathang(x)}else yield this._DathangService.CreateDathang(u)})),ge=l.map(u=>y(this,null,function*(){let w=this._DathangService.ListDathang().find(x=>x.masp===u);w.isActive=!1,yield this._DathangService.updateDathang(w)}));Promise.all([...f,...ge]).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ImporExcel(i){return y(this,null,function*(){let t=yield ie(i);this.DoImportData(t)})}ExportExcel(i,t){return y(this,null,function*(){yield this._NhacungcapService.getAllNhacungcap(),yield this._SanphamService.getAllSanpham(),yield this._BanggiaService.getAllBanggia();let e=yield this._SanphamService.getNhucau();console.log(e);let o=this._NhacungcapService.ListNhacungcap().map(f=>({manccold:f.manccold,name:f.name,mancc:f.mancc})),m=this._SanphamService.ListSanpham().map(f=>({subtitle:f.subtitle,masp:f.masp,title:f.title,dvt:f.dvt})),l=this._BanggiaService.ListBanggia().map(f=>({mabanggia:f.mabanggia,title:f.title}));ee({SP:m,NCC:o,BG:l},t)})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=q({type:a,selectors:[["app-listdathang"]],viewQuery:function(t,e){if(t&1&&(b(A,5),b(O,5),b(Ce,7)),t&2){let o;k(o=F())&&(e.paginator=o.first),k(o=F())&&(e.sort=o.first),k(o=F())&&(e.drawer=o.first)}},decls:65,vars:28,consts:[["drawer",""],["menu","matMenu"],["uploadfile",""],["pickerBatdau",""],["pickerKetthuc",""],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[1,"cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","p-2","bg-white","rounded-lg"],[1,"flex","flex-row","space-x-2","items-center"],["matTooltip","Th\xEAm m\u1EDBi","mat-flat-button","",1,"flex","flex-row","items-center","btn-primary",3,"click"],[1,"whitespace-nowrap"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","B\u1ED9 L\u1ECDc","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i l\xEAn file excel","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],["matTooltip","T\u1EA3i d\u1EEF li\u1EC7u t\u1EEB drive","color","primary","mat-icon-button","",3,"click"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],["class","w-full grid grid-cols-2 gap-2 lg:flex lg:flex-row lg:space-x-2 items-center",4,"ngIf"],[3,"appearance","subscriptSizing"],["matInput","",3,"dateChange","ngModelChange","matDatepicker","ngModel","ngModelOptions"],["matIconSuffix","",3,"for"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"class","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"page","pageSizeOptions","pageSize","length"],["mat-menu-item","",3,"click"],[1,"w-full","grid","grid-cols-2","gap-2","lg:flex","lg:flex-row","lg:space-x-2","items-center"],["appearance","outline","subscriptSizing","dynamic",4,"ngFor","ngForOf"],["appearance","outline","subscriptSizing","dynamic"],["matInput","",3,"keyup","ngModelChange","ngModel","ngModelOptions","placeholder"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","font-bold",3,"ngClass"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,e){if(t&1){let o=M();n(0,"mat-drawer-container",5)(1,"mat-drawer",6,0),v(3,"router-outlet"),r(),n(4,"div",7)(5,"div",8)(6,"div",9)(7,"button",10),_("click",function(){return g(o),h(e.create())}),n(8,"mat-icon"),p(9,"add_circle"),r(),n(10,"span",11),p(11,"T\u1EA1o M\u1EDBi"),r()(),n(12,"button",12)(13,"mat-icon"),p(14,"tune"),r()(),n(15,"mat-menu",null,1)(17,"div",13)(18,"mat-form-field",14)(19,"input",15),_("input",function(l){return g(o),h(e.doFilterColumns(l))})("click",function(l){return g(o),h(l.stopPropagation())}),r(),n(20,"mat-icon",16),p(21,"search"),r()()(),n(22,"div",17),K(23,xe,5,2,"button",18,we),r()(),n(25,"button",19),_("click",function(){return g(o),h(e.isFilter=!e.isFilter)}),n(26,"mat-icon"),p(27,"filter_list"),r()(),n(28,"button",20),_("click",function(){return g(o),h(e.ExportExcel(e.Listdathang(),"Dathang"))}),n(29,"mat-icon"),p(30,"file_download"),r()(),n(31,"button",21),_("click",function(){g(o);let l=T(35);return h(l.click())}),n(32,"mat-icon"),p(33,"file_upload"),r()(),n(34,"input",22,2),_("change",function(l){return g(o),h(e.ImporExcel(l))}),r(),n(36,"button",23),_("click",function(){return g(o),h(e.LoadDrive())}),n(37,"mat-icon"),p(38,"cloud_download"),r()(),n(39,"span",24),p(40),r()()(),D(41,ve,2,1,"div",25),n(42,"div",9)(43,"mat-form-field",26)(44,"mat-label"),p(45,"B\u1EAFt \u0110\u1EA7u"),r(),n(46,"input",27),_("dateChange",function(l){return g(o),h(e.onDateChange(l))}),N("ngModelChange",function(l){return g(o),V(e.SearchParams.Batdau,l)||(e.SearchParams.Batdau=l),h(l)}),r(),v(47,"mat-datepicker-toggle",28)(48,"mat-datepicker",null,3),r(),n(50,"mat-form-field",26)(51,"mat-label"),p(52,"K\u1EBFt Th\xFAc"),r(),n(53,"input",27),_("dateChange",function(l){return g(o),h(e.onDateChange(l))}),N("ngModelChange",function(l){return g(o),V(e.SearchParams.Ketthuc,l)||(e.SearchParams.Ketthuc=l),h(l)}),r(),v(54,"mat-datepicker-toggle",28)(55,"mat-datepicker",null,4),r()(),n(57,"div",29)(58,"table",30),K(59,Oe,3,1,"ng-container",31,j),D(61,ze,1,0,"tr",32)(62,$e,1,3,"tr",33)(63,Re,3,0,"tr",34),r()(),n(64,"mat-paginator",35),_("page",function(l){return g(o),h(e.onPageChange(l))}),r()()()}if(t&2){let o=T(16),m=T(49),l=T(56);s(),d("position","end"),s(11),d("matMenuTriggerFor",o),s(11),H(e.FilterColumns),s(2),G(e.isFilter?"!bg-slate-200":""),s(15),C(" ",e.CountItem," \u0110\u01A1n \u0110\u1EB7t H\xE0ng "),s(),d("ngIf",e.isFilter),s(2),d("appearance","outline")("subscriptSizing","dynamic"),s(3),d("matDatepicker",m),I("ngModel",e.SearchParams.Batdau),d("ngModelOptions",E(25,W)),s(),d("for",m),s(3),d("appearance","outline")("subscriptSizing","dynamic"),s(3),d("matDatepicker",l),I("ngModel",e.SearchParams.Ketthuc),d("ngModelOptions",E(26,W)),s(),d("for",l),s(4),d("dataSource",e.dataSource),s(),H(e.displayedColumns),s(2),d("matHeaderRowDef",e.displayedColumns),s(),d("matRowDefColumns",e.displayedColumns),s(2),d("pageSizeOptions",E(27,Se))("pageSize",e.pageSize)("length",e.totalItems)}},dependencies:[Lt,Ft,Et,bt,kt,Vt,It,te,Ht,Wt,jt,qt,Qt,Zt,Gt,Jt,Ut,Yt,Xt,Kt,O,Rt,$t,A,xt,yt,St,wt,_t,gt,ht,rt,Ct,ft,ut,ct,pt,Nt,ot,et,it,at,nt,Tt,Dt,vt,Mt,zt,Ot,le,ne,oe,re],encapsulation:2})};export{de as a};
