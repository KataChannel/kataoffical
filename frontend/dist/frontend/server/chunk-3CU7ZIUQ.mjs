import './polyfills.server.mjs';
import{a as oe}from"./chunk-FUFVR7E3.mjs";import{a as re}from"./chunk-UVCOV5DY.mjs";import{a as ne}from"./chunk-4PX42VIJ.mjs";import{a as ae}from"./chunk-PFE7E2A3.mjs";import{a as ie}from"./chunk-QFQJYT4U.mjs";import{c as te,d as ee}from"./chunk-HRADRX7C.mjs";import{a as Xt}from"./chunk-3HINESDB.mjs";import{a as Bt,b as At,c as I,d as Pt,e as N,f as $t,g as Ot,h as Rt,i as Ht,j as zt,k as Qt,l as qt,m as Gt,n as Jt,o as Kt,p as jt,q as Wt,r as Zt,s as Ut,t as Yt}from"./chunk-ZBNIG4IU.mjs";import{a as ut,b as dt,c as _t}from"./chunk-CJBCEEYN.mjs";import{b as kt}from"./chunk-SOYYRHY2.mjs";import{b as It,d as Nt,e as Vt}from"./chunk-SWDJOT3A.mjs";import{a as pt}from"./chunk-7GD4YCI7.mjs";import{a as ft,b as Ct,c as xt,d as St}from"./chunk-OI6SIBPJ.mjs";import{a as gt,b as ht}from"./chunk-SN5D3QGT.mjs";import{b as wt,g as yt,j as Dt,n as vt,p as Mt,q as Tt,u as Et,v as bt,x as Ft,y as Lt}from"./chunk-ZY25VIV4.mjs";import{a as st,c as mt,e as ct}from"./chunk-RJ4EPAWB.mjs";import{y as rt,z as lt}from"./chunk-G2Y3YIGV.mjs";import{b as at,d as ot}from"./chunk-VMIQABYG.mjs";import{m as X,n as tt,o as et,t as it,v as nt}from"./chunk-OMNNIR3J.mjs";import{Ac as T,Bc as E,Cc as b,Gb as R,Gc as $,Hc as m,Ic as F,Jc as C,Kc as K,Mc as j,Nb as D,Nc as W,Oc as Z,Qc as O,Uc as U,Vc as L,Xc as k,Zb as h,ac as H,bc as z,cc as B,ec as Q,fc as A,gc as P,hc as a,ic as r,jc as M,kc as q,lc as G,nc as v,oa as x,rd as Y,sc as f,tb as s,uc as l,xa as _,ya as g,yc as J}from"./chunk-TSF6OWWP.mjs";import{a as V,j as S}from"./chunk-RIAI3ORJ.mjs";var ce=["drawer"],pe=()=>[5,10,25,100],ue=()=>({standalone:!0}),de=(n,e,t,i)=>({"text-blue-500":n,"text-yellow-500":e,"text-green-500":t,"text-red-500":i}),_e=(n,e)=>e.key;function ge(n,e){if(n&1){let t=v();a(0,"button",31),f("click",function(o){let c=_(t).$implicit;return l().toggleColumn(c),g(o.stopPropagation())}),a(1,"mat-icon"),m(2),r(),a(3,"span"),m(4),r()()}if(n&2){let t=e.$implicit;s(2),F(t.isShow?"check_box":"check_box_outline_blank"),s(2),F(t.value)}}function he(n,e){if(n&1){let t=v();a(0,"mat-form-field",34)(1,"mat-label"),m(2),r(),a(3,"input",35),f("keyup",function(){_(t);let o=l(2);return g(o.applyFilter())}),Z("ngModelChange",function(o){let c=_(t).$implicit,u=l(2);return W(u.filterValues[c],o)||(u.filterValues[c]=o),g(o)}),r()()}if(n&2){let t=e.$implicit,i=l(2);s(2),F(i.ColumnName[t]),s(),J("placeholder","Vui l\xF2ng Nh\u1EADp ",t,""),j("ngModel",i.filterValues[t]),h("ngModelOptions",O(5,ue))}}function fe(n,e){if(n&1&&(a(0,"div",32),D(1,he,4,6,"mat-form-field",33),r()),n&2){let t=l();s(),h("ngForOf",t.displayedColumns)}}function Ce(n,e){if(n&1&&(a(0,"th",38)(1,"span",39),m(2),r()()),n&2){let t=l().$implicit,i=l();s(2),C(" ",i.ColumnName[t]," ")}}function xe(n,e){if(n&1&&(a(0,"span",41),m(1),r()),n&2){let t=l().index;s(),C(" ",t+1," ")}}function Se(n,e){if(n&1&&(a(0,"span",41),m(1),r()),n&2){let t=l().$implicit,i=l().$implicit;s(),C(" ",t[i].length," ")}}function we(n,e){if(n&1&&(a(0,"span",41),m(1),r()),n&2){let t=l().$implicit,i=l().$implicit;s(),K(" (",t[i].mancc,") ",t[i].name," ")}}function ye(n,e){if(n&1&&(a(0,"span",41),m(1),L(2,"date"),r()),n&2){let t=l().$implicit,i=l().$implicit;s(),C(" ",k(2,1,t[i],"dd/MM/yyyy")," ")}}function De(n,e){if(n&1&&(a(0,"span",41),m(1),L(2,"date"),r()),n&2){let t=l().$implicit,i=l().$implicit;s(),C(" ",k(2,1,t[i],"dd/MM/yyyy")," ")}}function ve(n,e){if(n&1&&(a(0,"span",42),m(1),r()),n&2){let t=l().$implicit,i=l().$implicit,o=l();h("ngClass",U(2,de,t[i]==="dadat",t[i]==="dagiao",t[i]==="danhan",t[i]==="huy")),s(),C(" ",o.Trangthaidon[t[i]]," ")}}function Me(n,e){n&1&&(a(0,"mat-icon",43),m(1,"check_circle"),r())}function Te(n,e){n&1&&(a(0,"mat-icon",44),m(1,"cancel"),r())}function Ee(n,e){if(n&1&&(a(0,"span",41),D(1,Me,2,0,"mat-icon",43)(2,Te,2,0,"mat-icon",44),r()),n&2){let t=l().$implicit,i=l().$implicit;s(),B(t[i]?1:2)}}function be(n,e){if(n&1&&(a(0,"span",41),m(1),L(2,"date"),r()),n&2){let t=l().$implicit,i=l().$implicit;s(),C(" ",k(2,1,t[i],"dd/MM/yyyy")," ")}}function Fe(n,e){if(n&1&&(a(0,"span",41),m(1),r()),n&2){let t=l().$implicit,i=l().$implicit;s(),C(" ",t[i]," ")}}function Le(n,e){if(n&1&&(a(0,"td",40),D(1,xe,2,1,"span",41)(2,Se,2,1,"span",41)(3,we,2,2,"span",41)(4,ye,3,4,"span",41)(5,De,3,4,"span",41)(6,ve,2,7,"span",42)(7,Ee,3,1,"span",41)(8,be,3,4,"span",41)(9,Fe,2,1,"span",41),r()),n&2){let t,i=l().$implicit;s(),B((t=i)==="STT"?1:t==="sanpham"?2:t==="nhacungcap"?3:t==="ngaynhan"?4:t==="createdAt"?5:t==="status"?6:t==="isActive"?7:t==="updatedAt"?8:9)}}function ke(n,e){if(n&1&&(q(0,26),D(1,Ce,3,1,"th",36)(2,Le,10,1,"td",37),G()),n&2){let t=e.$implicit;h("matColumnDef",t)}}function Ie(n,e){n&1&&M(0,"tr",45)}function Ne(n,e){if(n&1){let t=v();a(0,"tr",46),f("click",function(){let o=_(t).$implicit,c=l();return g(c.goToDetail(o))}),r()}if(n&2){let t=e.$implicit,i=l();z("hover:bg-slate-100 ",i.dathangId()==t.id?"!bg-slate-200":"","")}}function Ve(n,e){n&1&&(a(0,"tr",47)(1,"td",48),m(2,"Kh\xF4ng t\xECm th\u1EA5y"),r()())}var le=class n{Detail={};displayedColumns=["STT","madncc","nhacungcap","sanpham","ngaynhan","status","ghichu","createdAt","updatedAt"];ColumnName={STT:"STT",madncc:"M\xE3 \u0110\u01A1n Nh\u1EADp",nhacungcap:"Nh\xE0 Cung C\u1EA5p",sanpham:"S\u1EA3n Ph\u1EA9m",ngaynhan:"Ng\xE0y Nh\u1EADn",status:"Tr\u1EA1ng Th\xE1i",ghichu:"Ghi Ch\xFA",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("DathangColFilter")||"[]");Columns=[];isFilter=!1;Trangthaidon=re;paginator;sort;drawer;filterValues={};_DathangService=x(oe);_breakpointObserver=x(rt);_GoogleSheetService=x(Xt);_NhacungcapService=x(ne);_SanphamService=x(ie);_BanggiaService=x(ae);_router=x(ot);Listdathang=this._DathangService.ListDathang;dataSource=Y(()=>{let e=new Yt(this.Listdathang());return e.filterPredicate=this.createFilter(),e.paginator=this.paginator,e.sort=this.sort,e});dathangId=this._DathangService.dathangId;_snackBar=x(pt);CountItem=0;constructor(){this.displayedColumns.forEach(e=>{this.filterValues[e]=""})}createFilter(){return(e,t)=>{let i=JSON.parse(t),o=!0;return this.displayedColumns.forEach(c=>{if(i[c]){let u=e[c]?e[c].toString().toLowerCase():"";o=o&&u.includes(i[c].toLowerCase())}}),o}}applyFilter(){this.dataSource().filter=JSON.stringify(this.filterValues)}ngOnInit(){return S(this,null,function*(){yield this._DathangService.getAllDathang(),this.CountItem=this.Listdathang().length,this.initializeColumns(),this.setupDrawer(),this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i"})}refresh(){return S(this,null,function*(){yield this._DathangService.getAllDathang()})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(e=>({key:e,value:this.ColumnName[e],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("DathangColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{})}setupDrawer(){this._breakpointObserver.observe([lt.Handset]).subscribe(e=>{e.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}toggleColumn(e){let t=this.FilterColumns.find(i=>i.key===e.key);t&&(t.isShow=!t.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{}),localStorage.setItem("DathangColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(e){let t=e.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(i=>i.value.toLowerCase().includes(t))}create(){this.drawer.open(),this._router.navigate(["admin/dathang",0])}goToDetail(e){this._DathangService.setDathangId(e.id),this.drawer.open(),this._router.navigate(["admin/dathang",e.id])}LoadDrive(){return S(this,null,function*(){let e={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"SPImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},t=yield this._GoogleSheetService.getDrive(e),i=It(t.values);console.log(i),this.DoImportData(i)})}DoImportData(e){console.log(e);let i=e.map(p=>({title:p.title?.trim()||"",masp:p.masp?.trim()||"",slug:`${Nt(p?.title?.trim()||"")}_${Vt(5,!1)}`,giagoc:Number(p.giagoc)||0,dvt:p.dvt||"",soluong:Number(p.soluong)||0,soluongkho:Number(p.soluongkho)||0,ghichu:p.ghichu||"",order:Number(p.order)||0})).filter((p,w,y)=>w===y.findIndex(me=>me.masp===p.masp)),o=i.map(p=>p.masp),c=this._DathangService.ListDathang().map(p=>p.masp),u=o.filter(p=>!c.includes(p)),d=i.map(p=>S(this,null,function*(){let w=this._DathangService.ListDathang().find(y=>y.masp===p.masp);if(w){let y=V(V({},w),p);yield this._DathangService.updateDathang(y)}else yield this._DathangService.CreateDathang(p)})),se=u.map(p=>S(this,null,function*(){let w=this._DathangService.ListDathang().find(y=>y.masp===p);w.isActive=!1,yield this._DathangService.updateDathang(w)}));Promise.all([...d,...se]).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ImporExcel(e){return S(this,null,function*(){let t=yield ee(e);this.DoImportData(t)})}ExportExcel(e,t){return S(this,null,function*(){yield this._NhacungcapService.getAllNhacungcap(),yield this._SanphamService.getAllSanpham(),yield this._BanggiaService.getAllBanggia();let i=yield this._SanphamService.getNhucau();console.log(i);let o=this._NhacungcapService.ListNhacungcap().map(d=>({manccold:d.manccold,name:d.name,mancc:d.mancc})),c=this._SanphamService.ListSanpham().map(d=>({subtitle:d.subtitle,masp:d.masp,title:d.title,dvt:d.dvt})),u=this._BanggiaService.ListBanggia().map(d=>({mabanggia:d.mabanggia,title:d.title}));te({SP:c,NCC:o,BG:u},t)})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=R({type:n,selectors:[["app-listdathang"]],viewQuery:function(t,i){if(t&1&&(T(I,5),T(N,5),T(ce,7)),t&2){let o;E(o=b())&&(i.paginator=o.first),E(o=b())&&(i.sort=o.first),E(o=b())&&(i.drawer=o.first)}},decls:50,vars:12,consts:[["drawer",""],["menu","matMenu"],["uploadfile",""],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[1,"cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","p-2","bg-white","rounded-lg"],[1,"flex","flex-row","space-x-2","items-center"],["matTooltip","Th\xEAm m\u1EDBi","mat-flat-button","",1,"flex","flex-row","items-center","btn-primary",3,"click"],[1,"whitespace-nowrap"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","B\u1ED9 L\u1ECDc","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i l\xEAn file excel","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],["matTooltip","T\u1EA3i d\u1EEF li\u1EC7u t\u1EEB drive","color","primary","mat-icon-button","",3,"click"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],["class","w-full grid grid-cols-2 gap-2 lg:flex lg:flex-row lg:space-x-2 items-center",4,"ngIf"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"class","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],[1,"w-full","grid","grid-cols-2","gap-2","lg:flex","lg:flex-row","lg:space-x-2","items-center"],["appearance","outline","subscriptSizing","dynamic",4,"ngFor","ngForOf"],["appearance","outline","subscriptSizing","dynamic"],["matInput","",3,"keyup","ngModelChange","ngModel","ngModelOptions","placeholder"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","font-bold",3,"ngClass"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,i){if(t&1){let o=v();a(0,"mat-drawer-container",3)(1,"mat-drawer",4,0),M(3,"router-outlet"),r(),a(4,"div",5)(5,"div",6)(6,"div",7)(7,"button",8),f("click",function(){return _(o),g(i.create())}),a(8,"mat-icon"),m(9,"add_circle"),r(),a(10,"span",9),m(11,"T\u1EA1o M\u1EDBi"),r()(),a(12,"button",10)(13,"mat-icon"),m(14,"tune"),r()(),a(15,"mat-menu",null,1)(17,"div",11)(18,"mat-form-field",12)(19,"input",13),f("input",function(u){return _(o),g(i.doFilterColumns(u))})("click",function(u){return _(o),g(u.stopPropagation())}),r(),a(20,"mat-icon",14),m(21,"search"),r()()(),a(22,"div",15),A(23,ge,5,2,"button",16,_e),r()(),a(25,"button",17),f("click",function(){return _(o),g(i.isFilter=!i.isFilter)}),a(26,"mat-icon"),m(27,"filter_list"),r()(),a(28,"button",18),f("click",function(){return _(o),g(i.ExportExcel(i.Listdathang(),"Dathang"))}),a(29,"mat-icon"),m(30,"file_download"),r()(),a(31,"button",19),f("click",function(){_(o);let u=$(35);return g(u.click())}),a(32,"mat-icon"),m(33,"file_upload"),r()(),a(34,"input",20,2),f("change",function(u){return _(o),g(i.ImporExcel(u))}),r(),a(36,"button",21),f("click",function(){return _(o),g(i.LoadDrive())}),a(37,"mat-icon"),m(38,"cloud_download"),r()(),a(39,"span",22),m(40),r()()(),D(41,fe,2,1,"div",23),a(42,"div",24)(43,"table",25),A(44,ke,3,1,"ng-container",26,Q),D(46,Ie,1,0,"tr",27)(47,Ne,1,3,"tr",28)(48,Ve,3,0,"tr",29),r(),M(49,"mat-paginator",30),r()()()}if(t&2){let o=$(16);s(),h("position","end"),s(11),h("matMenuTriggerFor",o),s(11),P(i.FilterColumns),s(2),H(i.isFilter?"!bg-slate-200":""),s(15),C(" ",i.CountItem," \u0110\u01A1n \u0110\u1EB7t H\xE0ng "),s(),h("ngIf",i.isFilter),s(2),h("dataSource",i.dataSource()),s(),P(i.displayedColumns),s(2),h("matHeaderRowDef",i.displayedColumns),s(),h("matRowDefColumns",i.displayedColumns),s(2),h("pageSizeOptions",O(11,pe))}},dependencies:[bt,Et,Mt,Tt,Lt,Ft,Ut,Rt,zt,Jt,Qt,Ht,Kt,qt,Gt,jt,Wt,Zt,Ot,N,$t,Pt,I,St,Ct,ft,xt,_t,ut,dt,at,ht,gt,ct,st,mt,kt,nt,X,tt,et,it,vt,wt,yt,Dt,At,Bt],encapsulation:2})};export{le as a};
