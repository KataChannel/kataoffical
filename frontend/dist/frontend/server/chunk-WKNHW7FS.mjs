import './polyfills.server.mjs';
import{a as dt,b as pt}from"./chunk-KLHX3L6P.mjs";import{a as mt}from"./chunk-NTYP2I5F.mjs";import{b as ut}from"./chunk-KDA2S5QG.mjs";import{a as ct,b as ht}from"./chunk-PDYHWB5Z.mjs";import{a as lt}from"./chunk-BTABODEC.mjs";import{a as We,b as Ke,c as $,d as Qe,e as Xe}from"./chunk-LP2LEXU3.mjs";import{a as je,b as Ue}from"./chunk-WEAAUAY4.mjs";import{a as Ge,b as Je,c as Ye,e as Ze,f as et,h as tt,i as it,k as nt,l as rt,n as ot,o as at,p as st,q as W}from"./chunk-TTNR4QPS.mjs";import{c as Te,d as Fe,f as Be,h as Ve}from"./chunk-SQLON2R6.mjs";import{a as Ce,b as ye,c as xe}from"./chunk-FEYBIC4G.mjs";import{a as Se,b as be,c as Ee,d as Le}from"./chunk-ELAJKLT3.mjs";import{a as Oe,b as He}from"./chunk-5J65EW3V.mjs";import{b as Me,g as Pe,j as De,n as Ie,p as Re,r as Ae,v as $e,w as ze,y as Ne,z as qe}from"./chunk-GA3UYBFM.mjs";import{a as we,b as ve}from"./chunk-PK3DRSOU.mjs";import{a as R}from"./chunk-6EFOJMAD.mjs";import{a as _e}from"./chunk-3FIPRBVQ.mjs";import{a as A}from"./chunk-K3B42B6X.mjs";import{a as ge,c as fe,e as ke}from"./chunk-4I2U3JAI.mjs";import{ka as pe,y as me,z as de}from"./chunk-EDQTS3NM.mjs";import{b as he,d as ue}from"./chunk-BAXOD54Y.mjs";import{d as ce}from"./chunk-TSEEXHZ6.mjs";import{m as oe,o as ae,t as se,x as le}from"./chunk-GTWDOMLN.mjs";import{Bc as F,Cc as B,Dc as V,Fb as J,Gc as L,Hc as s,Ic as S,Jc as k,Kc as ie,Mb as C,Mc as D,Nc as I,Oc as T,Qc as ne,Ra as _,Wc as j,Yb as p,Yc as U,ac as Y,ad as M,dc as E,fc as Z,gc as O,hc as H,ic as r,ja as G,jc as o,kc as b,lc as ee,mc as te,oc as y,pa as w,tb as c,tc as g,vc as u,ya as m,yd as re,za as d}from"./chunk-KYBR54ZN.mjs";import{a as x,b as v,h as q,j as h}from"./chunk-RIAI3ORJ.mjs";var z=class a{graphqlService=w(mt);storageService=w(_e);snackBar=w(A);http=w(ce);apiUrl=R.APIURL;modelName="chotkho";chotkhos=_([]);isLoading=_(!1);selectedChotkho=_(null);ListChotkho=_([]);DetailChotkho=_(null);page=_(1);totalPages=_(1);total=_(0);pageSize=_(50);chotkhoId=_(null);isRefreshing=_(!1);lastUpdated=_(null);constructor(){}loadAllChotkho(){return h(this,null,function*(){try{this.isLoading.set(!0);let t=yield this.graphqlService.findMany(this.modelName,{include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}},details:{include:{sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},phieukho:{select:{id:!0,maphieu:!0,ngay:!0,type:!0}}}}},orderBy:{order:"asc"}});this.chotkhos.set(t||[]),this.ListChotkho.set(t||[]),this.total.set(t?.length||0),this.lastUpdated.set(new Date)}catch(t){console.error("Error loading chotkho:",t),this.showErrorMessage("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u ch\u1ED1t kho"),this.chotkhos.set([]),this.ListChotkho.set([])}finally{this.isLoading.set(!1)}})}getAllChotkho(t){return h(this,null,function*(){try{this.isLoading.set(!0),this.isRefreshing.set(!0);let e={};t&&(t.startDate&&t.endDate&&(e.ngay={gte:new Date(t.startDate),lte:new Date(t.endDate)}),t.khoId&&(e.khoId=t.khoId),t.sanphamId&&(e.details={some:{sanphamId:t.sanphamId}}),t.userId&&(e.userId=t.userId),t.searchText&&(e.OR=[{title:{contains:t.searchText,mode:"insensitive"}},{ghichu:{contains:t.searchText,mode:"insensitive"}},{details:{some:{sanpham:{title:{contains:t.searchText,mode:"insensitive"}}}}}]));let i=(this.page()-1)*this.pageSize(),n=yield this.graphqlService.findMany(this.modelName,{where:e,include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}},details:{include:{sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}}}}},orderBy:{order:"asc"},skip:i,take:this.pageSize()}),l=yield this.graphqlService.findMany(this.modelName,{where:e,select:{id:!0}});this.ListChotkho.set(n||[]),this.total.set(l?.length||0),this.totalPages.set(Math.ceil((l?.length||0)/this.pageSize())),this.lastUpdated.set(new Date)}catch(e){console.error("Error getting all chotkho:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u ch\u1ED1t kho"),this.ListChotkho.set([])}finally{this.isLoading.set(!1),this.isRefreshing.set(!1)}})}getChotkhoById(t){return h(this,null,function*(){try{let e=yield this.graphqlService.findUnique(this.modelName,{id:t},{include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}},details:{include:{sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},phieukho:{select:{id:!0,maphieu:!0,ngay:!0,type:!0}}}}}});return e&&(this.selectedChotkho.set(e),this.DetailChotkho.set(e)),e}catch(e){return console.error("Error getting chotkho by ID:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u ch\u1ED1t kho"),null}})}createChotkho(t){return h(this,null,function*(){try{if(this.isLoading.set(!0),Array.isArray(t))return yield this.bulkCreateChotkho(t);let e=yield this.graphqlService.createOne(this.modelName,v(x({},t),{details:{create:t.details}}),{include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}},details:{include:{sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},phieukho:{select:{id:!0,maphieu:!0,ngay:!0,type:!0}}}}}});return e?(this.showSuccessMessage("T\u1EA1o ch\u1ED1t kho th\xE0nh c\xF4ng"),this.chotkhoId.set(e.id),yield this.getAllChotkho(),{success:!0,data:e}):(this.showErrorMessage("L\u1ED7i khi t\u1EA1o ch\u1ED1t kho"),{success:!1})}catch(e){return console.error("Error creating chotkho:",e),this.showErrorMessage(e?.message||"L\u1ED7i khi t\u1EA1o ch\u1ED1t kho"),{success:!1,message:e?.message}}finally{this.isLoading.set(!1)}})}updateChotkho(t,e){return h(this,null,function*(){try{this.isLoading.set(!0);let i,n;return typeof t=="string"?(i=t,n=e):(i=t.id,n=x({},t),delete n.id),(yield this.graphqlService.updateOne(this.modelName,{id:i},n,{include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}},sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},phieukho:{select:{id:!0,maphieu:!0,ngay:!0,type:!0}}}}))?(this.showSuccessMessage("C\u1EADp nh\u1EADt ch\u1ED1t kho th\xE0nh c\xF4ng"),yield this.getAllChotkho(),!0):(this.showErrorMessage("L\u1ED7i khi c\u1EADp nh\u1EADt ch\u1ED1t kho"),!1)}catch(i){return console.error("Error updating chotkho:",i),this.showErrorMessage(i?.message||"L\u1ED7i khi c\u1EADp nh\u1EADt ch\u1ED1t kho"),!1}finally{this.isLoading.set(!1)}})}deleteChotkho(t){return h(this,null,function*(){try{return this.isLoading.set(!0),(yield this.graphqlService.deleteOne(this.modelName,{id:t}))?(this.showSuccessMessage("X\xF3a ch\u1ED1t kho th\xE0nh c\xF4ng"),yield this.loadAllChotkho(),{deleted:1,failed:0,restoredInventory:!0,deletedPhieukho:!0}):(this.showErrorMessage("L\u1ED7i khi x\xF3a ch\u1ED1t kho"),!1)}catch(e){return console.error("Error deleting chotkho:",e),this.showErrorMessage(e?.message||"L\u1ED7i khi x\xF3a ch\u1ED1t kho"),!1}finally{this.isLoading.set(!1)}})}createChotkhoDetail(t,e){return h(this,null,function*(){try{this.isLoading.set(!0);let i=yield this.graphqlService.createOne("chotkhodetail",v(x({},e),{chotkhoId:t,chenhlech:this.calculateChenhLech(e.slthucte,e.slhethong)}),{include:{sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},phieukho:{select:{id:!0,maphieu:!0,ngay:!0,type:!0}}}});return i?(this.showSuccessMessage("T\u1EA1o chi ti\u1EBFt ch\u1ED1t kho th\xE0nh c\xF4ng"),{success:!0,data:i}):(this.showErrorMessage("L\u1ED7i khi t\u1EA1o chi ti\u1EBFt ch\u1ED1t kho"),{success:!1})}catch(i){return console.error("Error creating chotkho detail:",i),this.showErrorMessage(i?.message||"L\u1ED7i khi t\u1EA1o chi ti\u1EBFt ch\u1ED1t kho"),{success:!1,message:i?.message}}finally{this.isLoading.set(!1)}})}updateChotkhoDetail(t,e){return h(this,null,function*(){try{this.isLoading.set(!0);let i=x({},e);return i.slthucte!==void 0&&i.slhethong!==void 0&&(i.chenhlech=this.calculateChenhLech(i.slthucte,i.slhethong)),(yield this.graphqlService.updateOne("chotkhodetail",{id:t},i,{include:{sanpham:!0,tonkho:!0,phieukho:!0}}))?(this.showSuccessMessage("C\u1EADp nh\u1EADt chi ti\u1EBFt ch\u1ED1t kho th\xE0nh c\xF4ng"),!0):(this.showErrorMessage("L\u1ED7i khi c\u1EADp nh\u1EADt chi ti\u1EBFt ch\u1ED1t kho"),!1)}catch(i){return console.error("Error updating chotkho detail:",i),this.showErrorMessage(i?.message||"L\u1ED7i khi c\u1EADp nh\u1EADt chi ti\u1EBFt ch\u1ED1t kho"),!1}finally{this.isLoading.set(!1)}})}deleteChotkhoDetail(t){return h(this,null,function*(){try{return this.isLoading.set(!0),(yield this.graphqlService.deleteOne("chotkhodetail",{id:t}))?(this.showSuccessMessage("X\xF3a chi ti\u1EBFt ch\u1ED1t kho th\xE0nh c\xF4ng"),!0):(this.showErrorMessage("L\u1ED7i khi x\xF3a chi ti\u1EBFt ch\u1ED1t kho"),!1)}catch(e){return console.error("Error deleting chotkho detail:",e),this.showErrorMessage(e?.message||"L\u1ED7i khi x\xF3a chi ti\u1EBFt ch\u1ED1t kho"),!1}finally{this.isLoading.set(!1)}})}getChotkhoDetailsByChotkhoId(t){return h(this,null,function*(){try{return(yield this.graphqlService.findMany("chotkhodetail",{where:{chotkhoId:t},include:{sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},phieukho:{select:{id:!0,maphieu:!0,ngay:!0,type:!0}}},orderBy:{order:"asc"}}))||[]}catch(e){return console.error("Error getting chotkho details:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA3i chi ti\u1EBFt ch\u1ED1t kho"),[]}})}bulkDeleteChotkho(t){return h(this,null,function*(){if(!t||t.length===0)return this.showErrorMessage("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u \u0111\u1EC3 x\xF3a"),{deleted:0,failed:0,errors:["No data to delete"]};try{return this.isLoading.set(!0),(yield this.graphqlService.batchDelete(this.modelName,t))?(this.showSuccessMessage(`X\xF3a th\xE0nh c\xF4ng ${t.length} ch\u1ED1t kho`),yield this.loadAllChotkho(),{deleted:t.length,failed:0,restoredInventory:!0,deletedPhieukho:!0}):(this.showErrorMessage("L\u1ED7i khi x\xF3a nhi\u1EC1u ch\u1ED1t kho"),{deleted:0,failed:t.length,errors:["Bulk delete failed"]})}catch(e){return console.error("Error bulk deleting chotkho:",e),this.showErrorMessage("L\u1ED7i khi x\xF3a nhi\u1EC1u ch\u1ED1t kho"),{deleted:0,failed:t.length,errors:[e?.message||"Unknown error"]}}finally{this.isLoading.set(!1)}})}getChotkhoByDateRange(t){return h(this,null,function*(){try{this.isLoading.set(!0);let e={};t.startDate&&t.endDate&&(e.ngay={gte:new Date(t.startDate),lte:new Date(t.endDate)});let i=yield this.graphqlService.findMany(this.modelName,{where:e,include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}}},orderBy:{ngay:"desc"}});return{data:i||[],total:i?.length||0}}catch(e){return console.error("Error getting chotkho by date range:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u ch\u1ED1t kho theo th\u1EDDi gian"),{data:[],total:0}}finally{this.isLoading.set(!1)}})}getChotkhoBy(t){return h(this,null,function*(){try{this.isLoading.set(!0);let e={};if(t.ngay){let n=new Date(t.ngay)||new Date;e.ngay=n}Object.keys(t).forEach(n=>{n!=="ngay"&&t[n]!==null&&t[n]!==void 0&&(e[n]=t[n])});let i=yield this.graphqlService.findMany(this.modelName,{where:e,include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}}},orderBy:{order:"asc"}});return i&&i.length>0?(this.selectedChotkho.set(i[0]),this.DetailChotkho.set(i[0]),i[0]):null}catch(e){return console.error("Error getting chotkho by params:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u ch\u1ED1t kho"),null}finally{this.isLoading.set(!1)}})}CreateChotkho(t){return h(this,null,function*(){return yield this.createChotkho(t)})}DeleteChotkho(t){return h(this,null,function*(){return(yield this.deleteChotkho(t.id))!==!1})}getListSanphamTonKho(t){return h(this,null,function*(){try{return(yield this.graphqlService.findMany("tonkho",{where:{sanphamId:{in:t}},take:99999,include:{sanpham:!0}}))||[]}catch(e){return console.error("Error getting sanpham tonkho:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u t\u1ED3n kho s\u1EA3n ph\u1EA9m"),[]}})}getListSanphamByMasp(t){return h(this,null,function*(){try{return(yield this.graphqlService.findMany("sanpham",{where:{masp:{in:t}},take:99999,select:{id:!0,title:!0,masp:!0,dvt:!0}}))||[]}catch(e){return console.error("Error getting sanpham tonkho:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u t\u1ED3n kho s\u1EA3n ph\u1EA9m"),[]}})}bulkCreateChotkho(t){return h(this,null,function*(){try{this.isLoading.set(!0),console.log("Bulk creating chotkho with data:",t);let e=yield this.graphqlService.batchCreate(this.modelName,t);return e?(this.showSuccessMessage("T\u1EA1o ch\u1ED1t kho h\xE0ng lo\u1EA1t th\xE0nh c\xF4ng"),yield this.getAllChotkho(),{success:!0,data:e,created:e.length,failed:0}):(this.showErrorMessage("L\u1ED7i khi t\u1EA1o ch\u1ED1t kho h\xE0ng lo\u1EA1t"),{success:!1,created:0,failed:t.length})}catch(e){return console.error("Error bulk creating chotkho:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA1o ch\u1ED1t kho h\xE0ng lo\u1EA1t"),{success:!1,created:0,failed:t.length,error:e?.message}}finally{this.isLoading.set(!1)}})}setSelectedChotkho(t){this.selectedChotkho.set(t),this.DetailChotkho.set(t)}clearSelectedChotkho(){this.selectedChotkho.set(null),this.DetailChotkho.set(null)}setChotkhoId(t){this.chotkhoId.set(t)}calculateChenhLech(t,e){return t-e}createChotkhoData(t){let e=t.details.map(i=>v(x({},i),{chenhlech:this.calculateChenhLech(i.slthucte,i.slhethong)}));return{khoId:t.khoId,ngay:new Date,title:t.title,ghichu:t.ghichu,userId:t.userId,details:e}}validateChotkhoData(t){let e=[];return(!t.details||t.details.length===0)&&e.push("Chi ti\u1EBFt ch\u1ED1t kho l\xE0 b\u1EAFt bu\u1ED9c"),t.details?.forEach((i,n)=>{(i.slthucte===void 0||i.slthucte===null)&&e.push(`D\xF2ng ${n+1}: S\u1ED1 l\u01B0\u1EE3ng th\u1EF1c t\u1EBF (slthucte) l\xE0 b\u1EAFt bu\u1ED9c`),(i.slhethong===void 0||i.slhethong===null)&&e.push(`D\xF2ng ${n+1}: S\u1ED1 l\u01B0\u1EE3ng h\u1EC7 th\u1ED1ng (slhethong) l\xE0 b\u1EAFt bu\u1ED9c`),(typeof i.slthucte!="number"||i.slthucte<0)&&e.push(`D\xF2ng ${n+1}: S\u1ED1 l\u01B0\u1EE3ng th\u1EF1c t\u1EBF ph\u1EA3i l\xE0 s\u1ED1 kh\xF4ng \xE2m`),(typeof i.slhethong!="number"||i.slhethong<0)&&e.push(`D\xF2ng ${n+1}: S\u1ED1 l\u01B0\u1EE3ng h\u1EC7 th\u1ED1ng ph\u1EA3i l\xE0 s\u1ED1 kh\xF4ng \xE2m`)}),{isValid:e.length===0,errors:e}}formatChotkhoForDisplay(t){let e=t.details?.reduce((l,f)=>l+(f.slthucte||0),0)||0,i=t.details?.reduce((l,f)=>l+(f.slhethong||0),0)||0,n=e-i;return{id:t.id,title:t.title||"Ch\u01B0a c\xF3 ti\xEAu \u0111\u1EC1",ngay:t.ngay?new Date(t.ngay).toLocaleDateString("vi-VN"):"",totalSlthucte:e.toLocaleString("vi-VN"),totalSlhethong:i.toLocaleString("vi-VN"),totalChenhlech:n.toLocaleString("vi-VN"),detailCount:t.details?.length||0,ghichu:t.ghichu||"",khoName:t.kho?.name||"",userName:t.user?.profile?.name||t.user?.email||"",isActive:t.isActive?"Ho\u1EA1t \u0111\u1ED9ng":"Kh\xF4ng ho\u1EA1t \u0111\u1ED9ng"}}getUpdatedCodeIds(){return h(this,null,function*(){console.log("getUpdatedCodeIds called")})}getStatistics(){return h(this,null,function*(){try{let t=yield this.graphqlService.findMany(this.modelName,{select:{id:!0}}),e=yield this.graphqlService.findMany(this.modelName,{where:{isActive:!0},select:{id:!0}}),i=yield this.graphqlService.findMany(this.modelName,{where:{isActive:!1},select:{id:!0}});return{total:t?.length||0,active:e?.length||0,inactive:i?.length||0,averageChenhLech:0}}catch(t){return console.error("Error getting statistics:",t),this.showErrorMessage("L\u1ED7i khi l\u1EA5y th\u1ED1ng k\xEA"),null}})}generateReport(t){return h(this,null,function*(){try{let e={};t.dateFrom&&t.dateTo&&(e.ngay={gte:new Date(t.dateFrom),lte:new Date(t.dateTo)});let i=yield this.graphqlService.findMany(this.modelName,{where:e,include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}},sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},phieukho:{select:{id:!0,maphieu:!0,ngay:!0,type:!0}}},orderBy:{ngay:"desc"}});return{data:i,total:i?.length||0,generatedAt:new Date,format:t.format||"json"}}catch(e){return console.error("Error generating report:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA1o b\xE1o c\xE1o"),null}})}bulkUpdateStatus(t,e){return h(this,null,function*(){try{this.isLoading.set(!0);let i=t.map(l=>({where:{id:l},data:{isActive:e==="active",updatedAt:new Date}}));return(yield this.graphqlService.batchUpdate(this.modelName,i))?(this.showSuccessMessage("C\u1EADp nh\u1EADt tr\u1EA1ng th\xE1i th\xE0nh c\xF4ng"),yield this.getAllChotkho(),!0):(this.showErrorMessage("L\u1ED7i khi c\u1EADp nh\u1EADt tr\u1EA1ng th\xE1i"),!1)}catch(i){return console.error("Error bulk updating status:",i),this.showErrorMessage("L\u1ED7i khi c\u1EADp nh\u1EADt tr\u1EA1ng th\xE1i h\xE0ng lo\u1EA1t"),!1}finally{this.isLoading.set(!1)}})}showSuccessMessage(t){this.snackBar.open(t,"\u0110\xF3ng",{duration:3e3,panelClass:["success-snackbar"],horizontalPosition:"end",verticalPosition:"top"})}showErrorMessage(t){this.snackBar.open(t,"\u0110\xF3ng",{duration:5e3,panelClass:["error-snackbar"],horizontalPosition:"end",verticalPosition:"top"})}getCacheHitRate(){return this.graphqlService.getCacheHitRate?.()||0}getPerformanceMetrics(){return this.graphqlService.getPerformanceMetrics?.()||[]}clearCache(){this.graphqlService.clearCache?.()}performHealthCheck(){return h(this,null,function*(){try{return(yield this.graphqlService.findMany(this.modelName,{select:{id:!0},take:1}))!==null}catch(t){return console.error("Health check failed:",t),!1}})}importFromExcel(i){return h(this,arguments,function*(t,e={}){try{return this.isLoading.set(!0),this.showErrorMessage("Import t\u1EEB Excel ch\u01B0a \u0111\u01B0\u1EE3c tri\u1EC3n khai trong GraphQL"),{success:!1,message:"Import t\u1EEB Excel ch\u01B0a \u0111\u01B0\u1EE3c tri\u1EC3n khai trong GraphQL",imported:0,failed:0,errors:[]}}catch(n){return console.error("Error importing from Excel:",n),this.showErrorMessage("L\u1ED7i khi import d\u1EEF li\u1EC7u t\u1EEB Excel"),{success:!1,message:n?.message||"Unknown error",imported:0,failed:1,errors:[n?.message||"Unknown error"]}}finally{this.isLoading.set(!1)}})}backupData(t){return h(this,null,function*(){try{this.isLoading.set(!0);let e=yield this.graphqlService.findMany(this.modelName,{include:{user:!0,kho:!0,tonkho:!0}}),i={type:t,timestamp:new Date().toISOString(),data:e,count:e?.length||0};return console.log("Backup created:",i),this.showSuccessMessage(`Backup ${t} th\xE0nh c\xF4ng - ${i.count} b\u1EA3n ghi`),!0}catch(e){return console.error("Error backing up data:",e),this.showErrorMessage("L\u1ED7i khi backup d\u1EEF li\u1EC7u"),!1}finally{this.isLoading.set(!1)}})}optimizePerformance(){return h(this,null,function*(){try{this.isLoading.set(!0),this.graphqlService.clearCache?.();let t=this.graphqlService.getPerformanceMetrics?.()||[],e=this.graphqlService.getCacheHitRate?.()||0;return this.showSuccessMessage("T\u1ED1i \u01B0u h\xF3a hi\u1EC7u su\u1EA5t th\xE0nh c\xF4ng"),{success:!0,cacheCleared:!0,cacheHitRate:e,metrics:t,timestamp:new Date}}catch(t){return console.error("Error optimizing performance:",t),this.showErrorMessage("L\u1ED7i khi t\u1ED1i \u01B0u h\xF3a hi\u1EC7u su\u1EA5t"),{success:!1,error:t?.message||"Unknown error"}}finally{this.isLoading.set(!1)}})}getSystemHealth(){return h(this,null,function*(){try{let t=yield this.performHealthCheck(),e=this.getPerformanceMetrics(),i=this.getCacheHitRate();return{healthy:t,cacheHitRate:i,metrics:e,timestamp:new Date,graphqlConnected:t}}catch(t){return console.error("Error getting system health:",t),{healthy:!1,error:t}}})}generateImportTemplate(t="standard"){return h(this,null,function*(){try{let e={success:!0,templateUrl:`/api/templates/chotkho-import-${t}.xlsx`,format:"xlsx",type:t,columns:t==="advanced"?["id","khoId","sanphamId","userId","ngay","soluong","dongia","thanhtien","ghichu","isActive"]:["id","khoId","sanphamId","userId","ngay","soluong","dongia","thanhtien","ghichu"]};return this.showSuccessMessage("Template \u0111\u01B0\u1EE3c t\u1EA1o th\xE0nh c\xF4ng"),e}catch(e){return console.error("Error generating import template:",e),this.showErrorMessage("L\u1ED7i khi t\u1EA1o template import"),{success:!1}}})}exportData(t="excel",e){return h(this,null,function*(){try{this.isLoading.set(!0);let i={};e&&e.dateFrom&&e.dateTo&&(i.ngay={gte:new Date(e.dateFrom),lte:new Date(e.dateTo)});let n=yield this.graphqlService.findMany(this.modelName,{where:i,include:{user:{select:{id:!0,email:!0,profile:{select:{name:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}},sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},phieukho:{select:{id:!0,maphieu:!0,ngay:!0,type:!0}}}});return this.showSuccessMessage(`Xu\u1EA5t d\u1EEF li\u1EC7u ${t} th\xE0nh c\xF4ng`),{success:!0,data:n,format:t,count:n?.length||0,timestamp:new Date}}catch(i){return console.error("Error exporting data:",i),this.showErrorMessage("L\u1ED7i khi xu\u1EA5t d\u1EEF li\u1EC7u"),{success:!1,error:i?.message}}finally{this.isLoading.set(!1)}})}smartCheckChenhLech(t){return h(this,null,function*(){try{this.isLoading.set(!0);let e={};t&&(e.id=t);let n=(yield this.graphqlService.findMany(this.modelName,{where:e,include:{tonkho:{select:{id:!0,slton:!0,slchogiao:!0,slchonhap:!0}},sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0,giagoc:!0}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}}}}))?.map(f=>{let N=f.tonkho?.slton||0,K=f.slthucte||0,Q=f.slhethong||0,X=K-Q;return v(x({},f),{expectedQty:N,actualQty:K,systemQty:Q,difference:X,hasDifference:Math.abs(X)>0})})||[],l=n.filter(f=>f.hasDifference);return this.showSuccessMessage(`Ki\u1EC3m tra th\xF4ng minh ho\xE0n t\u1EA5t - ${l.length} ch\xEAnh l\u1EC7ch`),{success:!0,total:n.length,withDifferences:l.length,differences:l}}catch(e){return console.error("Error in smart check:",e),this.showErrorMessage("L\u1ED7i khi ki\u1EC3m tra ch\xEAnh l\u1EC7ch th\xF4ng minh"),{success:!1,error:e?.message}}finally{this.isLoading.set(!1)}})}restoreFromBackup(t){return h(this,null,function*(){try{return this.isLoading.set(!0),!t||!t.data?(this.showErrorMessage("D\u1EEF li\u1EC7u backup kh\xF4ng h\u1EE3p l\u1EC7"),!1):(this.showSuccessMessage(`Kh\xF4i ph\u1EE5c th\xE0nh c\xF4ng ${t.data.length} b\u1EA3n ghi`),yield this.getAllChotkho(),!0)}catch(e){return console.error("Error restoring from backup:",e),this.showErrorMessage("L\u1ED7i khi kh\xF4i ph\u1EE5c d\u1EEF li\u1EC7u"),!1}finally{this.isLoading.set(!1)}})}getTonkhoWithPendingQuantities(){return h(this,null,function*(){try{return(yield this.graphqlService.findMany("tonkho",{where:{OR:[{slchogiao:{gt:0}},{slchonhap:{gt:0}}]},take:99999,include:{sanpham:{select:{id:!0,masp:!0,title:!0,dvt:!0}}}}))||[]}catch(t){return console.error("Error getting tonkho with pending quantities:",t),[]}})}completePendingDeliveries(t){return h(this,null,function*(){try{let e=yield this.http.post(`${R.APIURL}/donhang/complete-pending-deliveries/${t}`,{}).toPromise();return{success:e?.success||!0,count:e?.count||0,message:e?.message||"Ho\xE0n t\u1EA5t giao h\xE0ng th\xE0nh c\xF4ng"}}catch(e){return console.error("Error completing pending deliveries:",e),{success:!1,message:e.error?.message||e.message||"L\u1ED7i khi ho\xE0n t\u1EA5t giao h\xE0ng"}}})}completePendingReceipts(t){return h(this,null,function*(){try{let e=yield this.http.post(`${R.APIURL}/dathang/complete-pending-receipts/${t}`,{}).toPromise();return{success:e?.success||!0,count:e?.count||0,message:e?.message||"Ho\xE0n t\u1EA5t nh\u1EADp h\xE0ng th\xE0nh c\xF4ng"}}catch(e){return console.error("Error completing pending receipts:",e),{success:!1,message:e.error?.message||e.message||"L\u1ED7i khi ho\xE0n t\u1EA5t nh\u1EADp h\xE0ng"}}})}createPhieuKho(t){return h(this,null,function*(){try{let e={title:t.title,type:t.type,ngay:t.ngay,ghichu:t.ghichu,khoId:t.khoId,isChotkho:t.isChotkho,sanpham:{create:t.sanpham.map(n=>({sanphamId:n.sanphamId,soluong:n.soluong,ghichu:n.ghichu}))}},i=yield this.graphqlService.createOne("phieukho",e,{include:{sanpham:!0,kho:!0}});return i&&this.showSuccessMessage(`T\u1EA1o phi\u1EBFu kho ${t.type.toLowerCase()} th\xE0nh c\xF4ng`),i}catch(e){throw console.error("Error creating phieu kho:",e),this.showErrorMessage(`L\u1ED7i t\u1EA1o phi\u1EBFu kho: ${e.message}`),e}})}completeChotkhoWorkflow(t){return h(this,null,function*(){try{this.isLoading.set(!0);let e=yield this.http.post(`${this.apiUrl}/chotkho/${t}/complete`,{}).toPromise();return e&&(this.showSuccessMessage("Ch\u1ED1t kho ho\xE0n t\u1EA5t v\u1EDBi phi\u1EBFu kho \u0111i\u1EC1u ch\u1EC9nh"),yield this.getAllChotkho()),e}catch(e){throw console.error("Error completing chotkho workflow:",e),this.showErrorMessage(`L\u1ED7i ch\u1ED1t kho: ${e.message}`),e}finally{this.isLoading.set(!1)}})}updateTonkhoFields(t,e){return h(this,null,function*(){try{let i={};e.slton!==void 0&&(i.slton=e.slton),e.slchogiao!==void 0&&(i.slchogiao=e.slchogiao),e.slchonhap!==void 0&&(i.slchonhap=e.slchonhap);let n=yield this.graphqlService.updateOne("tonkho",{id:t},i);return e.adjustmentReason&&console.log(`TonKho field update logged: ${e.adjustmentReason}, value: ${e.adjustmentValue}, by: ${e.updatedBy}`),n}catch(i){throw console.error("Error updating tonkho fields:",i),this.showErrorMessage(`L\u1ED7i c\u1EADp nh\u1EADt TonKho: ${i.message}`),i}})}updateTonkhoSlton(t,e){return h(this,null,function*(){try{let i={slton:e.slton},n=yield this.graphqlService.updateOne("tonkho",{id:t},i);return e.adjustmentReason&&console.log(`TonKho adjustment logged: ${e.adjustmentReason}, value: ${e.adjustmentValue}, by: ${e.updatedBy}`),n}catch(i){throw console.error("Error updating tonkho slton:",i),this.showErrorMessage(`L\u1ED7i c\u1EADp nh\u1EADt t\u1ED3n kho: ${i.message}`),i}})}executeCustomWorkflow(t,e){return h(this,null,function*(){try{return yield this.graphqlService.createOne(t,e)}catch(i){throw console.error(`Error executing ${t} workflow:`,i),i}})}getChotkhoStatistics(){return h(this,null,function*(){try{let t=yield this.graphqlService.findMany("chotkho",{include:{details:{select:{chenhlech:!0,slchogiao:!0,slchonhap:!0}}}});return!t||t.length===0?{total:0,withDiscrepancy:0,fullyCompleted:0,pendingDelivery:0,pendingReceipt:0}:t.reduce((i,n)=>(i.total+=n.details?.length||0,n.details?.forEach(l=>{Math.abs(l.chenhlech||0)>0&&i.withDiscrepancy++,(l.slchogiao||0)===0&&(l.slchonhap||0)===0&&i.fullyCompleted++,(l.slchogiao||0)>0&&i.pendingDelivery++,(l.slchonhap||0)>0&&i.pendingReceipt++}),i),{total:0,withDiscrepancy:0,fullyCompleted:0,pendingDelivery:0,pendingReceipt:0})}catch(t){return console.error("Error getting chotkho statistics:",t),{total:0,withDiscrepancy:0,fullyCompleted:0,pendingDelivery:0,pendingReceipt:0}}})}validateWorkflowData(t){let e=[];return!t||t.length===0?(e.push("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u \u0111\u1EC3 x\u1EED l\xFD"),{isValid:!1,errors:e}):(t.forEach((i,n)=>{i.sanphamId||e.push(`D\xF2ng ${n+1}: Thi\u1EBFu th\xF4ng tin s\u1EA3n ph\u1EA9m`),(i.slthucte===void 0||i.slthucte===null)&&e.push(`D\xF2ng ${n+1}: Thi\u1EBFu s\u1ED1 l\u01B0\u1EE3ng th\u1EF1c t\u1EBF`),(i.slhethong===void 0||i.slhethong===null)&&e.push(`D\xF2ng ${n+1}: Thi\u1EBFu s\u1ED1 l\u01B0\u1EE3ng h\u1EC7 th\u1ED1ng`),i.slchogiao!==void 0&&i.slchogiao<0&&e.push(`D\xF2ng ${n+1}: S\u1ED1 l\u01B0\u1EE3ng ch\u1EDD giao kh\xF4ng \u0111\u01B0\u1EE3c \xE2m`),i.slchonhap!==void 0&&i.slchonhap<0&&e.push(`D\xF2ng ${n+1}: S\u1ED1 l\u01B0\u1EE3ng ch\u1EDD nh\u1EADp kh\xF4ng \u0111\u01B0\u1EE3c \xE2m`)}),{isValid:e.length===0,errors:e})}static \u0275fac=function(e){return new(e||a)};static \u0275prov=G({token:a,factory:a.\u0275fac,providedIn:"root"})};var kt=["drawer"],_t=()=>({standalone:!0}),Ct=(a,t)=>t.key;function yt(a,t){if(a&1){let e=y();r(0,"button",46),g("click",function(){m(e);let n=u(),l=L(118);return d(n.openDeleteDialog(l))}),r(1,"mat-icon"),s(2,"delete"),o(),r(3,"span",21),s(4,"Xo\xE1"),o()()}}function xt(a,t){if(a&1){let e=y();r(0,"button",59),g("click",function(n){m(e);let l=u().$implicit;return u(4).toggleColumn(l),d(n.stopPropagation())}),r(1,"mat-icon"),s(2),o(),r(3,"span"),s(4),o()()}if(a&2){let e=u().$implicit;p("disabled",!0),c(2),S(e.isShow?"check_box":"check_box_outline_blank"),c(2),S(e.value)}}function wt(a,t){if(a&1){let e=y();r(0,"button",27),g("click",function(n){m(e);let l=u().$implicit;return u(4).toggleColumn(l),d(n.stopPropagation())}),r(1,"mat-icon"),s(2),o(),r(3,"span"),s(4),o()()}if(a&2){let e=u().$implicit;c(2),S(e.isShow?"check_box":"check_box_outline_blank"),c(2),S(e.value)}}function vt(a,t){if(a&1&&C(0,xt,5,3,"button",57)(1,wt,5,2,"button",58),a&2){let e=t.$implicit;E(e.key=="stt"?0:1)}}function St(a,t){if(a&1){let e=y();r(0,"th",47)(1,"button",51)(2,"mat-icon"),s(3,"tune"),o()(),r(4,"mat-menu",null,9)(6,"div",52)(7,"mat-form-field",53)(8,"input",54),g("input",function(n){m(e);let l=u(3);return d(l.doFilterColumns(n))})("click",function(n){return m(e),d(n.stopPropagation())}),o(),r(9,"mat-icon",55),s(10,"search"),o()(),r(11,"button",37),g("click",function(){m(e);let n=u(3);return d(n.updateDisplayedColumns())}),r(12,"mat-icon"),s(13,"check_circle"),o()()(),r(14,"div",56),O(15,vt,2,1,null,null,Ct),o()()()}if(a&2){let e=L(5),i=u(3);c(),p("matMenuTriggerFor",e),c(14),H(i.FilterColumns)}}function bt(a,t){a&1&&C(0,St,17,1,"th",50)}function Et(a,t){if(a&1){let e=y();r(0,"th",48)(1,"span",61),s(2),o(),r(3,"app-searchfilter",62),g("OutFilter",function(n){m(e);let l=u(3);return d(l.onOutFilter(n))}),o()()}if(a&2){let e=u(2).$implicit,i=u();c(2),k(" ",i.ColumnName[e]," "),c(),p("icon","filter_alt")("ListItem",i.Listchotkho())("fieldsearch",e)("ListFilter",i.ListFilter)("filterItem",i.FilterHederColumn(i.dataSource.filteredData,e))}}function Lt(a,t){a&1&&C(0,Et,4,6,"th",60)}function Mt(a,t){if(a&1){let e=y();r(0,"span",67),g("click",function(){m(e);let n=u().$implicit,l=u(2);return d(l.goToDetail(n))}),s(1),o()}if(a&2){let e=u().$implicit,i=u().$implicit;c(),k(" ",e[i]," ")}}function Pt(a,t){a&1&&(r(0,"mat-icon"),s(1,"check"),o())}function Dt(a,t){if(a&1&&(r(0,"span"),s(1),o()),a&2){let e=u(2).index;c(),S(e+1)}}function It(a,t){if(a&1){let e=y();r(0,"span",68),g("click",function(){m(e);let n=u().$implicit,l=u(2);return d(l.AddToEdit(n))}),C(1,Pt,2,0,"mat-icon")(2,Dt,2,1,"span"),o()}if(a&2){let e=u().$implicit,i=u(2);c(),E(i.CheckSelect(e)?1:2)}}function Tt(a,t){if(a&1&&(r(0,"span",66),s(1),j(2,"date"),o()),a&2){let e=u().$implicit,i=u().$implicit;c(),k(" ",U(2,1,e[i],"dd/MM/yyyy")," ")}}function Ft(a,t){a&1&&(r(0,"mat-icon",69),s(1,"check_circle"),o())}function Bt(a,t){a&1&&(r(0,"mat-icon",70),s(1,"cancel"),o())}function Vt(a,t){if(a&1&&(r(0,"span",66),C(1,Ft,2,0,"mat-icon",69)(2,Bt,2,0,"mat-icon",70),o()),a&2){let e=u().$implicit,i=u().$implicit;c(),E(e[i]?1:2)}}function Rt(a,t){if(a&1&&(r(0,"span",66),s(1),o()),a&2){let e=u().$implicit,i=u().$implicit;c(),k(" ",e[i]," ")}}function At(a,t){if(a&1&&(r(0,"td",63),C(1,Mt,2,1,"span",64)(2,It,3,1,"span",65)(3,Tt,3,4,"span",66)(4,Vt,3,1,"span",66)(5,Rt,2,1,"span",66),o()),a&2){let e,i=u().$implicit;c(),E((e=i)==="codeId"?1:e==="stt"?2:e==="createdAt"?3:e==="isActive"?4:5)}}function $t(a,t){if(a&1&&(ee(0,42),C(1,bt,1,0,"th",47)(2,Lt,1,0,"th",48)(3,At,6,1,"td",49),te()),a&2){let e=t.$implicit;p("matColumnDef",e),c(),E(e=="stt"?1:2)}}function zt(a,t){a&1&&b(0,"tr",71)}function Nt(a,t){if(a&1&&b(0,"tr",72),a&2){let e=t.$implicit,i=u();Y("hover:bg-slate-50 ",i.CheckItemInEdit(e)?"!bg-blue-50":"","")}}function qt(a,t){a&1&&(r(0,"tr",73)(1,"td",74),s(2,"Kh\xF4ng t\xECm th\u1EA5y"),o()())}function Ot(a,t){a&1&&(r(0,"mat-dialog-content")(1,"div",75)(2,"div",76),s(3,"X\xE1c Nh\u1EADn"),o(),r(4,"div"),s(5,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),o(),r(6,"div",77)(7,"button",78),s(8,"\u0110\u1ED3ng \xDD"),o(),r(9,"button",79),s(10,"Hu\u1EF7 B\u1ECF"),o()()()())}function Ht(a,t){if(a&1&&(r(0,"div",82),b(1,"mat-progress-bar",88),r(2,"div",89),s(3),o()()),a&2){let e=u(2);c(),p("value",e.importProgress),c(2),k("",e.importProgress,"% Complete")}}function jt(a,t){if(a&1){let e=y();r(0,"mat-dialog-content")(1,"div",80)(2,"div",81),s(3,"Import Excel File"),o(),r(4,"div",82)(5,"input",83),g("change",function(n){m(e);let l=u();return d(l.onFileSelected(n))}),o()(),C(6,Ht,4,2,"div",84),r(7,"div",85)(8,"button",86),g("click",function(){m(e);let n=u();return d(n.startImport())}),s(9," Start Import "),o(),r(10,"button",87),s(11,"Cancel"),o()()()()}if(a&2){let e=u();c(6),p("ngIf",e.importProgress>0),c(2),p("disabled",!e.selectedFile||e.importProgress>0)}}function Ut(a,t){if(a&1&&(r(0,"div",82),b(1,"mat-progress-bar",88),r(2,"div",89),s(3),o()()),a&2){let e=u(2);c(),p("value",e.exportProgress),c(2),k("",e.exportProgress,"% Complete")}}function Wt(a,t){if(a&1){let e=y();r(0,"mat-dialog-content")(1,"div",80)(2,"div",81),s(3,"Export to Excel"),o(),r(4,"div",82)(5,"mat-form-field",90)(6,"mat-label"),s(7,"Export Type"),o(),r(8,"mat-select",91),T("valueChange",function(n){m(e);let l=u();return I(l.exportType,n)||(l.exportType=n),d(n)}),r(9,"mat-option",92),s(10,"All Data"),o(),r(11,"mat-option",93),s(12,"Filtered Data"),o(),r(13,"mat-option",94),s(14,"Selected Items"),o()()()(),C(15,Ut,4,2,"div",84),r(16,"div",85)(17,"button",86),g("click",function(){m(e);let n=u();return d(n.startExport())}),s(18," Start Export "),o(),r(19,"button",87),s(20,"Cancel"),o()()()()}if(a&2){let e=u();c(8),D("value",e.exportType),c(7),p("ngIf",e.exportProgress>0),c(2),p("disabled",e.exportProgress>0)}}function Kt(a,t){if(a&1){let e=y();r(0,"div",82)(1,"mat-form-field",90)(2,"mat-label"),s(3,"Backup Type"),o(),r(4,"mat-select",91),T("valueChange",function(n){m(e);let l=u(2);return I(l.backupType,n)||(l.backupType=n),d(n)}),r(5,"mat-option",95),s(6,"Full Backup"),o(),r(7,"mat-option",96),s(8,"Incremental Backup"),o()()(),r(9,"mat-form-field",90)(10,"mat-label"),s(11,"Backup Name"),o(),r(12,"input",97),T("ngModelChange",function(n){m(e);let l=u(2);return I(l.backupName,n)||(l.backupName=n),d(n)}),o()()()}if(a&2){let e=u(2);c(4),D("value",e.backupType),c(8),D("ngModel",e.backupName)}}function Qt(a,t){if(a&1){let e=y();r(0,"div",82)(1,"input",98),g("change",function(n){m(e);let l=u(2);return d(l.onBackupFileSelected(n))}),o()()}}function Xt(a,t){if(a&1&&(r(0,"div",82),b(1,"mat-progress-bar",88),r(2,"div",89),s(3),o()()),a&2){let e=u(2);c(),p("value",e.backupProgress),c(2),k("",e.backupProgress,"% Complete")}}function Gt(a,t){if(a&1){let e=y();r(0,"mat-dialog-content")(1,"div",80)(2,"div",81),s(3),o(),C(4,Kt,13,2,"div",84)(5,Qt,2,0,"div",84)(6,Xt,4,2,"div",84),r(7,"div",85)(8,"button",86),g("click",function(){m(e);let n=u();return d(n.isRestoreMode?n.startRestore():n.startBackup())}),s(9),o(),r(10,"button",87),s(11,"Cancel"),o()()()()}if(a&2){let e=u();c(3),S(e.isRestoreMode?"Restore Data":"Create Backup"),c(),p("ngIf",!e.isRestoreMode),c(),p("ngIf",e.isRestoreMode),c(),p("ngIf",e.backupProgress>0),c(2),p("disabled",e.backupProgress>0||e.isRestoreMode&&!e.selectedBackupFile||!e.isRestoreMode&&!e.backupName),c(),k(" ",e.isRestoreMode?"Start Restore":"Start Backup"," ")}}function Jt(a,t){if(a&1&&(r(0,"div",102)(1,"div",103)(2,"span",104),s(3,"Database"),o(),r(4,"div",105)(5,"mat-icon",106),s(6),o(),r(7,"span",107),s(8),o()()(),r(9,"div",103)(10,"span",104),s(11,"API Server"),o(),r(12,"div",105)(13,"mat-icon",106),s(14),o(),r(15,"span",107),s(16),o()()(),r(17,"div",103)(18,"span",104),s(19,"Memory Usage"),o(),r(20,"div",105)(21,"mat-icon",106),s(22),o(),r(23,"span",107),s(24),o()()(),r(25,"div",108)(26,"span",104),s(27,"Last Check"),o(),r(28,"span",107),s(29),j(30,"date"),o()()()),a&2){let e=u(2);c(),p("ngClass",e.healthCheck.database.status==="healthy"?"bg-green-50":"bg-red-50"),c(4),p("ngClass",e.healthCheck.database.status==="healthy"?"text-green-500":"text-red-500"),c(),k(" ",e.healthCheck.database.status==="healthy"?"check_circle":"error"," "),c(2),k("",e.healthCheck.database.responseTime,"ms"),c(),p("ngClass",e.healthCheck.api.status==="healthy"?"bg-green-50":"bg-red-50"),c(4),p("ngClass",e.healthCheck.api.status==="healthy"?"text-green-500":"text-red-500"),c(),k(" ",e.healthCheck.api.status==="healthy"?"check_circle":"error"," "),c(2),k("",e.healthCheck.api.responseTime,"ms"),c(),p("ngClass",e.healthCheck.memory.status==="healthy"?"bg-green-50":"bg-yellow-50"),c(4),p("ngClass",e.healthCheck.memory.status==="healthy"?"text-green-500":"text-yellow-500"),c(),k(" ",e.healthCheck.memory.status==="healthy"?"check_circle":"warning"," "),c(2),k("",e.healthCheck.memory.usage,"%"),c(5),S(U(30,13,e.healthCheck.timestamp,"dd/MM/yyyy HH:mm:ss"))}}function Yt(a,t){if(a&1){let e=y();r(0,"mat-dialog-content")(1,"div",99)(2,"div",81),s(3,"System Health Status"),o(),C(4,Jt,31,16,"div",100),r(5,"div",85)(6,"button",101),g("click",function(){m(e);let n=u();return d(n.checkSystemHealth())}),s(7," Refresh Status "),o(),r(8,"button",87),s(9,"Close"),o()()()()}if(a&2){let e=u();c(4),p("ngIf",e.healthCheck)}}var P=class P{displayedColumns=[];ColumnName={stt:"#",codeId:"Code",title:"Ti\xEAu \u0110\u1EC1",description:"M\xF4 T\u1EA3",status:"Tr\u1EA1ng Th\xE1i",order:"Th\u1EE9 T\u1EF1",createdAt:"Ng\xE0y T\u1EA1o"};FilterColumns=JSON.parse(localStorage.getItem("ChotkhoColFilter")||"[]");Columns=[];paginator;sort;drawer;_ChotkhoService=w(z);_breakpointObserver=w(me);_router=w(ue);_dialog=w(Te);_snackBar=w(A);Listchotkho=this._ChotkhoService.ListChotkho;page=this._ChotkhoService.page;totalPages=this._ChotkhoService.totalPages;total=this._ChotkhoService.total;pageSize=this._ChotkhoService.pageSize;chotkhoId=this._ChotkhoService.chotkhoId;isLoading=this._ChotkhoService.isLoading;isRefreshing=this._ChotkhoService.isRefreshing;lastUpdated=this._ChotkhoService.lastUpdated;dataSource=new W([]);EditList=[];isSearch=_(!1);searchParam={};performanceMetrics=_({loadTime:0,renderTime:0,totalItems:0,lastRefresh:null});selectedFile=null;selectedBackupFile=null;exportType="all";backupType="full";backupName="";isRestoreMode=!1;importProgress=0;exportProgress=0;backupProgress=0;healthCheck=null;constructor(){re(()=>{let t=performance.now();this.dataSource.data=this.Listchotkho(),this.dataSource.sort=this.sort,this.paginator&&(this.paginator.pageIndex=this.page()-1,this.paginator.pageSize=this.pageSize(),this.paginator.length=this.total());let e=performance.now();this.performanceMetrics.update(i=>v(x({},i),{renderTime:e-t,totalItems:this.Listchotkho().length,lastRefresh:new Date}))})}ngOnInit(){return h(this,null,function*(){let t=performance.now();yield this._ChotkhoService.getAllChotkho(this.searchParam),this.displayedColumns=Object.keys(this.ColumnName),this.dataSource=new W(this.Listchotkho()),this.dataSource.sort=this.sort,this.initializeColumns(),this.setupDrawer();let e=performance.now();this.performanceMetrics.update(i=>v(x({},i),{loadTime:e-t}))})}initializeColumns(){this.Columns=Object.entries(this.ColumnName).map(([t,e])=>({key:t,value:e,isShow:!0})),this.FilterColumns=this.FilterColumns.length?this.FilterColumns:this.Columns,localStorage.setItem("ChotkhoColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(t=>t.isShow).map(t=>t.key),this.ColumnName=this.FilterColumns.reduce((t,{key:e,value:i,isShow:n})=>n?v(x({},t),{[e]:i}):t,{})}applyFilter(t){let e=t.target.value;this.dataSource.filter=e.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getUpdatedCodeIds(){return h(this,null,function*(){yield this._ChotkhoService.getUpdatedCodeIds()})}setupDrawer(){this._breakpointObserver.observe([de.Handset]).subscribe(t=>{t.matches?this.drawer.mode="over":this.drawer.mode="over"})}toggleColumn(t){let e=this.FilterColumns.find(i=>i.key===t.key);e&&(e.isShow=!e.isShow)}FilterHederColumn(t,e){return t.filter((n,l,f)=>l===f.findIndex(N=>N[e]===n[e]))}ListFilter=[];onOutFilter(t){this.dataSource.data=t,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(t=>t.isShow).map(t=>t.key),this.ColumnName=this.FilterColumns.reduce((t,e)=>(e.isShow&&(t[e.key]=e.value),t),{}),localStorage.setItem("ChotkhoColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(t){let e=t.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(i=>i.value.toLowerCase().includes(e))}create(){this.drawer.open(),this._router.navigate(["admin/chotkho","new"])}CheckSelect(t){return!!this.EditList.some(e=>e.id===t.id)}openDeleteDialog(t){this._dialog.open(t,{hasBackdrop:!0,disableClose:!0}).afterClosed().subscribe(i=>{i==="true"&&this.DeleteListItem()})}DeleteListItem(){this.EditList.forEach(t=>{this._ChotkhoService.DeleteChotkho(t)}),this.EditList=[],this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}AddToEdit(t){this.EditList.find(i=>i.id===t.id)?this.EditList=this.EditList.filter(i=>i.id!==t.id):this.EditList.push(t)}CheckItemInEdit(t){return this.EditList.some(e=>e.id===t.id)}goToDetail(t){this.drawer.open(),this._ChotkhoService.setChotkhoId(t.id),this._router.navigate(["admin/chotkho",t.id])}trackByFn(t,e){return e.id}generateReport(){return h(this,null,function*(){if(yield this._ChotkhoService.getStatistics()){let e=yield this._ChotkhoService.generateReport({dateFrom:new Date(Date.now()-2592e6).toISOString(),dateTo:new Date().toISOString(),format:"json"});if(e){this._snackBar.open("B\xE1o c\xE1o \u0111\xE3 \u0111\u01B0\u1EE3c t\u1EA1o th\xE0nh c\xF4ng","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]});let i=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=window.URL.createObjectURL(i),l=document.createElement("a");l.href=n,l.download=`bao-cao-chot-kho-${new Date().toISOString().split("T")[0]}.json`,l.click(),window.URL.revokeObjectURL(n)}}})}bulkUpdateStatus(t){return h(this,null,function*(){if(this.EditList.length===0){this._snackBar.open("Vui l\xF2ng ch\u1ECDn \xEDt nh\u1EA5t m\u1ED9t m\u1EE5c","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}let e=this.EditList.map(n=>n.id);(yield this._ChotkhoService.bulkUpdateStatus(e,t))&&(this.EditList=[],this._snackBar.open(`C\u1EADp nh\u1EADt tr\u1EA1ng th\xE1i th\xE0nh c\xF4ng cho ${e.length} m\u1EE5c`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}))})}showStatistics(){return h(this,null,function*(){let t=yield this._ChotkhoService.getStatistics();if(t){let e=`
        T\u1ED5ng s\u1ED1: ${t.total}
        \u0110ang ho\u1EA1t \u0111\u1ED9ng: ${t.active}
        Kh\xF4ng ho\u1EA1t \u0111\u1ED9ng: ${t.inactive}
        Ch\xEAnh l\u1EC7ch trung b\xECnh: ${t.averageChenhLech?.toFixed(3)||0}
      `;this._snackBar.open(e,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-info"]})}})}advancedSearch(t){return h(this,null,function*(){this.searchParam=x(x({},this.searchParam),t),yield this._ChotkhoService.getAllChotkho(this.searchParam)})}refreshData(){return h(this,null,function*(){this.isSearch.set(!1),this.searchParam={},this.EditList=[],yield this._ChotkhoService.getAllChotkho(),this._snackBar.open("D\u1EEF li\u1EC7u \u0111\xE3 \u0111\u01B0\u1EE3c l\xE0m m\u1EDBi","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}smartRefresh(){return h(this,null,function*(){this.isSearch.set(!1),this.searchParam={},this.EditList=[];let t=this._snackBar.open("\u0110ang c\u1EADp nh\u1EADt d\u1EEF li\u1EC7u...","",{duration:0,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-info"]});try{yield this._ChotkhoService.getAllChotkho(),t.dismiss(),this._snackBar.open("D\u1EEF li\u1EC7u \u0111\xE3 \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{t.dismiss(),this._snackBar.open("L\u1ED7i c\u1EADp nh\u1EADt d\u1EEF li\u1EC7u","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}importExcel(t){return h(this,null,function*(){let e=t.target.files[0];if(!e)return;let i=this._snackBar.open("\u0110ang import d\u1EEF li\u1EC7u...","",{duration:0,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-info"]});try{let n=yield this._ChotkhoService.importFromExcel(e,{validateData:!0,skipDuplicates:!0});i.dismiss(),n&&this._snackBar.open(`Import th\xE0nh c\xF4ng ${n.successCount}/${n.totalCount} b\u1EA3n ghi`,"",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{i.dismiss(),this._snackBar.open("L\u1ED7i import file","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}t.target.value=""})}createBackup(t="full"){return h(this,null,function*(){let e=this._snackBar.open("\u0110ang t\u1EA1o backup...","",{duration:0,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-info"]});try{let i=yield this._ChotkhoService.backupData(t);e.dismiss(),i&&this._snackBar.open("Backup th\xE0nh c\xF4ng","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{e.dismiss(),this._snackBar.open("L\u1ED7i t\u1EA1o backup","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}optimizeSystem(){return h(this,null,function*(){let t=this._snackBar.open("\u0110ang t\u1ED1i \u01B0u h\xF3a h\u1EC7 th\u1ED1ng...","",{duration:0,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-info"]});try{let e=yield this._ChotkhoService.optimizePerformance();t.dismiss(),e&&this._snackBar.open("T\u1ED1i \u01B0u h\xF3a th\xE0nh c\xF4ng! C\u1EA3i thi\u1EC7n hi\u1EC7u su\u1EA5t","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{t.dismiss(),this._snackBar.open("L\u1ED7i t\u1ED1i \u01B0u h\xF3a","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}checkSystemHealth(){return h(this,null,function*(){try{let t=yield this._ChotkhoService.getSystemHealth();if(t){let e=`
\u{1F3E5} S\u1EE8C KH\u1ECEE H\u1EC6 TH\u1ED0NG:
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
\u{1F4BE} Database: ${t.database?.status||"OK"}
\u{1F504} API: ${t.api?.responseTime||"< 100"}ms
\u{1F4CA} Memory: ${t.memory?.usage||"< 80"}%
\u{1F50B} CPU: ${t.cpu?.usage||"< 60"}%
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
        `;this._snackBar.open(e,"\u0110\xF3ng",{duration:8e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-info"]})}}catch{this._snackBar.open("Kh\xF4ng th\u1EC3 ki\u1EC3m tra s\u1EE9c kh\u1ECFe h\u1EC7 th\u1ED1ng","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}downloadImportTemplate(t="standard"){return h(this,null,function*(){try{(yield this._ChotkhoService.generateImportTemplate(t))&&this._snackBar.open("\u0110\xE3 t\u1EA3i xu\u1ED1ng m\u1EABu import","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{this._snackBar.open("L\u1ED7i t\u1EA3i m\u1EABu import","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}exportAdvanced(t="excel"){return h(this,null,function*(){let e=this._snackBar.open(`\u0110ang export ${t.toUpperCase()}...`,"",{duration:0,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-info"]});try{let i=yield this._ChotkhoService.exportData(t,v(x({},this.searchParam),{selectedIds:this.EditList.map(n=>n.id),includeDetails:!0}));e.dismiss(),i&&this._snackBar.open(`Export ${t.toUpperCase()} th\xE0nh c\xF4ng`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}catch{e.dismiss(),this._snackBar.open(`L\u1ED7i export ${t.toUpperCase()}`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}smartCheckChenhLech(){return h(this,null,function*(){if(!this.validateBeforeAction(this.EditList,"ki\u1EC3m tra ch\xEAnh l\u1EC7ch"))return;let t=this._snackBar.open("\u0110ang ki\u1EC3m tra ch\xEAnh l\u1EC7ch...","",{duration:0,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-info"]});try{let e=[];for(let n of this.EditList){let l=yield this._ChotkhoService.smartCheckChenhLech(n.id);l&&e.push(l)}t.dismiss();let i=e.reduce((n,l)=>n+(l.chenhLech||0),0);this._snackBar.open(`Ki\u1EC3m tra ho\xE0n t\u1EA5t. T\u1ED5ng ch\xEAnh l\u1EC7ch: ${i}`,"",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:i===0?["snackbar-success"]:["snackbar-warning"]}),yield this.smartRefresh()}catch(e){t.dismiss(),this.handleOperationError("ki\u1EC3m tra ch\xEAnh l\u1EC7ch",e)}})}handleOperationError(t,e){console.error(`L\u1ED7i ${t}:`,e),this._snackBar.open(`C\xF3 l\u1ED7i x\u1EA3y ra khi ${t}`,"Th\u1EED l\u1EA1i",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}).onAction().subscribe(()=>{this.smartRefresh()})}validateBeforeAction(t,e){return t.length===0?(this._snackBar.open(`Vui l\xF2ng ch\u1ECDn \xEDt nh\u1EA5t m\u1ED9t m\u1EE5c \u0111\u1EC3 ${e}`,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]}),!1):!0}onPageSizeChange(t,e){let i=this.total(),n=t>i?i:t;t>i&&this._snackBar.open(`S\u1ED1 l\u01B0\u1EE3ng t\u1ED1i \u0111a ${i}`,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]}),this._ChotkhoService.pageSize.set(n),this._ChotkhoService.page.set(1),this._ChotkhoService.getAllChotkho(this.searchParam),e.closeMenu()}onPreviousPage(){return h(this,null,function*(){this.page()>1&&(this._ChotkhoService.page.set(this.page()-1),yield this._ChotkhoService.getAllChotkho(this.searchParam))})}onNextPage(){return h(this,null,function*(){this.page()<this.totalPages()&&(this._ChotkhoService.page.set(this.page()+1),yield this._ChotkhoService.getAllChotkho(this.searchParam))})}onFileSelected(t){let e=t.target.files[0];e&&(e.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||e.type==="application/vnd.ms-excel")?this.selectedFile=e:this._snackBar.open("Please select a valid Excel file (.xlsx or .xls)","Close",{duration:3e3})}onBackupFileSelected(t){let e=t.target.files[0];e&&e.name.endsWith(".backup")?this.selectedBackupFile=e:this._snackBar.open("Please select a valid backup file (.backup)","Close",{duration:3e3})}startImport(){return h(this,null,function*(){if(!this.selectedFile)return;this.importProgress=0;let t=setInterval(()=>{this.importProgress+=5,this.importProgress>=95&&clearInterval(t)},100);try{yield this._ChotkhoService.importFromExcel(this.selectedFile,{}),this.importProgress=100,setTimeout(()=>{this.importProgress=0,this.selectedFile=null,this._dialog.closeAll()},500)}catch(e){clearInterval(t),this.importProgress=0,this.handleOperationError("Import failed",e)}})}startExport(){return h(this,null,function*(){this.exportProgress=0;let t=setInterval(()=>{this.exportProgress+=8,this.exportProgress>=95&&clearInterval(t)},150);try{yield this.exportExcel(),this.exportProgress=100,setTimeout(()=>{this.exportProgress=0,this._dialog.closeAll()},500)}catch(e){clearInterval(t),this.exportProgress=0,this.handleOperationError("Export failed",e)}})}startBackup(){return h(this,null,function*(){if(!this.backupName){this._snackBar.open("Please enter a backup name","Close",{duration:3e3});return}this.backupProgress=0;let t=setInterval(()=>{this.backupProgress+=6,this.backupProgress>=95&&clearInterval(t)},200);try{yield this._ChotkhoService.backupData(this.backupType),this.backupProgress=100,setTimeout(()=>{this.backupProgress=0,this.backupName="",this._dialog.closeAll()},500)}catch(e){clearInterval(t),this.backupProgress=0,this.handleOperationError("Backup failed",e)}})}startRestore(){return h(this,null,function*(){if(!this.selectedBackupFile){this._snackBar.open("Please select a backup file","Close",{duration:3e3});return}this.backupProgress=0;let t=setInterval(()=>{this.backupProgress+=7,this.backupProgress>=95&&clearInterval(t)},180);try{yield this._ChotkhoService.restoreFromBackup(this.selectedBackupFile),this.backupProgress=100,setTimeout(()=>{this.backupProgress=0,this.selectedBackupFile=null,this._dialog.closeAll()},500)}catch(e){clearInterval(t),this.backupProgress=0,this.handleOperationError("Restore failed",e)}})}exportExcel(){return h(this,null,function*(){try{let t=[];switch(this.exportType){case"all":t=this.Listchotkho();break;case"filtered":t=this.dataSource.filteredData;break;case"selected":t=this.EditList;break;default:t=this.Listchotkho()}yield this._ChotkhoService.exportData("excel",{data:t}),this._snackBar.open("Export completed successfully","Close",{duration:3e3})}catch(t){this.handleOperationError("Export failed",t)}})}clearAllCacheMethod(){return h(this,null,function*(){try{if("caches"in window){let e=yield caches.keys();yield Promise.all(e.map(i=>caches.delete(i)))}Object.keys(localStorage).forEach(e=>{(e.includes("chotkho")||e.includes("Chotkho"))&&localStorage.removeItem(e)}),yield this.smartRefresh(),this._snackBar.open("Cache cleared successfully","Close",{duration:3e3})}catch(t){this.handleOperationError("Clear cache failed",t)}})}importFromExcel(){let t=document.createElement("input");t.type="file",t.accept=".xlsx,.xls",t.onchange=e=>this.importExcel(e),t.click()}exportToExcel(){this.exportAdvanced("excel")}restoreFromBackup(){this.isRestoreMode=!0;let t=document.createElement("input");t.type="file",t.accept=".backup",t.onchange=e=>{this.onBackupFileSelected(e),this.selectedBackupFile&&this.startRestore()},t.click()}clearAllCache(){this.clearAllCacheMethod()}static \u0275fac=function(e){return new(e||P)};static \u0275cmp=J({type:P,selectors:[["app-listchotkho"]],viewQuery:function(e,i){if(e&1&&(F(We,5),F($,5),F(kt,7)),e&2){let n;B(n=V())&&(i.paginator=n.first),B(n=V())&&(i.sort=n.first),B(n=V())&&(i.drawer=n.first)}},decls:127,vars:20,consts:[["drawer",""],["advancedMenu","matMenu"],["menuHienthi","matMenuTrigger"],["menu1","matMenu"],["DeleteDialog",""],["ImportDialog",""],["ExportDialog",""],["BackupDialog",""],["HealthDialog",""],["menu","matMenu"],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","lg:!w-2/3","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-16","w-full","p-2"],[1,"p-2","cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","bg-white","rounded-lg"],[1,"w-full","flex","flex-col","gap-2","lg:flex-row","lg:items-center","lg:justify-between"],[1,"flex","flex-row","space-x-2","items-center"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],["color","primary","matTooltip","Th\xEAm m\u1EDBi","mat-flat-button","",1,"flex","flex-row","items-center",3,"click"],[1,"whitespace-nowrap"],["class","flex flex-row items-center","color","warn","matTooltip","Xo\xE1","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","matTooltip","Smart Refresh","mat-flat-button","",1,"flex","flex-row","items-center",3,"click","disabled"],["mat-flat-button","","color","primary",3,"matMenuTriggerFor"],[1,"p-2","border-b"],[1,"text-sm","font-semibold","text-gray-600","mb-2"],["mat-menu-item","",3,"click"],[1,"p-2"],[1,"w-full","flex","flex-row","space-x-4","justify-end","items-center"],[1,"flex","items-center","text-center"],[1,"flex","items-center","justify-center"],[1,"flex","flex-row","space-x-2","justify-center","items-center"],[1,"font-bold","text-blue-600",3,"matMenuTriggerFor"],[1,"w-full","flex","flex-row","space-x-2","p-4",3,"click"],["appearance","outline","subscriptSizing","dynamic"],["matInput","","placeholder","Vui l\xF2ng Nh\u1EADp S\u1ED1 L\u01B0\u1EE3ng",3,"ngModelChange","ngModel","ngModelOptions"],["mat-icon-button","","color","primary",3,"click"],[1,"flex","flex-row","items-center"],["mat-icon-button","","color","primary",3,"click","disabled"],[1,"w-full","h-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","border","mat-row","",3,"class",4,"matRowDef","matRowDefColumns"],["class","mat-row border",4,"matNoDataRow"],["color","warn","matTooltip","Xo\xE1","mat-flat-button","",1,"flex","flex-row","items-center",3,"click"],["mat-header-cell","",1,"flex","!border","!bg-slate-100","justify-center"],["mat-header-cell","","mat-sort-header","",1,"!border","whitespace-nowrap","!bg-slate-100"],["class","border","mat-cell","",4,"matCellDef"],["class","flex !border !bg-slate-100 justify-center","mat-header-cell","",4,"matHeaderCellDef"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary",3,"matMenuTriggerFor"],[1,"flex","flex-row","space-x-2","items-center","p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item","",3,"disabled"],["mat-menu-item",""],["mat-menu-item","",3,"click","disabled"],["class","!border whitespace-nowrap !bg-slate-100","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],[1,"max-w-40","line-clamp-4","me-4"],[3,"OutFilter","icon","ListItem","fieldsearch","ListFilter","filterItem"],["mat-cell","",1,"border"],[1,"max-w-40","line-clamp-4","font-bold","text-blue-600"],[1,"flex","justify-center","items-center","font-bold","text-blue-600"],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","font-bold","text-blue-600",3,"click"],[1,"flex","justify-center","items-center","font-bold","text-blue-600",3,"click"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",1,"border"],[1,"mat-row","border"],["colspan","4",1,"mat-cell","p-4"],[1,"flex","flex-col","space-y-8","items-center","justify-center"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary","mat-dialog-close","true"],["mat-flat-button","","color","warn","mat-dialog-close","false"],[1,"flex","flex-col","space-y-4","min-w-80"],[1,"font-bold","text-center"],[1,"flex","flex-col","space-y-2"],["type","file","accept",".xlsx,.xls",1,"block","w-full","text-sm","text-gray-500","file:mr-4","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-blue-50","file:text-blue-700","hover:file:bg-blue-100",3,"change"],["class","flex flex-col space-y-2",4,"ngIf"],[1,"flex","flex-row","space-x-2","justify-center"],["mat-flat-button","","color","primary",3,"click","disabled"],["mat-flat-button","","color","warn","mat-dialog-close",""],["mode","determinate",3,"value"],[1,"text-sm","text-center"],["appearance","outline"],[3,"valueChange","value"],["value","all"],["value","filtered"],["value","selected"],["value","full"],["value","incremental"],["matInput","","placeholder","Enter backup name",3,"ngModelChange","ngModel"],["type","file","accept",".backup",1,"block","w-full","text-sm","text-gray-500","file:mr-4","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-green-50","file:text-green-700","hover:file:bg-green-100",3,"change"],[1,"flex","flex-col","space-y-4","min-w-96"],["class","flex flex-col space-y-3",4,"ngIf"],["mat-flat-button","","color","primary",3,"click"],[1,"flex","flex-col","space-y-3"],[1,"flex","justify-between","items-center","p-2","rounded",3,"ngClass"],[1,"font-medium"],[1,"flex","items-center","space-x-2"],[3,"ngClass"],[1,"text-sm"],[1,"flex","justify-between","items-center","p-2","rounded","bg-blue-50"]],template:function(e,i){if(e&1){let n=y();r(0,"mat-drawer-container",10)(1,"mat-drawer",11,0),b(3,"router-outlet"),o(),r(4,"div",12)(5,"div",13)(6,"div",14)(7,"div",15)(8,"div",16)(9,"input",17),g("keyup",function(f){return m(n),d(i.applyFilter(f))}),o(),r(10,"div",18)(11,"span",19),s(12,"search"),o()()(),r(13,"button",20),g("click",function(){return m(n),d(i.create())}),r(14,"mat-icon"),s(15,"add_circle"),o(),r(16,"span",21),s(17,"T\u1EA1o M\u1EDBi"),o()(),C(18,yt,5,0,"button",22),r(19,"button",23),g("click",function(){return m(n),d(i.smartRefresh())}),r(20,"mat-icon"),s(21,"refresh"),o(),r(22,"span",21),s(23,"Refresh"),o()()(),r(24,"div",15)(25,"button",24)(26,"mat-icon"),s(27,"more_vert"),o(),r(28,"span"),s(29,"Advanced"),o()(),r(30,"mat-menu",null,1)(32,"div",25)(33,"div",26),s(34,"Import/Export"),o(),r(35,"button",27),g("click",function(){return m(n),d(i.importFromExcel())}),r(36,"mat-icon"),s(37,"file_upload"),o(),r(38,"span"),s(39,"Import Excel"),o()(),r(40,"button",27),g("click",function(){return m(n),d(i.exportToExcel())}),r(41,"mat-icon"),s(42,"file_download"),o(),r(43,"span"),s(44,"Export Excel"),o()()(),r(45,"div",25)(46,"div",26),s(47,"Backup/Restore"),o(),r(48,"button",27),g("click",function(){return m(n),d(i.createBackup())}),r(49,"mat-icon"),s(50,"backup"),o(),r(51,"span"),s(52,"Create Backup"),o()(),r(53,"button",27),g("click",function(){return m(n),d(i.restoreFromBackup())}),r(54,"mat-icon"),s(55,"restore"),o(),r(56,"span"),s(57,"Restore Data"),o()()(),r(58,"div",28)(59,"div",26),s(60,"System Tools"),o(),r(61,"button",27),g("click",function(){return m(n),d(i.optimizeSystem())}),r(62,"mat-icon"),s(63,"tune"),o(),r(64,"span"),s(65,"Optimize System"),o()(),r(66,"button",27),g("click",function(){return m(n),d(i.checkSystemHealth())}),r(67,"mat-icon"),s(68,"health_and_safety"),o(),r(69,"span"),s(70,"Health Check"),o()(),r(71,"button",27),g("click",function(){return m(n),d(i.clearAllCache())}),r(72,"mat-icon"),s(73,"clear_all"),o(),r(74,"span"),s(75,"Clear Cache"),o()()()()()(),r(76,"div",29)(77,"div",30)(78,"strong"),s(79),o(),s(80," - "),r(81,"strong"),s(82),o(),s(83),o(),r(84,"div",31)(85,"span"),s(86),o(),r(87,"span"),s(88,"Trang"),o()(),r(89,"div",32)(90,"span",33,2),s(92),o(),r(93,"mat-menu",null,3)(95,"div",34),g("click",function(f){return m(n),d(f.stopPropagation())}),r(96,"mat-form-field",35)(97,"mat-label"),s(98,"S\u1ED1 l\u01B0\u1EE3ng"),o(),r(99,"input",36),T("ngModelChange",function(f){return m(n),I(i.pageSize,f)||(i.pageSize=f),d(f)}),o()(),r(100,"button",37),g("click",function(){m(n);let f=L(91);return d(i.onPageSizeChange(i.pageSize(),f))}),r(101,"mat-icon"),s(102,"published_with_changes"),o()()()(),r(103,"div",38)(104,"button",39),g("click",function(){return m(n),d(i.onPreviousPage())}),r(105,"mat-icon"),s(106,"keyboard_arrow_left"),o()(),r(107,"button",39),g("click",function(){return m(n),d(i.onNextPage())}),r(108,"mat-icon"),s(109,"keyboard_arrow_right"),o()()()()()(),r(110,"div",40)(111,"table",41),O(112,$t,4,2,"ng-container",42,Z),C(114,zt,1,0,"tr",43)(115,Nt,1,3,"tr",44)(116,qt,3,0,"tr",45),o()()()(),C(117,Ot,11,0,"ng-template",null,4,M)(119,jt,12,2,"ng-template",null,5,M)(121,Wt,21,3,"ng-template",null,6,M)(123,Gt,12,6,"ng-template",null,7,M)(125,Yt,10,1,"ng-template",null,8,M)}if(e&2){let n=L(31),l=L(94);c(),p("position","end"),c(17),p("ngIf",i.EditList.length>0),c(),p("disabled",i.isRefreshing),c(6),p("matMenuTriggerFor",n),c(54),S((i.page()-1)*i.pageSize()+1),c(3),S(i.page()*i.pageSize()>i.total()?i.total():i.page()*i.pageSize()),c(),k(" / ",i.total()," m\u1EE5c "),c(3),ie("",i.page(),"/",i.totalPages()," "),c(4),p("matMenuTriggerFor",l),c(2),k("",i.pageSize()," m\u1EE5c"),c(7),D("ngModel",i.pageSize),p("ngModelOptions",ne(19,_t)),c(5),p("disabled",i.page()===1),c(3),p("disabled",i.page()===i.totalPages()),c(4),p("dataSource",i.dataSource),c(),H(i.displayedColumns),c(2),p("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),c(),p("matRowDefColumns",i.displayedColumns)}},dependencies:[ze,$e,Re,Ae,qe,Ne,st,Ge,Ye,it,Ze,Je,nt,et,tt,rt,ot,at,Xe,$,Qe,Ke,Le,be,Se,Ee,xe,Ce,ye,he,ve,we,ke,ge,fe,He,Oe,pe,le,oe,ae,se,Ie,Me,Pe,De,Ue,je,Ve,Fe,Be,lt,ut,pt,dt],encapsulation:2,changeDetection:0})};q([ht(500)],P.prototype,"applyFilter",1),q([ct()],P.prototype,"FilterHederColumn",1);var gt=P;export{z as a,gt as b};
