import './polyfills.server.mjs';
import{a as Ue}from"./chunk-D7WJSQAB.mjs";import{a as Xe}from"./chunk-BGLO2JAG.mjs";import{a as D,b as qe}from"./chunk-RHSABDND.mjs";import{a as I,b as Ge,c as Je}from"./chunk-COSQG4OV.mjs";import{b as je,f as We}from"./chunk-POE2MFM3.mjs";import{d as Te,e as be}from"./chunk-4AA42E7K.mjs";import{a as se,b as me,c as ue}from"./chunk-2WVZEUAT.mjs";import{a as he,b as de,c as _e,d as fe}from"./chunk-WRSBCCBG.mjs";import{b as ee,d as te}from"./chunk-OSDT3VMP.mjs";import{a as Fe,b as Le,c as De,e as Ie,f as Ve,h as Ne,i as Ae,k as Be,l as $e,n as Oe,o as Re,p as He,q as ze}from"./chunk-KKZPVVZF.mjs";import{a as Qe,b as Ke}from"./chunk-JPZMWWYO.mjs";import{b as Me}from"./chunk-SNL6NQRQ.mjs";import{b as Pe,c as Ee}from"./chunk-HXEL4YEF.mjs";import{B as Se,C as ve,b as Ce,g as ge,j as xe,s as ke,u as ye,x as we}from"./chunk-67NKMS7C.mjs";import{a as ce,b as pe}from"./chunk-RSHWTPDD.mjs";import{a as le}from"./chunk-AKVYLSG6.mjs";import{a as oe,c as ae,e as re}from"./chunk-LQWFEOWT.mjs";import{y as ie,z as ne}from"./chunk-YS2PDZ6Q.mjs";import{n as X,o as U,u as Y,z as Z}from"./chunk-EYW3XZCQ.mjs";import{$b as R,Ac as E,Bc as M,Cc as T,Fb as O,Fc as B,Gc as l,Hc as b,Ic as C,Lc as G,Mb as x,Mc as J,Nc as j,Pc as $,Vc as F,Xc as L,Yb as f,ac as H,cc as v,ec as z,fc as N,gc as A,hc as o,ic as a,jc as P,kc as Q,lc as K,nc as S,pa as w,sc as _,tb as s,uc as m,wd as W,ya as h,yc as q,za as d}from"./chunk-LL6B6DB7.mjs";import{a as V,j as g}from"./chunk-RIAI3ORJ.mjs";var it=["drawer"],nt=()=>[10,25,100],ot=()=>({standalone:!0}),at=(n,t)=>t.key;function rt(n,t){if(n&1){let e=S();o(0,"button",33),_("click",function(r){let u=h(e).$implicit;return m().toggleColumn(u),d(r.stopPropagation())}),o(1,"mat-icon"),l(2),a(),o(3,"span"),l(4),a()()}if(n&2){let e=t.$implicit;s(2),b(e.isShow?"check_box":"check_box_outline_blank"),s(2),b(e.value)}}function lt(n,t){if(n&1){let e=S();o(0,"mat-form-field",36)(1,"mat-label"),l(2),a(),o(3,"input",37),_("keyup",function(){h(e);let r=m(2);return d(r.applyFilter())}),j("ngModelChange",function(r){let u=h(e).$implicit,p=m(2);return J(p.filterValues[u],r)||(p.filterValues[u]=r),d(r)}),a()()}if(n&2){let e=t.$implicit,i=m(2);s(2),b(i.ColumnName[e]),s(),q("placeholder","Vui l\xF2ng Nh\u1EADp ",e,""),G("ngModel",i.filterValues[e]),f("ngModelOptions",$(5,ot))}}function st(n,t){if(n&1&&(o(0,"div",34),x(1,lt,4,6,"mat-form-field",35),a()),n&2){let e=m();s(),f("ngForOf",e.displayedColumns)}}function mt(n,t){if(n&1){let e=S();o(0,"div",26)(1,"mat-icon",38),l(2,"search"),a(),o(3,"h3",39),l(4,"Ch\u01B0a c\xF3 d\u1EEF li\u1EC7u"),a(),o(5,"p",40),l(6," Vui l\xF2ng nh\u1EA5n n\xFAt "),o(7,"strong",41),l(8,"T\xECm Ki\u1EBFm"),a(),l(9," \u0111\u1EC3 t\u1EA3i d\u1EEF li\u1EC7u phi\u1EBFu kho "),a(),o(10,"button",42),_("click",function(){h(e);let r=m();return d(r.searchData())}),o(11,"mat-icon"),l(12,"search"),a(),o(13,"span",43),l(14,"T\xECm Ki\u1EBFm Ngay"),a()()()}}function ut(n,t){if(n&1&&(o(0,"th",46)(1,"span",47),l(2),a()()),n&2){let e=m().$implicit,i=m();s(2),C(" ",i.ColumnName[e]," ")}}function ct(n,t){if(n&1&&(o(0,"span",49),l(1),a()),n&2){let e=m().index;s(),C(" ",e+1," ")}}function pt(n,t){if(n&1&&(o(0,"span",49),l(1),a()),n&2){let e,i=m().$implicit,r=m().$implicit,u=m();s(),C(" ",(e=u.getName(i[r]))==null?null:e.title," ")}}function ht(n,t){if(n&1&&(o(0,"span",49),l(1),a()),n&2){let e=m().$implicit,i=m().$implicit;s(),C(" ",e[i]==null?null:e[i].name," ")}}function dt(n,t){if(n&1&&(o(0,"span",49),l(1),F(2,"date"),a()),n&2){let e=m().$implicit,i=m().$implicit;s(),C(" ",L(2,1,e[i],"dd/MM/yyyy")," ")}}function _t(n,t){if(n&1&&(o(0,"span",50),l(1),F(2,"date"),a()),n&2){let e=m().$implicit,i=m().$implicit;s(),C(" ",L(2,1,e[i],"HH:mm:ss dd/MM/yyyy")," ")}}function ft(n,t){n&1&&(o(0,"mat-icon",51),l(1,"check_circle"),a())}function Ct(n,t){n&1&&(o(0,"mat-icon",52),l(1,"cancel"),a())}function gt(n,t){if(n&1&&(o(0,"span",49),x(1,ft,2,0,"mat-icon",51)(2,Ct,2,0,"mat-icon",52),a()),n&2){let e=m().$implicit,i=m().$implicit;s(),v(e[i]?1:2)}}function xt(n,t){if(n&1&&(o(0,"span",50),l(1),F(2,"date"),a()),n&2){let e=m().$implicit,i=m().$implicit;s(),C(" ",L(2,1,e[i],"HH:mm:ss dd/MM/yyyy")," ")}}function kt(n,t){if(n&1&&(o(0,"span",49),l(1),a()),n&2){let e=m().$implicit,i=m().$implicit;s(),C(" ",e[i]," ")}}function yt(n,t){if(n&1&&(o(0,"td",48),x(1,ct,2,1,"span",49)(2,pt,2,1,"span",49)(3,ht,2,1,"span",49)(4,dt,3,4,"span",49)(5,_t,3,4,"span",50)(6,gt,3,1,"span",49)(7,xt,3,4,"span",50)(8,kt,2,1,"span",49),a()),n&2){let e,i=m().$implicit;s(),v((e=i)==="STT"?1:e==="type"?2:e==="kho"?3:e==="ngay"?4:e==="createdAt"?5:e==="isActive"?6:e==="updatedAt"?7:8)}}function wt(n,t){if(n&1&&(Q(0,28),x(1,ut,3,1,"th",44)(2,yt,9,1,"td",45),K()),n&2){let e=t.$implicit;f("matColumnDef",e)}}function St(n,t){n&1&&P(0,"tr",53)}function vt(n,t){if(n&1){let e=S();o(0,"tr",54),_("click",function(){let r=h(e).$implicit,u=m();return d(u.goToDetail(r))}),a()}if(n&2){let e=t.$implicit,i=m();H("hover:bg-slate-100 ",i.phieukhoId()==e.id?"!bg-slate-200":"","")}}function Pt(n,t){n&1&&(o(0,"tr",55)(1,"td",56),l(2,"Kh\xF4ng t\xECm th\u1EA5y"),a()())}var Ye=class n{Detail={};displayedColumns=["STT","maphieu","ngay","type","kho","ghichu","isActive","createdAt","updatedAt"];ColumnName={STT:"STT",maphieu:"M\xE3 Phi\u1EBFu",ngay:"Ng\xE0y",type:"Lo\u1EA1i Phi\u1EBFu",kho:"Kho",ghichu:"Ghi Ch\xFA",isActive:"Tr\u1EA1ng Th\xE1i",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("PhieukhoColFilter")||"[]");Columns=[];LoaiPhieu=[{title:"Phi\u1EBFu Nh\u1EADp",value:"nhap"},{title:"Phi\u1EBFu Xu\u1EA5t",value:"xuat"},{title:"Chuy\u1EC3n Kho",value:"chuyenkho"},{title:"\u0110i\u1EC1u Ch\u1EC9nh",value:"dieuchinh"}];isFilter=!1;paginator;sort;drawer;filterValues={};_PhieukhoService=w(Ue);_breakpointObserver=w(ie);_GoogleSheetService=w(Xe);_router=w(te);Listphieukho=this._PhieukhoService.ListPhieukho;dataSource=W(()=>{let t=new ze(this.Listphieukho());return t.filterPredicate=this.createFilter(),t.paginator=this.paginator,t.sort=this.sort,t});phieukhoId=this._PhieukhoService.phieukhoId;_snackBar=w(le);CountItem=0;constructor(){this.displayedColumns.forEach(t=>{this.filterValues[t]=""})}createFilter(){return(t,e)=>{let i=JSON.parse(e),r=!0;return this.displayedColumns.forEach(u=>{if(i[u]){let p=t[u]?t[u].toString().toLowerCase():"";r=r&&p.includes(i[u].toLowerCase())}}),r}}applyFilter(){this.dataSource().filter=JSON.stringify(this.filterValues)}searchData(){return g(this,null,function*(){yield this.loadData()})}ngOnInit(){return g(this,null,function*(){this.initializeColumns(),this.setupDrawer(),this.paginator&&(this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i")})}loadData(){return g(this,null,function*(){yield this._PhieukhoService.getAllPhieukho(),this.CountItem=this.Listphieukho().length})}refresh(){return g(this,null,function*(){yield this._PhieukhoService.getAllPhieukho()})}getName(t){return this.LoaiPhieu.find(e=>e.value===t)}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(t=>({key:t,value:this.ColumnName[t],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("PhieukhoColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(t=>t.isShow).map(t=>t.key),this.ColumnName=this.FilterColumns.reduce((t,e)=>(e.isShow&&(t[e.key]=e.value),t),{})}setupDrawer(){this._breakpointObserver.observe([ne.Handset]).subscribe(t=>{t.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}toggleColumn(t){let e=this.FilterColumns.find(i=>i.key===t.key);e&&(e.isShow=!e.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(t=>t.isShow).map(t=>t.key),this.ColumnName=this.FilterColumns.reduce((t,e)=>(e.isShow&&(t[e.key]=e.value),t),{}),localStorage.setItem("PhieukhoColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(t){let e=t.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(i=>i.value.toLowerCase().includes(e))}create(){this.drawer.open(),this._router.navigate(["admin/phieukho",0])}goToDetail(t){this._PhieukhoService.setPhieukhoId(t.id),this.drawer.open(),this._router.navigate(["admin/phieukho",t.id])}LoadData(){return g(this,null,function*(){try{yield this.refresh(),this.CountItem=this.Listphieukho().length,this._snackBar.open("\u0110\xE3 t\u1EA3i d\u1EEF li\u1EC7u th\xE0nh c\xF4ng!","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}catch(t){console.error("Error loading data:",t),this._snackBar.open("C\xF3 l\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u!","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}DoImportData(t){console.log(t);let i=t.map(c=>({title:c.title?.trim()||"",masp:c.masp?.trim()||"",slug:`${Te(c?.title?.trim()||"")}_${be(5,!1)}`,giagoc:Number(c.giagoc)||0,dvt:c.dvt||"",soluong:Number(c.soluong)||0,soluongkho:Number(c.soluongkho)||0,ghichu:c.ghichu||"",order:Number(c.order)||0})).filter((c,k,y)=>k===y.findIndex(tt=>tt.masp===c.masp)),r=i.map(c=>c.masp),u=this._PhieukhoService.ListPhieukho().map(c=>c.masp),p=r.filter(c=>!u.includes(c)),Ze=i.map(c=>g(this,null,function*(){let k=this._PhieukhoService.ListPhieukho().find(y=>y.masp===c.masp);if(k){let y=V(V({},k),c);yield this._PhieukhoService.updatePhieukho(y)}else yield this._PhieukhoService.CreatePhieukho(c)})),et=p.map(c=>g(this,null,function*(){let k=this._PhieukhoService.ListPhieukho().find(y=>y.masp===c);k.isActive=!1,yield this._PhieukhoService.updatePhieukho(k)}));Promise.all([...Ze,...et]).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ImporExcel(t){return g(this,null,function*(){let e=yield We(t);this.DoImportData(e)})}ExportExcel(t,e){je(t,e)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=O({type:n,selectors:[["app-listphieukho"]],viewQuery:function(e,i){if(e&1&&(E(D,5),E(I,5),E(it,7)),e&2){let r;M(r=T())&&(i.paginator=r.first),M(r=T())&&(i.sort=r.first),M(r=T())&&(i.drawer=r.first)}},decls:54,vars:13,consts:[["drawer",""],["menu","matMenu"],["uploadfile",""],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[1,"cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","p-2","bg-white","rounded-lg"],[1,"flex","flex-row","space-x-2","items-center"],["matTooltip","Th\xEAm m\u1EDBi","mat-flat-button","",1,"flex","flex-row","items-center","btn-primary",3,"click"],[1,"whitespace-nowrap"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","B\u1ED9 L\u1ECDc","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i l\xEAn file excel","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],["matTooltip","T\u1EA3i d\u1EEF li\u1EC7u t\u1EEB drive","color","primary","mat-icon-button","",3,"click"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],["mat-icon-button","","color","primary","matTooltip","Nh\u1EA5n \u0111\u1EC3 t\u1EA3i d\u1EEF li\u1EC7u phi\u1EBFu kho",1,"!h-10",3,"click"],["class","w-full grid grid-cols-2 gap-2 lg:flex lg:flex-row lg:space-x-2 items-center",4,"ngIf"],[1,"w-full","overflow-auto","relative"],[1,"flex","flex-col","items-center","justify-center","p-12","bg-gray-50","rounded-lg"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"class","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],[1,"w-full","grid","grid-cols-2","gap-2","lg:flex","lg:flex-row","lg:space-x-2","items-center"],["appearance","outline","subscriptSizing","dynamic",4,"ngFor","ngForOf"],["appearance","outline","subscriptSizing","dynamic"],["matInput","",3,"keyup","ngModelChange","ngModel","ngModelOptions","placeholder"],[1,"!text-6xl","!w-24","!h-24","text-gray-400","mb-4"],[1,"text-xl","font-semibold","text-gray-700","mb-2"],[1,"text-gray-500","text-center","mb-4"],[1,"text-blue-600"],["mat-flat-button","","color","primary",3,"click"],[1,"ml-2"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","text-xs"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(e,i){if(e&1){let r=S();o(0,"mat-drawer-container",3)(1,"mat-drawer",4,0),P(3,"router-outlet"),a(),o(4,"div",5)(5,"div",6)(6,"div",7)(7,"button",8),_("click",function(){return h(r),d(i.create())}),o(8,"mat-icon"),l(9,"add_circle"),a(),o(10,"span",9),l(11,"T\u1EA1o M\u1EDBi"),a()(),o(12,"button",10)(13,"mat-icon"),l(14,"tune"),a()(),o(15,"mat-menu",null,1)(17,"div",11)(18,"mat-form-field",12)(19,"input",13),_("input",function(p){return h(r),d(i.doFilterColumns(p))})("click",function(p){return h(r),d(p.stopPropagation())}),a(),o(20,"mat-icon",14),l(21,"search"),a()()(),o(22,"div",15),N(23,rt,5,2,"button",16,at),a()(),o(25,"button",17),_("click",function(){return h(r),d(i.isFilter=!i.isFilter)}),o(26,"mat-icon"),l(27,"filter_list"),a()(),o(28,"button",18),_("click",function(){return h(r),d(i.ExportExcel(i.Listphieukho(),"Phieukho"))}),o(29,"mat-icon"),l(30,"file_download"),a()(),o(31,"button",19),_("click",function(){h(r);let p=B(35);return d(p.click())}),o(32,"mat-icon"),l(33,"file_upload"),a()(),o(34,"input",20,2),_("change",function(p){return h(r),d(i.ImporExcel(p))}),a(),o(36,"button",21),_("click",function(){return h(r),d(i.LoadData())}),o(37,"mat-icon"),l(38,"cloud_download"),a()(),o(39,"span",22),l(40),a(),o(41,"button",23),_("click",function(){return h(r),d(i.searchData())}),o(42,"mat-icon"),l(43,"search"),a()()()(),x(44,st,2,1,"div",24),o(45,"div",25),x(46,mt,15,0,"div",26),o(47,"table",27),N(48,wt,3,1,"ng-container",28,z),x(50,St,1,0,"tr",29)(51,vt,1,3,"tr",30)(52,Pt,3,0,"tr",31),a()(),P(53,"mat-paginator",32),a()()}if(e&2){let r=B(16);s(),f("position","end"),s(11),f("matMenuTriggerFor",r),s(11),A(i.FilterColumns),s(2),R(i.isFilter?"!bg-slate-200":""),s(15),C(" ",i.CountItem," S\u1EA3n Ph\u1EA9m "),s(4),f("ngIf",i.isFilter),s(2),v(i.Listphieukho().length===0?46:-1),s(),f("dataSource",i.dataSource()),s(),A(i.displayedColumns),s(2),f("matHeaderRowDef",i.displayedColumns),s(),f("matRowDefColumns",i.displayedColumns),s(2),f("pageSizeOptions",$(12,nt))}},dependencies:[ve,Se,ye,we,Ee,Pe,He,Fe,De,Ae,Ie,Le,Be,Ve,Ne,$e,Oe,Re,Je,I,Ge,qe,D,fe,de,he,_e,ue,se,me,ee,pe,ce,re,oe,ae,Me,Z,X,U,Y,ke,Ce,ge,xe,Ke,Qe],encapsulation:2})};export{Ye as a};
