import './polyfills.server.mjs';
import{a as de}from"./chunk-H6HTOIWP.mjs";import{d as W,e as L,h as N}from"./chunk-BH2HSQOL.mjs";import{a as pe,b as se}from"./chunk-A5DTS3DX.mjs";import"./chunk-5Z34U3BE.mjs";import"./chunk-TCSF6YHO.mjs";import{a as oe,b as ae}from"./chunk-Z5HBVRZE.mjs";import{b as ne,c as re}from"./chunk-UYCQ6AC2.mjs";import{B as te,C as ie,b as U,g as O,h as J,i as Q,j as X,k as Y,p as Z,s as $,u as ee}from"./chunk-PZLAASAT.mjs";import"./chunk-XICIHPPV.mjs";import{a as le,c as me,g as ue}from"./chunk-OAFQWT62.mjs";import{a as H,b as K}from"./chunk-XDVOMTEU.mjs";import{a as z,b as G}from"./chunk-3KXFP7XD.mjs";import"./chunk-WUYXYVVH.mjs";import"./chunk-FTH7NJLF.mjs";import{a as R,c as j,e as q}from"./chunk-VNDW64SF.mjs";import{la as P}from"./chunk-DY3FLVM4.mjs";import"./chunk-7T6LZHUD.mjs";import"./chunk-X2AKCL2B.mjs";import{z as D}from"./chunk-DDYTIRWA.mjs";import{Fb as w,Fc as V,Gc as o,Hc as x,Ic as T,Lc as C,Mb as M,Mc as S,Nc as _,Pc as y,Ra as h,Yb as g,cc as v,dc as k,fc as B,gc as A,hc as e,ic as t,jc as I,nc as b,sc as c,tb as l,uc as E,ya as p,yb as f,za as s}from"./chunk-J2JCPQ23.mjs";import"./chunk-XAZRL6IZ.mjs";import{j as F}from"./chunk-RIAI3ORJ.mjs";var ce=()=>["/admin/support"];function ge(m,r){if(m&1){let i=b();e(0,"div",24)(1,"div",25)(2,"mat-icon"),o(3),t(),e(4,"span",26),o(5),t(),e(6,"span",27),o(7),t()(),e(8,"button",28),c("click",function(){let u=p(i).$index,d=E(2);return s(d.removeFile(u))}),e(9,"mat-icon"),o(10,"close"),t()()()}if(m&2){let i=r.$implicit,n=E(2);l(3),x(n.getFileIcon(i.type)),l(2),x(i.name),l(2),T("(",n.formatFileSize(i.size),")")}}function Ee(m,r){if(m&1&&(e(0,"div",19),B(1,ge,11,3,"div",24,k),t()),m&2){let i=E();l(),A(i.selectedFiles())}}function Ce(m,r){m&1&&I(0,"mat-spinner",22)}function Se(m,r){m&1&&(e(0,"mat-icon"),o(1,"send"),t())}var fe=class m{constructor(r,i,n){this.supportService=r;this.router=i;this.snackBar=n}title="";description="";priority="medium";selectedFiles=h([]);loading=h(!1);onFileSelected(r){let i=Array.from(r.target.files);this.selectedFiles.set([...this.selectedFiles(),...i])}removeFile(r){let i=this.selectedFiles();i.splice(r,1),this.selectedFiles.set([...i])}onSubmit(r){return F(this,null,function*(){r.preventDefault(),this.loading.set(!0);try{let i=[];this.selectedFiles().length>0&&(i=(yield this.supportService.uploadFiles(this.selectedFiles()).toPromise())?.map(u=>u.fileUrl)||[]),yield this.supportService.createTicket({title:this.title,description:this.description,priority:this.priority,attachmentUrls:i}).toPromise(),this.snackBar.open("\u0110\xE3 t\u1EA1o v\u1EA5n \u0111\u1EC1 th\xE0nh c\xF4ng!","\u0110\xF3ng",{duration:3e3,panelClass:["snackbar-success"]}),this.router.navigate(["/admin/support"])}catch(i){console.error("Error creating ticket:",i),this.snackBar.open("L\u1ED7i t\u1EA1o v\u1EA5n \u0111\u1EC1","\u0110\xF3ng",{duration:3e3,panelClass:["snackbar-error"]})}finally{this.loading.set(!1)}})}getFileIcon(r){return r.startsWith("image/")?"image":r.startsWith("video/")?"videocam":"attach_file"}formatFileSize(r){return r<1024?r+" B":r<1024*1024?(r/1024).toFixed(1)+" KB":(r/(1024*1024)).toFixed(1)+" MB"}static \u0275fac=function(i){return new(i||m)(f(de),f(W),f(z))};static \u0275cmp=w({type:m,selectors:[["app-support-create"]],decls:50,vars:11,consts:[["fileInput",""],[1,"container","mx-auto","p-4","max-w-3xl"],[1,"flex","items-center","gap-4","mb-6"],["mat-icon-button","","color","primary",3,"routerLink"],[1,"text-2xl","font-bold"],[1,"space-y-4",3,"submit"],["appearance","outline",1,"w-full"],["matInput","","name","title","required","","placeholder","M\xF4 t\u1EA3 ng\u1EAFn g\u1ECDn v\u1EA5n \u0111\u1EC1 c\u1EE7a b\u1EA1n",3,"ngModelChange","ngModel"],["matInput","","name","description","required","","rows","6","placeholder","M\xF4 t\u1EA3 chi ti\u1EBFt v\u1EA5n \u0111\u1EC1, c\xE1c b\u01B0\u1EDBc t\xE1i hi\u1EC7n l\u1ED7i...",3,"ngModelChange","ngModel"],["name","priority",3,"ngModelChange","ngModel"],["value","low"],["value","medium"],["value","high"],["value","urgent"],[1,"block","text-sm","font-medium","mb-2"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6","text-center"],["type","file","multiple","","accept","image/*,video/*",1,"hidden",3,"change"],["mat-raised-button","","type","button",3,"click"],[1,"text-sm","text-gray-500","mt-2"],[1,"mt-4","space-y-2"],[1,"flex","gap-4"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20"],["mat-stroked-button","","type","button",3,"routerLink","disabled"],[1,"flex","items-center","justify-between","p-2","bg-gray-50","rounded"],[1,"flex","items-center","gap-2"],[1,"text-sm"],[1,"text-xs","text-gray-500"],["mat-icon-button","","type","button",3,"click"]],template:function(i,n){if(i&1){let u=b();e(0,"div",1)(1,"div",2)(2,"button",3)(3,"mat-icon"),o(4,"arrow_back"),t()(),e(5,"span",4),o(6,"T\u1EA1o v\u1EA5n \u0111\u1EC1 m\u1EDBi"),t()(),e(7,"mat-card")(8,"mat-card-content")(9,"form",5),c("submit",function(a){return p(u),s(n.onSubmit(a))}),e(10,"mat-form-field",6)(11,"mat-label"),o(12,"Ti\xEAu \u0111\u1EC1"),t(),e(13,"input",7),_("ngModelChange",function(a){return p(u),S(n.title,a)||(n.title=a),s(a)}),t()(),e(14,"mat-form-field",6)(15,"mat-label"),o(16,"M\xF4 t\u1EA3 chi ti\u1EBFt"),t(),e(17,"textarea",8),_("ngModelChange",function(a){return p(u),S(n.description,a)||(n.description=a),s(a)}),t()(),e(18,"mat-form-field",6)(19,"mat-label"),o(20,"M\u1EE9c \u0111\u1ED9 \u01B0u ti\xEAn"),t(),e(21,"mat-select",9),_("ngModelChange",function(a){return p(u),S(n.priority,a)||(n.priority=a),s(a)}),e(22,"mat-option",10),o(23,"Th\u1EA5p"),t(),e(24,"mat-option",11),o(25,"Trung b\xECnh"),t(),e(26,"mat-option",12),o(27,"Cao"),t(),e(28,"mat-option",13),o(29,"Kh\u1EA9n c\u1EA5p"),t()()(),e(30,"div")(31,"label",14),o(32,"\u0110\xEDnh k\xE8m file (h\xECnh \u1EA3nh/video)"),t(),e(33,"div",15)(34,"input",16,0),c("change",function(a){return p(u),s(n.onFileSelected(a))}),t(),e(36,"button",17),c("click",function(){p(u);let a=V(35);return s(a.click())}),e(37,"mat-icon"),o(38,"attach_file"),t(),o(39," Ch\u1ECDn file "),t(),e(40,"p",18),o(41,"H\u1ED7 tr\u1EE3 h\xECnh \u1EA3nh v\xE0 video, t\u1ED1i \u0111a 50MB/file"),t()(),M(42,Ee,3,0,"div",19),t(),e(43,"div",20)(44,"button",21),M(45,Ce,1,0,"mat-spinner",22)(46,Se,2,0,"mat-icon"),o(47," G\u1EEDi v\u1EA5n \u0111\u1EC1 "),t(),e(48,"button",23),o(49," H\u1EE7y "),t()()()()()()}i&2&&(l(2),g("routerLink",y(9,ce)),l(11),C("ngModel",n.title),l(4),C("ngModel",n.description),l(4),C("ngModel",n.priority),l(21),v(n.selectedFiles().length>0?42:-1),l(2),g("disabled",n.loading()||!n.title||!n.description),l(),v(n.loading()?45:46),l(3),g("routerLink",y(10,ce))("disabled",n.loading()))},dependencies:[D,$,Y,U,O,J,Z,X,Q,N,L,q,R,j,ue,le,me,ie,te,ee,re,ne,ae,oe,P,K,H,se,pe,G],encapsulation:2})};export{fe as SupportCreateComponent};
