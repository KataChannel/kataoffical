import './polyfills.server.mjs';
import{a as Y}from"./chunk-IDKA5VNE.mjs";import{a as U}from"./chunk-OPBKZ7KD.mjs";import{a as N,c as z,e as V,f as j,g as O,h as W}from"./chunk-G22LVZ3C.mjs";import{b as J,c as Q}from"./chunk-CLIOYSV5.mjs";import{B as G,C as K,b as R,g as B,j as T,p as A,q as H,s as L,u as q,v as X,w as $}from"./chunk-6OXZJDYM.mjs";import{a as P,b as F}from"./chunk-HY6ZSEAG.mjs";import{a as w}from"./chunk-NJUROCK7.mjs";import{a as k,e as S}from"./chunk-YYTI3S2Z.mjs";import{o as I,z as M}from"./chunk-OZK2OCZT.mjs";import{$b as b,Fb as C,Hc as a,Jc as d,Mb as g,Mc as v,Nc as D,Oc as _,Yb as m,_b as x,ic as i,ja as E,jc as e,pa as c,tb as l,tc as h,vc as f}from"./chunk-TKMPR5S6.mjs";import{j as y}from"./chunk-RIAI3ORJ.mjs";function et(r,t){r&1&&(i(0,"mat-error"),a(1,"L\xFD do h\u1EE7y ph\u1EA3i c\xF3 \xEDt nh\u1EA5t 10 k\xFD t\u1EF1"),e())}function nt(r,t){if(r&1&&(i(0,"p")(1,"strong"),a(2,"Kh\xE1ch h\xE0ng:"),e(),a(3),e()),r&2){let n=f(2);l(3),d(" ",n.orderInfo.khachhang.name," ")}}function at(r,t){if(r&1&&(i(0,"p")(1,"strong"),a(2,"Nh\xE0 cung c\u1EA5p:"),e(),a(3),e()),r&2){let n=f(2);l(3),d(" ",n.orderInfo.nhacungcap.name," ")}}function ot(r,t){if(r&1&&(i(0,"div",14)(1,"p",15)(2,"strong"),a(3,"Th\xF4ng tin \u0111\u01A1n h\xE0ng:"),e()(),i(4,"div",16)(5,"p")(6,"strong"),a(7,"M\xE3 \u0111\u01A1n:"),e(),a(8),e(),g(9,nt,4,1,"p",9)(10,at,4,1,"p",9),i(11,"p")(12,"strong"),a(13,"Tr\u1EA1ng th\xE1i:"),e(),i(14,"span",17),a(15),e()()()()),r&2){let n=f();l(8),d(" ",n.orderInfo.madonhang||n.orderInfo.madncc,""),l(),m("ngIf",n.orderInfo.khachhang),l(),m("ngIf",n.orderInfo.nhacungcap),l(4),b(n.getStatusClass(n.orderInfo.status)),l(),d(" ",n.getStatusLabel(n.orderInfo.status)," ")}}var p=class r{lydohuy="";showError=!1;orderInfo=null;hasInventory=!1;dialogRef=c(N);onCancel(){this.dialogRef.close(null)}onConfirm(){this.isValid()?this.dialogRef.close(this.lydohuy.trim()):this.showError=!0}onInputChange(){this.lydohuy.length>=10&&(this.showError=!1)}isValid(){return this.lydohuy.trim().length>=10}getStatusLabel(t){return{dadat:"\u0110\xE3 \u0110\u1EB7t",dagiao:"\u0110\xE3 Giao",danhan:"\u0110\xE3 Nh\u1EADn",huy:"\u0110\xE3 H\u1EE7y",hoanthanh:"Ho\xE0n Th\xE0nh"}[t]||t}getStatusClass(t){return{dadat:"bg-blue-100 text-blue-800",dagiao:"bg-green-100 text-green-800",danhan:"bg-purple-100 text-purple-800",huy:"bg-red-100 text-red-800",hoanthanh:"bg-gray-100 text-gray-800"}[t]||"bg-gray-100 text-gray-800"}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=C({type:r,selectors:[["app-cancel-reason-dialog"]],decls:31,vars:9,consts:[["mat-dialog-title","",1,"text-red-600","font-bold"],[1,"align-middle","mr-2"],[1,"mt-4"],[1,"mb-4","p-3","bg-yellow-50","border-l-4","border-yellow-400","text-yellow-700"],[1,"text-sm"],["appearance","outline",1,"w-full"],["matInput","","rows","5","placeholder","Vui l\xF2ng nh\u1EADp l\xFD do h\u1EE7y \u0111\u01A1n h\xE0ng (t\u1ED1i thi\u1EC3u 10 k\xFD t\u1EF1)","required","","maxlength","500",3,"ngModelChange","input","ngModel"],["align","start"],["align","end"],[4,"ngIf"],["class","mt-4 p-3 bg-gray-50 rounded",4,"ngIf"],["align","end",1,"mt-4","gap-2"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","warn","type","button",3,"click","disabled"],[1,"mt-4","p-3","bg-gray-50","rounded"],[1,"text-sm","text-gray-600","mb-2"],[1,"text-sm","space-y-1"],[1,"px-2","py-1","rounded","text-xs"]],template:function(n,o){n&1&&(i(0,"h2",0)(1,"mat-icon",1),a(2,"warning"),e(),a(3," X\xE1c Nh\u1EADn H\u1EE7y \u0110\u01A1n H\xE0ng "),e(),i(4,"mat-dialog-content",2)(5,"div",3)(6,"p",4)(7,"strong"),a(8,"C\u1EA3nh b\xE1o:"),e(),a(9),e()(),i(10,"mat-form-field",5)(11,"mat-label"),a(12,"L\xFD do h\u1EE7y \u0111\u01A1n h\xE0ng"),e(),i(13,"textarea",6),_("ngModelChange",function(s){return D(o.lydohuy,s)||(o.lydohuy=s),s}),h("input",function(){return o.onInputChange()}),a(14,"        "),e(),i(15,"mat-hint",7)(16,"span"),a(17),e()(),i(18,"mat-hint",8),a(19),e(),g(20,et,2,0,"mat-error",9),e(),g(21,ot,16,6,"div",10),e(),i(22,"mat-dialog-actions",11)(23,"button",12),h("click",function(){return o.onCancel()}),i(24,"mat-icon"),a(25,"close"),e(),a(26," H\u1EE7y B\u1ECF "),e(),i(27,"button",13),h("click",function(){return o.onConfirm()}),i(28,"mat-icon"),a(29,"check"),e(),a(30," X\xE1c Nh\u1EADn H\u1EE7y \u0110\u01A1n "),e()()),n&2&&(l(9),d(" H\xE0nh \u0111\u1ED9ng n\xE0y kh\xF4ng th\u1EC3 ho\xE0n t\xE1c. ",o.hasInventory?"T\u1ED3n kho s\u1EBD \u0111\u01B0\u1EE3c \u0111i\u1EC1u ch\u1EC9nh t\u1EF1 \u0111\u1ED9ng.":""," "),l(4),v("ngModel",o.lydohuy),l(3),x("text-red-500",o.lydohuy.length<10),l(),d(" ",o.lydohuy.length,"/10 k\xFD t\u1EF1 t\u1ED1i thi\u1EC3u "),l(2),d("",o.lydohuy.length,"/500"),l(),m("ngIf",o.showError),l(),m("ngIf",o.orderInfo),l(6),m("disabled",!o.isValid()))},dependencies:[M,I,W,V,O,j,K,G,q,$,X,Q,J,S,k,F,P,L,R,B,A,H,T],styles:["[_nghost-%COMP%]{display:block}mat-dialog-content[_ngcontent-%COMP%]{min-width:500px;max-width:600px}"]})};var Z=class r{dialog=c(z);snackBar=c(w);donhangService=c(U);dathangService=c(Y);cancelDonhang(t){return y(this,null,function*(){if(t.status==="huy")return this.snackBar.open("\u274C \u0110\u01A1n h\xE0ng \u0111\xE3 \u0111\u01B0\u1EE3c h\u1EE7y tr\u01B0\u1EDBc \u0111\xF3","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1;let o=yield this.dialog.open(p,{width:"500px",disableClose:!0,data:{orderType:"donhang",orderId:t.id,orderCode:t.code||t.madonhang,currentStatus:t.status}}).afterClosed().toPromise();if(!o)return!1;let u=this.snackBar.open("\u23F3 \u0110ang x\u1EED l\xFD h\u1EE7y \u0111\u01A1n h\xE0ng...","",{duration:0,horizontalPosition:"end",verticalPosition:"top"});try{let s=yield this.donhangService.cancelDonhang(t.id,o);return u.dismiss(),this.snackBar.open(`\u2705 ${s.message}`,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),!0}catch(s){return u.dismiss(),this.snackBar.open(`\u274C L\u1ED7i khi h\u1EE7y \u0111\u01A1n h\xE0ng: ${s.message}`,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1}})}cancelDathang(t){return y(this,null,function*(){if(t.status==="huy")return this.snackBar.open("\u274C \u0110\u01A1n \u0111\u1EB7t h\xE0ng \u0111\xE3 \u0111\u01B0\u1EE3c h\u1EE7y tr\u01B0\u1EDBc \u0111\xF3","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1;let o=yield this.dialog.open(p,{width:"500px",disableClose:!0,data:{orderType:"dathang",orderId:t.id,orderCode:t.code||t.madathang,currentStatus:t.status}}).afterClosed().toPromise();if(!o)return!1;let u=this.snackBar.open("\u23F3 \u0110ang x\u1EED l\xFD h\u1EE7y \u0111\u01A1n \u0111\u1EB7t h\xE0ng...","",{duration:0,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{let s=yield this.dathangService.cancelDathang(t.id,o);return u.dismiss(),this.snackBar.open(`\u2705 ${s.message}`,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),!0}catch(s){return u.dismiss(),this.snackBar.open(`\u274C L\u1ED7i khi h\u1EE7y \u0111\u01A1n \u0111\u1EB7t h\xE0ng: ${s.message}`,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1}})}canCancelOrder(t){return t.status!=="huy"}getCancelButtonTooltip(t){return t.status==="huy"?"\u0110\u01A1n h\xE0ng \u0111\xE3 \u0111\u01B0\u1EE3c h\u1EE7y":"H\u1EE7y \u0111\u01A1n h\xE0ng"}static \u0275fac=function(n){return new(n||r)};static \u0275prov=E({token:r,factory:r.\u0275fac,providedIn:"root"})};export{Z as a};
