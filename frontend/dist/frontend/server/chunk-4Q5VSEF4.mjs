import './polyfills.server.mjs';
import{a as oe,b as re}from"./chunk-QML3I3N5.mjs";import{a as he}from"./chunk-6MU435OM.mjs";import"./chunk-X4ZSYWAN.mjs";import"./chunk-7BHYQM75.mjs";import"./chunk-73IBRO6I.mjs";import{a as ie,b as ae}from"./chunk-DKGIHELM.mjs";import"./chunk-NCQK6CLO.mjs";import"./chunk-4K3JD57Z.mjs";import"./chunk-MGIVCIKU.mjs";import"./chunk-LTXEXXKP.mjs";import"./chunk-63VCJS6D.mjs";import{h as Q}from"./chunk-L4NEGAA5.mjs";import"./chunk-26NM6QMQ.mjs";import{d as ne}from"./chunk-SWDJOT3A.mjs";import"./chunk-2LPVCQ2D.mjs";import{b as te}from"./chunk-H7545ZTN.mjs";import{b as R,c as O,d as z}from"./chunk-UDERLDF4.mjs";import{a as j,b as H}from"./chunk-UXT4BTQU.mjs";import{b as G,g as X,j as q,n as J,p as U,u as Y,v as Z,x as $,y as ee}from"./chunk-5KMKQOCQ.mjs";import"./chunk-NIUW4K4I.mjs";import"./chunk-7ZQLLCLM.mjs";import{a as W}from"./chunk-VVTKGC3D.mjs";import"./chunk-H5UC2HJQ.mjs";import"./chunk-Y7AZMXL7.mjs";import{a as B,c as A,e as P}from"./chunk-JPGXAD5G.mjs";import"./chunk-JQPIWTCW.mjs";import"./chunk-7T6LZHUD.mjs";import{a as V,d as L}from"./chunk-AOYZMTNN.mjs";import"./chunk-NSZ5DDYR.mjs";import{n as K,o as F,w as I}from"./chunk-L5MIOCHX.mjs";import{Gb as M,Gc as C,Hc as o,Ic as E,Jc as S,Mc as x,Nb as f,Nc as N,Oc as y,Ra as w,Zb as p,hc as a,ic as h,kc as D,lc as b,nc as k,oa as _,sc as g,tb as l,uc as u,vd as T,xa as m,ya as s}from"./chunk-QJJOREH3.mjs";import"./chunk-KB5IWD3E.mjs";import{j as d}from"./chunk-RIAI3ORJ.mjs";function le(c,e){if(c&1){let n=k();a(0,"button",3),g("click",function(){m(n);let i=u();return s(i.handleNhomkhachhangAction())}),a(1,"mat-icon"),o(2,"save"),h()()}}function me(c,e){if(c&1){let n=k();a(0,"button",3),g("click",function(){m(n);let i=u();return s(i.toggleEdit())}),a(1,"mat-icon"),o(2,"edit"),h()()}}function se(c,e){if(c&1){let n=k();D(0),a(1,"div",11)(2,"div",12),o(3,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),h(),a(4,"div",13)(5,"button",14),g("click",function(){m(n);let i=u();return s(i.DeleteData())}),o(6,"\u0110\u1ED3ng \xDD"),h(),a(7,"button",15),g("click",function(){m(n);let i=u();return s(i.toggleDelete())}),o(8,"Hu\u1EF7 B\u1ECF"),h()()(),b()}}function ge(c,e){c&1&&(a(0,"span",31),o(1,"check"),h())}function ue(c,e){if(c&1){let n=k();a(0,"div",29),g("click",function(){let i=m(n).$implicit,r=u(2);return s(r.ChosenKhachhang(i))}),f(1,ge,2,0,"span",30),o(2),h()}if(c&2){let n=e.$implicit,t=u(2);l(),p("ngIf",t.CheckKhachhang(n)),l(),S(" ",n.name," ")}}function pe(c,e){if(c&1){let n=k();D(0)(1),a(2,"div",16)(3,"mat-form-field",17)(4,"mat-label"),o(5,"Nh\xF3m Kh\xE1ch h\xE0ng"),h(),a(6,"input",18),y("ngModelChange",function(i){m(n);let r=u();return N(r.DetailNhomkhachhang().name,i)||(r.DetailNhomkhachhang().name=i),s(i)}),g("input",function(){m(n);let i=u();return s(i.FillSlug())}),h()(),a(7,"mat-form-field",17)(8,"mat-label"),o(9,"M\xF4 T\u1EA3"),h(),a(10,"input",19),y("ngModelChange",function(i){m(n);let r=u();return N(r.DetailNhomkhachhang().description,i)||(r.DetailNhomkhachhang().description=i),s(i)}),g("input",function(){m(n);let i=u();return s(i.FillSlug())}),h()(),a(11,"div")(12,"span",20,0),o(14),h(),a(15,"mat-menu",null,1)(17,"div",21),g("click",function(i){return m(n),s(i.stopPropagation())}),a(18,"div",22)(19,"input",23),g("keyup",function(i){m(n);let r=u();return s(r.doFilterKhachhang(i))}),h(),a(20,"div",24)(21,"span",25),o(22,"search"),h()()(),a(23,"div",26),f(24,ue,3,2,"div",27),h(),a(25,"div",28)(26,"button",15),g("click",function(){m(n);let i=C(13);return s(i.closeMenu())}),o(27,"\u0110\xF3ng"),h(),a(28,"button",14),g("click",function(){m(n);let i=C(13),r=u();return s(r.ApplyKhachhang(i))}),o(29,"\xC1p D\u1EE5ng"),h()()()()()(),b()()}if(c&2){let n=C(16),t=u();l(6),x("ngModel",t.DetailNhomkhachhang().name),p("disabled",!t.isEdit()),l(4),x("ngModel",t.DetailNhomkhachhang().description),p("disabled",!t.isEdit()),l(2),p("matMenuTriggerFor",n),l(2),S(" ",t.CheckListKhachhang.length," Kh\xE1ch H\xE0ng "),l(10),p("ngForOf",t.ListKhachhang)("ngForTrackBy",t.trackByFn)}}var ce=class c{_ListnhomkhachhangComponent=_(re);_NhomkhachhangService=_(oe);_KhachhangService=_(he);_route=_(V);_router=_(L);_snackBar=_(W);constructor(){this._route.paramMap.subscribe(e=>{let n=e.get("id");this._NhomkhachhangService.setNhomkhachhangId(n)}),T(()=>d(this,null,function*(){let e=this._NhomkhachhangService.nhomkhachhangId();e||(this._router.navigate(["/admin/nhomkhachhang"]),this._ListnhomkhachhangComponent.drawer.close()),e==="0"?(this.DetailNhomkhachhang.update(()=>({})),this._ListnhomkhachhangComponent.drawer.open(),this.isEdit.update(n=>!n),this._router.navigate(["/admin/nhomkhachhang","0"])):(yield this._NhomkhachhangService.getNhomkhachhangByid(e),yield this._KhachhangService.getAllKhachhang(),this.ListKhachhang=this._KhachhangService.ListKhachhang(),this.CheckListKhachhang=this.DetailNhomkhachhang().khachhang,this._ListnhomkhachhangComponent.drawer.open(),this._router.navigate(["/admin/nhomkhachhang",e]))}))}DetailNhomkhachhang=this._NhomkhachhangService.DetailNhomkhachhang;isEdit=w(!1);isDelete=w(!1);nhomkhachhangId=this._NhomkhachhangService.nhomkhachhangId;ngOnInit(){return d(this,null,function*(){})}handleNhomkhachhangAction(){return d(this,null,function*(){this.nhomkhachhangId()==="0"?yield this.createNhomkhachhang():yield this.updateNhomkhachhang()})}createNhomkhachhang(){return d(this,null,function*(){try{this.DetailNhomkhachhang.update(e=>(delete e.khachhang,e)),yield this._NhomkhachhangService.CreateNhomkhachhang(this.DetailNhomkhachhang()),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi t\u1EA1o nhomkhachhang:",e)}})}updateNhomkhachhang(){return d(this,null,function*(){try{this.DetailNhomkhachhang.update(e=>(delete e.khachhang,e)),yield this._NhomkhachhangService.updateNhomkhachhang(this.DetailNhomkhachhang()),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(e=>!e)}catch(e){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt nhomkhachhang:",e)}})}DeleteData(){return d(this,null,function*(){try{yield this._NhomkhachhangService.DeleteNhomkhachhang(this.DetailNhomkhachhang()),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["/admin/nhomkhachhang"])}catch(e){console.error("L\u1ED7i khi x\xF3a nhomkhachhang:",e)}})}goBack(){this._router.navigate(["/admin/nhomkhachhang"]),this._ListnhomkhachhangComponent.drawer.close()}trackByFn(e,n){return n.id}toggleEdit(){this.isEdit.update(e=>!e)}toggleDelete(){this.isDelete.update(e=>!e)}FillSlug(){this.DetailNhomkhachhang.update(e=>(e.slug=ne(e.title),e))}ListKhachhang=[];CheckListKhachhang=[];doFilterKhachhang(e){let n=e.target.value;this.ListKhachhang=this._KhachhangService.ListKhachhang().filter(t=>t.name.toLowerCase().includes(n.toLowerCase()))}ChosenKhachhang(e){this.CheckListKhachhang.find(t=>t.id===e.id)?this.CheckListKhachhang=this.CheckListKhachhang.filter(t=>t.id!==e.id):this.CheckListKhachhang.push(e)}ApplyKhachhang(e){return d(this,null,function*(){console.log(this.DetailNhomkhachhang()),console.log(this.CheckListKhachhang);let n={nhomId:this.nhomkhachhangId(),khachhangIds:this.DetailNhomkhachhang().khachhang.map(v=>v.id)},t=yield this._NhomkhachhangService.removeKHfromNhom(n),i={nhomId:this.nhomkhachhangId(),khachhangIds:this.CheckListKhachhang.map(v=>v.id)},r=yield this._NhomkhachhangService.addKHtoNhom(i);Promise.all([t,r]).then(()=>{e.closeMenu()})})}CheckKhachhang(e){return!!this.CheckListKhachhang.find(n=>n.id===e.id)}static \u0275fac=function(n){return new(n||c)};static \u0275cmp=M({type:c,selectors:[["app-detailnhomkhachhang"]],decls:17,vars:8,consts:[["menuTrigger","matMenuTrigger"],["menu","matMenu"],[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center"],[3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","warn",3,"click"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[4,"ngIf"],[1,"flex","flex-col","space-y-4","items-center","justify-center"],[1,"font-bold","text-2xl"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"w-full","flex","flex-col","space-y-2"],["appearance","outline"],["matInput","","placeholder","Vui l\xF2ng nh\u1EADp Nh\xF3m Kh\xE1ch h\xE0ng",3,"ngModelChange","input","ngModel","disabled"],["matInput","","placeholder","Vui l\xF2ng nh\u1EADp M\xF4 T\u1EA3",3,"ngModelChange","input","ngModel","disabled"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200",3,"matMenuTriggerFor"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],["class","flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"]],template:function(n,t){if(n&1&&(a(0,"div",2)(1,"button",3),g("click",function(){return t.goBack()}),a(2,"mat-icon"),o(3,"arrow_back"),h()(),a(4,"div",4),o(5),h(),a(6,"div",5)(7,"mat-slide-toggle",6),y("ngModelChange",function(r){return N(t.DetailNhomkhachhang().isActive,r)||(t.DetailNhomkhachhang().isActive=r),r}),o(8),h(),f(9,le,3,0,"button",7)(10,me,3,0,"button",7),a(11,"button",8),g("click",function(){return t.toggleDelete()}),a(12,"mat-icon"),o(13,"delete"),h()()()(),a(14,"div",9),f(15,se,9,0,"ng-container",10)(16,pe,30,8,"ng-container",10),h()),n&2){let i;l(5),E(((i=t.DetailNhomkhachhang())==null?null:i.name)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),l(2),x("ngModel",t.DetailNhomkhachhang().isActive),p("disabled",!t.isEdit()),l(),E(t.DetailNhomkhachhang().isActive?"Hi\u1EC3n Th\u1ECB":"\u1EA8n"),l(),p("ngIf",t.isEdit()),l(),p("ngIf",!t.isEdit()),l(5),p("ngIf",t.isDelete()),l(),p("ngIf",!t.isDelete())}},dependencies:[Z,Y,U,ee,$,J,G,X,q,H,j,P,B,A,te,Q,I,K,F,ae,ie,z,R,O],encapsulation:2})};export{ce as DetailNhomkhachhangComponent};
