import './polyfills.server.mjs';
var i=class{constructor(){}static isTokenExpired(r,e){if(!r||r==="")return!0;let t=this._getTokenExpirationDate(r);return e=e||0,t===null?!0:!(t.valueOf()>new Date().valueOf()+e*1e3)}static _b64decode(r){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="";if(r=String(r).replace(/=+$/,""),r.length%4===1)throw new Error("The string to be decoded is not correctly encoded.");for(let n=0,a,o,s=0;o=r.charAt(s++);~o&&(a=n%4?a*64+o:o,n++%4)?t+=String.fromCharCode(255&a>>(-2*n&6)):0)o=e.indexOf(o);return t}static _b64DecodeUnicode(r){return decodeURIComponent(Array.prototype.map.call(this._b64decode(r),e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))}static _urlBase64Decode(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Error("Illegal base64url string!")}return this._b64DecodeUnicode(e)}static _decodeToken(r){if(!r)return null;let e=r.split(".");if(e.length!==3)throw new Error("Invalid JWT. Check for three parts and refer to https://jwt.io.");let t=this._urlBase64Decode(e[1]);if(!t)throw new Error("Cannot decode the token.");return JSON.parse(t)}static _getTokenExpirationDate(r){let e=this._decodeToken(r);if(!e.hasOwnProperty("exp"))return null;let t=new Date(0);return t.setUTCSeconds(e.exp),t}static removeDuplicatePermissions(r){let e=new Map;return r.roles.forEach(t=>{t.role.permissions.forEach(n=>{e.has(n.permissionId)||e.set(n.permissionId,n)})}),r.permissions=Array.from(e.values()),r}};export{i as a};
