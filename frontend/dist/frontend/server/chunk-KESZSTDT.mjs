import './polyfills.server.mjs';
import{a as rt}from"./chunk-FEJ5N7SF.mjs";import{a as O,b as tt}from"./chunk-RHSABDND.mjs";import{a as B,b as it,c as nt}from"./chunk-COSQG4OV.mjs";import{b as at,g as ot}from"./chunk-POE2MFM3.mjs";import{a as st}from"./chunk-73IBRO6I.mjs";import{b as Oe}from"./chunk-4AA42E7K.mjs";import{a as Be}from"./chunk-26NM6QMQ.mjs";import{a as ye,b as ke,c as Ce}from"./chunk-2WVZEUAT.mjs";import{a as Se,b as ve,c as be,d as Ne}from"./chunk-WRSBCCBG.mjs";import{b as he,d as $}from"./chunk-HQVYZIQD.mjs";import{a as qe,b as He,c as je,e as ze,f as Je,h as Ke,i as Ge,k as Ue,l as Qe,n as We,o as Ze,p as Xe,q as K}from"./chunk-KKZPVVZF.mjs";import{a as Re}from"./chunk-JGIKJIHL.mjs";import{a as _e}from"./chunk-GS6F3HBF.mjs";import{a as S}from"./chunk-6EFOJMAD.mjs";import{a as Ye,b as et}from"./chunk-JPZMWWYO.mjs";import{b as $e}from"./chunk-SNL6NQRQ.mjs";import{b as Ve,c as Ae}from"./chunk-HXEL4YEF.mjs";import{B as De,C as Pe,b as Fe,g as Te,j as Le,s as Ee,u as Me,x as Ie}from"./chunk-67NKMS7C.mjs";import{a as xe,b as we}from"./chunk-Z6WUDYX6.mjs";import{a as fe}from"./chunk-AKVYLSG6.mjs";import{a as ue,c as de,e as ge}from"./chunk-LQWFEOWT.mjs";import{y as me,z as pe}from"./chunk-YS2PDZ6Q.mjs";import{n as re,o as se,u as le,z as ce}from"./chunk-EYW3XZCQ.mjs";import{$b as W,Ac as D,Bc as P,Cc as V,Fb as Q,Fc as F,Gc as m,Hc as A,Ic as C,Lc as ne,Mb as w,Mc as ae,Nc as oe,Pc as j,Ra as L,Vc as z,Xc as J,Yb as y,ac as Z,cc as H,dc as X,ec as Y,fc as E,gc as M,hc as r,ic as s,ja as U,jc as I,kc as ee,lc as te,nc as b,oa as q,pa as v,sc as f,tb as h,uc as c,ya as d,yc as ie,za as g}from"./chunk-LL6B6DB7.mjs";import{a as T,b as G,j as u}from"./chunk-RIAI3ORJ.mjs";var R=class a{constructor(i,t){this._StorageService=i;this.router=t}ListNhomkhachhang=L([]);DetailNhomkhachhang=L({});nhomkhachhangId=L(null);setNhomkhachhangId(i){this.nhomkhachhangId.set(i)}addKHtoNhom(i){return u(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},e=yield fetch(`${S.APIURL}/nhomkhachhang/addKHtoNhom`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let n=yield e.json();e.ok}catch(t){return console.error(t)}})}removeKHfromNhom(i){return u(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},e=yield fetch(`${S.APIURL}/nhomkhachhang/removeKHfromNhom`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let n=yield e.json();e.ok}catch(t){return console.error(t)}})}CreateNhomkhachhang(i){return u(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},e=yield fetch(`${S.APIURL}/nhomkhachhang`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let n=yield e.json();e.ok,this.getAllNhomkhachhang(),this.nhomkhachhangId.set(n.id)}catch(t){return console.error(t)}})}getAllNhomkhachhang(){return u(this,null,function*(){try{let i={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},t=yield fetch(`${S.APIURL}/nhomkhachhang`,i);t.ok;let e=yield t.json();this.ListNhomkhachhang.set(e)}catch(i){return console.error(i)}})}listenNhomkhachhangUpdates(){}initDB(){return u(this,null,function*(){return yield st("NhomkhachhangDB",1,{upgrade(i){i.createObjectStore("nhomkhachhangs",{keyPath:"id"})}})})}getNhomkhachhangByid(i){return u(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},e=yield fetch(`${S.APIURL}/nhomkhachhang/findid/${i}`,t);if(!e.ok)if(e.status===401){let o=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else if(e.status===403){let o=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else if(e.status===500){let o=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}else{let o=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:o}})}let n=yield e.json();this.DetailNhomkhachhang.set(n)}catch(t){return console.error(t)}})}updateNhomkhachhang(i){return u(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(i)},e=yield fetch(`${S.APIURL}/nhomkhachhang/${i.id}`,t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let n=yield e.json();e.ok,this.getAllNhomkhachhang(),this.getNhomkhachhangByid(i.id)}catch(t){return console.error(t)}})}DeleteNhomkhachhang(i){return u(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},e=yield fetch(`${S.APIURL}/nhomkhachhang/${i.id}`,t);if(!e.ok)if(e.status===401){let n=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else if(e.status===403){let n=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else if(e.status===500){let n=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}else{let n=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:n}})}this.getAllNhomkhachhang()}catch(t){return console.error(t)}})}static \u0275fac=function(t){return new(t||a)(q(_e),q($))};static \u0275prov=U({token:a,factory:a.\u0275fac,providedIn:"root"})};var mt=["drawer"],pt=()=>[50,100],ut=()=>({standalone:!0}),dt=(a,i)=>i.key;function gt(a,i){if(a&1){let t=b();r(0,"button",31),f("click",function(n){let o=d(t).$implicit;return c().toggleColumn(o),g(n.stopPropagation())}),r(1,"mat-icon"),m(2),s(),r(3,"span"),m(4),s()()}if(a&2){let t=i.$implicit;h(2),A(t.isShow?"check_box":"check_box_outline_blank"),h(2),A(t.value)}}function ft(a,i){if(a&1){let t=b();r(0,"mat-form-field",34)(1,"mat-label"),m(2),s(),r(3,"input",35),f("keyup",function(){d(t);let n=c(2);return g(n.applyFilter())}),oe("ngModelChange",function(n){let o=d(t).$implicit,l=c(2);return ae(l.filterValues[o],n)||(l.filterValues[o]=n),g(n)}),s()()}if(a&2){let t=i.$implicit,e=c(2);h(2),A(e.ColumnName[t]),h(),ie("placeholder","Vui l\xF2ng Nh\u1EADp ",t,""),ne("ngModel",e.filterValues[t]),y("ngModelOptions",j(5,ut))}}function _t(a,i){if(a&1&&(r(0,"div",32),w(1,ft,4,6,"mat-form-field",33),s()),a&2){let t=c();h(),y("ngForOf",t.displayedColumns)}}function yt(a,i){a&1&&(r(0,"span",55),m(1,"check"),s())}function kt(a,i){if(a&1){let t=b();r(0,"div",53),f("click",function(){let n=d(t).$implicit,o=c(3);return g(o.ChosenItem(n))}),w(1,yt,2,0,"span",54),m(2),s()}if(a&2){let t=i.$implicit,e=c(2).$implicit,n=c();h(),y("ngIf",n.CheckItem(t)),h(),C(" ",t[e]||"Tr\u1ED1ng"," ")}}function Ct(a,i){if(a&1){let t=b();r(0,"th",38)(1,"span",39),m(2),s(),r(3,"span",40,3),m(5," filter_alt "),s(),r(6,"mat-menu",null,1)(8,"div",41),f("click",function(n){return d(t),g(n.stopPropagation())}),r(9,"div",42)(10,"input",43),f("keyup",function(n){d(t);let o=c().$implicit,l=c();return g(l.doFilterHederColumn(n,o))}),s(),r(11,"div",44)(12,"span",45),m(13,"search"),s()()(),r(14,"div",46)(15,"div",8)(16,"span",47),f("click",function(){d(t);let n=c().$implicit,o=c();return g(o.ChosenAll(o.FilterHederColumn(o.dataSource.filteredData,n)))}),m(17),s(),r(18,"span",47),f("click",function(){d(t);let n=c(2);return g(n.EmptyFiter())}),m(19,"Xo\xE1"),s()(),r(20,"span",47),f("click",function(){d(t);let n=c(2);return g(n.ResetFilter())}),m(21,"Reset"),s()(),r(22,"div",48),E(23,kt,3,2,"div",49,X),s(),r(25,"div",50)(26,"button",51),f("click",function(){d(t);let n=F(4);return g(n.closeMenu())}),m(27,"\u0110\xF3ng"),s(),r(28,"button",52),f("click",function(){d(t);let n=F(4),o=c(2);return g(o.ApplyFilterColum(n))}),m(29,"\xC1p D\u1EE5ng"),s()()()()()}if(a&2){let t=F(7),e=c().$implicit,n=c();h(2),C(" ",n.ColumnName[e]," "),h(),y("matMenuTriggerFor",t),h(14),C("Ch\u1ECDn T\u1EA5t C\u1EA3 ",n.FilterHederColumn(n.dataSource.filteredData,e).length||0,""),h(6),M(n.FilterHederColumn(n.dataSource.filteredData,e))}}function xt(a,i){if(a&1&&(r(0,"span",57),m(1),s()),a&2){let t=c().index;h(),C(" ",t+1," ")}}function wt(a,i){if(a&1&&(r(0,"span",58),m(1),z(2,"date"),s()),a&2){let t=c().$implicit,e=c().$implicit;h(),C(" ",J(2,1,t[e],"HH:mm:ss dd/MM/yyyy")," ")}}function St(a,i){a&1&&(r(0,"mat-icon",59),m(1,"check_circle"),s())}function vt(a,i){a&1&&(r(0,"mat-icon",60),m(1,"cancel"),s())}function bt(a,i){if(a&1&&(r(0,"span",57),w(1,St,2,0,"mat-icon",59)(2,vt,2,0,"mat-icon",60),s()),a&2){let t=c().$implicit,e=c().$implicit;h(),H(t[e]?1:2)}}function Nt(a,i){if(a&1&&(r(0,"span",58),m(1),z(2,"date"),s()),a&2){let t=c().$implicit,e=c().$implicit;h(),C(" ",J(2,1,t[e],"HH:mm:ss dd/MM/yyyy")," ")}}function Ft(a,i){if(a&1&&(r(0,"span",57),m(1),s()),a&2){let t=c().$implicit,e=c().$implicit;h(),C(" ",t[e]," ")}}function Tt(a,i){if(a&1&&(r(0,"td",56),w(1,xt,2,1,"span",57)(2,wt,3,4,"span",58)(3,bt,3,1,"span",57)(4,Nt,3,4,"span",58)(5,Ft,2,1,"span",57),s()),a&2){let t,e=c().$implicit;h(),H((t=e)==="STT"?1:t==="createdAt"?2:t==="isActive"?3:t==="updatedAt"?4:5)}}function Lt(a,i){if(a&1&&(ee(0,26),w(1,Ct,30,3,"th",36)(2,Tt,6,1,"td",37),te()),a&2){let t=i.$implicit;y("matColumnDef",t)}}function Et(a,i){a&1&&I(0,"tr",61)}function Mt(a,i){if(a&1){let t=b();r(0,"tr",62),f("click",function(){let n=d(t).$implicit,o=c();return g(o.goToDetail(n))}),s()}if(a&2){let t=i.$implicit,e=c();Z("hover:bg-slate-100 ",e.nhomkhachhangId()==t.id?"!bg-slate-200":"","")}}function It(a,i){a&1&&(r(0,"tr",63)(1,"td",64),m(2,"Kh\xF4ng t\xECm th\u1EA5y"),s()())}var lt=class a{Detail={};displayedColumns=["name","description","createdAt","updatedAt"];ColumnName={name:"Nh\xF3m Kh\xE1ch h\xE0ng",description:"M\xF4 T\u1EA3",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("NhomkhachhangColFilter")||"[]");Columns=[];isFilter=!1;paginator;sort;drawer;filterValues={};_NhomkhachhangService=v(R);_breakpointObserver=v(me);_GoogleSheetService=v(rt);_GraphqlService=v(Re);_router=v($);Listnhomkhachhang=this._NhomkhachhangService.ListNhomkhachhang;dataSource=new K([]);nhomkhachhangId=this._NhomkhachhangService.nhomkhachhangId;_snackBar=v(fe);CountItem=0;constructor(){this.displayedColumns.forEach(i=>{this.filterValues[i]=""})}createFilter(){return(i,t)=>{let e=JSON.parse(t),n=!0;return this.displayedColumns.forEach(o=>{if(e[o]){let l=i[o]?i[o].toString().toLowerCase():"";n=n&&l.includes(e[o].toLowerCase())}}),n}}applyFilter(){this.dataSource.filter=JSON.stringify(this.filterValues)}ngOnInit(){return u(this,null,function*(){yield this._NhomkhachhangService.getAllNhomkhachhang(),this.CountItem=this.Listnhomkhachhang().length,this.dataSource=new K(this.Listnhomkhachhang()),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource.filterPredicate=this.createFilter(),this.initializeColumns(),this.setupDrawer(),this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i"})}refresh(){return u(this,null,function*(){yield this._NhomkhachhangService.getAllNhomkhachhang()})}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(i=>({key:i,value:this.ColumnName[i],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("NhomkhachhangColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(i=>i.isShow).map(i=>i.key),this.ColumnName=this.FilterColumns.reduce((i,t)=>(t.isShow&&(i[t.key]=t.value),i),{})}setupDrawer(){this._breakpointObserver.observe([pe.Handset]).subscribe(i=>{i.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}toggleColumn(i){let t=this.FilterColumns.find(e=>e.key===i.key);t&&(t.isShow=!t.isShow,this.updateDisplayedColumns())}FilterHederColumn(i,t){return i.filter((n,o,l)=>o===l.findIndex(_=>_[t]===n[t]))}doFilterHederColumn(i,t){this.dataSource.filteredData=this.Listnhomkhachhang().filter(n=>Be(n[t]).includes(i.target.value.toLowerCase())||n[t].toLowerCase().includes(i.target.value.toLowerCase()));let e=i.target.value.toLowerCase();console.log(e,t),console.log(this.dataSource.filteredData)}ListFilter=[];ChosenItem(i){this.ListFilter.includes(i.id)?this.ListFilter=this.ListFilter.filter(t=>t!==i.id):this.ListFilter.push(i.id),console.log(this.ListFilter)}ChosenAll(i){i.forEach(t=>{this.ListFilter.includes(t.id)?this.ListFilter=this.ListFilter.filter(e=>e!==e.id):this.ListFilter.push(t.id)})}ResetFilter(){this.ListFilter=this.Listnhomkhachhang().map(i=>i.id),this.dataSource.data=this.Listnhomkhachhang(),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}EmptyFiter(){this.ListFilter=[]}CheckItem(i){return this.ListFilter.includes(i.id)}ApplyFilterColum(i){this.dataSource.data=this.Listnhomkhachhang().filter(t=>this.ListFilter.includes(t.id)),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,console.log(this.dataSource.data),i.closeMenu()}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(i=>i.isShow).map(i=>i.key),this.ColumnName=this.FilterColumns.reduce((i,t)=>(t.isShow&&(i[t.key]=t.value),i),{}),localStorage.setItem("NhomkhachhangColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(i){let t=i.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(e=>e.value.toLowerCase().includes(t))}create(){this.drawer.open(),this._router.navigate(["admin/nhomkhachhang","new"])}goToDetail(i){this._NhomkhachhangService.setNhomkhachhangId(i.id),this.drawer.open(),this._router.navigate(["admin/nhomkhachhang",i.id])}LoadDrive(){return u(this,null,function*(){let i={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"NCCImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},t=yield this._GoogleSheetService.getDrive(i),e=Oe(t.values);console.log(e),this.DoImportData(e)})}DoImportData(i){console.log(i);let e=i.map(p=>({name:p.name?.trim()||"",mancc:p.mancc?.trim()||"",sdt:p.sdt?.trim()||"",diachi:p.diachi?.trim()||"",ghichu:p.ghichu?.trim()||""})).filter((p,x,k)=>x===k.findIndex(ct=>ct.mancc===p.mancc)),n=e.map(p=>p.mancc),o=this._NhomkhachhangService.ListNhomkhachhang().map(p=>p.mancc),l=n.filter(p=>!o.includes(p)),_=e.map(p=>u(this,null,function*(){let x=this._NhomkhachhangService.ListNhomkhachhang().find(k=>k.mancc===p.mancc);if(x){let k=T(T({},x),p);yield this._NhomkhachhangService.updateNhomkhachhang(k)}else yield this._NhomkhachhangService.CreateNhomkhachhang(p)})),N=l.map(p=>u(this,null,function*(){let x=this._NhomkhachhangService.ListNhomkhachhang().find(k=>k.mancc===p);x.isActive=!1,yield this._NhomkhachhangService.updateNhomkhachhang(x)}));Promise.all([..._,...N]).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}convertFlatToGroup(i){if(!i||i.length===0)return[];let t=Object.keys(i[0]).filter(e=>!["description","name"].includes(e));return console.log(t),i.forEach(e=>{e.khachhang=[];for(let n of t)e[n]!==void 0&&e[n]!==null&&e[n]!==""&&e.khachhang.push(e[n]),delete e[n]}),i}ImporExcel(i){return u(this,null,function*(){let t=yield ot(i);console.log(i),console.log(t);let e=this.convertFlatToGroup(t);console.log(e);let n=yield this._GraphqlService.findAll("khachhang",{select:{id:!0,name:!0,makh:!0},take:99999,aggressiveCache:!0,enableParallelFetch:!0}),o=e.filter(l=>l?.khachhang?.length>0).map(l=>G(T({},l),{khachhang:l?.khachhang?.map(_=>n.data.find(N=>N?.makh===_)?.id).filter(_=>_!==void 0)}));console.log("ListNCCSP for import:",o),yield this.processImportData(o)})}processImportData(i){return u(this,null,function*(){try{let t=i.map(e=>u(this,null,function*(){try{let n=this.Listnhomkhachhang().find(l=>l.name===e.name),o={name:e.name,description:e.description||"",khachhang:{connect:e.khachhang.map(l=>({id:l}))}};n?(console.log(`Updating existing nhomkhachhang: ${e.name}`),yield this._GraphqlService.updateOne("nhomkhachhang",{id:n.id},o)):(console.log(`Creating new nhomkhachhang: ${e.name}`),yield this._GraphqlService.createOne("nhomkhachhang",o))}catch(n){console.error(`Error processing nhomkhachhang "${e.name}":`,n),n.message?.includes("Unique constraint failed")&&n.message?.includes("name")?this._snackBar.open(`T\xEAn nh\xF3m "${e.name}" \u0111\xE3 t\u1ED3n t\u1EA1i, b\u1ECF qua.`,"",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]}):this._snackBar.open(`L\u1ED7i x\u1EED l\xFD nh\xF3m "${e.name}": ${n.message}`,"",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}}));yield Promise.all(t),yield this.refresh(),this._snackBar.open(`Import ho\xE0n t\u1EA5t! \u0110\xE3 x\u1EED l\xFD ${i.length} nh\xF3m kh\xE1ch h\xE0ng.`,"",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),setTimeout(()=>{window.location.reload()},300)}catch(t){console.error("Import error:",t),this._snackBar.open(`L\u1ED7i import: ${t.message}`,"",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}testImportWithSampleData(){return u(this,null,function*(){let i=[{name:"Nh\xF3m 2",description:"M\xF4 t\u1EA3",khachhang:["0032fc11-b99f-4ab6-a10b-9bfdb32f61b5","003c52fc-4e54-4d58-92e2-a7bf3b847e2c","008fc6fb-4834-4c72-9f80-7281db4b09db","011c521e-8b2e-4ba1-a9dc-4a819321444d"]},{name:"Nh\xF3m 4",description:"M\xF4 T\u1EA3 2",khachhang:["0032fc11-b99f-4ab6-a10b-9bfdb32f61b5","008fc6fb-4834-4c72-9f80-7281db4b09db","01cc2b3e-a279-4fb7-8e78-7073cf7d8d8b","02f57b49-2734-4d92-988a-2fac2a5fbbfa","036b2dd7-8026-45ae-b388-e643f3546df8","036ded8c-a9ab-4d0b-b18a-daa0c04aaea8"]}];console.log("Testing import with sample data:",i),yield this.processImportData(i)})}ExportExcel(i,t){return u(this,null,function*(){console.log(i);let n=(yield this._GraphqlService.findAll("khachhang",{select:{id:!0,name:!0,makh:!0},take:99999,aggressiveCache:!0,enableParallelFetch:!0})).data.reduce((l,_)=>(_&&_.makh&&(l[_.makh]=""),l),{}),o=i.map(l=>{let _={name:l.name||"",description:l.description||""},N=1;for(let p of Object.keys(n))l.khachhang?.some(k=>k.makh===p)&&(_["z"+N]=p,N++);return _});console.log(o),at(o,t)})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=Q({type:a,selectors:[["app-listnhomkhachhang"]],viewQuery:function(t,e){if(t&1&&(D(O,5),D(B,5),D(mt,7)),t&2){let n;P(n=V())&&(e.paginator=n.first),P(n=V())&&(e.sort=n.first),P(n=V())&&(e.drawer=n.first)}},decls:47,vars:12,consts:[["drawer",""],["menu","matMenu"],["uploadfile",""],["menuTrigger","matMenuTrigger"],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[1,"cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","p-2","bg-white","rounded-lg"],[1,"flex","flex-row","space-x-2","items-center"],["matTooltip","Th\xEAm m\u1EDBi","mat-flat-button","",1,"flex","flex-row","items-center","btn-primary",3,"click"],[1,"whitespace-nowrap"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","B\u1ED9 L\u1ECDc","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i l\xEAn file excel","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],["class","w-full grid grid-cols-2 gap-2 lg:flex lg:flex-row lg:space-x-2 items-center",4,"ngIf"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"class","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],[1,"w-full","grid","grid-cols-2","gap-2","lg:flex","lg:flex-row","lg:space-x-2","items-center"],["appearance","outline","subscriptSizing","dynamic",4,"ngFor","ngForOf"],["appearance","outline","subscriptSizing","dynamic"],["matInput","",3,"keyup","ngModelChange","ngModel","ngModelOptions","placeholder"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],[1,"z-10","material-symbols-outlined","text-gray-500",3,"matMenuTriggerFor"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],[1,"flex","flex-row","space-x-2","items-center","justify-between"],[1,"text-xs","text-blue-600","underline",3,"click"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"max-w-40","line-clamp-4","text-xs"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(t,e){if(t&1){let n=b();r(0,"mat-drawer-container",4)(1,"mat-drawer",5,0),I(3,"router-outlet"),s(),r(4,"div",6)(5,"div",7)(6,"div",8)(7,"button",9),f("click",function(){return d(n),g(e.create())}),r(8,"mat-icon"),m(9,"add_circle"),s(),r(10,"span",10),m(11,"T\u1EA1o M\u1EDBi"),s()(),r(12,"button",11)(13,"mat-icon"),m(14,"tune"),s()(),r(15,"mat-menu",null,1)(17,"div",12)(18,"mat-form-field",13)(19,"input",14),f("input",function(l){return d(n),g(e.doFilterColumns(l))})("click",function(l){return d(n),g(l.stopPropagation())}),s(),r(20,"mat-icon",15),m(21,"search"),s()()(),r(22,"div",16),E(23,gt,5,2,"button",17,dt),s()(),r(25,"button",18),f("click",function(){return d(n),g(e.isFilter=!e.isFilter)}),r(26,"mat-icon"),m(27,"filter_list"),s()(),r(28,"button",19),f("click",function(){return d(n),g(e.ExportExcel(e.Listnhomkhachhang(),"Nhomkhachhang"))}),r(29,"mat-icon"),m(30,"file_download"),s()(),r(31,"button",20),f("click",function(){d(n);let l=F(35);return g(l.click())}),r(32,"mat-icon"),m(33,"file_upload"),s()(),r(34,"input",21,2),f("change",function(l){return d(n),g(e.ImporExcel(l))}),s(),r(36,"span",22),m(37),s()()(),w(38,_t,2,1,"div",23),r(39,"div",24)(40,"table",25),E(41,Lt,3,1,"ng-container",26,Y),w(43,Et,1,0,"tr",27)(44,Mt,1,3,"tr",28)(45,It,3,0,"tr",29),s(),I(46,"mat-paginator",30),s()()()}if(t&2){let n=F(16);h(),y("position","end"),h(11),y("matMenuTriggerFor",n),h(11),M(e.FilterColumns),h(2),W(e.isFilter?"!bg-slate-200":""),h(12),C(" ",e.CountItem," Nh\xE0 Cung C\u1EA5p "),h(),y("ngIf",e.isFilter),h(2),y("dataSource",e.dataSource),h(),M(e.displayedColumns),h(2),y("matHeaderRowDef",e.displayedColumns),h(),y("matRowDefColumns",e.displayedColumns),h(2),y("pageSizeOptions",j(11,pt))}},dependencies:[Pe,De,Me,Ie,Ae,Ve,Xe,qe,je,Ge,ze,He,Ue,Je,Ke,Qe,We,Ze,nt,B,it,tt,O,Ne,ve,Se,be,Ce,ye,ke,he,we,xe,ge,ue,de,$e,ce,re,se,le,Ee,Fe,Te,Le,et,Ye],encapsulation:2})};export{R as a,lt as b};
