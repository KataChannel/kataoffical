import './polyfills.server.mjs';
import{a as b}from"./chunk-GS6F3HBF.mjs";import{a as p}from"./chunk-6EFOJMAD.mjs";import{a as d}from"./chunk-AKVYLSG6.mjs";import{a as l,d as c}from"./chunk-SYOYXCNA.mjs";import{Ra as r,ja as g,pa as h,u as a}from"./chunk-LL6B6DB7.mjs";import{j as s}from"./chunk-RIAI3ORJ.mjs";var u=class o{http=h(c);storageService=h(b);snackBar=h(d);apiUrl=`${p.APIURL}/phongban`;ListPhongban=r([]);PhongbanTree=r([]);DetailPhongban=r(null);Statistics=r(null);loading=r(!1);error=r(null);getHeaders(){let t=this.storageService.getItem("token");return new l({"Content-Type":"application/json",Authorization:`Bearer ${t}`})}getAllPhongban(t){return s(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let e=this.apiUrl,n=[];t?.level!==void 0&&n.push(`level=${t.level}`),t?.loai&&n.push(`loai=${t.loai}`),t?.parentId!==void 0&&n.push(`parentId=${t.parentId||"null"}`),t?.includeChildren!==void 0&&n.push(`includeChildren=${t.includeChildren}`),n.length>0&&(e+="?"+n.join("&"));let i=yield a(this.http.get(e,{headers:this.getHeaders()}));return this.ListPhongban.set(i),i}catch(e){throw this.error.set(e.message||"L\u1ED7i khi t\u1EA3i danh s\xE1ch ph\xF2ng ban"),this.snackBar.open("L\u1ED7i khi t\u1EA3i danh s\xE1ch ph\xF2ng ban","\u0110\xF3ng",{duration:3e3}),e}finally{this.loading.set(!1)}})}getPhongbanTree(){return s(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=yield a(this.http.get(`${this.apiUrl}/tree`,{headers:this.getHeaders()}));return this.PhongbanTree.set(t),t}catch(t){throw this.error.set(t.message||"L\u1ED7i khi t\u1EA3i c\xE2y ph\xF2ng ban"),this.snackBar.open("L\u1ED7i khi t\u1EA3i c\xE2y ph\xF2ng ban","\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}getStatistics(){return s(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let t=yield a(this.http.get(`${this.apiUrl}/statistics`,{headers:this.getHeaders()}));return this.Statistics.set(t),t}catch(t){throw this.error.set(t.message||"L\u1ED7i khi t\u1EA3i th\u1ED1ng k\xEA"),this.snackBar.open("L\u1ED7i khi t\u1EA3i th\u1ED1ng k\xEA","\u0110\xF3ng",{duration:3e3}),t}finally{this.loading.set(!1)}})}getPhongbanById(t){return s(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let e=yield a(this.http.get(`${this.apiUrl}/${t}`,{headers:this.getHeaders()}));return this.DetailPhongban.set(e),e}catch(e){throw this.error.set(e.message||"L\u1ED7i khi t\u1EA3i chi ti\u1EBFt ph\xF2ng ban"),this.snackBar.open("L\u1ED7i khi t\u1EA3i chi ti\u1EBFt ph\xF2ng ban","\u0110\xF3ng",{duration:3e3}),e}finally{this.loading.set(!1)}})}getPhongbanByMa(t){return s(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let e=yield a(this.http.get(`${this.apiUrl}/ma/${t}`,{headers:this.getHeaders()}));return this.DetailPhongban.set(e),e}catch(e){throw this.error.set(e.message||"L\u1ED7i khi t\u1EA3i ph\xF2ng ban"),this.snackBar.open("L\u1ED7i khi t\u1EA3i ph\xF2ng ban","\u0110\xF3ng",{duration:3e3}),e}finally{this.loading.set(!1)}})}createPhongban(t){return s(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let e=yield a(this.http.post(this.apiUrl,t,{headers:this.getHeaders()}));return this.snackBar.open("T\u1EA1o ph\xF2ng ban th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),yield this.getAllPhongban(),e}catch(e){let n=e.error?.message||"L\u1ED7i khi t\u1EA1o ph\xF2ng ban";throw this.error.set(n),this.snackBar.open(n,"\u0110\xF3ng",{duration:3e3}),e}finally{this.loading.set(!1)}})}updatePhongban(t,e){return s(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let n=yield a(this.http.patch(`${this.apiUrl}/${t}`,e,{headers:this.getHeaders()}));return this.snackBar.open("C\u1EADp nh\u1EADt ph\xF2ng ban th\xE0nh c\xF4ng","\u0110\xF3ng",{duration:3e3}),yield this.getAllPhongban(),n}catch(n){let i=n.error?.message||"L\u1ED7i khi c\u1EADp nh\u1EADt ph\xF2ng ban";throw this.error.set(i),this.snackBar.open(i,"\u0110\xF3ng",{duration:3e3}),n}finally{this.loading.set(!1)}})}deletePhongban(t){return s(this,null,function*(){try{this.loading.set(!0),this.error.set(null);let e=yield a(this.http.delete(`${this.apiUrl}/${t}`,{headers:this.getHeaders()}));return this.snackBar.open(e.message,"\u0110\xF3ng",{duration:3e3}),yield this.getAllPhongban(),e}catch(e){let n=e.error?.message||"L\u1ED7i khi x\xF3a ph\xF2ng ban";throw this.error.set(n),this.snackBar.open(n,"\u0110\xF3ng",{duration:3e3}),e}finally{this.loading.set(!1)}})}clearError(){this.error.set(null)}reset(){this.ListPhongban.set([]),this.PhongbanTree.set([]),this.DetailPhongban.set(null),this.Statistics.set(null),this.loading.set(!1),this.error.set(null)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};export{u as a};
