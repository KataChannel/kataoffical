import './polyfills.server.mjs';
import{e as Ae}from"./chunk-CNJ7QSOI.mjs";import{a as Ie}from"./chunk-CKTW2Y2H.mjs";import{a as Le}from"./chunk-3DNZHT2T.mjs";import{a as Oe}from"./chunk-5SWEIAWE.mjs";import{a as Ne}from"./chunk-CJGHUN7A.mjs";import"./chunk-73IBRO6I.mjs";import{c as ve,f as we}from"./chunk-OSR76MA5.mjs";import{b as Fe}from"./chunk-UG4NV5SZ.mjs";import{a as se,b as ce,c as at,d as de,e as ue}from"./chunk-M4J2MUAR.mjs";import{e as le}from"./chunk-4CVVRMK6.mjs";import{a as Ut,b as Qt,c as Xt,d as J,f as Z,g as Jt,h as tt}from"./chunk-QQBP4AU2.mjs";import{a as Bt,b as Gt,c as zt}from"./chunk-QB764O3U.mjs";import{a as $t,b as Rt,c as Yt,d as Ht}from"./chunk-Q2TTBLPO.mjs";import"./chunk-Y5GM6BPP.mjs";import{a as Vt}from"./chunk-MIPBML43.mjs";import{a as Pe,b as it}from"./chunk-HZUVE6S4.mjs";import{a as ot}from"./chunk-BDGBI6HK.mjs";import"./chunk-IZQHBKKJ.mjs";import"./chunk-MGIVCIKU.mjs";import{a as Ee,b as Me,c as ke,k as Te}from"./chunk-EHNX2KTB.mjs";import{a as et,b as nt,c as me,d as pe,e as he,g as ge,h as _e,j as xe,k as fe,m as Ce,n as be,p as ye,q as De,r as Se,s as _t}from"./chunk-VWZQI7JC.mjs";import{b as re}from"./chunk-I2TU747W.mjs";import{b as qt,g as jt,j as Wt,n as Kt,p as Zt,r as te,s as ee,v as ne,w as ae,y as ie,z as oe}from"./chunk-K5JBZREZ.mjs";import"./chunk-YHY2PH7R.mjs";import{a as Q,b as X}from"./chunk-VSF3PFK7.mjs";import"./chunk-XS2QDODU.mjs";import"./chunk-3KDPKSHC.mjs";import{a as W,c as K,e as U}from"./chunk-7EPSYLRI.mjs";import{_ as At,y as Lt,z as Ot}from"./chunk-QKIZLTPN.mjs";import{c as Tt,d as Ft,g as ht,h as gt,j as Pt}from"./chunk-7T6LZHUD.mjs";import{b as Nt,d as It}from"./chunk-NES7BRLR.mjs";import"./chunk-EFFACMZL.mjs";import{m as Et,n as Mt,o as kt,v as q,x as j}from"./chunk-XQ6Z6XLV.mjs";import{$c as St,Bc as G,Cc as z,Dc as $,Fb as B,Gc as S,Hc as l,Ic as C,Jc as _,Kc as pt,Lc as yt,Mb as b,Mc as R,Nc as Y,Oc as H,Qc as Dt,Wc as y,Xb as ut,Yb as f,Yc as D,_b as V,dc as w,fc as ft,gc as I,hc as L,ic as i,jc as r,kc as k,kd as vt,lc as Ct,mc as bt,oc as P,pa as v,tb as s,tc as x,vc as d,xd as wt,ya as h,yb as dt,za as g,zc as mt}from"./chunk-5IMI5WTE.mjs";import"./chunk-XAZRL6IZ.mjs";import{a as N,b as st,h as ct,j as M}from"./chunk-RIAI3ORJ.mjs";var Ve=(a,e)=>e.id||a;function We(a,e){a&1&&(i(0,"div",9)(1,"div",14),k(2,"mat-spinner",15),i(3,"p",16),l(4,"\u0110ang t\u1EA3i d\u1EEF li\u1EC7u..."),r()()())}function Ke(a,e){if(a&1&&(i(0,"div",26)(1,"div",33)(2,"mat-icon",34),l(3,"inbox"),r()(),i(4,"p",35),l(5,"Ch\u01B0a c\xF3 d\u1EEF li\u1EC7u \u0111\u1EB7t h\xE0ng"),r(),i(6,"p",36),l(7,"Kh\xF4ng t\xECm th\u1EA5y \u0111\u01A1n \u0111\u1EB7t h\xE0ng n\xE0o cho s\u1EA3n ph\u1EA9m n\xE0y"),r(),i(8,"div",37)(9,"p"),l(10,"M\xE3 SP: "),i(11,"span",38),l(12),r()()()()),a&2){let t=d(2);s(12),C(t.data.product==null?null:t.data.product.masp)}}function Ue(a,e){if(a&1&&(i(0,"tr",43)(1,"td",44),l(2),r(),i(3,"td",45),l(4),r(),i(5,"td",46),l(6),y(7,"number"),r(),i(8,"td",47),l(9),y(10,"number"),r(),i(11,"td",48)(12,"span",49),l(13),r()()()),a&2){let t=e.$implicit,n=d(3);s(2),C(t.madathang||t.id||"N/A"),s(2),_(" ",n.formatDateForDisplay(t.ngaydat||t.createdAt,"DD/MM/YYYY")," "),s(2),_(" ",D(7,6,t.sldat||t.soluong||0,"1.0-0")," "),s(3),_(" ",D(10,9,t.slnhan||t.soluongnhan||0,"1.0-0")," "),s(3),f("ngClass",n.getDathangStatusClass(t.trangthai||t.status)),s(),_(" ",n.getStatusText(t.trangthai||t.status)," ")}}function Qe(a,e){if(a&1&&(i(0,"div",27)(1,"table",39)(2,"thead")(3,"tr",40)(4,"th",41),l(5,"M\xE3 \u0110\u1EB7t H\xE0ng"),r(),i(6,"th",41),l(7,"Ng\xE0y \u0110\u1EB7t"),r(),i(8,"th",42),l(9,"SL \u0110\u1EB7t"),r(),i(10,"th",42),l(11,"SL Nh\u1EADn"),r(),i(12,"th",41),l(13,"Tr\u1EA1ng Th\xE1i"),r()()(),i(14,"tbody"),I(15,Ue,14,12,"tr",43,Ve),r()()()),a&2){let t=d(2);s(15),L(t.data.dathangData)}}function Xe(a,e){if(a&1&&(i(0,"div",26)(1,"div",50)(2,"mat-icon",51),l(3,"inbox"),r()(),i(4,"p",35),l(5,"Ch\u01B0a c\xF3 d\u1EEF li\u1EC7u \u0111\u01A1n h\xE0ng"),r(),i(6,"p",36),l(7,"Kh\xF4ng t\xECm th\u1EA5y \u0111\u01A1n h\xE0ng n\xE0o cho s\u1EA3n ph\u1EA9m n\xE0y"),r(),i(8,"div",37)(9,"p"),l(10,"M\xE3 SP: "),i(11,"span",38),l(12),r()()()()),a&2){let t=d(2);s(12),C(t.data.product==null?null:t.data.product.masp)}}function Je(a,e){if(a&1&&(i(0,"tr",55)(1,"td",44),l(2),r(),i(3,"td",45),l(4),r(),i(5,"td",56),l(6),y(7,"number"),r(),i(8,"td",47),l(9),y(10,"number"),r(),i(11,"td",57),l(12),y(13,"number"),r(),i(14,"td",48)(15,"span",49),l(16),r()()()),a&2){let t=e.$implicit,n=d(3);s(2),C(t.madonhang||t.id||"N/A"),s(2),_(" ",n.formatDateForDisplay(t.ngaygiao||t.deliveryDate||t.createdAt,"DD/MM/YYYY")," "),s(2),_(" ",D(7,7,t.sldat||t.soluong||0,"1.0-0")," "),s(3),_(" ",D(10,10,t.slgiao||t.soluonggiao||0,"1.0-0")," "),s(3),_(" ",D(13,13,t.slnhan||t.soluongnhan||0,"1.0-0")," "),s(3),f("ngClass",n.getDonhangStatusClass(t.trangthai||t.status)),s(),_(" ",n.getStatusText(t.trangthai||t.status)," ")}}function Ze(a,e){if(a&1&&(i(0,"div",27)(1,"table",39)(2,"thead")(3,"tr",52)(4,"th",53),l(5,"M\xE3 \u0110\u01A1n H\xE0ng"),r(),i(6,"th",53),l(7,"Ng\xE0y Giao"),r(),i(8,"th",54),l(9,"SL \u0110\u1EB7t"),r(),i(10,"th",54),l(11,"SL Giao"),r(),i(12,"th",54),l(13,"SL Nh\u1EADn"),r(),i(14,"th",53),l(15,"Tr\u1EA1ng Th\xE1i"),r()()(),i(16,"tbody"),I(17,Je,17,16,"tr",55,Ve),r()()()),a&2){let t=d(2);s(17),L(t.data.donhangData)}}function tn(a,e){if(a&1&&(i(0,"div",10)(1,"div",17)(2,"div",18)(3,"div",19)(4,"div",20)(5,"div",21)(6,"mat-icon",22),l(7,"shopping_cart"),r()(),i(8,"h4",23),l(9,"\u0110\u1EB7t H\xE0ng"),r(),i(10,"span",24),l(11),r()()()(),i(12,"div",25),b(13,Ke,13,1,"div",26)(14,Qe,17,0,"div",27),r()(),i(15,"div",28)(16,"div",29)(17,"div",19)(18,"div",20)(19,"div",30)(20,"mat-icon",22),l(21,"local_shipping"),r()(),i(22,"h4",31),l(23,"\u0110\u01A1n H\xE0ng"),r(),i(24,"span",32),l(25),r()()()(),i(26,"div",25),b(27,Xe,13,1,"div",26)(28,Ze,19,0,"div",27),r()()()),a&2){let t=d();s(11),_(" ",t.data.dathangData.length," "),s(2),w(t.data.dathangData.length===0?13:14),s(12),_(" ",t.data.donhangData.length," "),s(2),w(t.data.donhangData.length===0?27:28)}}var rt=class a{constructor(e,t){this.dialogRef=e;this.data=t}timezoneService=v(ot);cdr=v(vt);ngOnInit(){console.log("Dialog initialized with data:",this.data),this.data&&(this.data.triggerChangeDetection=()=>{console.log("Triggering change detection, loading:",this.data.loading),this.cdr.detectChanges()})}triggerChangeDetection(){this.cdr.detectChanges()}closeDialog(){this.dialogRef.close()}formatDateForDisplay(e,t="DD/MM/YYYY"){return this.timezoneService.formatForDisplay(e,t)}getDathangStatusClass(e){return{"bg-green-100 text-green-800":e==="completed","bg-yellow-100 text-yellow-800":e==="pending","bg-blue-100 text-blue-800":e==="processing","bg-gray-100 text-gray-800":!e||e==="unknown"}}getDonhangStatusClass(e){return{"bg-green-100 text-green-800":e==="delivered","bg-blue-100 text-blue-800":e==="shipping","bg-yellow-100 text-yellow-800":e==="pending","bg-orange-100 text-orange-800":e==="processing","bg-gray-100 text-gray-800":!e||e==="unknown"}}getStatusText(e){return{completed:"Ho\xE0n th\xE0nh",pending:"Ch\u1EDD x\u1EED l\xFD",processing:"\u0110ang x\u1EED l\xFD",delivered:"\u0110\xE3 giao",shipping:"\u0110ang giao",cancelled:"\u0110\xE3 h\u1EE7y"}[e]||e||"Kh\xF4ng x\xE1c \u0111\u1ECBnh"}static \u0275fac=function(t){return new(t||a)(dt(Ut),dt(Qt))};static \u0275cmp=B({type:a,selectors:[["app-nested-data-dialog"]],decls:24,vars:5,consts:[[1,"flex","items-center","justify-between","p-4"],[1,"flex","items-center","space-x-3"],[1,"bg-white","bg-opacity-20","p-2","rounded-full"],["color","primary",1,"text-white"],[1,"text-xl","font-bold"],[1,"text-blue-100","text-sm"],[1,"font-mono","bg-white","bg-opacity-20","px-2","py-1","rounded"],["mat-icon-button","","matTooltip","\u0110\xF3ng",1,"text-white","hover:bg-white","hover:bg-opacity-20","transition-colors","duration-200",3,"click"],[1,"mat-typography"],[1,"flex","items-center","justify-center","py-16"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],["align","end"],["mat-button","","color","warn","mat-dialog-close",""],["mat-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"],[1,"text-center"],["diameter","50",1,"mx-auto","mb-4"],[1,"text-gray-600","text-lg","animate-pulse"],[1,"bg-blue-50","rounded-lg","border","border-blue-200","overflow-hidden"],[1,"bg-blue-100","px-4","py-3","border-b","border-blue-200"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-2"],[1,"bg-blue-500","p-1","rounded-full"],[1,"text-white","text-sm"],[1,"font-semibold","text-blue-800"],[1,"bg-blue-200","text-blue-800","px-2","py-1","rounded-full","text-xs","font-medium"],[1,"p-4","max-h-96","overflow-y-auto"],[1,"text-center","py-8"],[1,"overflow-x-auto"],[1,"bg-green-50","rounded-lg","border","border-green-200","overflow-hidden"],[1,"bg-green-100","px-4","py-3","border-b","border-green-200"],[1,"bg-green-500","p-1","rounded-full"],[1,"font-semibold","text-green-800"],[1,"bg-green-200","text-green-800","px-2","py-1","rounded-full","text-xs","font-medium"],[1,"bg-blue-100","p-4","rounded-full","w-16","h-16","mx-auto","mb-4","flex","items-center","justify-center"],[1,"text-4xl","text-blue-300"],[1,"text-gray-500","font-medium"],[1,"text-gray-400","text-sm","mt-1"],[1,"mt-3","text-xs","text-gray-400"],[1,"font-mono"],[1,"w-full","border-collapse"],[1,"border-b","border-blue-200"],[1,"text-left","p-2","text-xs","font-semibold","text-blue-800"],[1,"text-right","p-2","text-xs","font-semibold","text-blue-800"],[1,"border-b","border-blue-100","hover:bg-blue-50","transition-colors","duration-150"],[1,"p-2","font-mono","text-xs"],[1,"p-2","text-xs"],[1,"p-2","text-right","text-xs","font-semibold","text-blue-700"],[1,"p-2","text-right","text-xs","font-semibold","text-green-600"],[1,"p-2"],[1,"px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"bg-green-100","p-4","rounded-full","w-16","h-16","mx-auto","mb-4","flex","items-center","justify-center"],[1,"text-4xl","text-green-300"],[1,"border-b","border-green-200"],[1,"text-left","p-2","text-xs","font-semibold","text-green-800"],[1,"text-right","p-2","text-xs","font-semibold","text-green-800"],[1,"border-b","border-green-100","hover:bg-green-50","transition-colors","duration-150"],[1,"p-2","text-right","text-xs","font-semibold","text-blue-600"],[1,"p-2","text-right","text-xs","font-semibold","text-purple-600"]],template:function(t,n){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),l(4,"inventory_2"),r()(),i(5,"div"),l(6),i(7,"h3",4),l(8),r(),i(9,"p",5),l(10," M\xE3 SP: "),i(11,"span",6),l(12),r()()()(),i(13,"button",7),x("click",function(){return n.closeDialog()}),i(14,"mat-icon"),l(15,"close"),r()()(),i(16,"mat-dialog-content",8),b(17,We,5,0,"div",9)(18,tn,29,4,"div",10),r(),i(19,"mat-dialog-actions",11)(20,"button",12),l(21,"Cancel"),r(),i(22,"button",13),l(23,"Install"),r()()),t&2&&(s(6),_(" ",n.data.loading," "),s(2),C((n.data.product==null?null:n.data.product.title)||"Chi ti\u1EBFt s\u1EA3n ph\u1EA9m"),s(4),C((n.data.product==null?null:n.data.product.masp)||"N/A"),s(5),w(n.data.loading?17:18),s(5),f("mat-dialog-close",!0))},dependencies:[j,Et,q,tt,J,Jt,Z,U,W,K,X,Q,it,Pe,nt,et],styles:[".mat-mdc-dialog-container[_ngcontent-%COMP%]{max-width:95vw!important;max-height:95vh!important}.p-4.max-h-96.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.p-4.max-h-96.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0000001a;border-radius:3px}.p-4.max-h-96.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#0000004d;border-radius:3px}.p-4.max-h-96.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#00000080}.border-b.hover\\:bg-blue-50[_ngcontent-%COMP%]:hover{background-color:#3b82f60d!important}.border-b.hover\\:bg-green-50[_ngcontent-%COMP%]:hover{background-color:#22c55e0d!important}.mat-mdc-dialog-content[_ngcontent-%COMP%]{padding:0 24px!important}.bg-gradient-to-r.from-blue-600.to-blue-700[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2563eb,#1d4ed8)}.animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.px-2.py-1.rounded-full.text-xs.font-medium[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;min-width:60px;text-align:center;font-weight:600;letter-spacing:.025em}@media (max-width: 1024px){.grid.grid-cols-1.lg\\:grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:1fr}.mat-mdc-dialog-container[_ngcontent-%COMP%]{max-width:98vw!important;margin:8px}}.text-4xl.text-blue-300[_ngcontent-%COMP%], .text-4xl.text-green-300[_ngcontent-%COMP%]{font-size:3rem;opacity:.6}"],changeDetection:0})};var en=["drawer"],nn=()=>({standalone:!0}),an=(a,e)=>e.key;function on(a,e){a&1&&(i(0,"div",37),l(1," \u26A0\uFE0F C\xF3 thay \u0111\u1ED5i ng\xE0y ch\u01B0a \u0111\u01B0\u1EE3c \xE1p d\u1EE5ng "),r())}function rn(a,e){if(a&1){let t=P();i(0,"button",65),x("click",function(o){let c=h(t).$implicit;return d().toggleColumn(c),g(o.stopPropagation())}),i(1,"mat-icon"),l(2),r(),i(3,"span"),l(4),r()()}if(a&2){let t=e.$implicit;s(2),C(t.isShow?"check_box":"check_box_outline_blank"),s(2),C(t.value)}}function ln(a,e){if(a&1&&(i(0,"span",48),l(1),r()),a&2){let t=d();s(),pt(" \u{1F4C5} ",t.formatDateForDisplay(t.batdau,"DD/MM")," - ",t.formatDateForDisplay(t.ketthuc,"DD/MM")," ")}}function sn(a,e){a&1&&k(0,"span")}function cn(a,e){if(a&1&&(i(0,"div",25)(1,"span",80),l(2),r(),i(3,"span",81,7),l(5," filter_alt "),r()()),a&2){d();let t=S(4),n=d().$implicit,o=d();s(2),_(" ",o.ColumnName[n]," "),s(),mt("matTooltip","Filter ",o.ColumnName[n],""),f("matMenuTriggerFor",t)}}function dn(a,e){a&1&&(i(0,"span",85),l(1,"check"),r())}function un(a,e){a&1&&k(0,"span",86)}function mn(a,e){if(a&1&&(i(0,"span"),l(1),r()),a&2){let t=d().$implicit,n=d(2).$implicit,o=d();s(),C(o.formatDateForDisplay(t[n],"DD/MM/YYYY"))}}function pn(a,e){if(a&1&&(i(0,"span"),l(1),r()),a&2){let t=d().$implicit,n=d(2).$implicit,o=d();s(),C(o.formatDateForDisplay(t[n],"DD/MM/YYYY"))}}function hn(a,e){if(a&1&&(i(0,"span"),l(1),r()),a&2){let t=d().$implicit,n=d(2).$implicit,o=d();s(),C(o.formatDateForDisplay(t[n],"DD/MM/YYYY"))}}function gn(a,e){if(a&1&&(i(0,"span"),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d(2).$implicit;s(),C(D(2,1,t[n],"1.0-0"))}}function _n(a,e){if(a&1&&(i(0,"span"),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d(2).$implicit;s(),C(D(2,1,t[n],"1.0-0"))}}function xn(a,e){if(a&1&&(i(0,"span"),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d(2).$implicit;s(),C(D(2,1,t[n],"1.0-0"))}}function fn(a,e){if(a&1&&(i(0,"span"),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d(2).$implicit;s(),C(D(2,1,t[n],"1.0-0"))}}function Cn(a,e){if(a&1&&(i(0,"span"),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d(2).$implicit;s(),C(D(2,1,t[n],"1.0-0"))}}function bn(a,e){if(a&1&&(i(0,"span"),l(1),r()),a&2){let t=d().$implicit,n=d(3);s(),C(n.GetGoiy(t))}}function yn(a,e){if(a&1&&(i(0,"span"),l(1),r()),a&2){let t=d().$implicit,n=d(2).$implicit;s(),C(t[n]||"Tr\u1ED1ng")}}function Dn(a,e){if(a&1){let t=P();i(0,"div",82),x("click",function(){let o=h(t).$implicit,c=d(2).$implicit,u=d();return g(u.ChosenItem(o,c))}),b(1,dn,2,0,"span",83)(2,un,1,0,"span",84)(3,mn,2,1,"span")(4,pn,2,1,"span")(5,hn,2,1,"span")(6,gn,3,4,"span")(7,_n,3,4,"span")(8,xn,3,4,"span")(9,fn,3,4,"span")(10,Cn,3,4,"span")(11,bn,2,1,"span")(12,yn,2,1,"span"),r()}if(a&2){let t,n=e.$implicit,o=d(2).$implicit,c=d();s(),f("ngIf",c.CheckItem(n)),s(),f("ngIf",!c.CheckItem(n)),s(),w((t=o)==="createdAt"?3:t==="updatedAt"?4:t==="ngaynhan"?5:t==="slton"?6:t==="slchogiao"?7:t==="slchonhap"?8:t==="SLDat"?9:t==="SLGiao"?10:t==="goiy"?11:12)}}function Sn(a,e){if(a&1){let t=P();i(0,"th",68),b(1,sn,1,0,"span")(2,cn,6,4,"div",25),i(3,"mat-menu",69,10)(5,"div",70),x("click",function(o){return h(t),g(o.stopPropagation())}),i(6,"div",71)(7,"input",72),x("keyup",function(o){h(t);let c=d().$implicit,u=d();return g(u.doFilterHederColumn(o,c))}),r(),i(8,"div",18)(9,"span",19),l(10,"search"),r()()(),i(11,"div",73)(12,"div",74)(13,"span",75),x("click",function(){h(t);let o=d().$implicit,c=d();return g(c.ChosenAll(c.getCurrentFilteredData(o)))}),l(14),r(),i(15,"span",75),x("click",function(){h(t);let o=d(2);return g(o.EmptyFiter())}),l(16,"Xo\xE1"),r()(),i(17,"span",75),x("click",function(){h(t);let o=d(2);return g(o.ResetFilter())}),l(18,"Reset"),r()(),i(19,"div",76),b(20,Dn,13,3,"div",77),r(),i(21,"div",78)(22,"button",79),x("click",function(){h(t),d(2);let o=S(98);return g(o.closeMenu())}),l(23,"\u0110\xF3ng"),r(),i(24,"button",62),x("click",function(){h(t);let o=d(2),c=S(98);return g(o.ApplyFilterColum(c))}),l(25,"\xC1p D\u1EE5ng"),r()()()()()}if(a&2){let t=d().$implicit,n=d();s(),w(t==="expand"?1:2),s(6),mt("placeholder","T\xECm ki\u1EBFm ",n.ColumnName[t],"..."),s(7),_(" Ch\u1ECDn T\u1EA5t C\u1EA3 (",n.getCurrentFilteredData(t).length||0,") "),s(6),f("ngForOf",n.getCurrentFilteredData(t))("ngForTrackBy",n.trackByFn)}}function vn(a,e){a&1&&(i(0,"div",103),k(1,"div",105),r())}function wn(a,e){if(a&1&&(i(0,"span",104),l(1),r()),a&2){let t=d(2).$implicit,n=d(2);s(),_(" ",n.getTotalNestedDataCount(t.masp)," ")}}function En(a,e){if(a&1){let t=P();i(0,"div",88)(1,"button",101),x("click",function(o){h(t);let c=d().$implicit;return d(2).toggleExpanded(c),g(o.stopPropagation())}),i(2,"mat-icon",102),l(3," visibility "),r(),b(4,vn,2,0,"div",103),r(),b(5,wn,2,1,"span",104),r()}if(a&2){let t=d().$implicit,n=d(2);s(),f("matTooltip","Xem \u0111\u1EB7t h\xE0ng & \u0111\u01A1n h\xE0ng"),ut("aria-label","Xem chi ti\u1EBFt"),s(3),w(n.isAnyDataLoading(t.masp)?4:-1),s(),w(n.hasNestedData(t.masp)?5:-1)}}function Mn(a,e){if(a&1&&(i(0,"span",89),l(1),r()),a&2){let t=d().index;s(),_(" ",t+1," ")}}function kn(a,e){if(a&1&&(i(0,"span",90),l(1),r()),a&2){let t=d().$implicit,n=d().$implicit;f("matTooltip",t[n]),s(),_(" ",t[n]," ")}}function Tn(a,e){if(a&1&&(i(0,"span",91),l(1),r()),a&2){let t=d().$implicit,n=d().$implicit;s(),_(" ",t[n]," ")}}function Fn(a,e){if(a&1&&(i(0,"span",106),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d().$implicit;V("text-red-600",t[n]<=0)("text-green-600",t[n]>0),s(),_(" ",D(2,5,t[n],"1.0-0")," ")}}function Pn(a,e){if(a&1&&(i(0,"span",93),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d().$implicit;s(),_(" ",D(2,1,t[n],"1.0-0")," ")}}function Nn(a,e){if(a&1&&(i(0,"span",94),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d().$implicit;s(),_(" ",D(2,1,t[n],"1.0-0")," ")}}function In(a,e){if(a&1&&(i(0,"span",95),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d().$implicit;s(),_(" ",D(2,1,t[n],"1.0-0")," ")}}function Ln(a,e){if(a&1&&(i(0,"span",96),l(1),y(2,"number"),r()),a&2){let t=d().$implicit,n=d().$implicit;s(),_(" ",D(2,1,t[n],"1.0-0")," ")}}function On(a,e){if(a&1&&(i(0,"span",107),l(1),r()),a&2){let t=d().$implicit,n=d(2);V("text-red-600",n.parseFloat(n.GetGoiy(t))>0)("text-gray-400",n.parseFloat(n.GetGoiy(t))==0),s(),_(" ",n.GetGoiy(t)," ")}}function An(a,e){if(a&1&&(i(0,"span",98),l(1),r()),a&2){let t=d().$implicit,n=d().$implicit,o=d();s(),_(" ",o.formatDateForDisplay(t[n],"DD/MM/YYYY")," ")}}function Vn(a,e){if(a&1&&(i(0,"span",98),l(1),r()),a&2){let t=d().$implicit,n=d().$implicit,o=d();s(),_(" ",o.formatDateForDisplay(t[n],"DD/MM/YYYY")," ")}}function Bn(a,e){if(a&1&&(i(0,"span",98),l(1),r()),a&2){let t=d().$implicit,n=d().$implicit,o=d();s(),_(" ",o.formatDateForDisplay(t[n],"DD/MM/YYYY")," ")}}function Gn(a,e){a&1&&(i(0,"mat-icon",108),l(1,"check_circle"),r())}function zn(a,e){a&1&&(i(0,"mat-icon",109),l(1,"cancel"),r())}function $n(a,e){if(a&1&&(i(0,"span",99),b(1,Gn,2,0,"mat-icon",108)(2,zn,2,0,"mat-icon",109),r()),a&2){let t=d().$implicit,n=d().$implicit;s(),w(t[n]?1:2)}}function Rn(a,e){if(a&1&&(i(0,"span",100),l(1),r()),a&2){let t=d().$implicit,n=d().$implicit;f("matTooltip",t[n]),s(),_(" ",t[n]," ")}}function Yn(a,e){if(a&1&&(i(0,"td",87),b(1,En,6,4,"div",88)(2,Mn,2,1,"span",89)(3,kn,2,2,"span",90)(4,Tn,2,1,"span",91)(5,Fn,3,8,"span",92)(6,Pn,3,4,"span",93)(7,Nn,3,4,"span",94)(8,In,3,4,"span",95)(9,Ln,3,4,"span",96)(10,On,2,5,"span",97)(11,An,2,1,"span",98)(12,Vn,2,1,"span",98)(13,Bn,2,1,"span",98)(14,$n,3,1,"span",99)(15,Rn,2,2,"span",100),r()),a&2){let t,n=d().$implicit;s(),w((t=n)==="expand"?1:t==="STT"?2:t==="title"?3:t==="masp"?4:t==="slton"?5:t==="slchogiao"?6:t==="slchonhap"?7:t==="SLDat"?8:t==="SLGiao"?9:t==="goiy"?10:t==="createdAt"?11:t==="updatedAt"?12:t==="ngaynhan"?13:t==="isActive"?14:15)}}function Hn(a,e){if(a&1&&(Ct(0,51),b(1,Sn,26,6,"th",66)(2,Yn,16,1,"td",67),bt()),a&2){let t=e.$implicit;f("matColumnDef",t)}}function qn(a,e){a&1&&k(0,"tr",110)}function jn(a,e){if(a&1){let t=P();i(0,"tr",111),x("click",function(){let o=h(t).$implicit,c=d();return g(c.AddToEdit(o))}),r()}if(a&2){let t=e.$implicit,n=d();V("bg-slate-200",n.CheckItemInEdit(t))}}function Wn(a,e){if(a&1&&(i(0,"tr",112)(1,"td",113)(2,"div",114)(3,"mat-icon",115),l(4,"search_off"),r(),i(5,"span"),l(6,"Kh\xF4ng t\xECm th\u1EA5y d\u1EEF li\u1EC7u"),r()()()()),a&2){let t=d();s(),ut("colspan",t.displayedColumns.length)}}function Kn(a,e){a&1&&(i(0,"mat-dialog-content")(1,"div",116)(2,"div",117),l(3,"X\xE1c Nh\u1EADn"),r(),i(4,"div"),l(5,"B\u1EA1n ch\u1EAFc ch\u1EAFn mu\u1ED1n xo\xE1 kh\xF4ng?"),r(),i(6,"div",118)(7,"button",119),l(8,"\u0110\u1ED3ng \xDD"),r(),i(9,"button",120),l(10,"Hu\u1EF7 B\u1ECF"),r()()()())}var O=class O{displayedColumns=["expand","title","masp","dvt","SLDat","goiy","SLGiao","slton","kho1","kho2","kho3","kho4","kho5","kho6","haohut","slhaohut"];ColumnName={expand:"",title:"T\xEAn S\u1EA3n Ph\u1EA9m",masp:"M\xE3 S\u1EA3n Ph\u1EA9m",dvt:"\u0110VT",SLDat:"SL \u0110\u1EB7t (Nh\xE0 CC)",goiy:"SL C\u1EA7n \u0110\u1EB7t (G\u1EE3i \xDD)",SLGiao:"SL Giao (Kh\xE1ch)",slton:"T\u1ED3n Kho",kho1:"TG-LONG AN",kho2:"B\u1ED5 Sung",kho3:"TG-\u0110\xC0 L\u1EA0T",kho4:"KHO T\u1ED4NG - HCM",kho5:"SG1",kho6:"SG2",haohut:"T\u1EC9 L\u1EC7 Hao H\u1EE5t",slhaohut:"SL Hao H\u1EE5t"};FilterColumns=JSON.parse(localStorage.getItem("NhucauColFilter")||"[]");Columns=[];totalItems=0;pageSize=10;currentPage=1;totalPages=1;paginator;sort;drawer;_SanphamService=v(Oe);_breakpointObserver=v(Lt);_GraphqlService=v(Ne);_router=v(It);_dialog=v(Xt);_timezoneService=v(ot);_DathangService=v(Ie);_DonhangService=v(Le);_snackBar=v(Vt);Listsanpham=this._SanphamService.ListSanpham;TonghopsFinal=[];EditList=[];dataSource=new _t;ListFilter=[];ListDathang=[];isSubmit=!1;quickFilter="all";globalFilterValue="";expandedElementId=null;dathangDataMap=new Map;donhangDataMap=new Map;loadingDathang=new Set;loadingDonhang=new Set;batdau=new Date;ketthuc=new Date;isDateRangeEnabled=!1;hasUnappliedDateChanges=!1;constructor(){wt(()=>{let e=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.dataSource.data=e,this.totalItems=e.length,this.calculateTotalPages()})}ngOnInit(){return M(this,null,function*(){let e=new Date;this.batdau=new Date(e),this.ketthuc=new Date(e),this.updateDisplayData(),this.loadDonhangWithRelations(),yield this._SanphamService.getNhucau(),this.dataSource=new _t(this.Listsanpham()),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource.sortingDataAccessor=(t,n)=>{switch(n){case"slton":case"slchogiao":case"slchonhap":case"SLDat":case"SLGiao":case"kho1":case"kho2":case"kho3":case"kho4":case"kho5":case"kho6":case"haohut":case"slhaohut":return Number(t[n])||0;case"goiy":return parseFloat(this.GetGoiy(t));case"title":case"masp":case"dvt":case"mancc":case"name":case"makho":case"namekho":return t[n]?.toLowerCase()||"";default:return t[n]?.toString().toLowerCase()||""}},this.initializeColumns(),this.setupDrawer()})}GetGoiy(e){if(e.SLGiao>e.SLDat){let t=e.SLGiao-e.SLDat,n=t*(e.haohut||0)/100;return(t+n).toFixed(0)}else return"0"}loadDonhangWithRelations(){return M(this,null,function*(){try{let e,t;if(this.isDateRangeEnabled&&this.batdau&&this.ketthuc){let m=this._timezoneService.getAPIDateRange(this.batdau,this.ketthuc);e=m.Batdau,t=m.Ketthuc}else{let m=new Date,p=this._timezoneService.getAPIDateRange(m,m);e=p.Batdau,t=p.Ketthuc}console.log(`Fetching data from ${e} to ${t}`);let[n,o,c,u]=yield Promise.all([this._GraphqlService.findAll("donhang",{enableParallelFetch:!0,batchSize:1e3,take:999999,aggressiveCache:!0,orderBy:{createdAt:"desc"},where:{ngaygiao:{gte:e,lte:t}},select:{id:!0,madonhang:!0,ngaygiao:!0,sanpham:{select:{giaban:!0,sldat:!0,slgiao:!0,slnhan:!0,sanpham:{select:{masp:!0}}}}}}),this._GraphqlService.findAll("dathang",{enableParallelFetch:!0,batchSize:1e3,take:999999,aggressiveCache:!0,orderBy:{createdAt:"desc"},where:{ngaynhan:{gte:e,lte:t}},select:{id:!0,madncc:!0,ngaynhan:!0,nhacungcap:{select:{name:!0,mancc:!0}},sanpham:{select:{sldat:!0,slgiao:!0,slnhan:!0,sanpham:{select:{masp:!0}}}},kho:{select:{name:!0,makho:!0}}}}),this._GraphqlService.findAll("tonkho",{enableParallelFetch:!0,aggressiveCache:!0,batchSize:1e3,take:999999,select:{id:!0,sanphamId:!0,slton:!0,slchogiao:!0,slchonhap:!0,sanpham:{select:{title:!0,masp:!0,dvt:!0,haohut:!0}}}}),this._GraphqlService.findAll("sanpham",{enableParallelFetch:!0,aggressiveCache:!0,batchSize:1e3,take:999999,select:{id:!0,title:!0,masp:!0,dvt:!0,haohut:!0}})]),E=n.data.flatMap(m=>m.sanpham.map(p=>({type:"donhang",madonhang:m.madonhang,ngaygiao:m.ngaygiao,masp:p.sanpham.masp,giaban:Number(p.giaban)||0,sldat:Number(p.sldat)||0,slgiao:Number(p.slgiao)||0,slnhan:Number(p.slnhan)||0}))),T=o.data.flatMap(m=>m.sanpham.map(p=>({type:"dathang",madncc:m.madncc,mancc:m.nhacungcap.mancc,name:m.nhacungcap.name,ngaynhan:m.ngaynhan,masp:p.sanpham.masp,sldat:Number(p.sldat)||0,slgiao:Number(p.slgiao)||0,slnhan:Number(p.slnhan)||0,makho:m.kho.makho,namekho:m.kho.name}))),lt=c.data.map(m=>({type:"tonkho",masp:m.sanpham.masp,title:m.sanpham.title,dvt:m.sanpham.dvt,haohut:m.sanpham.haohut||0,slton:Number(m.slton)||0,slchogiao:Number(m.slchogiao)||0,slchonhap:Number(m.slchonhap)||0}));console.log("Tonkhos",lt);let A=new Map;lt.forEach(m=>{A.set(m.masp,{id:le(8,!1),ngaynhan:m.ngaynhan,mancc:m.mancc,name:m.name,masp:m.masp,title:m.title,dvt:m.dvt,haohut:m.haohut||0,slton:m.slton,slchogiao:m.slchogiao,slchonhap:m.slchonhap,SLDat:0,SLGiao:0})}),T.forEach(m=>{if(A.has(m.masp)){let p=A.get(m.masp);p.SLDat+=m.sldat,p.ngaynhan=m.ngaynhan,p.mancc=m.mancc,p.name=m.name,p.makho=m.makho,p.namekho=m.namekho}}),E.forEach(m=>{if(A.has(m.masp)){let p=A.get(m.masp);p.SLGiao+=m.slnhan}});let xt=u.data;console.log("Donhangs:",n),console.log("Dathangs:",o),console.log("Tonkhos:",c),console.log("Sanphams:",xt),console.log("DonhangsTranfer:",E),console.log("DathangsTranfer:",T),this.TonghopsFinal=xt.map(m=>st(N({},m),{Dathangs:T.filter(p=>p.masp===m.masp),Donhangs:E.filter(p=>p.masp===m.masp),SLDat:T.reduce((p,F)=>F.masp===m.masp?p+F.sldat:p,0),SLGiao:E.reduce((p,F)=>F.masp===m.masp?p+F.sldat:p,0),slton:lt.reduce((p,F)=>F.masp===m.masp?p+F.slton:p,0)})),console.log("Sanphams with orders:",this.TonghopsFinal),this.dataSource.data=this.TonghopsFinal,this.totalItems=this.TonghopsFinal.length,this.calculateTotalPages(),this.updateDisplayData()}catch(e){console.error("Error loading data:",e),this._snackBar.open("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}refresh(){return M(this,null,function*(){this.expandedElementId=null,yield this._SanphamService.getAllSanpham(),yield this.loadDonhangWithRelations()})}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(e=>({key:e,value:this.ColumnName[e],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("NhucauColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{})}setupDrawer(){this._breakpointObserver.observe([Ot.Handset]).subscribe(e=>{e.matches?this.drawer.mode="over":this.drawer.mode="side"})}toggleColumn(e){let t=this.FilterColumns.find(n=>n.key===e.key);t&&(t.isShow=!t.isShow,this.updateDisplayedColumns())}doFilterHederColumn(e,t){let n=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.dataSource.filteredData=n.filter(o=>o[t]?.toString().toLowerCase().includes(e.target.value.toLowerCase()))}applyAdvancedColumnFilter(e,t){let n=e.target.value.toLowerCase();if(!n){this.getCurrentFilteredData(t);return}let c=(this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham()).filter(u=>u[t]?.toString().toLowerCase().includes(n));this.dataSource.filteredData=c}ChosenItem(e,t){let n=this.dataSource.filteredData.filter(c=>c[t]===e[t]);this.ListFilter.filter(c=>c[t]===e[t]).length>0?this.ListFilter=this.ListFilter.filter(c=>c[t]!==e[t]):this.ListFilter=[...this.ListFilter,...n]}ChosenAll(e){e.forEach(t=>{this.ListFilter.find(o=>o.id===t.id)?this.ListFilter=this.ListFilter.filter(o=>o.id!==t.id):this.ListFilter.push(t)})}ResetFilter(){let e=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.ListFilter=e,this.dataSource.data=e,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}EmptyFiter(){this.ListFilter=[]}CheckItem(e){return!!this.ListFilter.find(t=>t.masp===e.masp||t.id===e.id)}ApplyFilterColum(e){let t=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.dataSource.data=t.filter(n=>this.ListFilter.some(o=>o.masp===n.masp)),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,e.closeMenu()}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(e=>e.isShow).map(e=>e.key),this.ColumnName=this.FilterColumns.reduce((e,t)=>(t.isShow&&(e[t.key]=t.value),e),{}),localStorage.setItem("NhucauColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(e){let t=e.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(n=>n.value.toLowerCase().includes(t))}AddToEdit(e){this.EditList.find(n=>n.masp===e.masp||n.id===e.id)?this.EditList=this.EditList.filter(n=>n.masp!==e.masp&&n.id!==e.id):this.EditList.push(e)}ChoseAllEdit(){let e=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.EditList=e}CheckItemInEdit(e){return this.EditList.some(t=>t.masp===e.masp||t.id===e.id)}onListDathangChange(e){this.isSubmit=e.isSubmit,this.ListDathang=e.ListDathang}ImporExcel(e){return M(this,null,function*(){let n=(yield we(e)).map(u=>({title:u.title?.trim()||"",masp:u.masp?.trim()||"",giagoc:Number(u.giagoc)||0,dvt:u.dvt?.trim()||"",soluong:Number(u.soluong)||0,soluongkho:Number(u.soluongkho)||0,haohut:Number(u.haohut)||0,ghichu:u.ghichu?.trim()||""})),o=Array.from(new Map(n.map(u=>[u.masp,u])).values()),c=this._SanphamService.ListSanpham();yield Promise.all(o.map(u=>M(this,null,function*(){let E=c.find(T=>T.masp===u.masp);if(E){let T=N(N({},E),u);yield this._SanphamService.updateSanpham(T)}else yield this._SanphamService.CreateSanpham(u)}))),yield Promise.all(c.filter(u=>!o.some(E=>E.masp===u.masp)).map(u=>this._SanphamService.updateSanpham(st(N({},u),{isActive:!1})))),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ExportExcel(e,t){return M(this,null,function*(){let n=e.map(u=>({title:u.title||"",masp:u.masp||"",mancc:u.mancc||"",name:u.name||"",makho:u.makho||"",namekho:u.namekho||"",slton:u.slton||0,slchogiao:u.slchogiao||0,slchonhap:u.slchonhap||0,SLDat:u.SLDat||0,SLGiao:u.SLGiao||0,goiy:u.goiy||0})),o={title:"T\xEAn S\u1EA3n Ph\u1EA9m",masp:"M\xE3 S\u1EA3n Ph\u1EA9m",dvt:"\u0110VT",mancc:"M\xE3 NCC",name:"T\xEAn Nh\xE0 Cung C\u1EA5p",slchonhap:"SL \u0110\u1EB7t (Ch\u1EDD Nh\u1EADp)",SLDat:"SL \u0110\u1EB7t NCC",goiy:"SL C\u1EA7n \u0110\u1EB7t (G\u1EE3i \xDD)",slchogiao:"SL B\xE1n (Ch\u1EDD Giao)",SLGiao:"SL Giao KH",sltontt:"T\u1ED3n Kho (Th\u1EF1c T\u1EBF)",slton:"T\u1ED3n Kho",kho1:"TG-LONG AN",kho2:"B\u1ED5 Sung",kho3:"TG-\u0110\xC0 L\u1EA0T",kho4:"KHO T\u1ED4NG - HCM",kho5:"SG1",kho6:"SG2",haohut:"T\u1EC9 L\u1EC7 Hao H\u1EE5t",slhaohut:"SL Hao H\u1EE5t"},c=this.convertData(n);ve(c,t,Object.values(o),o)})}convertData(e){let t=[{name:"kho1",label:"TG-LONG AN"},{name:"kho2",label:"B\u1ED5 Sung"},{name:"kho3",label:"TG-\u0110\xC0 L\u1EA0T"},{name:"kho4",label:"KHO T\u1ED4NG - HCM"},{name:"kho5",label:"SG1"},{name:"kho6",label:"SG2"}];return e.map(n=>{let o=N({},n);t.forEach(u=>{o[u.name]="0"});let c=t.find(u=>u.label===n.namekho);return c&&(o[c.name]=n.SLDat||"0"),o})}trackByFn(e,t){return t.masp||t.id}calculateTotalPages(){this.totalPages=Math.ceil(this.totalItems/this.pageSize)}onPageSizeChange(e,t){let n=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();e>n.length?(this.pageSize=n.length,this._snackBar.open(`S\u1ED1 l\u01B0\u1EE3ng t\u1ED1i \u0111a ${n.length}`,"",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})):this.pageSize=e,this.currentPage=1,this.calculateTotalPages(),this.updateDisplayData(),t.closeMenu()}onPreviousPage(){this.currentPage>1&&(this.currentPage--,this.updateDisplayData())}onNextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.updateDisplayData())}updateDisplayData(){let e=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham(),t=(this.currentPage-1)*this.pageSize,n=t+this.pageSize,o=e.slice(t,n);this.dataSource.data=o}getCurrentFilteredData(e){let t=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham(),n=new Map;return t.forEach(o=>{let c=o[e];n.has(c)||n.set(c,o)}),Array.from(n.values())}parseFloat(e){return parseFloat(e)||0}applyQuickFilter(e){this.quickFilter=e;let t=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();switch(e){case"lowStock":t=t.filter(n=>(n.slton||0)<=10);break;case"needOrder":t=t.filter(n=>parseFloat(this.GetGoiy(n))>0);break;case"pendingDelivery":t=t.filter(n=>(n.slchogiao||0)>0);break;case"all":default:break}this.globalFilterValue&&(t=this.applyGlobalFilterToData(t,this.globalFilterValue)),this.dataSource.data=t,this.totalItems=t.length,this.calculateTotalPages(),this.currentPage=1,this.updateDisplayData()}applyGlobalFilter(e){let t=e.target.value;this.globalFilterValue=t;let n=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();if(this.quickFilter!=="all"){this.applyQuickFilter(this.quickFilter);return}t&&(n=this.applyGlobalFilterToData(n,t)),this.dataSource.data=n,this.totalItems=n.length,this.calculateTotalPages(),this.currentPage=1,this.updateDisplayData()}applyGlobalFilterToData(e,t){let n=t.trim().toLowerCase();return e.filter(o=>o.title?.toLowerCase().includes(n)||o.masp?.toLowerCase().includes(n)||o.name?.toLowerCase().includes(n)||o.mancc?.toLowerCase().includes(n))}sortData(e){let t=this.dataSource.data.slice();if(!e.active||e.direction===""){this.dataSource.data=t;return}this.dataSource.data=t.sort((n,o)=>{let c=e.direction==="asc";switch(e.active){case"title":case"masp":return this.compareStrings(n[e.active],o[e.active],c);case"slton":case"slchogiao":case"slchonhap":case"SLDat":case"SLGiao":return this.compareNumbers(Number(n[e.active])||0,Number(o[e.active])||0,c);case"goiy":return this.compareNumbers(parseFloat(this.GetGoiy(n)),parseFloat(this.GetGoiy(o)),c);default:return this.compareStrings(n[e.active],o[e.active],c)}})}compareStrings(e,t,n){return(e<t?-1:1)*(n?1:-1)}compareNumbers(e,t,n){return(e-t)*(n?1:-1)}clearAllFilters(){this.quickFilter="all",this.globalFilterValue="",this.ListFilter=[];let e=this.TonghopsFinal.length>0?this.TonghopsFinal:this.Listsanpham();this.dataSource.data=e,this.totalItems=e.length,this.calculateTotalPages(),this.currentPage=1,this.updateDisplayData(),document.querySelectorAll('input[type="text"]').forEach(n=>{n.placeholder.includes("T\xECm ki\u1EBFm")&&(n.value="")})}toggleDateRangeFilter(){if(this.isDateRangeEnabled=!this.isDateRangeEnabled,this.hasUnappliedDateChanges=!1,this.isDateRangeEnabled){let e=new Date;this.batdau=new Date(e),this.ketthuc=new Date(e),this.loadDonhangWithRelations()}else this.loadDonhangWithRelations()}applyDateFilter(e){if(this.isDateRangeEnabled||(this.isDateRangeEnabled=!0),!this.batdau||!this.ketthuc){this._snackBar.open("Vui l\xF2ng ch\u1ECDn kho\u1EA3ng th\u1EDDi gian h\u1EE3p l\u1EC7","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]});return}if(this.batdau>this.ketthuc){this._snackBar.open("Ng\xE0y b\u1EAFt \u0111\u1EA7u kh\xF4ng th\u1EC3 sau ng\xE0y k\u1EBFt th\xFAc","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]});return}this.hasUnappliedDateChanges=!1,this.loadDonhangWithRelations(),this._snackBar.open("\u0110\xE3 \xE1p d\u1EE5ng b\u1ED9 l\u1ECDc ng\xE0y","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),e.closeMenu()}onStartDateChange(e){this.batdau=e.value,this.batdau>this.ketthuc&&(this.ketthuc=new Date(this.batdau)),this.hasUnappliedDateChanges=!0}onEndDateChange(e){this.ketthuc=e.value,this.ketthuc<this.batdau&&(this.batdau=new Date(this.ketthuc)),this.hasUnappliedDateChanges=!0}setToday(e){let t=new Date;this.batdau=new Date(t),this.ketthuc=new Date(t),this.applyDateFilter(e)}setThisWeek(e){let t=new Date,n=new Date(t);n.setDate(t.getDate()-t.getDay());let o=new Date(n);o.setDate(n.getDate()+6),this.batdau=new Date(n),this.ketthuc=new Date(o),this.applyDateFilter(e)}setThisMonth(e){let t=new Date,n=new Date(t.getFullYear(),t.getMonth(),1),o=new Date(t.getFullYear(),t.getMonth()+1,0);this.batdau=new Date(n),this.ketthuc=new Date(o),this.applyDateFilter(e)}clearDateFilter(){this.isDateRangeEnabled=!1,this.hasUnappliedDateChanges=!1;let e=new Date;this.batdau=new Date(e),this.ketthuc=new Date(e),this.loadDonhangWithRelations(),this._snackBar.open("\u0110\xE3 x\xF3a b\u1ED9 l\u1ECDc ng\xE0y","",{duration:2e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})}formatDateForDisplay(e,t="DD/MM/YYYY"){return this._timezoneService.formatForDisplay(e,t)}convertFormDateToUTC(e){return this._timezoneService.formDateToUTC(e)}parseUserDateInput(e,t="YYYY-MM-DD"){try{return this._timezoneService.parseUserInputToUTC(e,t)}catch(n){return console.error("Invalid date format:",n),""}}toggleExpanded(e){this.openNestedDataDialog(e)}openNestedDataDialog(e){return M(this,null,function*(){console.log("Opening dialog for element:",e);let t={product:e,dathangData:[],donhangData:[],loading:!0},n=this._dialog.open(rt,{width:"95vw",maxWidth:"1200px",height:"90vh",maxHeight:"90vh",data:t,disableClose:!1,autoFocus:!1,panelClass:["nested-data-dialog-panel"]});try{yield this.loadNestedData(e),t.dathangData=this.getDathangData(e.masp),t.donhangData=this.getDonhangData(e.masp),t.loading=!1,t.triggerChangeDetection&&t.triggerChangeDetection(),console.log("Loaded data:",{dathang:t.dathangData.length,donhang:t.donhangData.length,loading:t.loading})}catch(o){console.error("Error loading nested data:",o),t.loading=!1,t.triggerChangeDetection&&t.triggerChangeDetection(),this._snackBar.open("L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u. Vui l\xF2ng th\u1EED l\u1EA1i.","",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}})}loadNestedData(e){return M(this,null,function*(){let t=e.masp||e.id;if(!t){console.warn("Cannot load nested data: masp is missing",e);return}console.log("Loading nested data for masp:",t),yield Promise.all([this.loadDathangData(t),this.loadDonhangData(t)]),console.log("Nested data loaded:",{masp:t,dathang:this.getDathangData(t).length,donhang:this.getDonhangData(t).length})})}loadDathangData(e){return M(this,null,function*(){if(!(this.dathangDataMap.has(e)||this.loadingDathang.has(e))){this.loadingDathang.add(e);try{console.log("Loading dathang data for masp:",e);let n=(yield this._GraphqlService.findAll("dathang",{enableParallelFetch:!0,batchSize:500,take:999999,aggressiveCache:!0,orderBy:{createdAt:"desc"},where:{sanpham:{some:{sanpham:{masp:{equals:e}}}}},select:{id:!0,madncc:!0,ngaynhan:!0,createdAt:!0,updatedAt:!0,status:!0,nhacungcap:{select:{id:!0,name:!0,mancc:!0,diachi:!0,sdt:!0}},sanpham:{where:{sanpham:{masp:{equals:e}}},select:{id:!0,sldat:!0,slgiao:!0,slnhan:!0,ttgiao:!0,sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0}}}},kho:{select:{id:!0,name:!0,makho:!0,diachi:!0}}}})).data.flatMap(o=>o.sanpham.map(c=>({id:o.id,madncc:o.madncc,ngaynhan:o.ngaynhan,createdAt:o.createdAt,updatedAt:o.updatedAt,status:o.status,sanphamId:c.sanpham.id,title:c.sanpham.title,masp:c.sanpham.masp,dvt:c.sanpham.dvt,sldat:Number(c.sldat)||0,slgiao:Number(c.slgiao)||0,slnhan:Number(c.slnhan)||0,giaban:Number(c.giaban)||0,ttgiao:Number(c.ttgiao)||0,nhacungcap:o.nhacungcap,mancc:o.nhacungcap?.mancc||"",name:o.nhacungcap?.name||"",type:"dathang"})));console.log(`Loaded ${n.length} dathang records for masp: ${e}`),this.dathangDataMap.set(e,n)}catch(t){console.error("Error loading dathang data:",t),this.dathangDataMap.set(e,[]),this._snackBar.open(`L\u1ED7i t\u1EA3i d\u1EEF li\u1EC7u \u0111\u1EB7t h\xE0ng cho ${e}`,"",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.loadingDathang.delete(e)}}})}loadDonhangData(e){return M(this,null,function*(){if(!(this.donhangDataMap.has(e)||this.loadingDonhang.has(e))){this.loadingDonhang.add(e);try{console.log("Loading donhang data for masp:",e);let n=(yield this._GraphqlService.findAll("donhang",{enableParallelFetch:!0,batchSize:500,take:999999,aggressiveCache:!0,orderBy:{createdAt:"desc"},where:{sanpham:{some:{sanpham:{masp:{equals:e}}}}},select:{id:!0,madonhang:!0,ngaygiao:!0,createdAt:!0,updatedAt:!0,status:!0,khachhang:{select:{id:!0,name:!0,sdt:!0,diachi:!0,makh:!0}},sanpham:{where:{sanpham:{masp:{equals:e}}},select:{id:!0,sldat:!0,slgiao:!0,slnhan:!0,giaban:!0,ttgiao:!0,sanpham:{select:{id:!0,title:!0,masp:!0,dvt:!0}}}}}})).data.flatMap(o=>o.sanpham.map(c=>({id:o.id,madonhang:o.madonhang,ngaygiao:o.ngaygiao,createdAt:o.createdAt,updatedAt:o.updatedAt,status:o.status,sanphamId:c.sanpham.id,title:c.sanpham.title,masp:c.sanpham.masp,dvt:c.sanpham.dvt,sldat:Number(c.sldat)||0,slgiao:Number(c.slgiao)||0,slnhan:Number(c.slnhan)||0,giaban:Number(c.giaban)||0,ttgiao:Number(c.ttgiao)||0,khachhang:o.khachhang,makh:o.khachhang?.makh||"",name:o.khachhang?.name||"",type:"donhang"})));console.log(`Loaded ${n.length} donhang records for masp: ${e}`),this.donhangDataMap.set(e,n)}catch(t){console.error("Error loading donhang data:",t),this.donhangDataMap.set(e,[]),this._snackBar.open(`L\u1ED7i t\u1EA3i d\u1EEF li\u1EC7u \u0111\u01A1n h\xE0ng cho ${e}`,"",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.loadingDonhang.delete(e)}}})}getDathangData(e){return this.dathangDataMap.get(e)||[]}getDonhangData(e){return this.donhangDataMap.get(e)||[]}isDathangLoading(e){return this.loadingDathang.has(e)}isDonhangLoading(e){return this.loadingDonhang.has(e)}clearNestedData(){this.dathangDataMap.clear(),this.donhangDataMap.clear(),this.loadingDathang.clear(),this.loadingDonhang.clear(),this.expandedElementId=null}isExpanded=(e,t)=>(t.id||t.masp)===this.expandedElementId;isElementExpanded(e){return!1}expandById(e,t){let n=this.dataSource.data.find(o=>(o.id||o.masp)===e||o.masp===t);n&&this.openNestedDataDialog(n)}collapseExpanded(){this.expandedElementId=null}isAnyDataLoading(e){return this.isDathangLoading(e)||this.isDonhangLoading(e)}getTotalNestedDataCount(e){return this.getDathangData(e).length+this.getDonhangData(e).length}hasNestedData(e){return this.getTotalNestedDataCount(e)>0}getLoadingStateSummary(){return{expandedElementId:this.expandedElementId,loadingDathang:Array.from(this.loadingDathang),loadingDonhang:Array.from(this.loadingDonhang),cachedDathang:Array.from(this.dathangDataMap.keys()),cachedDonhang:Array.from(this.donhangDataMap.keys())}}static \u0275fac=function(t){return new(t||O)};static \u0275cmp=B({type:O,selectors:[["app-nhucaudathang"]],viewQuery:function(t,n){if(t&1&&(G(se,5),G(at,5),G(en,7)),t&2){let o;z(o=$())&&(n.paginator=o.first),z(o=$())&&(n.sort=o.first),z(o=$())&&(n.drawer=o.first)}},decls:118,vars:35,consts:[["drawer",""],["dateMenuTrigger","matMenuTrigger"],["dateMenu","matMenu"],["startPicker",""],["endPicker",""],["menu","matMenu"],["uploadfile",""],["menuTrigger","matMenuTrigger"],["menuHienthi","matMenu"],["DeleteDialog",""],["filterMenu","matMenu"],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","lg:!w-1/2","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-16","w-full","p-2"],[1,"border","p-1","cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","bg-white","rounded-lg"],[1,"w-full","flex","flex-row","space-x-2","items-center"],[1,"relative"],["type","text","placeholder","T\xECm ki\u1EBFm s\u1EA3n ph\u1EA9m, m\xE3 s\u1EA3n ph\u1EA9m...",1,"block","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["matTooltip","L\u1ECDc theo ng\xE0y","mat-icon-button","","color","primary","aria-label","Date filter menu",3,"matMenuTriggerFor"],[1,"date-filter-menu"],[1,"p-4",3,"click"],[1,"flex","flex-col","space-y-4"],[1,"flex","items-center","justify-between"],[1,"font-semibold"],[1,"flex","flex-col","space-y-3"],["appearance","outline","subscriptSizing","dynamic"],["matInput","","readonly","","placeholder","Ch\u1ECDn ng\xE0y b\u1EAFt \u0111\u1EA7u",3,"ngModelChange","dateChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","readonly","","placeholder","Ch\u1ECDn ng\xE0y k\u1EBFt th\xFAc",3,"ngModelChange","dateChange","matDatepicker","ngModel"],[1,"flex","flex-wrap","gap-2"],["mat-stroked-button","","color","primary",1,"text-xs",3,"click"],["mat-stroked-button","","color","warn",1,"text-xs",3,"click"],[1,"flex","justify-center"],["mat-raised-button","",1,"w-full",3,"click","color"],[1,"text-xs","text-orange-600","bg-orange-50","p-2","rounded","text-center"],[1,"text-sm","text-gray-600","bg-gray-50","p-2","rounded"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200",3,"click"],[1,"ml-2","px-2","py-1","bg-blue-100","text-blue-800","rounded","text-xs"],[1,"border","rounded-lg","w-full","h-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","hover:bg-slate-100 transition-colors duration-200",3,"bg-slate-200","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"cursor-pointer","border","rounded-lg","px-3","p-1","flex","flex-row","space-x-2","items-center","justify-between"],[1,"w-full","flex","lg:p-0","p-2","lg:flex-row","lg:space-x-2","lg:items-center","lg:justify-between","flex-col","justify-center"],[1,"w-full","text-center"],[1,"w-full","flex","flex-row","space-x-2","items-center","lg:justify-end","justify-center"],[1,"font-bold","text-blue-600",3,"matMenuTriggerFor"],[1,"w-full","flex","flex-col","space-y-2","p-4",3,"click"],["matInput","","placeholder","Vui l\xF2ng Nh\u1EADp S\u1ED1 L\u01B0\u1EE3ng",3,"ngModelChange","ngModel","ngModelOptions"],["mat-flat-button","","color","primary",3,"click"],[1,"pagination-controls"],["mat-icon-button","","color","primary",3,"click","disabled"],["mat-menu-item","",3,"click"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","cursor-pointer",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"filter-menu"],[1,"cursor-pointer","flex","flex-col","space-y-4","p-3",3,"click"],[1,"relative","w-full"],["type","text",1,"block","w-full","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup","placeholder"],[1,"flex","flex-row","space-x-2","items-center","justify-between"],[1,"flex","flex-row","space-x-2","items-center"],[1,"text-xs","text-blue-600","underline","cursor-pointer",3,"click"],[1,"w-full","flex","flex-col","space-y-2","max-h-44","overflow-auto"],["class","flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100 cursor-pointer",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-row","space-x-2","items-end","justify-end"],["mat-flat-button","","color","warn",3,"click"],[1,"max-w-32","line-clamp-2","me-2"],[1,"z-10","material-symbols-outlined","text-gray-500","cursor-pointer",3,"matMenuTriggerFor","matTooltip"],[1,"flex","flex-row","space-x-2","items-center","p-2","rounded-lg","hover:bg-slate-100","cursor-pointer",3,"click"],["class","material-symbols-outlined text-blue-600",4,"ngIf"],["class","w-6",4,"ngIf"],[1,"material-symbols-outlined","text-blue-600"],[1,"w-6"],["mat-cell","",1,"cursor-pointer"],[1,"flex","items-center","space-x-2"],[1,"max-w-16","line-clamp-1"],[1,"max-w-48","line-clamp-2",3,"matTooltip"],[1,"max-w-32","line-clamp-1","font-mono","text-sm"],[1,"max-w-20","line-clamp-1","text-end","font-semibold",3,"text-red-600","text-green-600"],[1,"max-w-20","line-clamp-1","text-end","text-orange-600","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","text-blue-600","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","text-purple-600","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","text-indigo-600","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","font-bold",3,"text-red-600","text-gray-400"],[1,"max-w-28","line-clamp-1","text-sm"],[1,"max-w-16","line-clamp-1","text-center"],[1,"max-w-32","line-clamp-2",3,"matTooltip"],["mat-icon-button","","color","primary",1,"transition-all","duration-300","ease-in-out","hover:scale-110","relative",3,"click","matTooltip"],[1,"transition-transform","duration-300","ease-in-out","text-blue-600"],[1,"absolute","-top-1","-right-1"],[1,"text-xs","bg-blue-100","text-blue-800","px-2","py-1","rounded-full","font-medium"],[1,"w-3","h-3","bg-blue-500","rounded-full","animate-pulse"],[1,"max-w-20","line-clamp-1","text-end","font-semibold"],[1,"max-w-20","line-clamp-1","text-end","font-bold"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-slate-100","transition-colors","duration-200",3,"click"],[1,"mat-row"],[1,"mat-cell","p-8","text-center","text-gray-500"],[1,"flex","flex-col","items-center","space-y-2"],[1,"text-4xl","text-gray-300"],[1,"flex","flex-col","space-y-8","items-center","justify-center"],[1,"font-bold"],[1,"flex","flex-row","space-x-2","items-center","justify-center"],["mat-flat-button","","color","primary","mat-dialog-close","true"],["mat-flat-button","","color","warn","mat-dialog-close","false"]],template:function(t,n){if(t&1){let o=P();i(0,"mat-drawer-container",11)(1,"mat-drawer",12,0),k(3,"router-outlet"),r(),i(4,"div",13)(5,"div",14)(6,"div",15)(7,"div",16)(8,"input",17),x("keyup",function(u){return h(o),g(n.applyGlobalFilter(u))}),r(),i(9,"div",18)(10,"span",19),l(11,"search"),r()()(),i(12,"button",20)(13,"mat-icon"),l(14,"tune"),r()(),i(15,"button",21,1)(17,"mat-icon"),l(18,"date_range"),r()(),i(19,"mat-menu",22,2)(21,"div",23),x("click",function(u){return h(o),g(u.stopPropagation())}),i(22,"div",24)(23,"div",25)(24,"span",26),l(25,"L\u1ECDc theo kho\u1EA3ng th\u1EDDi gian"),r()(),i(26,"div",27)(27,"mat-form-field",28)(28,"mat-label"),l(29,"T\u1EEB ng\xE0y"),r(),i(30,"input",29),H("ngModelChange",function(u){return h(o),Y(n.batdau,u)||(n.batdau=u),g(u)}),x("dateChange",function(u){return h(o),g(n.onStartDateChange(u))}),r(),k(31,"mat-datepicker-toggle",30)(32,"mat-datepicker",null,3),r(),i(34,"mat-form-field",28)(35,"mat-label"),l(36,"\u0110\u1EBFn ng\xE0y"),r(),i(37,"input",31),H("ngModelChange",function(u){return h(o),Y(n.ketthuc,u)||(n.ketthuc=u),g(u)}),x("dateChange",function(u){return h(o),g(n.onEndDateChange(u))}),r(),k(38,"mat-datepicker-toggle",30)(39,"mat-datepicker",null,4),r(),i(41,"div",32)(42,"button",33),x("click",function(){h(o);let u=S(16);return g(n.setToday(u))}),l(43," H\xF4m nay "),r(),i(44,"button",33),x("click",function(){h(o);let u=S(16);return g(n.setThisWeek(u))}),l(45," Tu\u1EA7n n\xE0y "),r(),i(46,"button",33),x("click",function(){h(o);let u=S(16);return g(n.setThisMonth(u))}),l(47," Th\xE1ng n\xE0y "),r(),i(48,"button",34),x("click",function(){return h(o),g(n.clearDateFilter())}),l(49," X\xF3a l\u1ECDc "),r()(),i(50,"div",35)(51,"button",36),x("click",function(){h(o);let u=S(16);return g(n.applyDateFilter(u))}),i(52,"mat-icon"),l(53),r(),l(54),r()(),b(55,on,2,0,"div",37),i(56,"div",38)(57,"strong"),l(58,"Kho\u1EA3ng th\u1EDDi gian:"),r(),k(59,"br"),l(60),r()()()()(),i(61,"mat-menu",null,5)(63,"div",39)(64,"mat-form-field",40)(65,"input",41),x("input",function(u){return h(o),g(n.doFilterColumns(u))})("click",function(u){return h(o),g(u.stopPropagation())}),r(),i(66,"mat-icon",42),l(67,"search"),r()()(),i(68,"div",43),I(69,rn,5,2,"button",44,an),r()(),i(71,"button",45),x("click",function(){return h(o),g(n.ExportExcel(n.TonghopsFinal,"Tonghop"))}),i(72,"mat-icon"),l(73,"file_download"),r()(),i(74,"input",46,6),x("change",function(u){return h(o),g(n.ImporExcel(u))}),r(),i(76,"span",47),x("click",function(){return h(o),n.pageSize=n.TonghopsFinal.length,g(n.updateDisplayData())}),l(77),b(78,ln,2,2,"span",48),r()()(),i(79,"div",49)(80,"table",50),I(81,Hn,3,1,"ng-container",51,ft),b(83,qn,1,0,"tr",52)(84,jn,1,2,"tr",53)(85,Wn,7,1,"tr",54),r()(),i(86,"div",55)(87,"div",56)(88,"span",57),l(89,"\u0110ang Xem "),i(90,"strong"),l(91),r(),l(92," - "),i(93,"strong"),l(94),r(),l(95),r(),i(96,"div",58)(97,"span",59,7),l(99),r(),i(100,"mat-menu",null,8)(102,"div",60),x("click",function(u){return h(o),g(u.stopPropagation())}),i(103,"span"),l(104,"S\u1ED1 L\u01B0\u1EE3ng"),r(),i(105,"mat-form-field",28)(106,"input",61),H("ngModelChange",function(u){return h(o),Y(n.pageSize,u)||(n.pageSize=u),g(u)}),r()(),i(107,"button",62),x("click",function(){h(o);let u=S(101);return g(n.onPageSizeChange(n.pageSize,u))}),l(108,"\xC1p D\u1EE5ng"),r()()(),i(109,"div",63)(110,"button",64),x("click",function(){return h(o),g(n.onPreviousPage())}),i(111,"mat-icon"),l(112,"keyboard_arrow_left"),r()(),i(113,"button",64),x("click",function(){return h(o),g(n.onNextPage())}),i(114,"mat-icon"),l(115,"keyboard_arrow_right"),r()()()()()()()(),b(116,Kn,11,0,"ng-template",null,9,St)}if(t&2){let o=S(20),c=S(33),u=S(40),E=S(62),T=S(101);s(),f("position","end"),s(11),f("matMenuTriggerFor",E),s(3),f("matMenuTriggerFor",o),s(2),V("text-blue-600",n.isDateRangeEnabled),s(13),f("matDatepicker",c),R("ngModel",n.batdau),s(),f("for",c),s(6),f("matDatepicker",u),R("ngModel",n.ketthuc),s(),f("for",u),s(13),f("color",n.hasUnappliedDateChanges?"warn":"primary"),s(2),C(n.hasUnappliedDateChanges?"pending":"filter_alt"),s(),_(" ",n.hasUnappliedDateChanges?"C\xF3 thay \u0111\u1ED5i - \xC1p d\u1EE5ng":"\xC1p d\u1EE5ng l\u1ECDc"," "),s(),w(n.hasUnappliedDateChanges?55:-1),s(5),pt(" ",n.formatDateForDisplay(n.batdau,"DD/MM/YYYY")," - ",n.formatDateForDisplay(n.ketthuc,"DD/MM/YYYY")," "),s(9),L(n.FilterColumns),s(8),_(" ",n.TonghopsFinal.length>0?n.TonghopsFinal.length:n.Listsanpham().length," S\u1EA3n Ph\u1EA9m "),s(),w(n.isDateRangeEnabled?78:-1),s(2),f("dataSource",n.dataSource),s(),L(n.displayedColumns),s(2),f("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),s(),f("matRowDefColumns",n.displayedColumns),s(7),C((n.currentPage-1)*n.pageSize+1),s(3),C(n.currentPage*n.pageSize>n.totalItems?n.totalItems:n.currentPage*n.pageSize),s(),yt(" trong s\u1ED1 ",n.totalItems," m\u1EE5c, ",n.currentPage,"/",n.totalPages," Trang"),s(2),f("matMenuTriggerFor",T),s(2),_("Hi\u1EC7n Th\u1ECB : ",n.pageSize," m\u1EE5c"),s(7),R("ngModel",n.pageSize),f("ngModelOptions",Dt(34,nn)),s(4),f("disabled",n.currentPage===1),s(3),f("disabled",n.currentPage===n.totalPages)}},dependencies:[ae,ne,Zt,te,ee,oe,ie,Se,me,he,fe,ge,pe,Ce,_e,xe,be,ye,De,ue,at,de,ce,Ht,Rt,$t,Yt,zt,Bt,Gt,Nt,X,Q,U,W,K,re,j,Mt,kt,q,Kt,qt,jt,Wt,nt,et,tt,J,Z,Te,Ee,Me,ke,At,Fe,Ae,it],styles:[".mat-mdc-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.mat-mdc-header-cell[_ngcontent-%COMP%]{padding:8px 12px;position:sticky;top:0;background:#f8fafc;border-bottom:2px solid #e2e8f0;font-weight:600;z-index:10}.mat-mdc-cell[_ngcontent-%COMP%]{padding:8px 12px;border-bottom:1px solid #e2e8f0;vertical-align:middle}.mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#f1f5f9;transition:background-color .2s ease}.quick-filter-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;align-items:center}.quick-filter-button[_ngcontent-%COMP%]{padding:4px 12px;font-size:12px;min-height:32px;border-radius:16px}.quick-filter-button.active[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.filter-menu[_ngcontent-%COMP%]{max-width:400px}.date-filter-menu[_ngcontent-%COMP%]{max-width:350px}.date-filter-menu[_ngcontent-%COMP%]   .mat-mdc-menu-content[_ngcontent-%COMP%]{padding:0!important}.date-range-indicator[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 8px;background-color:#dbeafe;color:#1e40af;border-radius:12px;font-size:11px;font-weight:500;margin-left:8px}.mat-mdc-form-field.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{background-color:#fff}.date-range-status[_ngcontent-%COMP%]{background-color:#f1f5f9;border:1px solid #e2e8f0;border-radius:6px;padding:8px;font-size:12px;color:#475569}.quick-date-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px}.quick-date-buttons[_ngcontent-%COMP%]   .mat-mdc-button[_ngcontent-%COMP%]{font-size:11px;min-width:auto;padding:4px 8px;height:28px;line-height:20px}.filter-menu[_ngcontent-%COMP%]   .mat-mdc-menu-content[_ngcontent-%COMP%]{padding:0}.filter-search-input[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px}.filter-search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f61a}.filter-options[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}.filter-option[_ngcontent-%COMP%]{padding:8px 12px;cursor:pointer;display:flex;align-items:center;gap:8px;border-radius:4px;margin:2px 4px}.filter-option[_ngcontent-%COMP%]:hover{background-color:#f1f5f9}.filter-option.selected[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1d4ed8}.column-filter-icon[_ngcontent-%COMP%]{opacity:.6;transition:opacity .2s ease;cursor:pointer}.column-filter-icon[_ngcontent-%COMP%]:hover{opacity:1;color:#3b82f6}@media (max-width: 768px){.mat-mdc-header-cell[_ngcontent-%COMP%], .mat-mdc-cell[_ngcontent-%COMP%]{padding:6px 8px;font-size:13px}.quick-filter-buttons[_ngcontent-%COMP%]{gap:4px}.quick-filter-button[_ngcontent-%COMP%]{padding:3px 8px;font-size:11px;min-height:28px}}.status-low-stock[_ngcontent-%COMP%]{color:#dc2626;font-weight:600}.status-normal-stock[_ngcontent-%COMP%]{color:#059669;font-weight:600}.status-pending[_ngcontent-%COMP%]{color:#d97706;font-weight:600}.status-suggestion[_ngcontent-%COMP%]{color:#7c3aed;font-weight:600}.mat-mdc-row[_ngcontent-%COMP%]{transition:all .2s ease}.mat-mdc-row.filtered-out[_ngcontent-%COMP%]{opacity:.5;transform:scale(.98)}.search-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#6b7280;z-index:1}.search-input[_ngcontent-%COMP%]{padding-left:40px}.pagination-info[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 4px}.filter-badge[_ngcontent-%COMP%]{position:absolute;top:-2px;right:-2px;background:#dc2626;color:#fff;border-radius:50%;width:16px;height:16px;font-size:10px;display:flex;align-items:center;justify-content:center}.filter-options[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.filter-options[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.filter-options[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.filter-options[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.detail-row[_ngcontent-%COMP%]{height:0}.mat-icon.rotate-180[_ngcontent-%COMP%]{transform:rotate(180deg);transition:transform .3s ease}.mat-icon[_ngcontent-%COMP%]:not(.rotate-180){transition:transform .3s ease}.expanded-content[_ngcontent-%COMP%]{padding:16px;background-color:#f8fafc;border-top:1px solid #e2e8f0}.nested-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}.nested-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .nested-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px;text-align:left;border:1px solid #e2e8f0}.nested-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f5f9;font-weight:600;font-size:13px}.nested-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:11px;font-weight:500;text-transform:uppercase}.status-badge.completed[_ngcontent-%COMP%], .status-badge.delivered[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.status-badge.pending[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.status-badge.shipping[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.loading-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:24px}.loading-spinner[_ngcontent-%COMP%]{margin-right:12px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#64748b}.empty-state[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:8px;opacity:.5}"],data:{animation:[Tt("detailExpand",[gt("collapsed",ht({height:"0px",minHeight:"0"})),gt("expanded",ht({height:"*"})),Pt("expanded <=> collapsed",Ft("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]},changeDetection:0})};ct([Ge(300)],O.prototype,"doFilterHederColumn",1),ct([Ge(300)],O.prototype,"applyAdvancedColumnFilter",1);var Be=O;function Ge(a=300){return function(e,t,n){let o=n.value,c;return n.value=function(...u){clearTimeout(c),c=setTimeout(()=>{o.apply(this,u)},a)},n}}export{Be as NhucaudathangComponent};
