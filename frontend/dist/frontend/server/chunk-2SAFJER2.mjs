import './polyfills.server.mjs';
import{a as Y}from"./chunk-IDKA5VNE.mjs";import{a as U}from"./chunk-OPBKZ7KD.mjs";import{a as L,c as N,e as K,f as V,g as j,h as O}from"./chunk-G22LVZ3C.mjs";import{b as J,c as Q}from"./chunk-CLIOYSV5.mjs";import{B as $,C as G,b as R,g as B,j as T,p as A,q as z,s as H,u as W,v as q,w as X}from"./chunk-6OXZJDYM.mjs";import{a as w,b as F}from"./chunk-HY6ZSEAG.mjs";import{a as P}from"./chunk-NJUROCK7.mjs";import{a as M,e as S}from"./chunk-YYTI3S2Z.mjs";import{o as _,z as I}from"./chunk-OZK2OCZT.mjs";import{$b as b,Fb as C,Hc as a,Jc as h,Mb as m,Mc as v,Nc as D,Oc as k,Yb as c,_b as x,ic as i,ja as E,jc as n,pa as d,tb as l,tc as p,vc as f}from"./chunk-TKMPR5S6.mjs";import{j as y}from"./chunk-RIAI3ORJ.mjs";function nt(r,t){r&1&&(i(0,"mat-error"),a(1,"L\xFD do h\u1EE7y ph\u1EA3i c\xF3 \xEDt nh\u1EA5t 10 k\xFD t\u1EF1"),n())}function et(r,t){if(r&1&&(i(0,"p")(1,"strong"),a(2,"Kh\xE1ch h\xE0ng:"),n(),a(3),n()),r&2){let e=f(2);l(3),h(" ",e.orderInfo.khachhang.name," ")}}function at(r,t){if(r&1&&(i(0,"p")(1,"strong"),a(2,"Nh\xE0 cung c\u1EA5p:"),n(),a(3),n()),r&2){let e=f(2);l(3),h(" ",e.orderInfo.nhacungcap.name," ")}}function ot(r,t){if(r&1&&(i(0,"div",14)(1,"p",15)(2,"strong"),a(3,"Th\xF4ng tin \u0111\u01A1n h\xE0ng:"),n()(),i(4,"div",16)(5,"p")(6,"strong"),a(7,"M\xE3 \u0111\u01A1n:"),n(),a(8),n(),m(9,et,4,1,"p",9)(10,at,4,1,"p",9),i(11,"p")(12,"strong"),a(13,"Tr\u1EA1ng th\xE1i:"),n(),i(14,"span",17),a(15),n()()()()),r&2){let e=f();l(8),h(" ",e.orderInfo.madonhang||e.orderInfo.madncc,""),l(),c("ngIf",e.orderInfo.khachhang),l(),c("ngIf",e.orderInfo.nhacungcap),l(4),b(e.getStatusClass(e.orderInfo.status)),l(),h(" ",e.getStatusLabel(e.orderInfo.status)," ")}}var g=class r{lydohuy="";showError=!1;orderInfo=null;hasInventory=!1;dialogRef=d(L);onCancel(){this.dialogRef.close(null)}onConfirm(){this.isValid()?this.dialogRef.close(this.lydohuy.trim()):this.showError=!0}onInputChange(){this.lydohuy.length>=10&&(this.showError=!1)}isValid(){return this.lydohuy.trim().length>=10}getStatusLabel(t){return{dadat:"\u0110\xE3 \u0110\u1EB7t",dagiao:"\u0110\xE3 Giao",danhan:"\u0110\xE3 Nh\u1EADn",huy:"\u0110\xE3 H\u1EE7y",hoanthanh:"Ho\xE0n Th\xE0nh"}[t]||t}getStatusClass(t){return{dadat:"bg-blue-100 text-blue-800",dagiao:"bg-green-100 text-green-800",danhan:"bg-purple-100 text-purple-800",huy:"bg-red-100 text-red-800",hoanthanh:"bg-gray-100 text-gray-800"}[t]||"bg-gray-100 text-gray-800"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=C({type:r,selectors:[["app-cancel-reason-dialog"]],decls:31,vars:9,consts:[["mat-dialog-title","",1,"text-red-600","font-bold"],[1,"align-middle","mr-2"],[1,"mt-4"],[1,"mb-4","p-3","bg-yellow-50","border-l-4","border-yellow-400","text-yellow-700"],[1,"text-sm"],["appearance","outline",1,"w-full"],["matInput","","rows","5","placeholder","Vui l\xF2ng nh\u1EADp l\xFD do h\u1EE7y \u0111\u01A1n h\xE0ng (t\u1ED1i thi\u1EC3u 10 k\xFD t\u1EF1)","required","","maxlength","500",3,"ngModelChange","input","ngModel"],["align","start"],["align","end"],[4,"ngIf"],["class","mt-4 p-3 bg-gray-50 rounded",4,"ngIf"],["align","end",1,"mt-4","gap-2"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","warn","type","button",3,"click","disabled"],[1,"mt-4","p-3","bg-gray-50","rounded"],[1,"text-sm","text-gray-600","mb-2"],[1,"text-sm","space-y-1"],[1,"px-2","py-1","rounded","text-xs"]],template:function(e,o){e&1&&(i(0,"h2",0)(1,"mat-icon",1),a(2,"warning"),n(),a(3," X\xE1c Nh\u1EADn H\u1EE7y \u0110\u01A1n H\xE0ng "),n(),i(4,"mat-dialog-content",2)(5,"div",3)(6,"p",4)(7,"strong"),a(8,"C\u1EA3nh b\xE1o:"),n(),a(9),n()(),i(10,"mat-form-field",5)(11,"mat-label"),a(12,"L\xFD do h\u1EE7y \u0111\u01A1n h\xE0ng"),n(),i(13,"textarea",6),k("ngModelChange",function(s){return D(o.lydohuy,s)||(o.lydohuy=s),s}),p("input",function(){return o.onInputChange()}),a(14,"        "),n(),i(15,"mat-hint",7)(16,"span"),a(17),n()(),i(18,"mat-hint",8),a(19),n(),m(20,nt,2,0,"mat-error",9),n(),m(21,ot,16,6,"div",10),n(),i(22,"mat-dialog-actions",11)(23,"button",12),p("click",function(){return o.onCancel()}),i(24,"mat-icon"),a(25,"close"),n(),a(26," H\u1EE7y B\u1ECF "),n(),i(27,"button",13),p("click",function(){return o.onConfirm()}),i(28,"mat-icon"),a(29,"check"),n(),a(30," X\xE1c Nh\u1EADn H\u1EE7y \u0110\u01A1n "),n()()),e&2&&(l(9),h(" H\xE0nh \u0111\u1ED9ng n\xE0y kh\xF4ng th\u1EC3 ho\xE0n t\xE1c. ",o.hasInventory?"T\u1ED3n kho s\u1EBD \u0111\u01B0\u1EE3c \u0111i\u1EC1u ch\u1EC9nh t\u1EF1 \u0111\u1ED9ng.":""," "),l(4),v("ngModel",o.lydohuy),l(3),x("text-red-500",o.lydohuy.length<10),l(),h(" ",o.lydohuy.length,"/10 k\xFD t\u1EF1 t\u1ED1i thi\u1EC3u "),l(2),h("",o.lydohuy.length,"/500"),l(),c("ngIf",o.showError),l(),c("ngIf",o.orderInfo),l(6),c("disabled",!o.isValid()))},dependencies:[I,_,O,K,j,V,G,$,W,X,q,Q,J,S,M,F,w,H,R,B,A,z,T],styles:["[_nghost-%COMP%]{display:block}mat-dialog-content[_ngcontent-%COMP%]{min-width:500px;max-width:600px}"]})};var Z=class r{dialog=d(N);snackBar=d(P);donhangService=d(U);dathangService=d(Y);cancelDonhang(t){return y(this,null,function*(){if(t.status==="huy")return this.snackBar.open("\u274C \u0110\u01A1n h\xE0ng \u0111\xE3 \u0111\u01B0\u1EE3c h\u1EE7y tr\u01B0\u1EDBc \u0111\xF3","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1;if(t.status==="hoanthanh")return this.snackBar.open("\u274C Kh\xF4ng th\u1EC3 h\u1EE7y \u0111\u01A1n h\xE0ng \u0111\xE3 ho\xE0n th\xE0nh","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1;if(t.status==="danhan")return this.snackBar.open("\u274C Kh\xF4ng th\u1EC3 h\u1EE7y \u0111\u01A1n h\xE0ng \u0111\xE3 nh\u1EADn","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1;let o=yield this.dialog.open(g,{width:"500px",disableClose:!0,data:{orderType:"donhang",orderId:t.id,orderCode:t.code||t.madonhang,currentStatus:t.status}}).afterClosed().toPromise();if(!o)return!1;let u=this.snackBar.open("\u23F3 \u0110ang x\u1EED l\xFD h\u1EE7y \u0111\u01A1n h\xE0ng...","",{duration:0,horizontalPosition:"end",verticalPosition:"top"});try{let s=yield this.donhangService.cancelDonhang(t.id,o);return u.dismiss(),this.snackBar.open(`\u2705 ${s.message}`,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),!0}catch(s){return u.dismiss(),this.snackBar.open(`\u274C L\u1ED7i khi h\u1EE7y \u0111\u01A1n h\xE0ng: ${s.message}`,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1}})}cancelDathang(t){return y(this,null,function*(){if(t.status==="huy")return this.snackBar.open("\u274C \u0110\u01A1n \u0111\u1EB7t h\xE0ng \u0111\xE3 \u0111\u01B0\u1EE3c h\u1EE7y tr\u01B0\u1EDBc \u0111\xF3","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1;if(t.status==="hoanthanh")return this.snackBar.open("\u274C Kh\xF4ng th\u1EC3 h\u1EE7y \u0111\u01A1n \u0111\u1EB7t h\xE0ng \u0111\xE3 ho\xE0n th\xE0nh","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),!1;if(t.status==="danhan")return this.snackBar.open("\u274C Kh\xF4ng th\u1EC3 h\u1EE7y \u0111\u01A1n \u0111\u1EB7t h\xE0ng \u0111\xE3 nh\u1EADn","\u0110\xF3ng",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),!1;let o=yield this.dialog.open(g,{width:"500px",disableClose:!0,data:{orderType:"dathang",orderId:t.id,orderCode:t.code||t.madathang,currentStatus:t.status}}).afterClosed().toPromise();if(!o)return!1;let u=this.snackBar.open("\u23F3 \u0110ang x\u1EED l\xFD h\u1EE7y \u0111\u01A1n \u0111\u1EB7t h\xE0ng...","",{duration:0,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});try{let s=yield this.dathangService.cancelDathang(t.id,o);return u.dismiss(),this.snackBar.open(`\u2705 ${s.message}`,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),!0}catch(s){return u.dismiss(),this.snackBar.open(`\u274C L\u1ED7i khi h\u1EE7y \u0111\u01A1n \u0111\u1EB7t h\xE0ng: ${s.message}`,"\u0110\xF3ng",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]}),!1}})}canCancelOrder(t){return t.status!=="huy"&&t.status!=="hoanthanh"&&t.status!=="danhan"}getCancelButtonTooltip(t){return t.status==="huy"?"\u0110\u01A1n h\xE0ng \u0111\xE3 \u0111\u01B0\u1EE3c h\u1EE7y":t.status==="hoanthanh"?"Kh\xF4ng th\u1EC3 h\u1EE7y \u0111\u01A1n h\xE0ng \u0111\xE3 ho\xE0n th\xE0nh":t.status==="danhan"?"Kh\xF4ng th\u1EC3 h\u1EE7y \u0111\u01A1n h\xE0ng \u0111\xE3 nh\u1EADn":"H\u1EE7y \u0111\u01A1n h\xE0ng"}static \u0275fac=function(e){return new(e||r)};static \u0275prov=E({token:r,factory:r.\u0275fac,providedIn:"root"})};export{Z as a};
