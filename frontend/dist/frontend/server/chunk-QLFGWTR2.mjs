import './polyfills.server.mjs';
import{a as m}from"./chunk-MGIVCIKU.mjs";import{a as n}from"./chunk-Y5GM6BPP.mjs";import{b as y}from"./chunk-24HJ3KDN.mjs";import{d as u}from"./chunk-ZZ6RE4P2.mjs";import{Ra as i,ia as p,na as d}from"./chunk-HSX3JMXX.mjs";import{a as h,g as f,j as o}from"./chunk-RIAI3ORJ.mjs";var c=f(m());var l=class g{constructor(e,t){this._StorageService=e;this.router=t}ListDathang=i([]);DetailDathang=i({});page=i(1);pageCount=i(1);total=i(0);pageSize=i(50);dathangId=i(null);setDathangId(e){this.dathangId.set(e)}ImportDathang(e){return o(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},a=yield fetch(`${n.APIURL}/dathang/import`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let r=yield a.json();return a.ok||console.log(a.status),r}catch(t){throw console.error(t),t}})}CreateDathang(e){return o(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},a=yield fetch(`${n.APIURL}/dathang`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let r=yield a.json();a.ok,this.getAllDathang(),this.dathangId.set(r.id)}catch(t){return console.error(t)}})}CreateByNhucau(e){return o(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},a=yield fetch(`${n.APIURL}/dathang/bynhucau`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let r=yield a.json();a.ok,this.getAllDathang(),this.dathangId.set(r.id)}catch(t){return console.error(t)}})}getSLChonhap(e){return o(this,null,function*(){let t=h({},e);t.Batdau=(0,c.default)(t.Batdau).utc(),t.Ketthuc=(0,c.default)(t.Ketthuc).utc();try{let a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")},body:JSON.stringify(t)},r=yield fetch(`${n.APIURL}/dathang/getchonhap`,a);return r.ok,yield r.json()}catch(a){return console.error(a)}})}searchDathang(e){return o(this,null,function*(){let t=h({},e);t.Batdau=(0,c.default)(t.Batdau).utc(),t.Ketthuc=(0,c.default)(t.Ketthuc).utc();try{let a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")},body:JSON.stringify(t)},r=yield fetch(`${n.APIURL}/dathang/search`,a);r.ok;let s=yield r.json();return this.ListDathang.set(s.data),s}catch(a){return console.error(a)}})}getAllDathang(){return o(this,null,function*(){try{let e={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},t=yield fetch(`${n.APIURL}/dathang?`,e);t.ok;let a=yield t.json();return this.ListDathang.set(a),a}catch(e){return console.error(e)}})}getDathangByid(e){return o(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},a=yield fetch(`${n.APIURL}/dathang/findid/${e}`,t);if(!a.ok)if(a.status===401){let s=JSON.stringify({code:a.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:s}})}else if(a.status===403){let s=JSON.stringify({code:a.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:s}})}else if(a.status===500){let s=JSON.stringify({code:a.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:s}})}else{let s=JSON.stringify({code:a.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:s}})}let r=yield a.json();this.DetailDathang.set(r)}catch(t){return console.error(t)}})}findbysanpham(e){return o(this,null,function*(){try{let t={method:"GET",headers:{"Content-Type":"application/json"}},a=yield fetch(`${n.APIURL}/dathang/findbysanpham/${e}`,t);return a.ok||this.handleError(a.status),yield a.json()}catch(t){return console.error(t)}})}updateDathang(e){return o(this,null,function*(){try{let t={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},a=yield fetch(`${n.APIURL}/dathang/${e.id}`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let r=yield a.json();a.ok,this.getAllDathang(),this.getDathangByid(e.id)}catch(t){return console.error(t)}})}DeleteDathang(e){return o(this,null,function*(){try{let t={method:"DELETE",headers:{"Content-Type":"application/json"}};(yield fetch(`${n.APIURL}/dathang/${e.id}`,t)).ok,this.getAllDathang()}catch(t){return console.error(t)}})}getDathangBy(e){return o(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(h({},e))},a=yield fetch(`${n.APIURL}/dathang/findby`,t);a.ok||this.handleError(a.status);let r=yield a.json();e.isOne===!0?this.DetailDathang.set(r):(this._StorageService.setItem("dathangs_updatedAt",new Date().toISOString()),this.ListDathang.set(r.data),this.page.set(r.page||1),this.pageCount.set(r.pageCount||1),this.total.set(r.total||r.data.length),this.pageSize.set(this.pageSize()))}catch{}})}handleError(e){let t="L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh";switch(e){case 400:t="Th\xF4ng tin \u0111\xE3 t\u1ED3n t\u1EA1i";break;case 401:case 404:t="Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i";break;case 403:t="B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp";break;case 500:t="L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau";break}}ImportDathangCu(e){return o(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")},body:JSON.stringify(e)},a=yield fetch(`${n.APIURL}/dathang/importcu`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let r=yield a.json();return this.getAllDathang(),r}catch(t){throw console.error("Error importing dathang:",t),t}})}DeleteBulkDathang(e){return o(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")},body:JSON.stringify({ids:e})},a=yield fetch(`${n.APIURL}/dathang/deletebulk`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let r=yield a.json();return this.getAllDathang(),r}catch(t){throw console.error("Error deleting bulk dathang:",t),t}})}getNhacungcapBy(e){return o(this,null,function*(){try{let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")},body:JSON.stringify(e)},a=yield fetch(`${n.APIURL}/nhacungcap/findby`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return yield a.json()}catch(t){throw console.error("Error finding nhacungcap:",t),t}})}static \u0275fac=function(t){return new(t||g)(d(y),d(u))};static \u0275prov=p({token:g,factory:g.\u0275fac,providedIn:"root"})};export{l as a};
