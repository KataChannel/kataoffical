import './polyfills.server.mjs';
import{b as Re,d as Le}from"./chunk-QBPLJZ3D.mjs";import{a as He,b as Be,c as Ae,d as $e,f as We}from"./chunk-ANHJXDI3.mjs";import{a as Ve,b as Fe}from"./chunk-KDA2S5QG.mjs";import{a as Me,b as Pe,c as De,d as Ie,f as Oe,g as ke}from"./chunk-XWEC6ZBH.mjs";import{a as Q,b as X,c as Y,d as Z}from"./chunk-EDNA7BCJ.mjs";import{a as Te,b as we}from"./chunk-QUPMPXJF.mjs";import{a as _e,b as fe,c as ge,e as xe,f as Se,h as he,i as be,k as Ce,l as ve,n as Ee,p as ye}from"./chunk-TTNR4QPS.mjs";import{c as ae,h as oe}from"./chunk-SQLON2R6.mjs";import{a as pe,b as ue}from"./chunk-5J65EW3V.mjs";import{b as ee,g as te,j as ne,l as ie,n as re,p as me,v as le,w as se,y as ce,z as de}from"./chunk-GA3UYBFM.mjs";import"./chunk-J6642ETB.mjs";import{a as q,b as K}from"./chunk-PK3DRSOU.mjs";import{a as j}from"./chunk-6EFOJMAD.mjs";import{a as G,b as J}from"./chunk-K3B42B6X.mjs";import"./chunk-B7K4I7M3.mjs";import"./chunk-FFMPUL32.mjs";import{a as N,e as z}from"./chunk-4I2U3JAI.mjs";import{ka as U}from"./chunk-EDQTS3NM.mjs";import"./chunk-7T6LZHUD.mjs";import{b as y,d as W}from"./chunk-TSEEXHZ6.mjs";import{m as F,n as H,o as B,u as A,x as $}from"./chunk-GTWDOMLN.mjs";import{$b as R,E as D,Fb as k,Hc as r,Ic as u,Jc as _,Mb as c,Mc as b,Nc as C,Oc as v,Wc as L,Xc as V,Yb as d,ic as t,ja as I,jc as n,kc as E,lc as S,mc as h,oa as O,oc as P,tb as o,tc as f,vc as s,ya as g,yb as w,za as x}from"./chunk-KYBR54ZN.mjs";import"./chunk-XAZRL6IZ.mjs";import"./chunk-RIAI3ORJ.mjs";var T=j.APIURL,M=class i{constructor(a){this.http=a}baseUrl=`${T}/performance`;getRealTimeStats(){return this.http.get(`${this.baseUrl}/stats`)}getDatabaseStats(a=24){let e=new y().set("hours",a.toString());return this.http.get(`${this.baseUrl}/db-stats`,{params:e})}getLogs(a={}){let e=new y;return a.limit&&(e=e.set("limit",a.limit.toString())),a.offset&&(e=e.set("offset",a.offset.toString())),a.operation&&(e=e.set("operation",a.operation)),a.success!==void 0&&(e=e.set("success",a.success.toString())),a.minDuration&&(e=e.set("minDuration",a.minDuration.toString())),a.hours&&(e=e.set("hours",a.hours.toString())),this.http.get(`${this.baseUrl}/logs`,{params:e})}getTrends(a=24){let e=new y().set("hours",a.toString());return this.http.get(`${this.baseUrl}/trends`,{params:e})}getSummary(a=24){let e=new y().set("hours",a.toString());return this.http.get(`${this.baseUrl}/summary`,{params:e})}cleanupLogs(a=30){let e=new y().set("days",a.toString());return this.http.get(`${this.baseUrl}/cleanup`,{params:e})}clearMemoryMetrics(){return this.http.get(`${this.baseUrl}/clear`)}testFastOperation(){return this.http.get(`${T}/test-performance/fast`)}testSlowOperation(){return this.http.get(`${T}/test-performance/slow`)}testErrorOperation(){return this.http.get(`${T}/test-performance/error`)}testBulkOperations(){return this.http.post(`${T}/test-performance/bulk`,{})}static \u0275fac=function(e){return new(e||i)(O(W))};static \u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})};function ze(i,a){if(i&1&&(t(0,"mat-card",30)(1,"mat-card-content",31)(2,"mat-icon",32),r(3,"error"),n(),t(4,"span"),r(5),n()()()),i&2){let e=s();o(5),u(e.errorMessage)}}function Ge(i,a){i&1&&(t(0,"div",33),E(1,"mat-spinner",34),n())}function Je(i,a){if(i&1&&(t(0,"div",43)(1,"h2",44)(2,"mat-icon",45),r(3,"flash_on"),n(),r(4," Real-time Performance "),n(),t(5,"div",46)(6,"mat-card",47)(7,"mat-card-content",48)(8,"div",49),r(9),n(),t(10,"div",50),r(11,"Total Operations"),n()()(),t(12,"mat-card",51)(13,"mat-card-content",48)(14,"div",49),r(15),n(),t(16,"div",52),r(17,"Success Rate (5m)"),n()()(),t(18,"mat-card",53)(19,"mat-card-content",48)(20,"div",49),r(21),n(),t(22,"div",54),r(23,"Avg Response (5m)"),n()()(),t(24,"mat-card",55)(25,"mat-card-content",48)(26,"div",49),r(27),n(),t(28,"div",56),r(29,"Error Rate"),n()()()()()),i&2){let e=s(2);o(9),u(e.summary.realTime.totalOperations),o(6),u((e.summary.realTime.recent==null||e.summary.realTime.recent.last5Minutes==null?null:e.summary.realTime.recent.last5Minutes.successRate)||"100%"),o(6),u((e.summary.realTime.recent==null||e.summary.realTime.recent.last5Minutes==null?null:e.summary.realTime.recent.last5Minutes.averageResponseTime)||"0ms"),o(6),u(e.summary.realTime.errorRate)}}function qe(i,a){if(i&1&&(t(0,"div",43)(1,"h2",44)(2,"mat-icon",57),r(3,"storage"),n(),r(4),n(),t(5,"div",46)(6,"mat-card",58)(7,"mat-card-content",48)(8,"div",59),r(9),n(),t(10,"div",60),r(11,"Total Operations"),n()()(),t(12,"mat-card",58)(13,"mat-card-content",48)(14,"div",61),r(15),n(),t(16,"div",60),r(17,"Success Rate"),n()()(),t(18,"mat-card",58)(19,"mat-card-content",48)(20,"div",62),r(21),n(),t(22,"div",60),r(23,"Avg Duration"),n()()(),t(24,"mat-card",58)(25,"mat-card-content",48)(26,"div",63),r(27),n(),t(28,"div",60),r(29,"Max Duration"),n()()()()()),i&2){let e=s(2);o(4),_(" Historical Performance (",e.dbStats.timeRange,") "),o(5),u(e.dbStats.overview.totalOperations),o(6),u(e.dbStats.overview.successRate),o(6),u(e.dbStats.overview.avgDuration),o(6),u(e.dbStats.overview.maxDuration)}}function Ke(i,a){i&1&&(t(0,"div",64)(1,"mat-icon",65),r(2,"check_circle"),n(),t(3,"p"),r(4,"No slow operations found"),n()())}function Qe(i,a){if(i&1&&(t(0,"div",66)(1,"div",67)(2,"div",68)(3,"div",69),r(4),n(),t(5,"div",70),r(6),n()(),t(7,"mat-chip",71),r(8),n()()()),i&2){let e=a.$implicit,m=s(2);o(4),u(e.name),o(2),u(m.formatTimestamp(e.timestamp)),o(),d("ngClass",m.getDurationColor(e.duration)),o(),_(" ",e.duration," ")}}function Xe(i,a){i&1&&(t(0,"div",64)(1,"mat-icon",72),r(2,"verified"),n(),t(3,"p"),r(4,"No recent errors"),n()())}function Ye(i,a){if(i&1&&(t(0,"div",66)(1,"div",67)(2,"div",68)(3,"div",73),r(4),n(),t(5,"div",74),r(6),n(),t(7,"div",75),r(8),n()(),t(9,"mat-chip",76),r(10),n()()()),i&2){let e=a.$implicit,m=s(2);o(4),u(e.name),o(2),u(e.error),o(2),u(m.formatTimestamp(e.timestamp)),o(2),u(e.duration)}}function Ze(i,a){if(i&1&&(t(0,"div",35),c(1,Je,30,4,"div",36)(2,qe,30,5,"div",36),t(3,"div",37)(4,"mat-card")(5,"mat-card-header",38)(6,"mat-card-title",24)(7,"mat-icon",39),r(8,"hourglass_bottom"),n(),r(9," Slowest Operations "),n()(),t(10,"mat-card-content",25),c(11,Ke,5,0,"div",40)(12,Qe,9,4,"div",41),n()(),t(13,"mat-card")(14,"mat-card-header",38)(15,"mat-card-title",24)(16,"mat-icon",42),r(17,"error"),n(),r(18," Recent Errors "),n()(),t(19,"mat-card-content",25),c(20,Xe,5,0,"div",40)(21,Ye,11,4,"div",41),n()()()()),i&2){let e=s();o(),d("ngIf",e.summary==null?null:e.summary.realTime),o(),d("ngIf",e.dbStats),o(9),d("ngIf",(e.dbStats==null||e.dbStats.slowestOperations==null?null:e.dbStats.slowestOperations.length)===0),o(),d("ngForOf",e.dbStats==null?null:e.dbStats.slowestOperations),o(8),d("ngIf",(e.dbStats==null||e.dbStats.recentErrors==null?null:e.dbStats.recentErrors.length)===0),o(),d("ngForOf",e.dbStats==null?null:e.dbStats.recentErrors)}}function et(i,a){i&1&&(t(0,"th",110),r(1,"Timestamp"),n())}function tt(i,a){if(i&1&&(t(0,"td",111),r(1),n()),i&2){let e=a.$implicit,m=s(2);o(),_(" ",m.formatTimestamp(e.timestamp)," ")}}function nt(i,a){i&1&&(t(0,"th",110),r(1,"Operation"),n())}function it(i,a){if(i&1&&(t(0,"td",112),r(1),n()),i&2){let e=a.$implicit;o(),_(" ",e.name," ")}}function rt(i,a){i&1&&(t(0,"th",110),r(1,"Duration"),n())}function at(i,a){if(i&1&&(t(0,"td",113)(1,"mat-chip",114),r(2),n()()),i&2){let e=a.$implicit,m=s(2);o(),d("ngClass",m.getDurationColor(e.duration+"ms")),o(),_(" ",e.duration.toFixed(2),"ms ")}}function ot(i,a){i&1&&(t(0,"th",110),r(1,"Status"),n())}function mt(i,a){if(i&1&&(t(0,"div",117),r(1),n()),i&2){let e=s().$implicit;o(),_(" ",e.error," ")}}function lt(i,a){if(i&1&&(t(0,"td",113)(1,"mat-chip",115),r(2),n(),c(3,mt,2,1,"div",116),n()),i&2){let e=a.$implicit;o(),d("color",e.success?"primary":"warn"),o(),_(" ",e.success?"Success":"Error"," "),o(),d("ngIf",!e.success&&e.error)}}function st(i,a){i&1&&(t(0,"th",110),r(1,"Method"),n())}function ct(i,a){if(i&1&&(t(0,"mat-chip",119),r(1),n()),i&2){let e=s().$implicit;o(),u(e.method)}}function dt(i,a){if(i&1&&(t(0,"td",113),c(1,ct,2,1,"mat-chip",118),n()),i&2){let e=a.$implicit;o(),d("ngIf",e.method)}}function pt(i,a){i&1&&(t(0,"th",110),r(1,"URL"),n())}function ut(i,a){if(i&1&&(t(0,"td",120),r(1),n()),i&2){let e=a.$implicit;o(),_(" ",e.url||"-"," ")}}function _t(i,a){i&1&&(t(0,"th",110),r(1,"Memory"),n())}function ft(i,a){if(i&1&&(t(0,"span"),r(1),n()),i&2){let e=s().$implicit;o(),_("",e.memoryUsage.toFixed(1),"MB")}}function gt(i,a){i&1&&(t(0,"span"),r(1,"-"),n())}function xt(i,a){if(i&1&&(t(0,"td",111),c(1,ft,2,1,"span",121)(2,gt,2,0,"span",121),n()),i&2){let e=a.$implicit;o(),d("ngIf",e.memoryUsage),o(),d("ngIf",!e.memoryUsage)}}function St(i,a){i&1&&(t(0,"th",110),r(1,"Context"),n())}function ht(i,a){i&1&&(t(0,"button",123),r(1," View "),n())}function bt(i,a){if(i&1&&(t(0,"td",113),c(1,ht,2,0,"button",122),n()),i&2){let e=a.$implicit;o(),d("ngIf",e.context)}}function Ct(i,a){i&1&&E(0,"tr",124)}function vt(i,a){i&1&&E(0,"tr",125)}function Et(i,a){if(i&1){let e=P();t(0,"div",35)(1,"mat-card",77)(2,"mat-card-header")(3,"mat-card-title",24)(4,"mat-icon"),r(5,"filter_list"),n(),r(6," Filters "),n()(),t(7,"mat-card-content",25)(8,"div",78)(9,"mat-form-field",79)(10,"mat-label"),r(11,"Operation Filter"),n(),t(12,"input",80),v("ngModelChange",function(l){g(e);let p=s();return C(p.selectedOperation,l)||(p.selectedOperation=l),x(l)}),f("input",function(){g(e);let l=s();return x(l.onFilterChange())}),n()(),t(13,"mat-form-field",79)(14,"mat-label"),r(15,"Success"),n(),t(16,"mat-select",9),v("ngModelChange",function(l){g(e);let p=s();return C(p.selectedSuccess,l)||(p.selectedSuccess=l),x(l)}),f("selectionChange",function(){g(e);let l=s();return x(l.onFilterChange())}),t(17,"mat-option",81),r(18,"All"),n(),t(19,"mat-option",82),r(20,"Success Only"),n(),t(21,"mat-option",83),r(22,"Errors Only"),n()()(),t(23,"mat-form-field",79)(24,"mat-label"),r(25,"Min Duration (ms)"),n(),t(26,"input",84),v("ngModelChange",function(l){g(e);let p=s();return C(p.minDuration,l)||(p.minDuration=l),x(l)}),f("input",function(){g(e);let l=s();return x(l.onFilterChange())}),n()(),t(27,"mat-form-field",79)(28,"mat-label"),r(29,"Limit"),n(),t(30,"mat-select",9),v("ngModelChange",function(l){g(e);let p=s();return C(p.logLimit,l)||(p.logLimit=l),x(l)}),f("selectionChange",function(){g(e);let l=s();return x(l.onFilterChange())}),t(31,"mat-option",85),r(32,"50"),n(),t(33,"mat-option",86),r(34,"100"),n(),t(35,"mat-option",87),r(36,"200"),n(),t(37,"mat-option",88),r(38,"500"),n()()(),t(39,"div",89)(40,"button",90),f("click",function(){g(e);let l=s();return x(l.loadLogs())}),t(41,"mat-icon"),r(42,"search"),n(),r(43," Search "),n(),t(44,"button",91),f("click",function(){g(e);let l=s();return x(l.loadAllData())}),t(45,"mat-icon"),r(46,"refresh"),n(),r(47," Refresh "),n()()()()(),t(48,"mat-card")(49,"mat-card-header")(50,"mat-card-title",24)(51,"mat-icon"),r(52,"list"),n(),r(53),n()(),t(54,"mat-card-content",92)(55,"div",93)(56,"table",94),S(57,95),c(58,et,2,0,"th",96)(59,tt,2,1,"td",97),h(),S(60,98),c(61,nt,2,0,"th",96)(62,it,2,1,"td",99),h(),S(63,100),c(64,rt,2,0,"th",96)(65,at,3,2,"td",101),h(),S(66,102),c(67,ot,2,0,"th",96)(68,lt,4,3,"td",101),h(),S(69,103),c(70,st,2,0,"th",96)(71,dt,2,1,"td",101),h(),S(72,104),c(73,pt,2,0,"th",96)(74,ut,2,1,"td",105),h(),S(75,106),c(76,_t,2,0,"th",96)(77,xt,3,2,"td",97),h(),S(78,107),c(79,St,2,0,"th",96)(80,bt,2,1,"td",101),h(),c(81,Ct,1,0,"tr",108)(82,vt,1,0,"tr",109),n()()()()()}if(i&2){let e=s();o(12),b("ngModel",e.selectedOperation),o(4),b("ngModel",e.selectedSuccess),o(10),b("ngModel",e.minDuration),o(4),b("ngModel",e.logLimit),o(23),_(" Performance Logs (",e.logs.length,") "),o(3),d("dataSource",e.logs),o(25),d("matHeaderRowDef",e.displayedColumns),o(),d("matRowDefColumns",e.displayedColumns)}}function yt(i,a){i&1&&(t(0,"th",110),r(1,"Hour"),n())}function Tt(i,a){if(i&1&&(t(0,"td",111),r(1),n()),i&2){let e=a.$implicit,m=s(2);o(),_(" ",m.formatTimestamp(e.hour)," ")}}function wt(i,a){i&1&&(t(0,"th",110),r(1,"Total Operations"),n())}function Mt(i,a){if(i&1&&(t(0,"td",112),r(1),n()),i&2){let e=a.$implicit;o(),_(" ",e.totalOperations," ")}}function Pt(i,a){i&1&&(t(0,"th",110),r(1,"Avg Duration"),n())}function Dt(i,a){if(i&1&&(t(0,"td",113)(1,"mat-chip",114),r(2),n()()),i&2){let e=a.$implicit,m=s(2);o(),d("ngClass",m.getDurationColor(e.avgDuration)),o(),_(" ",e.avgDuration," ")}}function It(i,a){i&1&&(t(0,"th",110),r(1,"Max Duration"),n())}function Ot(i,a){if(i&1&&(t(0,"td",113)(1,"mat-chip",114),r(2),n()()),i&2){let e=a.$implicit,m=s(2);o(),d("ngClass",m.getDurationColor(e.maxDuration)),o(),_(" ",e.maxDuration," ")}}function kt(i,a){i&1&&(t(0,"th",110),r(1,"Error Count"),n())}function Rt(i,a){if(i&1&&(t(0,"td",113)(1,"mat-chip",115),r(2),n()()),i&2){let e=a.$implicit;o(),d("color",e.errorCount>0?"warn":"primary"),o(),_(" ",e.errorCount," ")}}function Lt(i,a){i&1&&(t(0,"th",110),r(1,"Error Rate"),n())}function Vt(i,a){if(i&1&&(t(0,"td",111),r(1),n()),i&2){let e=a.$implicit;o(),_(" ",e.errorRate," ")}}function Ft(i,a){i&1&&E(0,"tr",124)}function Ht(i,a){i&1&&E(0,"tr",125)}function Bt(i,a){if(i&1&&(t(0,"div",35)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title",24)(4,"mat-icon"),r(5,"trending_up"),n(),r(6," Performance Trends "),n()(),t(7,"mat-card-content",92)(8,"div",93)(9,"table",94),S(10,126),c(11,yt,2,0,"th",96)(12,Tt,2,1,"td",97),h(),S(13,127),c(14,wt,2,0,"th",96)(15,Mt,2,1,"td",99),h(),S(16,128),c(17,Pt,2,0,"th",96)(18,Dt,3,2,"td",101),h(),S(19,129),c(20,It,2,0,"th",96)(21,Ot,3,2,"td",101),h(),S(22,130),c(23,kt,2,0,"th",96)(24,Rt,3,2,"td",101),h(),S(25,131),c(26,Lt,2,0,"th",96)(27,Vt,2,1,"td",97),h(),c(28,Ft,1,0,"tr",108)(29,Ht,1,0,"tr",109),n()()()()()),i&2){let e=s();o(9),d("dataSource",e.trends),o(19),d("matHeaderRowDef",e.displayedTrendColumns),o(),d("matRowDefColumns",e.displayedTrendColumns)}}function At(i,a){i&1&&(t(0,"div",141)(1,"mat-icon",142),r(2,"science"),n(),t(3,"p",143),r(4,"No test results yet"),n(),t(5,"p",7),r(6,"Run some tests above to see results"),n()())}function $t(i,a){if(i&1&&(t(0,"div",149)(1,"div",150)(2,"mat-icon",7),r(3,"error"),n(),t(4,"span",151),r(5,"Error:"),n()(),t(6,"p",152),r(7),n()()),i&2){let e=s().$implicit;o(7),u(e.error)}}function Wt(i,a){if(i&1&&(t(0,"div",153)(1,"div",154)(2,"mat-icon",7),r(3,"code"),n(),t(4,"span",151),r(5,"Result:"),n()(),t(6,"pre",155),r(7),L(8,"json"),n()()),i&2){let e=s().$implicit;o(7),u(V(8,1,e.result))}}function jt(i,a){if(i&1&&(t(0,"mat-expansion-panel",144)(1,"mat-expansion-panel-header")(2,"mat-panel-title",2)(3,"mat-icon"),r(4),n(),t(5,"span",145),r(6),n(),t(7,"mat-chip",115),r(8),n()(),t(9,"mat-panel-description"),r(10),n()(),t(11,"div",146),c(12,$t,8,1,"div",147)(13,Wt,9,3,"div",148),n()()),i&2){let e=a.$implicit,m=s(2);o(3),R(e.success?"text-green-600":"text-red-600"),o(),_(" ",e.success?"check_circle":"error"," "),o(2),_("",e.type," Test"),o(),d("color",e.success?"primary":"warn"),o(),u(e.duration),o(2),_(" ",m.formatTimestamp(e.timestamp)," "),o(2),d("ngIf",e.error),o(),d("ngIf",e.result)}}function Ut(i,a){if(i&1){let e=P();t(0,"div",35)(1,"mat-card",77)(2,"mat-card-header")(3,"mat-card-title",24)(4,"mat-icon"),r(5,"science"),n(),r(6," Test Operations "),n(),t(7,"mat-card-subtitle"),r(8,"Use these operations to test the performance logging system"),n()(),t(9,"mat-card-content",25)(10,"div",46)(11,"button",132),f("click",function(){g(e);let l=s();return x(l.runTest("fast"))}),t(12,"mat-icon",133),r(13,"flash_on"),n(),t(14,"span"),r(15,"Test Fast (~100ms)"),n()(),t(16,"button",134),f("click",function(){g(e);let l=s();return x(l.runTest("slow"))}),t(17,"mat-icon",133),r(18,"hourglass_bottom"),n(),t(19,"span"),r(20,"Test Slow (~2000ms)"),n()(),t(21,"button",135),f("click",function(){g(e);let l=s();return x(l.runTest("error"))}),t(22,"mat-icon",133),r(23,"error"),n(),t(24,"span"),r(25,"Test Error"),n()(),t(26,"button",136),f("click",function(){g(e);let l=s();return x(l.runTest("bulk"))}),t(27,"mat-icon",133),r(28,"layers"),n(),t(29,"span"),r(30,"Test Bulk (10 ops)"),n()()()()(),t(31,"mat-card")(32,"mat-card-header",137)(33,"mat-card-title",24)(34,"mat-icon"),r(35,"assignment_turned_in"),n(),r(36," Test Results "),n(),t(37,"button",138),f("click",function(){g(e);let l=s();return x(l.testResults=[])}),t(38,"mat-icon"),r(39,"clear_all"),n(),r(40," Clear Results "),n()(),t(41,"mat-card-content",25),c(42,At,7,0,"div",139)(43,jt,14,9,"mat-expansion-panel",140),n()()()}if(i&2){let e=s();o(42),d("ngIf",e.testResults.length===0),o(),d("ngForOf",e.testResults)}}var je=class i{constructor(a,e,m){this.performanceService=a;this.snackBar=e;this.dialog=m}summary=null;dbStats=null;logs=[];trends=[];selectedHours=24;selectedOperation="";selectedSuccess="all";minDuration=null;logLimit=50;activeTab="dashboard";isLoading=!1;errorMessage="";autoRefresh=!1;refreshInterval=null;testResults=[];displayedColumns=["timestamp","operation","duration","status","method","url","memory","context"];displayedTrendColumns=["hour","totalOperations","avgDuration","maxDuration","errorCount","errorRate"];ngOnInit(){this.loadAllData()}ngOnDestroy(){this.refreshInterval&&this.refreshInterval.unsubscribe()}loadAllData(){this.isLoading=!0,this.errorMessage="",this.performanceService.getSummary(this.selectedHours).subscribe({next:a=>{this.summary=a},error:a=>{console.error("Error loading summary:",a),this.errorMessage="Failed to load performance summary",this.showSnackBar("Failed to load performance summary","error")}}),this.performanceService.getDatabaseStats(this.selectedHours).subscribe({next:a=>{this.dbStats=a},error:a=>{console.error("Error loading database stats:",a)}}),this.performanceService.getTrends(this.selectedHours).subscribe({next:a=>{this.trends=a},error:a=>{console.error("Error loading trends:",a)}}),this.loadLogs(),this.isLoading=!1}loadLogs(){let a={hours:this.selectedHours,limit:this.logLimit,operation:this.selectedOperation||void 0,success:this.selectedSuccess==="all"?void 0:this.selectedSuccess==="true",minDuration:this.minDuration||void 0};this.performanceService.getLogs(a).subscribe({next:e=>{this.logs=e},error:e=>{console.error("Error loading logs:",e)}})}onFilterChange(){this.loadLogs()}onHoursChange(){this.loadAllData()}toggleAutoRefresh(){this.autoRefresh?this.refreshInterval=D(3e4).subscribe(()=>{this.loadAllData()}):this.refreshInterval&&(this.refreshInterval.unsubscribe(),this.refreshInterval=null)}runTest(a){let e;switch(a){case"fast":e=this.performanceService.testFastOperation();break;case"slow":e=this.performanceService.testSlowOperation();break;case"error":e=this.performanceService.testErrorOperation();break;case"bulk":e=this.performanceService.testBulkOperations();break;default:return}let m=Date.now();e.subscribe({next:l=>{let p=Date.now()-m;this.testResults.unshift({type:a,success:!0,duration:p+"ms",result:l,timestamp:new Date().toISOString()}),setTimeout(()=>this.loadAllData(),1e3)},error:l=>{let p=Date.now()-m;this.testResults.unshift({type:a,success:!1,duration:p+"ms",error:l.message,timestamp:new Date().toISOString()})}})}showSnackBar(a,e="info"){let m={duration:3e3,panelClass:[`snack-${e}`]};this.snackBar.open(a,"Close",m)}getDurationColor(a){let e=parseFloat(a.replace("ms",""));return e>1e3?"text-red-600 bg-red-100":e>500?"text-orange-600 bg-orange-100":"text-green-600 bg-green-100"}formatTimestamp(a){return new Date(a).toLocaleString()}cleanupLogs(){this.performanceService.cleanupLogs(30).subscribe({next:a=>{this.showSnackBar(a.message,"success"),this.loadAllData()},error:a=>{this.showSnackBar("Error cleaning up logs: "+a.message,"error")}})}clearMemoryMetrics(){this.performanceService.clearMemoryMetrics().subscribe({next:a=>{this.showSnackBar(a.message,"success"),this.loadAllData()},error:a=>{this.showSnackBar("Error clearing metrics: "+a.message,"error")}})}static \u0275fac=function(e){return new(e||i)(w(M),w(G),w(ae))};static \u0275cmp=k({type:i,selectors:[["app-performance"]],decls:59,vars:4,consts:[[1,"p-6","w-full","mx-auto"],[1,"flex","flex-col","lg:flex-row","justify-between","items-start","lg:items-center","mb-8","gap-4"],[1,"flex","items-center","gap-3"],[1,"text-blue-600","text-3xl"],[1,"text-3xl","font-bold","text-gray-800"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","gap-3"],["color","primary",3,"ngModelChange","change","ngModel"],[1,"text-sm"],["appearance","outline",1,"w-40"],[3,"ngModelChange","selectionChange","ngModel"],["value","1"],["value","6"],["value","24"],["value","72"],["value","168"],["class","mb-6 border-l-4 border-red-500 bg-red-50",4,"ngIf"],["class","flex justify-center items-center py-12",4,"ngIf"],["mat-align-tabs","start",1,"mb-8"],["label","Dashboard"],["matTabContent",""],["label","Performance Logs"],["label","Trends"],["label","Test Operations"],[1,"mt-8"],[1,"flex","items-center","gap-2"],[1,"p-4"],[1,"flex","flex-wrap","gap-3"],["mat-raised-button","","color","warn",1,"flex","items-center","gap-2",3,"click"],["mat-stroked-button","",1,"flex","items-center","gap-2",3,"click"],["mat-raised-button","","color","primary",1,"flex","items-center","gap-2",3,"click"],[1,"mb-6","border-l-4","border-red-500","bg-red-50"],[1,"flex","items-center","gap-3","text-red-700"],[1,"text-red-500"],[1,"flex","justify-center","items-center","py-12"],["diameter","60"],[1,"py-6"],["class","mb-8",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-gray-50"],[1,"text-orange-600"],["class","text-center text-gray-500 py-8",4,"ngIf"],["class","border-b border-gray-200 py-3 last:border-b-0",4,"ngFor","ngForOf"],[1,"text-red-600"],[1,"mb-8"],[1,"text-xl","font-semibold","mb-4","flex","items-center","gap-2"],[1,"text-yellow-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"bg-gradient-to-r","from-blue-500","to-blue-600","text-white"],[1,"text-center"],[1,"text-3xl","font-bold"],[1,"text-blue-100"],[1,"bg-gradient-to-r","from-green-500","to-green-600","text-white"],[1,"text-green-100"],[1,"bg-gradient-to-r","from-cyan-500","to-cyan-600","text-white"],[1,"text-cyan-100"],[1,"bg-gradient-to-r","from-orange-500","to-orange-600","text-white"],[1,"text-orange-100"],[1,"text-purple-600"],[1,"hover:shadow-lg","transition-shadow"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-gray-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-cyan-600"],[1,"text-2xl","font-bold","text-red-600"],[1,"text-center","text-gray-500","py-8"],[1,"text-4xl","mb-2","text-gray-400"],[1,"border-b","border-gray-200","py-3","last:border-b-0"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"ml-2",3,"ngClass"],[1,"text-4xl","mb-2","text-green-400"],[1,"font-medium","text-red-600"],[1,"text-sm","text-gray-600","mt-1"],[1,"text-xs","text-gray-500","mt-1"],["color","warn",1,"ml-2"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-5","gap-4"],["appearance","outline"],["matInput","","placeholder","e.g., DonhangService",3,"ngModelChange","input","ngModel"],["value","all"],["value","true"],["value","false"],["matInput","","type","number","placeholder","1000",3,"ngModelChange","input","ngModel"],["value","50"],["value","100"],["value","200"],["value","500"],[1,"flex","gap-2"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"p-0"],[1,"overflow-x-auto"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","timestamp"],["mat-header-cell","","class","font-semibold",4,"matHeaderCellDef"],["mat-cell","","class","text-sm",4,"matCellDef"],["matColumnDef","operation"],["mat-cell","","class","font-medium",4,"matCellDef"],["matColumnDef","duration"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","method"],["matColumnDef","url"],["mat-cell","","class","text-sm max-w-xs truncate",4,"matCellDef"],["matColumnDef","memory"],["matColumnDef","context"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 transition-colors",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"font-semibold"],["mat-cell","",1,"text-sm"],["mat-cell","",1,"font-medium"],["mat-cell",""],[3,"ngClass"],[3,"color"],["class","text-red-600 text-xs mt-1",4,"ngIf"],[1,"text-red-600","text-xs","mt-1"],["color","accent",4,"ngIf"],["color","accent"],["mat-cell","",1,"text-sm","max-w-xs","truncate"],[4,"ngIf"],["mat-stroked-button","","color","primary","class","text-xs",4,"ngIf"],["mat-stroked-button","","color","primary",1,"text-xs"],["mat-header-row",""],["mat-row","",1,"hover:bg-gray-50","transition-colors"],["matColumnDef","hour"],["matColumnDef","totalOperations"],["matColumnDef","avgDuration"],["matColumnDef","maxDuration"],["matColumnDef","errorCount"],["matColumnDef","errorRate"],["mat-raised-button","","color","primary",1,"h-20","flex","flex-col","justify-center",3,"click"],[1,"mb-2"],["mat-raised-button","","color","accent",1,"h-20","flex","flex-col","justify-center",3,"click"],["mat-raised-button","","color","warn",1,"h-20","flex","flex-col","justify-center",3,"click"],["mat-raised-button","",1,"h-20","flex","flex-col","justify-center","bg-purple-600","text-white",3,"click"],[1,"flex","justify-between","items-center"],["mat-stroked-button","","color","warn",3,"click"],["class","text-center text-gray-500 py-12",4,"ngIf"],["class","mb-3",4,"ngFor","ngForOf"],[1,"text-center","text-gray-500","py-12"],[1,"text-6xl","mb-4","text-gray-300"],[1,"text-lg"],[1,"mb-3"],[1,"capitalize","font-medium"],[1,"pt-4"],["class","bg-red-50 border border-red-200 rounded p-3 mb-4",4,"ngIf"],["class","bg-gray-50 border border-gray-200 rounded p-3",4,"ngIf"],[1,"bg-red-50","border","border-red-200","rounded","p-3","mb-4"],[1,"flex","items-center","gap-2","text-red-700"],[1,"font-medium"],[1,"text-red-600","mt-1"],[1,"bg-gray-50","border","border-gray-200","rounded","p-3"],[1,"flex","items-center","gap-2","text-gray-700","mb-2"],[1,"text-sm","bg-white","p-3","rounded","border","overflow-auto","max-h-40"]],template:function(e,m){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),r(4,"speed"),n(),t(5,"h1",4),r(6,"Performance Dashboard"),n()(),t(7,"div",5)(8,"mat-slide-toggle",6),v("ngModelChange",function(p){return C(m.autoRefresh,p)||(m.autoRefresh=p),p}),f("change",function(){return m.toggleAutoRefresh()}),t(9,"span",7),r(10,"Auto Refresh (30s)"),n()(),t(11,"mat-form-field",8)(12,"mat-label"),r(13,"Time Range"),n(),t(14,"mat-select",9),v("ngModelChange",function(p){return C(m.selectedHours,p)||(m.selectedHours=p),p}),f("selectionChange",function(){return m.onHoursChange()}),t(15,"mat-option",10),r(16,"Last Hour"),n(),t(17,"mat-option",11),r(18,"Last 6 Hours"),n(),t(19,"mat-option",12),r(20,"Last 24 Hours"),n(),t(21,"mat-option",13),r(22,"Last 3 Days"),n(),t(23,"mat-option",14),r(24,"Last Week"),n()()()()(),c(25,ze,6,1,"mat-card",15)(26,Ge,2,0,"div",16),t(27,"mat-tab-group",17)(28,"mat-tab",18),c(29,Ze,22,6,"ng-template",19),n(),t(30,"mat-tab",20),c(31,Et,83,8,"ng-template",19),n(),t(32,"mat-tab",21),c(33,Bt,30,3,"ng-template",19),n(),t(34,"mat-tab",22),c(35,Ut,44,2,"ng-template",19),n()(),t(36,"mat-card",23)(37,"mat-card-header")(38,"mat-card-title",24)(39,"mat-icon"),r(40,"settings"),n(),r(41," Management Actions "),n()(),t(42,"mat-card-content",25)(43,"div",26)(44,"button",27),f("click",function(){return m.cleanupLogs()}),t(45,"mat-icon"),r(46,"delete_sweep"),n(),t(47,"span"),r(48,"Cleanup Old Logs (30 days)"),n()(),t(49,"button",28),f("click",function(){return m.clearMemoryMetrics()}),t(50,"mat-icon"),r(51,"memory"),n(),t(52,"span"),r(53,"Clear Memory Metrics"),n()(),t(54,"button",29),f("click",function(){return m.loadAllData()}),t(55,"mat-icon"),r(56,"refresh"),n(),t(57,"span"),r(58,"Refresh All Data"),n()()()()()()),e&2&&(o(8),b("ngModel",m.autoRefresh),o(6),b("ngModel",m.selectedHours),o(11),d("ngIf",m.errorMessage),o(),d("ngIf",m.isLoading))},dependencies:[$,F,H,B,A,re,ee,ie,te,ne,ke,Me,De,Oe,Ie,Pe,Z,Q,X,Y,z,N,K,q,ue,le,me,pe,U,de,ce,se,we,Te,Le,Re,ye,_e,ge,be,xe,fe,Ce,Se,he,ve,Ee,Fe,Ve,J,oe,We,He,Be,$e,Ae],encapsulation:2})};export{je as PerformanceComponent};
