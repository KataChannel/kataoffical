import './polyfills.server.mjs';
import{a as ct,b as At}from"./chunk-2BZNUDNY.mjs";import"./chunk-OGD27TCZ.mjs";import"./chunk-PDYHWB5Z.mjs";import"./chunk-CIEUSRED.mjs";import{b as _t}from"./chunk-D2TPH5CL.mjs";import"./chunk-V6I7HCHT.mjs";import"./chunk-VFMQHSTT.mjs";import"./chunk-MGIVCIKU.mjs";import"./chunk-KUMBC2B4.mjs";import"./chunk-4E5KT4OO.mjs";import{h as ut}from"./chunk-LCG5BFFZ.mjs";import"./chunk-26NM6QMQ.mjs";import{d as gt}from"./chunk-SWDJOT3A.mjs";import"./chunk-XF6K4MFS.mjs";import{b as pt}from"./chunk-6E274S4T.mjs";import"./chunk-S7OLDBS7.mjs";import{a as at,b as dt}from"./chunk-HVMEC4BO.mjs";import{n as rt,v as st,y as mt}from"./chunk-HKITP4QW.mjs";import"./chunk-3IN2SXI7.mjs";import"./chunk-7ZQLLCLM.mjs";import{a as ot}from"./chunk-LBZM5ZJB.mjs";import"./chunk-PZHTLK5D.mjs";import"./chunk-3XQYAY3W.mjs";import{c as nt,e as lt}from"./chunk-JT2RA4VF.mjs";import"./chunk-75D2G2X6.mjs";import"./chunk-7T6LZHUD.mjs";import{a as et,d as it}from"./chunk-QPVY4VVM.mjs";import"./chunk-Q7U6F3W6.mjs";import{m as $,n as q,o as Q,t as Y,u as Z,w as tt}from"./chunk-A3OGUTBJ.mjs";import{$c as E,Gb as U,Hc as v,Ic as e,Jc as A,Kc as r,Nb as c,Ra as y,Uc as K,Xc as h,Yc as w,Zb as p,Zc as W,ic as l,jc as t,kc as G,lc as f,mc as x,oa as g,oc as H,tb as d,tc as J,vc as _,wd as X,xa as j,ya as z}from"./chunk-KEAQD3JS.mjs";import"./chunk-KB5IWD3E.mjs";import{j as m}from"./chunk-RIAI3ORJ.mjs";var Et=(a,i,o)=>({"bg-green-100 text-green-800":a,"bg-red-100 text-red-800":i,"bg-yellow-100 text-yellow-800":o});function Dt(a,i){if(a&1&&(l(0,"li"),e(1),t()),a&2){let o=i.$implicit;d(),A(o)}}function Ct(a,i){if(a&1&&(f(0),l(1,"ul",17),c(2,Dt,2,1,"li",18),t(),x()),a&2){let o,n=_();d(2),p("ngForOf",(o=n.DetailAuditlog())==null?null:o.changedFields)}}function St(a,i){a&1&&(l(0,"span",19),e(1,"No changed fields"),t())}function It(a,i){if(a&1&&(f(0),l(1,"pre",20),e(2),h(3,"json"),t(),x()),a&2){let o,n=_();d(2),A(w(3,1,(o=n.DetailAuditlog())==null?null:o.oldValues))}}function yt(a,i){a&1&&(l(0,"span",19),e(1,"No old values"),t())}function wt(a,i){if(a&1&&(f(0),l(1,"pre",20),e(2),h(3,"json"),t(),x()),a&2){let o,n=_();d(2),A(w(3,1,(o=n.DetailAuditlog())==null?null:o.newValues))}}function bt(a,i){a&1&&(l(0,"span",19),e(1,"No new values"),t())}function Mt(a,i){if(a&1&&(l(0,"div",21)(1,"h2",22),e(2,"Error Details"),t(),l(3,"div")(4,"strong"),e(5,"Message:"),t(),e(6),t(),l(7,"div")(8,"strong"),e(9,"Status Code:"),t(),e(10),t()()),a&2){let o,n,u=_();d(6),r(" ",((o=u.DetailAuditlog())==null||o.errorDetails==null?null:o.errorDetails.message)||"N/A"," "),d(4),r(" ",((n=u.DetailAuditlog())==null||n.errorDetails==null?null:n.errorDetails.statusCode)||"N/A"," ")}}var ft=class a{_ListAuditlogComponent=g(At);_AuditlogService=g(ct);_route=g(et);_router=g(it);_snackBar=g(ot);constructor(){this._route.paramMap.subscribe(i=>{let o=i.get("id");this._AuditlogService.setAuditlogId(o)}),X(()=>m(this,null,function*(){let i=this._AuditlogService.auditlogId();i||(this._router.navigate(["/admin/auditlog"]),this._ListAuditlogComponent.drawer.close()),i==="new"?(this.DetailAuditlog.set({}),this._ListAuditlogComponent.drawer.open(),this.isEdit.update(o=>!o),this._router.navigate(["/admin/auditlog","new"])):(yield this._AuditlogService.getAuditlogBy({id:i,isOne:!0}),this._ListAuditlogComponent.drawer.open(),this._router.navigate(["/admin/auditlog",i]))}))}DetailAuditlog=this._AuditlogService.DetailAuditlog;isEdit=y(!1);isDelete=y(!1);auditlogId=this._AuditlogService.auditlogId;ngOnInit(){return m(this,null,function*(){yield this._AuditlogService.getAuditlogBy({id:this.auditlogId(),isOne:!0}),console.log("DetailAuditlogComponent initialized",this.DetailAuditlog())})}handleAuditlogAction(){return m(this,null,function*(){this.auditlogId()==="new"?yield this.createAuditlog():yield this.updateAuditlog()})}createAuditlog(){return m(this,null,function*(){try{yield this._AuditlogService.CreateAuditlog(this.DetailAuditlog()),this._snackBar.open("T\u1EA1o M\u1EDBi Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(i=>!i)}catch(i){console.error("L\u1ED7i khi t\u1EA1o auditlog:",i)}})}updateAuditlog(){return m(this,null,function*(){try{yield this._AuditlogService.updateAuditlog(this.DetailAuditlog()),this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this.isEdit.update(i=>!i)}catch(i){console.error("L\u1ED7i khi c\u1EADp nh\u1EADt auditlog:",i)}})}DeleteData(){return m(this,null,function*(){try{yield this._AuditlogService.DeleteAuditlog(this.DetailAuditlog()),this._snackBar.open("X\xF3a Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),this._router.navigate(["/admin/auditlog"])}catch(i){console.error("L\u1ED7i khi x\xF3a auditlog:",i)}})}goBack(){this._router.navigate(["/admin/auditlog"]),this._ListAuditlogComponent.drawer.close()}trackByFn(i,o){return o.id}toggleEdit(){this.isEdit.update(i=>!i)}toggleDelete(){this.isDelete.update(i=>!i)}FillSlug(){this.DetailAuditlog.update(i=>(i.slug=gt(i.title),i))}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=U({type:a,selectors:[["app-detailauditlog"]],decls:79,vars:28,consts:[["noChangedFields",""],["noOldValues",""],["noNewValues",""],[1,"flex","flex-row","justify-between","items-center","space-x-2","p-2"],["mat-icon-button","","color","primary",3,"click"],[1,"font-bold"],[1,"flex-grow"],[1,"relative","flex","flex-col","w-full","p-4","overflow-auto"],[1,"bg-white","border","rounded","p-4"],[1,"flex","items-center","gap-2"],[1,"text-xl","font-semibold"],[1,"px-2","py-1","rounded","text-xs","font-bold",3,"ngClass"],[1,"grid","md:grid-cols-2","gap-4","mt-2"],[1,"bg-white","border","rounded","p-4","mt-4"],[1,"text-lg","font-semibold","mb-2"],[4,"ngIf","ngIfElse"],["class","bg-red-50 border border-red-200 rounded p-4 mt-4",4,"ngIf"],[1,"list-disc","pl-5"],[4,"ngFor","ngForOf"],[1,"text-gray-500"],[1,"whitespace-pre-wrap"],[1,"bg-red-50","border","border-red-200","rounded","p-4","mt-4"],[1,"text-lg","font-semibold","mb-2","text-red-700"]],template:function(o,n){if(o&1){let u=H();l(0,"div",3)(1,"button",4),J("click",function(){return j(u),z(n.goBack())}),l(2,"mat-icon"),e(3,"arrow_back"),t()(),l(4,"div",5),e(5),t(),G(6,"div",6),t(),l(7,"div",7)(8,"div",8)(9,"div",9)(10,"span",10),e(11,"Audit Log Detail"),t(),l(12,"span",11),e(13),t()(),l(14,"div",12)(15,"div")(16,"strong"),e(17,"ID:"),t(),e(18),t(),l(19,"div")(20,"strong"),e(21,"Entity Name:"),t(),e(22),t(),l(23,"div")(24,"strong"),e(25,"Action:"),t(),e(26),t(),l(27,"div")(28,"strong"),e(29,"Entity ID:"),t(),e(30),t(),l(31,"div")(32,"strong"),e(33,"IP Address:"),t(),e(34),t(),l(35,"div")(36,"strong"),e(37,"Created At:"),t(),e(38),h(39,"date"),t(),l(40,"div")(41,"strong"),e(42,"User Email:"),t(),e(43),t(),l(44,"div")(45,"strong"),e(46,"User Agent:"),t(),e(47),t(),l(48,"div")(49,"strong"),e(50,"Endpoint:"),t(),e(51),t(),l(52,"div")(53,"strong"),e(54,"Method:"),t(),e(55),t(),l(56,"div")(57,"strong"),e(58,"Response Time:"),t(),e(59),t()()(),l(60,"div",13)(61,"h2",14),e(62,"Changed Fields"),t(),c(63,Ct,3,1,"ng-container",15)(64,St,2,0,"ng-template",null,0,E),t(),l(66,"div",13)(67,"h2",14),e(68,"Old Values"),t(),c(69,It,4,3,"ng-container",15)(70,yt,2,0,"ng-template",null,1,E),t(),l(72,"div",13)(73,"h2",14),e(74,"New Values"),t(),c(75,wt,4,3,"ng-container",15)(76,bt,2,0,"ng-template",null,2,E),t(),c(78,Mt,11,2,"div",16),t()}if(o&2){let u,s,b,M,N,F,k,T,B,R,V,D,C,S,I,L,O,P,xt=v(65),vt=v(71),ht=v(77);d(5),A(((u=n.DetailAuditlog())==null?null:u.codeId)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u"),d(7),p("ngClass",K(24,Et,((s=n.DetailAuditlog())==null?null:s.status)==="SUCCESS",((s=n.DetailAuditlog())==null?null:s.status)==="ERROR",((s=n.DetailAuditlog())==null?null:s.status)==="WARNING")),d(),r(" ",((b=n.DetailAuditlog())==null?null:b.status)||"N/A"," "),d(5),r(" ",((M=n.DetailAuditlog())==null?null:M.id)||"N/A"," "),d(4),r(" ",((N=n.DetailAuditlog())==null?null:N.entityName)||"N/A"," "),d(4),r(" ",((F=n.DetailAuditlog())==null?null:F.action)||"N/A"," "),d(4),r(" ",((k=n.DetailAuditlog())==null?null:k.entityId)||"N/A"," "),d(4),r(" ",((T=n.DetailAuditlog())==null?null:T.ipAddress)||"N/A"," "),d(4),r(" ",W(39,21,(B=n.DetailAuditlog())==null?null:B.createdAt,"HH:mm:ss - dd/MM/yyyy")," "),d(5),r(" ",((R=n.DetailAuditlog())==null?null:R.userEmail)||"N/A"," "),d(4),r(" ",((V=n.DetailAuditlog())==null?null:V.userAgent)||"N/A"," "),d(4),r(" ",((D=n.DetailAuditlog())==null||D.metadata==null?null:D.metadata.endpoint)||"N/A"," "),d(4),r(" ",((C=n.DetailAuditlog())==null||C.metadata==null?null:C.metadata.method)||"N/A"," "),d(4),r(" ",((S=n.DetailAuditlog())==null||S.metadata==null?null:S.metadata.responseTime)||"N/A"," ms "),d(4),p("ngIf",(I=n.DetailAuditlog())==null||I.changedFields==null?null:I.changedFields.length)("ngIfElse",xt),d(6),p("ngIf",(L=n.DetailAuditlog())==null?null:L.oldValues)("ngIfElse",vt),d(6),p("ngIf",(O=n.DetailAuditlog())==null?null:O.newValues)("ngIfElse",ht),d(3),p("ngIf",((P=n.DetailAuditlog())==null?null:P.status)==="ERROR")}},dependencies:[st,mt,rt,dt,at,lt,nt,pt,ut,tt,$,q,Q,Z,Y,_t],encapsulation:2})};export{ft as DetailAuditlogComponent};
