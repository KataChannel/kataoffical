import './polyfills.server.mjs';
import{a as Xe}from"./chunk-NTTJTKHX.mjs";import{a as We,b as Ze}from"./chunk-GP5NNPSV.mjs";import{a as je}from"./chunk-KVXSGNXI.mjs";import{a as Fe,b as Le,c as L,d as De,e as D,f as Ie,g as Ve,h as Ne,i as Ae,j as $e,k as Oe,l as Re,m as Be,n as ze,o as He,p as Qe,q as qe,r as Ke,s as Je,t as Ge}from"./chunk-IVKJ7EUK.mjs";import{a as pe,b as he,c as de,d as _e}from"./chunk-PCKTCN7P.mjs";import{a as le,b as se,c as me}from"./chunk-2CQA7NHR.mjs";import{b as Me}from"./chunk-IRYT2YMQ.mjs";import{b as Te,d as Ee,e as be}from"./chunk-SWDJOT3A.mjs";import{a as ce,b as ue}from"./chunk-RRMIVD4H.mjs";import{a as re}from"./chunk-KZYXYOGH.mjs";import{b as fe,g as Ce,j as ge,n as xe,p as ke,q as ye,u as we,v as Se,x as ve,y as Pe}from"./chunk-2I4WAPPZ.mjs";import{b as oe,d as ae}from"./chunk-V3ASAWLT.mjs";import{x as ie,y as ne}from"./chunk-GFXQFTRQ.mjs";import{b as ee,d as te}from"./chunk-OAPSLP2Q.mjs";import{n as Z,o as X,q as Y,s as U}from"./chunk-G5MXV5JM.mjs";import{Bb as R,Bc as $,Cc as u,Dc as E,Ec as C,Ib as y,Ic as J,Jc as G,Kc as j,Mc as O,Rc as b,Tc as F,Ub as _,Xb as B,Yb as z,_b as V,ac as H,bc as N,cc as A,dc as o,ec as r,fc as v,gc as Q,hc as q,jc as S,la as w,nd as W,oc as f,pb as l,qc as s,ua as h,uc as K,va as d,wc as P,xc as M,yc as T}from"./chunk-WORJTRGV.mjs";import{a as I,j as k}from"./chunk-RIAI3ORJ.mjs";var it=["drawer"],nt=()=>[5,10,25,100],ot=()=>({standalone:!0}),at=(n,t)=>t.key;function rt(n,t){if(n&1){let e=S();o(0,"button",30),f("click",function(a){let m=h(e).$implicit;return s().toggleColumn(m),d(a.stopPropagation())}),o(1,"mat-icon"),u(2),r(),o(3,"span"),u(4),r()()}if(n&2){let e=t.$implicit;l(2),E(e.isShow?"check_box":"check_box_outline_blank"),l(2),E(e.value)}}function lt(n,t){if(n&1){let e=S();o(0,"mat-form-field",33)(1,"mat-label"),u(2),r(),o(3,"input",34),f("keyup",function(){h(e);let a=s(2);return d(a.applyFilter())}),j("ngModelChange",function(a){let m=h(e).$implicit,p=s(2);return G(p.filterValues[m],a)||(p.filterValues[m]=a),d(a)}),r()()}if(n&2){let e=t.$implicit,i=s(2);l(2),E(i.ColumnName[e]),l(),K("placeholder","Vui l\xF2ng Nh\u1EADp ",e,""),J("ngModel",i.filterValues[e]),_("ngModelOptions",O(5,ot))}}function st(n,t){if(n&1&&(o(0,"div",31),y(1,lt,4,6,"mat-form-field",32),r()),n&2){let e=s();l(),_("ngForOf",e.displayedColumns)}}function mt(n,t){if(n&1&&(o(0,"th",37)(1,"span",38),u(2),r()()),n&2){let e=s().$implicit,i=s();l(2),C(" ",i.ColumnName[e]," ")}}function ct(n,t){if(n&1&&(o(0,"span",40),u(1),r()),n&2){let e=s().index;l(),C(" ",e+1," ")}}function ut(n,t){if(n&1&&(o(0,"span",40),u(1),r()),n&2){let e,i=s().$implicit,a=s().$implicit,m=s();l(),C(" ",(e=m.getName(i[a]))==null?null:e.title," ")}}function pt(n,t){if(n&1&&(o(0,"span",40),u(1),r()),n&2){let e=s().$implicit,i=s().$implicit;l(),C(" ",e[i]==null?null:e[i].name," ")}}function ht(n,t){if(n&1&&(o(0,"span",40),u(1),b(2,"date"),r()),n&2){let e=s().$implicit,i=s().$implicit;l(),C(" ",F(2,1,e[i],"dd/MM/yyyy")," ")}}function dt(n,t){if(n&1&&(o(0,"span",40),u(1),b(2,"date"),r()),n&2){let e=s().$implicit,i=s().$implicit;l(),C(" ",F(2,1,e[i],"dd/MM/yyyy")," ")}}function _t(n,t){n&1&&(o(0,"mat-icon",41),u(1,"check_circle"),r())}function ft(n,t){n&1&&(o(0,"mat-icon",42),u(1,"cancel"),r())}function Ct(n,t){if(n&1&&(o(0,"span",40),y(1,_t,2,0,"mat-icon",41)(2,ft,2,0,"mat-icon",42),r()),n&2){let e=s().$implicit,i=s().$implicit;l(),V(e[i]?1:2)}}function gt(n,t){if(n&1&&(o(0,"span",40),u(1),b(2,"date"),r()),n&2){let e=s().$implicit,i=s().$implicit;l(),C(" ",F(2,1,e[i],"dd/MM/yyyy")," ")}}function xt(n,t){if(n&1&&(o(0,"span",40),u(1),r()),n&2){let e=s().$implicit,i=s().$implicit;l(),C(" ",e[i]," ")}}function kt(n,t){if(n&1&&(o(0,"td",39),y(1,ct,2,1,"span",40)(2,ut,2,1,"span",40)(3,pt,2,1,"span",40)(4,ht,3,4,"span",40)(5,dt,3,4,"span",40)(6,Ct,3,1,"span",40)(7,gt,3,4,"span",40)(8,xt,2,1,"span",40),r()),n&2){let e,i=s().$implicit;l(),V((e=i)==="STT"?1:e==="type"?2:e==="kho"?3:e==="ngay"?4:e==="createdAt"?5:e==="isActive"?6:e==="updatedAt"?7:8)}}function yt(n,t){if(n&1&&(Q(0,25),y(1,mt,3,1,"th",35)(2,kt,9,1,"td",36),q()),n&2){let e=t.$implicit;_("matColumnDef",e)}}function wt(n,t){n&1&&v(0,"tr",43)}function St(n,t){if(n&1){let e=S();o(0,"tr",44),f("click",function(){let a=h(e).$implicit,m=s();return d(m.goToDetail(a))}),r()}if(n&2){let e=t.$implicit,i=s();z("hover:bg-slate-100 ",i.phieukhoId()==e.id?"!bg-slate-200":"","")}}function vt(n,t){n&1&&(o(0,"tr",45)(1,"td",46),u(2,"Kh\xF4ng t\xECm th\u1EA5y"),r()())}var Ye=class n{Detail={};displayedColumns=["STT","maphieu","ngay","type","kho","ghichu","isActive","createdAt","updatedAt"];ColumnName={STT:"STT",maphieu:"M\xE3 Phi\u1EBFu",ngay:"Ng\xE0y",type:"Lo\u1EA1i Phi\u1EBFu",kho:"Kho",ghichu:"Ghi Ch\xFA",isActive:"Tr\u1EA1ng Th\xE1i",createdAt:"Ng\xE0y T\u1EA1o",updatedAt:"Ng\xE0y C\u1EADp Nh\u1EADt"};FilterColumns=JSON.parse(localStorage.getItem("PhieukhoColFilter")||"[]");Columns=[];LoaiPhieu=[{title:"Phi\u1EBFu Nh\u1EADp",value:"nhap"},{title:"Phi\u1EBFu Xu\u1EA5t",value:"xuat"},{title:"Chuy\u1EC3n Kho",value:"chuyenkho"},{title:"\u0110i\u1EC1u Ch\u1EC9nh",value:"dieuchinh"}];isFilter=!1;paginator;sort;drawer;filterValues={};_PhieukhoService=w(Xe);_breakpointObserver=w(ie);_GoogleSheetService=w(je);_router=w(te);Listphieukho=this._PhieukhoService.ListPhieukho;dataSource=W(()=>{let t=new Ge(this.Listphieukho());return t.filterPredicate=this.createFilter(),t.paginator=this.paginator,t.sort=this.sort,t});phieukhoId=this._PhieukhoService.phieukhoId;_snackBar=w(re);CountItem=0;constructor(){this.displayedColumns.forEach(t=>{this.filterValues[t]=""})}createFilter(){return(t,e)=>{let i=JSON.parse(e),a=!0;return this.displayedColumns.forEach(m=>{if(i[m]){let p=t[m]?t[m].toString().toLowerCase():"";a=a&&p.includes(i[m].toLowerCase())}}),a}}applyFilter(){this.dataSource().filter=JSON.stringify(this.filterValues)}ngOnInit(){return k(this,null,function*(){yield this._PhieukhoService.getAllPhieukho(),this.CountItem=this.Listphieukho().length,this.initializeColumns(),this.setupDrawer(),this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i"})}refresh(){return k(this,null,function*(){yield this._PhieukhoService.getAllPhieukho()})}getName(t){return this.LoaiPhieu.find(e=>e.value===t)}initializeColumns(){this.Columns=Object.keys(this.ColumnName).map(t=>({key:t,value:this.ColumnName[t],isShow:!0})),this.FilterColumns.length===0?this.FilterColumns=this.Columns:localStorage.setItem("PhieukhoColFilter",JSON.stringify(this.FilterColumns)),this.displayedColumns=this.FilterColumns.filter(t=>t.isShow).map(t=>t.key),this.ColumnName=this.FilterColumns.reduce((t,e)=>(e.isShow&&(t[e.key]=e.value),t),{})}setupDrawer(){this._breakpointObserver.observe([ne.Handset]).subscribe(t=>{t.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})}toggleColumn(t){let e=this.FilterColumns.find(i=>i.key===t.key);e&&(e.isShow=!e.isShow,this.updateDisplayedColumns())}updateDisplayedColumns(){this.displayedColumns=this.FilterColumns.filter(t=>t.isShow).map(t=>t.key),this.ColumnName=this.FilterColumns.reduce((t,e)=>(e.isShow&&(t[e.key]=e.value),t),{}),localStorage.setItem("PhieukhoColFilter",JSON.stringify(this.FilterColumns))}doFilterColumns(t){let e=t.target.value.toLowerCase();this.FilterColumns=this.Columns.filter(i=>i.value.toLowerCase().includes(e))}create(){this.drawer.open(),this._router.navigate(["admin/phieukho",0])}goToDetail(t){this._PhieukhoService.setPhieukhoId(t.id),this.drawer.open(),this._router.navigate(["admin/phieukho",t.id])}LoadDrive(){return k(this,null,function*(){let t={IdSheet:"15npo25qyH5FmfcEjl1uyqqyFMS_vdFnmxM_kt0KYmZk",SheetName:"SPImport",ApiKey:"AIzaSyD33kgZJKdFpv1JrKHacjCQccL_O0a2Eao"},e=yield this._GoogleSheetService.getDrive(t),i=Te(e.values);console.log(i),this.DoImportData(i)})}DoImportData(t){console.log(t);let i=t.map(c=>({title:c.title?.trim()||"",masp:c.masp?.trim()||"",slug:`${Ee(c?.title?.trim()||"")}_${be(5,!1)}`,giagoc:Number(c.giagoc)||0,dvt:c.dvt||"",soluong:Number(c.soluong)||0,soluongkho:Number(c.soluongkho)||0,ghichu:c.ghichu||"",order:Number(c.order)||0})).filter((c,g,x)=>g===x.findIndex(tt=>tt.masp===c.masp)),a=i.map(c=>c.masp),m=this._PhieukhoService.ListPhieukho().map(c=>c.masp),p=a.filter(c=>!m.includes(c)),Ue=i.map(c=>k(this,null,function*(){let g=this._PhieukhoService.ListPhieukho().find(x=>x.masp===c.masp);if(g){let x=I(I({},g),c);yield this._PhieukhoService.updatePhieukho(x)}else yield this._PhieukhoService.CreatePhieukho(c)})),et=p.map(c=>k(this,null,function*(){let g=this._PhieukhoService.ListPhieukho().find(x=>x.masp===c);g.isActive=!1,yield this._PhieukhoService.updatePhieukho(g)}));Promise.all([...Ue,...et]).then(()=>{this._snackBar.open("C\u1EADp Nh\u1EADt Th\xE0nh C\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]})})}ImporExcel(t){return k(this,null,function*(){let e=yield Ze(t);this.DoImportData(e)})}ExportExcel(t,e){We(t,e)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=R({type:n,selectors:[["app-listphieukho"]],viewQuery:function(e,i){if(e&1&&(P(L,5),P(D,5),P(it,7)),e&2){let a;M(a=T())&&(i.paginator=a.first),M(a=T())&&(i.sort=a.first),M(a=T())&&(i.drawer=a.first)}},decls:48,vars:12,consts:[["drawer",""],["menu","matMenu"],["uploadfile",""],["autosize","",1,"w-full","h-full"],["mode","over",1,"flex","flex-col","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","p-2"],[1,"cursor-pointer","w-full","relative","flex","lg:flex-row","lg:space-y-2","space-y-0","flex-col","space-x-2","justify-between","items-center","p-2","bg-white","rounded-lg"],[1,"flex","flex-row","space-x-2","items-center"],["matTooltip","Th\xEAm m\u1EDBi","color","primary","mat-icon-button","",3,"click"],["matTooltip","\u1EA8n hi\u1EC7n c\u1ED9t","mat-icon-button","","color","primary","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],[1,"p-4"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],["matInput","","placeholder","T\xECm Ki\u1EBFm",3,"input","click"],["matPrefix",""],[1,"flex","flex-col","max-h-80","overflow-auto"],["mat-menu-item",""],["matTooltip","B\u1ED9 L\u1ECDc","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i file excel M\u1EABu","color","primary","mat-icon-button","",3,"click"],["matTooltip","T\u1EA3i l\xEAn file excel","color","primary","mat-icon-button","",3,"click"],["type","file",1,"hidden",3,"change"],["matTooltip","T\u1EA3i d\u1EEF li\u1EC7u t\u1EEB drive","color","primary","mat-icon-button","",3,"click"],[1,"lg:flex","hidden","whitespace-nowrap","p-2","rounded-lg","bg-slate-200"],["class","w-full grid grid-cols-2 gap-2 lg:flex lg:flex-row lg:space-x-2 items-center",4,"ngIf"],[1,"w-full","overflow-auto"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"class","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-menu-item","",3,"click"],[1,"w-full","grid","grid-cols-2","gap-2","lg:flex","lg:flex-row","lg:space-x-2","items-center"],["appearance","outline","subscriptSizing","dynamic",4,"ngFor","ngForOf"],["appearance","outline","subscriptSizing","dynamic"],["matInput","",3,"keyup","ngModelChange","ngModel","ngModelOptions","placeholder"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],[1,"max-w-40","line-clamp-4","me-4"],["mat-cell",""],[1,"max-w-40","line-clamp-4"],[1,"text-green-500"],[1,"text-red-500"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell","p-4"]],template:function(e,i){if(e&1){let a=S();o(0,"mat-drawer-container",3)(1,"mat-drawer",4,0),v(3,"router-outlet"),r(),o(4,"div",5)(5,"div",6)(6,"div",7)(7,"button",8),f("click",function(){return h(a),d(i.create())}),o(8,"mat-icon"),u(9,"add_circle"),r()(),o(10,"button",9)(11,"mat-icon"),u(12,"tune"),r()(),o(13,"mat-menu",null,1)(15,"div",10)(16,"mat-form-field",11)(17,"input",12),f("input",function(p){return h(a),d(i.doFilterColumns(p))})("click",function(p){return h(a),d(p.stopPropagation())}),r(),o(18,"mat-icon",13),u(19,"search"),r()()(),o(20,"div",14),N(21,rt,5,2,"button",15,at),r()(),o(23,"button",16),f("click",function(){return h(a),d(i.isFilter=!i.isFilter)}),o(24,"mat-icon"),u(25,"filter_list"),r()(),o(26,"button",17),f("click",function(){return h(a),d(i.ExportExcel(i.Listphieukho(),"Phieukho"))}),o(27,"mat-icon"),u(28,"file_download"),r()(),o(29,"button",18),f("click",function(){h(a);let p=$(33);return d(p.click())}),o(30,"mat-icon"),u(31,"file_upload"),r()(),o(32,"input",19,2),f("change",function(p){return h(a),d(i.ImporExcel(p))}),r(),o(34,"button",20),f("click",function(){return h(a),d(i.LoadDrive())}),o(35,"mat-icon"),u(36,"cloud_download"),r()(),o(37,"span",21),u(38),r()()(),y(39,st,2,1,"div",22),o(40,"div",23)(41,"table",24),N(42,yt,3,1,"ng-container",25,H),y(44,wt,1,0,"tr",26)(45,St,1,3,"tr",27)(46,vt,3,0,"tr",28),r(),v(47,"mat-paginator",29),r()()()}if(e&2){let a=$(14);l(),_("position","end"),l(9),_("matMenuTriggerFor",a),l(11),A(i.FilterColumns),l(2),B(i.isFilter?"!bg-slate-200":""),l(15),C(" ",i.CountItem," S\u1EA3n Ph\u1EA9m "),l(),_("ngIf",i.isFilter),l(2),_("dataSource",i.dataSource()),l(),A(i.displayedColumns),l(2),_("matHeaderRowDef",i.displayedColumns),l(),_("matRowDefColumns",i.displayedColumns),l(2),_("pageSizeOptions",O(11,nt))}},dependencies:[Se,we,ke,ye,Pe,ve,Je,Ne,$e,ze,Oe,Ae,He,Re,Be,Qe,qe,Ke,Ve,D,Ie,De,L,_e,he,pe,de,me,le,se,ee,ue,ce,ae,oe,Me,U,Z,X,Y,xe,fe,Ce,ge,Le,Fe],encapsulation:2})};export{Ye as a};
