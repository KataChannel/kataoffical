import './polyfills.server.mjs';
import{a as m}from"./chunk-MGIVCIKU.mjs";import{a as o}from"./chunk-7ZQLLCLM.mjs";import{a as d}from"./chunk-GQMUTPQ3.mjs";import{d as y}from"./chunk-7FNXQ3TW.mjs";import{Ra as i,ia as l,na as g}from"./chunk-UIMG47TQ.mjs";import{a as u,g as f,j as n}from"./chunk-RIAI3ORJ.mjs";var c=f(m());var p=class h{constructor(s,e){this._StorageService=s;this.router=e}ListDathang=i([]);DetailDathang=i({});page=i(1);pageCount=i(1);total=i(0);pageSize=i(50);dathangId=i(null);setDathangId(s){this.dathangId.set(s)}ImportDathang(s){return n(this,null,function*(){try{let e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},t=yield fetch(`${o.APIURL}/dathang/import`,e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let r=yield t.json();t.ok||console.log(t.status),this.getAllDathang()}catch(e){return console.error(e)}})}CreateDathang(s){return n(this,null,function*(){try{let e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},t=yield fetch(`${o.APIURL}/dathang`,e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let r=yield t.json();if(!t.ok)if(t.status===401){let a=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(t.status===403){let a=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(t.status===500){let a=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else{let a=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}this.getAllDathang(),this.dathangId.set(r.id)}catch(e){return console.error(e)}})}CreateByNhucau(s){return n(this,null,function*(){try{let e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},t=yield fetch(`${o.APIURL}/dathang/bynhucau`,e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let r=yield t.json();if(!t.ok)if(t.status===401){let a=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(t.status===403){let a=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(t.status===500){let a=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else{let a=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}this.getAllDathang(),this.dathangId.set(r.id)}catch(e){return console.error(e)}})}getSLChonhap(s){return n(this,null,function*(){let e=u({},s);e.Batdau=(0,c.default)(e.Batdau).utc(),e.Ketthuc=(0,c.default)(e.Ketthuc).utc();try{let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")},body:JSON.stringify(e)},r=yield fetch(`${o.APIURL}/dathang/getchonhap`,t);return r.ok,yield r.json()}catch(t){return console.error(t)}})}searchDathang(s){return n(this,null,function*(){let e=u({},s);e.Batdau=(0,c.default)(e.Batdau).utc(),e.Ketthuc=(0,c.default)(e.Ketthuc).utc();try{let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")},body:JSON.stringify(e)},r=yield fetch(`${o.APIURL}/dathang/search`,t);r.ok;let a=yield r.json();return this.ListDathang.set(a.data),a}catch(t){return console.error(t)}})}getAllDathang(){return n(this,null,function*(){try{let s={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},e=yield fetch(`${o.APIURL}/dathang?`,s);if(!e.ok)if(e.status===401){let r=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(e.status===403){let r=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(e.status===500){let r=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else{let r=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}let t=yield e.json();return this.ListDathang.set(t),t}catch(s){return console.error(s)}})}getDathangByid(s){return n(this,null,function*(){try{let e={method:"GET",headers:{"Content-Type":"application/json"}},t=yield fetch(`${o.APIURL}/dathang/findid/${s}`,e);if(!t.ok)if(t.status===401){let a=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(t.status===403){let a=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(t.status===500){let a=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else{let a=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}let r=yield t.json();this.DetailDathang.set(r)}catch(e){return console.error(e)}})}findbysanpham(s){return n(this,null,function*(){try{let e={method:"GET",headers:{"Content-Type":"application/json"}},t=yield fetch(`${o.APIURL}/dathang/findbysanpham/${s}`,e);return t.ok||this.handleError(t.status),yield t.json()}catch(e){return console.error(e)}})}updateDathang(s){return n(this,null,function*(){try{let e={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},t=yield fetch(`${o.APIURL}/dathang/${s.id}`,e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let r=yield t.json();if(!t.ok)if(t.status===401){let a=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(t.status===403){let a=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else if(t.status===500){let a=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}else{let a=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:a}})}this.getAllDathang(),this.getDathangByid(s.id)}catch(e){return console.error(e)}})}DeleteDathang(s){return n(this,null,function*(){try{let e={method:"DELETE",headers:{"Content-Type":"application/json"}},t=yield fetch(`${o.APIURL}/dathang/${s.id}`,e);if(!t.ok)if(t.status===401){let r=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(t.status===403){let r=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(t.status===500){let r=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else{let r=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}this.getAllDathang()}catch(e){return console.error(e)}})}getDathangBy(s){return n(this,null,function*(){try{let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this._StorageService.getItem("token")}`},body:JSON.stringify(u({},s))},t=yield fetch(`${o.APIURL}/dathang/findby`,e);t.ok||this.handleError(t.status);let r=yield t.json();s.isOne===!0?this.DetailDathang.set(r):(this._StorageService.setItem("dathangs_updatedAt",new Date().toISOString()),this.ListDathang.set(r.data),this.page.set(r.page||1),this.pageCount.set(r.pageCount||1),this.total.set(r.total||r.data.length),this.pageSize.set(this.pageSize()))}catch{}})}handleError(s){let e="L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh";switch(s){case 400:e="Th\xF4ng tin \u0111\xE3 t\u1ED3n t\u1EA1i";break;case 401:case 404:e="Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i";break;case 403:e="B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp";break;case 500:e="L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau";break}}static \u0275fac=function(e){return new(e||h)(g(d),g(y))};static \u0275prov=l({token:h,factory:h.\u0275fac,providedIn:"root"})};export{p as a};
