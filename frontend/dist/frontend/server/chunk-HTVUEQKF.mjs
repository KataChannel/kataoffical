import './polyfills.server.mjs';
import{a as Tt}from"./chunk-PVDJXTUR.mjs";import{c as M,d as lt,e as L,f as ct,g as ut,h as mt,i as pt,j as dt,k as ht,l as ft,m as gt,n as yt,o as vt,p as St,q as wt,r as _t,s as Ct,t as Dt}from"./chunk-HAOIA4AN.mjs";import{d as at}from"./chunk-HLSIONMQ.mjs";import{a as Y,b as Z,c as tt}from"./chunk-CA2RQL2Q.mjs";import{b as N,c as st}from"./chunk-SWDJOT3A.mjs";import{a as et,b as rt}from"./chunk-TG7PV6C3.mjs";import{n as it,v as ot,y as nt}from"./chunk-JWQNDGNV.mjs";import{a as m}from"./chunk-7ZQLLCLM.mjs";import{a as U}from"./chunk-LBFNR2EE.mjs";import{b as W,d as X}from"./chunk-SIIUGA5M.mjs";import{x as z,y as K}from"./chunk-RQIUWH7Z.mjs";import{b as Q,d as T}from"./chunk-2FOTNBEA.mjs";import{s as H,v as G}from"./chunk-RQ7LQAK6.mjs";import{Bb as q,Bc as $,Cc as d,Ec as D,Ib as y,Mc as F,Na as k,Sa as R,Ub as u,_b as j,ac as E,bc as J,cc as A,dc as s,ec as l,fa as I,fc as v,gc as V,hc as B,jc as O,ka as h,la as P,oc as S,pb as n,qc as p,ua as f,ub as x,va as g,wc as w,xc as _,yc as C}from"./chunk-YCHD5L6F.mjs";import{j as c}from"./chunk-RIAI3ORJ.mjs";var b=class o{constructor(a,e,t){this._StorageService=a;this.platformId=e;this.router=t;this.isBrowser=G(this.platformId)}_authenticated=!1;APIURL=m.APIURL;isBrowser;ListDanhmuc=k([]);Danhmuc=k({});getDanhmucDrive(a){return c(this,null,function*(){try{let e={method:"GET",headers:{"Content-Type":"application/json"}},r=yield(yield fetch(`https://sheets.googleapis.com/v4/spreadsheets/${a.IdSheet}/values/${a.SheetName}?key=${a.ApiKey}`,e)).json();return console.log(r),r}catch(e){return console.error(e)}})}getAllDanhmuc(){return c(this,null,function*(){try{let a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this._StorageService.getItem("token")}},e=yield fetch(`${m.APIURL}/danhmucs`,a);if(!e.ok)if(e.status===401){let r=JSON.stringify({code:e.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(e.status===403){let r=JSON.stringify({code:e.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(e.status===500){let r=JSON.stringify({code:e.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else{let r=JSON.stringify({code:e.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}let t=yield e.json();return this.ListDanhmuc.set(t),t}catch(a){return console.error(a)}})}SearchDanhmuc(a){return c(this,null,function*(){try{let e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},t=yield fetch(`${m.APIURL}/setting/search`,e);if(!t.ok)if(t.status===401){let i=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(t.status===403){let i=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(t.status===500){let i=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else{let i=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}let r=yield t.json();return this.Danhmuc.set(r.items),r}catch(e){return console.error(e)}})}getDanhmucByid(a){return c(this,null,function*(){try{let e={method:"GET",headers:{"Content-Type":"application/json"}},t=yield fetch(`${m.APIURL}/danhmucs/${a}`,e);if(!t.ok)if(t.status===401){let i=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(t.status===403){let i=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(t.status===500){let i=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else{let i=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}let r=yield t.json();this.Danhmuc.set(r)}catch(e){return console.error(e)}})}updateOneDanhmuc(a){return c(this,null,function*(){try{let e={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},t=yield fetch(`${m.APIURL}/danhmucs/${a.id}`,e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let r=yield t.json();if(!t.ok)if(t.status===401){let i=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(t.status===403){let i=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else if(t.status===500){let i=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}else{let i=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:i}})}return this.getAllDanhmuc(),r}catch(e){return console.error(e)}})}DeleteDanhmuc(a){return c(this,null,function*(){try{let e={method:"DELETE",headers:{"Content-Type":"application/json"}},t=yield fetch(`${m.APIURL}/danhmucs/${a.id}`,e);if(!t.ok)if(t.status===401){let r=JSON.stringify({code:t.status,title:"Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(t.status===403){let r=JSON.stringify({code:t.status,title:"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else if(t.status===500){let r=JSON.stringify({code:t.status,title:"L\u1ED7i m\xE1y ch\u1EE7, vui l\xF2ng th\u1EED l\u1EA1i sau"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}else{let r=JSON.stringify({code:t.status,title:"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh"});this.router.navigate(["/errorserver"],{queryParams:{data:r}})}return this.getAllDanhmuc(),yield t.json()}catch(e){return console.error(e)}})}static \u0275fac=function(e){return new(e||o)(h(U),h(R),h(T))};static \u0275prov=I({token:o,factory:o.\u0275fac,providedIn:"root"})};var kt=["drawer"],xt=()=>[5,10,25,100];function Ot(o,a){}function Nt(o,a){if(o&1&&(s(0,"th",22),d(1),l()),o&2){let e=p().$implicit,t=p();n(),D("",t.ColumnName[e]," ")}}function It(o,a){if(o&1&&(s(0,"td",23),d(1),l()),o&2){let e=a.$implicit,t=a.index,r=p().$implicit;n(),D(" ",r==="STT"?t+1:e[r]," ")}}function Rt(o,a){if(o&1&&(V(0,15),y(1,Nt,2,1,"th",20)(2,It,2,1,"td",21),B()),o&2){let e=a.$implicit;u("matColumnDef",e)}}function qt(o,a){o&1&&v(0,"tr",24)}function jt(o,a){if(o&1){let e=O();s(0,"tr",25),S("click",function(){let r=f(e).$implicit,i=p();return g(i.goToDetail(r))}),l()}}function Et(o,a){if(o&1&&(s(0,"tr",26)(1,"td",27),d(2),l()()),o&2){p();let e=$(10);n(2),D('Kh\xF4ng t\xECm th\u1EA5y "',e.value,'"')}}var Mt=class o{constructor(a,e){this._breakpointObserver=a;this._router=e}Detail={};dataSource;displayedColumns=["STT","Title","Slug","CreatedAt"];ColumnName={STT:"STT",Title:"Ti\xEAu \u0110\u1EC1",Slug:"\u0110\u01B0\u1EDDng D\u1EABn",CreatedAt:"Ng\xE0y T\u1EA1o"};ListDanhmuc=[];_GoogleSheetService=P(Tt);paginator;sort;drawer;_DanhmucsService=P(b);isDownloadDrive=!1;ngOnInit(){return c(this,null,function*(){let a=JSON.parse(localStorage.getItem("ListSheets")||"[]");if(console.log(a),a.length>0){let e=a.find(t=>t.SheetName==="Danhmuc");e&&this._GoogleSheetService.getDrive(e).then(t=>{t.values.length>0&&(this.displayedColumns=t.values[0].map(r=>r),this.ColumnName=st(t.values),this.dataSource=new Dt(N(t.values)),this.ListDanhmuc=N(t.values),console.log(this.ListDanhmuc),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)})}this.Detail.id?this.drawer.open():this.drawer.close(),this._breakpointObserver.observe([K.Handset]).subscribe(e=>{e.matches?(this.drawer.mode="over",this.paginator.hidePageSize=!0):this.drawer.mode="side"})})}GetDrive(){return c(this,null,function*(){})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.paginator._intl.itemsPerPageLabel="S\u1ED1 l\u01B0\u1EE3ng 1 trang",this.paginator._intl.nextPageLabel="Ti\u1EBFp Theo",this.paginator._intl.previousPageLabel="V\u1EC1 Tr\u01B0\u1EDBc",this.paginator._intl.firstPageLabel="Trang \u0110\u1EA7u",this.paginator._intl.lastPageLabel="Trang Cu\u1ED1i",this.paginator.pageSize=30}applyFilter(a){let e=a.target.value;this.dataSource.filter=e.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}Create(){this.drawer.open(),this._router.navigate(["admin/danhmuc",0])}goToDetail(a){this.drawer.open(),this.Detail=a,this._router.navigate(["admin/danhmuc",a.id])}static \u0275fac=function(e){return new(e||o)(x(z),x(T))};static \u0275cmp=q({type:o,selectors:[["app-listdanhmuc"]],viewQuery:function(e,t){if(e&1&&(w(M,5),w(L,5),w(kt,7)),e&2){let r;_(r=C())&&(t.paginator=r.first),_(r=C())&&(t.sort=r.first),_(r=C())&&(t.drawer=r.first)}},decls:26,vars:7,consts:[["drawer",""],["input",""],["autosize","",1,"w-full","h-full"],[1,"flex","flex-col","lg:!w-1/3","!w-full","h-full",3,"position"],[1,"flex","flex-col","space-y-2","h-screen-12","w-full","justify-between","p-2"],[1,"flex","flex-col","space-y-2","w-full","p-2"],[1,"cursor-pointer","w-full","relative","grid","lg:grid-cols-2","gap-2","justify-between","items-center"],[1,"w-full","flex","flex-row","space-x-2","items-center"],[1,"relative"],["type","text","placeholder","T\xECm Ki\u1EBFm...",1,"block","pl-10","pr-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","focus:border-blue-400","focus:ring-blue-400","focus:outline-none","focus:ring","focus:ring-opacity-40",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none"],[1,"material-symbols-outlined","text-gray-500"],["mat-icon-button","","color","primary",3,"click"],[1,"w-full"],["mat-table","","matSort","",1,"!border","w-full","cursor-pointer",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of danhmucs",3,"pageSizeOptions"],["class","whitespace-nowrap","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","whitespace-nowrap","mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"whitespace-nowrap"],["mat-cell","",1,"whitespace-nowrap"],["mat-header-row",""],["mat-row","",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,t){if(e&1){let r=O();s(0,"mat-drawer-container",2)(1,"mat-drawer",3,0),v(3,"router-outlet"),l(),s(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"input",9,1),S("keyup",function(Lt){return f(r),g(t.applyFilter(Lt))}),l(),s(11,"div",10)(12,"span",11),d(13,"search"),l()()(),s(14,"button",12),S("click",function(){return f(r),g(t.Create())}),s(15,"mat-icon"),d(16,"add_circle"),l()()()(),y(17,Ot,0,0),s(18,"div",13)(19,"table",14),J(20,Rt,3,1,"ng-container",15,E),y(22,qt,1,0,"tr",16)(23,jt,1,0,"tr",17)(24,Et,3,1,"tr",18),l(),v(25,"mat-paginator",19),l()()()()}e&2&&(n(),u("position","end"),n(16),j(t.isDownloadDrive?17:-1),n(2),u("dataSource",t.dataSource),n(),A(t.displayedColumns),n(2),u("matHeaderRowDef",t.displayedColumns),n(),u("matRowDefColumns",t.displayedColumns),n(2),u("pageSizeOptions",F(6,xt)))},dependencies:[ot,nt,Ct,mt,dt,yt,ht,pt,vt,ft,gt,St,wt,_t,ut,L,ct,lt,M,at,tt,Y,Z,Q,rt,et,X,W,it,H],encapsulation:2})};export{Mt as a};
