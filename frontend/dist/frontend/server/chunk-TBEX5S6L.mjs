import './polyfills.server.mjs';
import{a as de,e as me}from"./chunk-JSSZE7PS.mjs";import{a as se}from"./chunk-6HDYPSHY.mjs";import{a as O,b as ce,c as le,f as F}from"./chunk-IDUXSRZE.mjs";import{L as re,P as oe,a as ne,y as ae,z as ie}from"./chunk-D22ASRXW.mjs";import{c as te,d as P,g as B,h as R,j as T}from"./chunk-7T6LZHUD.mjs";import{d as ee,y as l}from"./chunk-6BL7Z2F4.mjs";import{Ac as C,Bc as D,Cc as I,Da as k,Gb as A,Hc as M,Ib as y,Jc as E,Ka as q,Kb as U,Nb as S,Oa as V,Wa as H,Yb as Z,ca as j,cc as W,f as m,hc as g,hd as Y,ia as v,ic as _,jc as K,la as w,na as N,nc as J,oa as s,pc as X,sc as $,tb as f,tc as G,uc as x,vb as Q,xa as L,ya as z}from"./chunk-GWTCN232.mjs";import{a as h,j as u}from"./chunk-RIAI3ORJ.mjs";function ve(i,o){if(i&1){let e=J();g(0,"div",1)(1,"button",2),$("click",function(){L(e);let n=x();return z(n.action())}),M(2),_()()}if(i&2){let e=x();f(2),E(" ",e.data.action," ")}}var ke=["label"];function ye(i,o){}var ge=Math.pow(2,31)-1,b=class{_overlayRef;instance;containerInstance;_afterDismissed=new m;_afterOpened=new m;_onAction=new m;_durationTimeoutId;_dismissedByAction=!1;constructor(o,e){this._overlayRef=e,this.containerInstance=o,o._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(o){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(o,ge))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},he=new w("MatSnackBarData"),p=class{politeness="assertive";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},Be=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275dir=y({type:i,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return i})(),we=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275dir=y({type:i,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return i})(),Ae=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275dir=y({type:i,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return i})(),Se=(()=>{class i{snackBarRef=s(b);data=s(he);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=A({type:i,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(t,n){t&1&&(g(0,"div",0),M(1),_(),S(2,ve,3,1,"div",1)),t&2&&(f(),E(" ",n.data.message,`
`),f(),W(n.hasAction?2:-1))},dependencies:[se,Be,we,Ae],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0})}return i})(),xe={snackBarState:te("state",[R("void, hidden",B({transform:"scale(0.8)",opacity:0})),R("visible",B({transform:"scale(1)",opacity:1})),T("* => visible",P("150ms cubic-bezier(0, 0, 0.2, 1)")),T("* => void, * => hidden",P("75ms cubic-bezier(0.4, 0.0, 1, 1)",B({opacity:0})))])},Ce=(()=>{class i extends le{_ngZone=s(q);_elementRef=s(V);_changeDetectorRef=s(Y);_platform=s(ne);snackBarConfig=s(p);_document=s(ee);_trackedModals=new Set;_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new m;_onExit=new m;_onEnter=new m;_animationState="void";_live;_label;_role;_liveElementId=s(oe).getId("mat-snack-bar-container-live-");constructor(){super();let e=this.snackBarConfig;e.politeness==="assertive"&&!e.announcementMessage?this._live="assertive":e.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();let t=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),t}attachTemplatePortal(e){this._assertNotAttached();let t=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),t}attachDomPortal=e=>{this._assertNotAttached();let t=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),t};onAnimationEnd(e){let{fromState:t,toState:n}=e;if((n==="void"&&t!=="void"||n==="hidden")&&this._completeExit(),n==="visible"){let a=this._onEnter;this._ngZone.run(()=>{a.next(),a.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,t=this.snackBarConfig.panelClass;t&&(Array.isArray(t)?t.forEach(r=>e.classList.add(r)):e.classList.add(t)),this._exposeToModals();let n=this._label.nativeElement,a="mdc-snackbar__label";n.classList.toggle(a,!n.querySelector(`.${a}`))}_exposeToModals(){let e=this._liveElementId,t=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let n=0;n<t.length;n++){let a=t[n],r=a.getAttribute("aria-owns");this._trackedModals.add(a),r?r.indexOf(e)===-1&&a.setAttribute("aria-owns",r+" "+e):a.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let t=e.getAttribute("aria-owns");if(t){let n=t.replace(this._liveElementId,"").trim();n.length>0?e.setAttribute("aria-owns",n):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{let e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),t=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&t){let n=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(n=document.activeElement),e.removeAttribute("aria-hidden"),t.appendChild(e),n?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=A({type:i,selectors:[["mat-snack-bar-container"]],viewQuery:function(t,n){if(t&1&&(C(F,7),C(ke,7)),t&2){let a;D(a=I())&&(n._portalOutlet=a.first),D(a=I())&&(n._label=a.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:1,hostBindings:function(t,n){t&1&&G("@state.done",function(r){return n.onAnimationEnd(r)}),t&2&&X("@state",n._animationState)},features:[U],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(t,n){t&1&&(g(0,"div",1)(1,"div",2,0)(3,"div",3),S(4,ye,0,0,"ng-template",4),_(),K(5,"div"),_()()),t&2&&(f(5),Z("aria-live",n._live)("role",n._role)("id",n._liveElementId))},dependencies:[F],styles:[".mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-snackbar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mdc-snackbar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mdc-snackbar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mdc-snackbar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mdc-snackbar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}"],encapsulation:2,data:{animation:[xe.snackBarState]}})}return i})();function De(){return new p}var Ie=new w("mat-snack-bar-default-options",{providedIn:"root",factory:De}),ue=(()=>{class i{_overlay=s(me);_live=s(re);_injector=s(k);_breakpointObserver=s(ae);_parentSnackBar=s(i,{optional:!0,skipSelf:!0});_defaultConfig=s(Ie);_snackBarRefAtThisLevel=null;simpleSnackBarComponent=Se;snackBarContainerComponent=Ce;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,t){return this._attach(e,t)}openFromTemplate(e,t){return this._attach(e,t)}open(e,t="",n){let a=h(h({},this._defaultConfig),n);return a.data={message:e,action:t},a.announcementMessage===e&&(a.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,a)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,t){let n=t&&t.viewContainerRef&&t.viewContainerRef.injector,a=k.create({parent:n||this._injector,providers:[{provide:p,useValue:t}]}),r=new O(this.snackBarContainerComponent,t.viewContainerRef,a),c=e.attach(r);return c.instance.snackBarConfig=t,c.instance}_attach(e,t){let n=h(h(h({},new p),this._defaultConfig),t),a=this._createOverlay(n),r=this._attachSnackBarContainer(a,n),c=new b(r,a);if(e instanceof Q){let d=new ce(e,null,{$implicit:n.data,snackBarRef:c});c.instance=r.attachTemplatePortal(d)}else{let d=this._createInjector(n,c),fe=new O(e,void 0,d),_e=r.attachComponentPortal(fe);c.instance=_e.instance}return this._breakpointObserver.observe(ie.HandsetPortrait).pipe(j(a.detachments())).subscribe(d=>{a.overlayElement.classList.toggle(this.handsetCssClass,d.matches)}),n.announcementMessage&&r._onAnnounce.subscribe(()=>{this._live.announce(n.announcementMessage,n.politeness)}),this._animateSnackBar(c,n),this._openedSnackBarRef=c,this._openedSnackBarRef}_animateSnackBar(e,t){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),t.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),t.duration&&t.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(t.duration))}_createOverlay(e){let t=new de;t.direction=e.direction;let n=this._overlay.position().global(),a=e.direction==="rtl",r=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!a||e.horizontalPosition==="end"&&a,c=!r&&e.horizontalPosition!=="center";return r?n.left("0"):c?n.right("0"):n.centerHorizontally(),e.verticalPosition==="top"?n.top("0"):n.bottom("0"),t.positionStrategy=n,this._overlay.create(t)}_createInjector(e,t){let n=e&&e.viewContainerRef&&e.viewContainerRef.injector;return k.create({parent:n||this._injector,providers:[{provide:b,useValue:t},{provide:he,useValue:e.data}]})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=v({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var pe=class i{constructor(o){this.platformId=o}dbName="PermissionDB";storeName="permissions";db=null;openConnections=[];snackBar=s(ue);setItem(o,e){l(this.platformId)&&localStorage.setItem(o,JSON.stringify(e))}getItem(o){if(l(this.platformId)){let e=localStorage.getItem(o);return e?JSON.parse(e):null}return null}removeItem(o){l(this.platformId)&&localStorage.removeItem(o)}clear(){l(this.platformId)&&localStorage.clear()}openDB(){return u(this,null,function*(){if(!l(this.platformId))throw new Error("IndexedDB is not available in this environment");return this.db?this.db:new Promise((o,e)=>{let t=indexedDB.open(this.dbName,1);this.openConnections.push(t),t.onupgradeneeded=()=>{let n=t.result;n.objectStoreNames.contains(this.storeName)||n.createObjectStore(this.storeName,{keyPath:"id"})},t.onsuccess=()=>{this.db=t.result,o(this.db)},t.onerror=()=>{e(new Error("Failed to open PermissionDB"))},t.onblocked=()=>{this.snackBar.open("Cannot access PermissionDB: Database is blocked by another connection","Close",{duration:5e3,panelClass:["snackbar-error"]}),e(new Error("PermissionDB blocked"))}})})}saveData(o,e){return u(this,null,function*(){if(l(this.platformId))try{let r=(yield this.openDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName).put({id:o,data:e});return this.openConnections.push(r),new Promise((c,d)=>{r.onsuccess=()=>c(),r.onerror=()=>d(new Error("Failed to save data"))})}catch(t){throw console.error("Failed to save data:",t),t}})}getData(o){return u(this,null,function*(){if(!l(this.platformId))return null;try{let a=(yield this.openDB()).transaction([this.storeName],"readonly").objectStore(this.storeName).get(o);return this.openConnections.push(a),new Promise((r,c)=>{a.onsuccess=()=>r(a.result?.data),a.onerror=()=>c(new Error("Failed to retrieve data"))})}catch(e){return console.error("Failed to retrieve data:",e),null}})}clearStore(){return u(this,null,function*(){if(l(this.platformId))try{let n=(yield this.openDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName).clear();return this.openConnections.push(n),new Promise((a,r)=>{n.onsuccess=()=>a(),n.onerror=()=>r(new Error("Failed to clear store"))})}catch(o){throw console.error("Failed to clear store:",o),o}})}deleteDB(o=3,e=1e3){return u(this,null,function*(){if(l(this.platformId))for(let t=0;t<o;t++)try{return this.db&&(this.db.close(),this.db=null),this.openConnections=[],yield new Promise((n,a)=>{let r=indexedDB.deleteDatabase(this.dbName);r.onsuccess=()=>{this.snackBar.open("PermissionDB deleted successfully","",{duration:1e3,panelClass:["snackbar-success"]}),n()},r.onerror=()=>{a(new Error("Failed to delete PermissionDB"))},r.onblocked=()=>{this.snackBar.open("Cannot delete PermissionDB: Please close other tabs or refresh","Retry",{duration:5e3,panelClass:["snackbar-error"]}).onAction().subscribe(()=>{}),a(new Error("Deletion of PermissionDB blocked"))}})}catch(n){if(t===o-1)throw console.error("Failed to delete PermissionDB after retries:",n),n;yield new Promise(a=>setTimeout(a,e))}})}closeDB(){l(this.platformId)&&this.db&&(this.db.close(),this.db=null,this.openConnections=[])}static \u0275fac=function(e){return new(e||i)(N(H))};static \u0275prov=v({token:i,factory:i.\u0275fac,providedIn:"root"})};export{ue as a,pe as b};
