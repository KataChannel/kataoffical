<div class="flex flex-row justify-between items-center space-x-2 p-2">
  <button mat-icon-button color="primary" (click)="goBack()">
    <mat-icon>arrow_back</mat-icon>
  </button>
  <div class="font-bold">{{ DetailNhacungcap()?.name || 'Không có dữ liệu' }}</div>
  <div class="flex flex-row space-x-2 items-center">
    <mat-slide-toggle [(ngModel)]="DetailNhacungcap().isActive" [disabled]="!isEdit()">{{DetailNhacungcap().isActive?'Hiển Thị':'Ẩn'}}</mat-slide-toggle>
    <button mat-icon-button color="primary" *ngIf="isEdit()" (click)="handleNhacungcapAction()">
      <mat-icon>save</mat-icon>
    </button>
    <button mat-icon-button color="primary" *ngIf="!isEdit()" (click)="toggleEdit()">
      <mat-icon>edit</mat-icon>
    </button>
    <button mat-icon-button color="warn" (click)="toggleDelete()">
      <mat-icon>delete</mat-icon>
    </button>
  </div>
</div>

<div class="relative flex flex-col w-full p-4 overflow-auto">
  <!-- Xác nhận Xóa -->
  <ng-container *ngIf="isDelete()">
    <div class="flex flex-col space-y-4 items-center justify-center">
      <div class="font-bold text-2xl">Bạn chắc chắn muốn xoá không?</div>
      <div class="flex flex-row space-x-2 items-center justify-center">
        <button mat-flat-button color="primary" (click)="DeleteData()">Đồng Ý</button>
        <button mat-flat-button color="warn" (click)="toggleDelete()">Huỷ Bỏ</button>
      </div>
    </div>
  </ng-container>

  <!-- Chi tiết Nhacungcap -->
  <ng-container *ngIf="!isDelete()">
      <div class="w-full grid lg:grid-cols-2 gap-2 p-2">
          <mat-form-field appearance="outline">
            <mat-label>Tên Nhà Cung Cấp</mat-label>
            <input matInput [(ngModel)]="DetailNhacungcap().name" [disabled]="!isEdit()" placeholder="Vui lòng nhập Tên Nhà Cung Cấp"/>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Mã Nhà Cung Cấp</mat-label>
            <input matInput [(ngModel)]="DetailNhacungcap().mancc" [disabled]="!isEdit()" placeholder="Vui lòng nhập Mã Nhà Cung Cấp"/>
          </mat-form-field> 
          <mat-form-field appearance="outline">
            <mat-label>Địa Chỉ</mat-label>
            <input matInput [(ngModel)]="DetailNhacungcap().diachi" [disabled]="!isEdit()" placeholder="Vui lòng nhập Địa Chỉ"/>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input matInput [(ngModel)]="DetailNhacungcap().email" [disabled]="!isEdit()" placeholder="Vui lòng nhập Email"/>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Số Điện Thoại</mat-label>
            <input matInput [(ngModel)]="DetailNhacungcap().sdt" [disabled]="!isEdit()" placeholder="Vui lòng nhập Số Điện Thoại"/>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Ghi Chú</mat-label>
            <textarea matInput [(ngModel)]="DetailNhacungcap().ghichu" [disabled]="!isEdit()" placeholder="Vui lòng nhập Ghi Chú"></textarea>
          </mat-form-field>
          <div class="lg:col-span-2 py-2 w-full flex flex-wrap gap-2">   
            <button [disabled]="!isEdit()" mat-flat-button color="primary" [matMenuTriggerFor]="menu" #menuTrigger="matMenuTrigger">
             Sản Phẩm ({{ChosenListSanpham.length||0}})
            </button>
                 <mat-menu #menu="matMenu">
                     <div (click)="$event.stopPropagation()"  class="cursor-pointer flex flex-col space-y-4 p-3">                                        
                     <div class="relative w-full">
                         <input type="text"
                             placeholder="Tìm Kiếm..." (keyup)="doSearch($event)"
                             class="block w-full pl-10 pr-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg focus:border-blue-400 focus:ring-blue-400 focus:outline-none focus:ring focus:ring-opacity-40">
                         <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                             <span class="material-symbols-outlined text-gray-500">search</span>
                         </div>
                     </div>
                     <div class="flex flex-row space-x-2 items-center justify-between">
                         <div class="flex flex-row space-x-2 items-center">
                             <span class="text-xs text-blue-600 underline" (click)="ChosenAll()">Chọn Tất Cả {{FilterSanpham.length||0}}</span>
                             <span class="text-xs text-blue-600 underline" (click)="EmptyFiter()">Xoá</span>
                         </div>
                         <span class="text-xs text-blue-600 underline" (click)="ResetFilter()">Reset</span>
                     </div>
                     <div class="w-full flex flex-col space-y-2 max-h-44 overflow-auto">
                      <div *ngFor="let item of FilterSanpham; trackBy:trackByFn" (click)="ChosenItem(item)" class="flex flex-row space-x-2 items-center p-2 rounded-lg hover:bg-slate-100">
                         <span *ngIf="CheckItem(item)" class="material-symbols-outlined text-blue-600">check</span>
                         <span> {{item.title}} </span>   
                      </div>
                    </div>
                    <div class="flex flex-row space-x-2 items-end justify-end">
                        <button mat-flat-button color="warn" (click)="menuTrigger.closeMenu()">Đóng</button>
                        <button mat-flat-button color="primary" (click)="ApplyFilterColum(menuTrigger)" >Áp Dụng</button>
                    </div>
                  </div>
                 </mat-menu>
              <button mat-flat-button disabled="true" *ngFor="let item of ChosenListSanpham; let i=index">
                {{item.title}}
              </button>   
            </div>
      </div>
  </ng-container>
</div>