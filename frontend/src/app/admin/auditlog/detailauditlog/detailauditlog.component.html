<div class="flex flex-row justify-between items-center space-x-2 p-2">
  <button mat-icon-button color="primary" (click)="goBack()">
    <mat-icon>arrow_back</mat-icon>
  </button>
  <div class="font-bold">{{ DetailAuditlog()?.codeId || 'Không có dữ liệu' }}</div>
  <div class="flex-grow"></div>
</div>



<div class="relative flex flex-col w-full p-4 overflow-auto">
  <div class="bg-white border rounded p-4">
    <div class="flex items-center gap-2">
      <span class="text-xl font-semibold">Audit Log Detail</span>
      <span class="px-2 py-1 rounded text-xs font-bold"
            [ngClass]="{
              'bg-green-100 text-green-800': DetailAuditlog()?.status === 'SUCCESS',
              'bg-red-100 text-red-800': DetailAuditlog()?.status === 'ERROR',
              'bg-yellow-100 text-yellow-800': DetailAuditlog()?.status === 'WARNING'
            }">
        {{ DetailAuditlog()?.status || 'N/A' }}
      </span>
    </div>

    <div class="grid md:grid-cols-2 gap-4 mt-2">
      <div>
        <strong>ID:</strong> {{ DetailAuditlog()?.id || 'N/A' }}
      </div>
      <div>
        <strong>Entity Name:</strong> {{ DetailAuditlog()?.entityName || 'N/A' }}
      </div>
      <div>
        <strong>Action:</strong> {{ DetailAuditlog()?.action || 'N/A' }}
      </div>
      <div>
        <strong>Entity ID:</strong> {{ DetailAuditlog()?.entityId || 'N/A' }}
      </div>
      <div>
        <strong>IP Address:</strong> {{ DetailAuditlog()?.ipAddress || 'N/A' }}
      </div>
      <div>
        <strong>Created At:</strong> {{ DetailAuditlog()?.createdAt | date:'HH:mm:ss - dd/MM/yyyy' }}
      </div>
      <div>
        <strong>User Email:</strong> {{ DetailAuditlog()?.userEmail || 'N/A' }}
      </div>
      <div>
        <strong>User Agent:</strong> {{ DetailAuditlog()?.userAgent || 'N/A' }}
      </div>
      <div>
        <strong>Endpoint:</strong> {{ DetailAuditlog()?.metadata?.endpoint || 'N/A' }}
      </div>
      <div>
        <strong>Method:</strong> {{ DetailAuditlog()?.metadata?.method || 'N/A' }}
      </div>
      <div>
        <strong>Response Time:</strong> {{ DetailAuditlog()?.metadata?.responseTime || 'N/A' }} ms
      </div>
    </div>
  </div>

  <div class="bg-white border rounded p-4 mt-4">
    <h2 class="text-lg font-semibold mb-2">Changed Fields</h2>
    <ng-container *ngIf="DetailAuditlog()?.changedFields?.length; else noChangedFields">
      <ul class="list-disc pl-5">
        <li *ngFor="let field of DetailAuditlog()?.changedFields">{{ field }}</li>
      </ul>
    </ng-container>
    <ng-template #noChangedFields>
      <span class="text-gray-500">No changed fields</span>
    </ng-template>
  </div>

  <div class="bg-white border rounded p-4 mt-4">
    <h2 class="text-lg font-semibold mb-2">Old Values</h2>
    <ng-container *ngIf="DetailAuditlog()?.oldValues; else noOldValues">
      <pre class="whitespace-pre-wrap">{{ DetailAuditlog()?.oldValues | json }}</pre>
    </ng-container>
    <ng-template #noOldValues>
      <span class="text-gray-500">No old values</span>
    </ng-template>
  </div>

  <div class="bg-white border rounded p-4 mt-4">
    <h2 class="text-lg font-semibold mb-2">New Values</h2>
    <ng-container *ngIf="DetailAuditlog()?.newValues; else noNewValues">
      <pre class="whitespace-pre-wrap">{{ DetailAuditlog()?.newValues | json }}</pre>
    </ng-container>
    <ng-template #noNewValues>
      <span class="text-gray-500">No new values</span>
    </ng-template>
  </div>

  <div *ngIf="DetailAuditlog()?.status === 'ERROR'" class="bg-red-50 border border-red-200 rounded p-4 mt-4">
    <h2 class="text-lg font-semibold mb-2 text-red-700">Error Details</h2>
    <div>
      <strong>Message:</strong> {{ DetailAuditlog()?.errorDetails?.message || 'N/A' }}
    </div>
    <div>
      <strong>Status Code:</strong> {{ DetailAuditlog()?.errorDetails?.statusCode || 'N/A' }}
    </div>
  </div>

</div>