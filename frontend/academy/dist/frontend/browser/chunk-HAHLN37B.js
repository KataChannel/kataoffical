import{a as z}from"./chunk-CIEKPUEE.js";import{a as G}from"./chunk-XDODLAE3.js";import{b as U}from"./chunk-NAZSWLQP.js";import{e as j}from"./chunk-TTUYA3IA.js";import"./chunk-WO6JBKZH.js";import"./chunk-KCHV3U57.js";import{a as _}from"./chunk-KDGR5RKS.js";import"./chunk-FLOPEQPR.js";import"./chunk-YWRND724.js";import{a as L}from"./chunk-IE2REWW5.js";import"./chunk-UNPR42CG.js";import"./chunk-2A2F2WSO.js";import"./chunk-4D4RNNXO.js";import{l as $}from"./chunk-Y2MGBHEY.js";import"./chunk-N33J6L7E.js";import"./chunk-AYFHUWB6.js";import{c as B}from"./chunk-ZUCVSP5M.js";import{b as O}from"./chunk-QLVEQRWO.js";import"./chunk-DZJMYHXN.js";import"./chunk-54PG2AAV.js";import"./chunk-PKTJEQ3B.js";import{c as H}from"./chunk-ZQFWJ2OQ.js";import{h as P}from"./chunk-IU4WBIK7.js";import"./chunk-E4XDAHCC.js";import{a as A,b as R}from"./chunk-EPSPETOK.js";import"./chunk-KDLSUHPH.js";import"./chunk-VR2W35LS.js";import"./chunk-CQ54KAN2.js";import"./chunk-43DN6HYK.js";import"./chunk-4VR3POOM.js";import"./chunk-QU4AVUAP.js";import"./chunk-SGYCFQGT.js";import"./chunk-7GYZWPAF.js";import{c as I,h as N}from"./chunk-NLC72BFZ.js";import"./chunk-5B7P4IWF.js";import"./chunk-FNL7TNJH.js";import"./chunk-EUNMJJRI.js";import{d as w}from"./chunk-A4U7PHZP.js";import{h as F,i as k,m as M,p as T}from"./chunk-MKGF5YGY.js";import{Eb as p,Ec as D,Gc as b,Hc as C,Jc as y,Lc as v,Ob as d,Sc as K,Yb as e,Zb as a,_b as S,ja as u,lb as o,uc as i,vc as s,wc as m,yb as E}from"./chunk-R6SUZUUA.js";import"./chunk-EU2KAMEK.js";import{j as x}from"./chunk-47CWAPKR.js";var Y=()=>["../"],Q=(h,n,t)=>({"bg-blue-100 text-blue-800":h,"bg-pink-100 text-pink-800":n,"bg-gray-100 text-gray-800":t}),X=(h,n)=>({"bg-green-100 text-green-800":h,"bg-red-100 text-red-800":n});function q(h,n){if(h&1&&(e(0,"tr",26)(1,"td",27)(2,"div",28)(3,"div",29),i(4),a(),e(5,"span",30),i(6),a()()(),e(7,"td",31),i(8),a(),e(9,"td",32),i(10),a()()),h&2){let t=n.$implicit,r=n.index;o(4),m(" ",r+1," "),o(2),s(t.name),o(2),s(t.total),o(2),s(t.branch)}}function J(h,n){if(h&1&&(e(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",36),i(4),a(),e(5,"div",5),i(6),a(),e(7,"div",37),i(8),a()(),e(9,"div",38)(10,"div",39),i(11),a(),e(12,"div",37),i(13),y(14,"date"),a()()()()),h&2){let t=n.$implicit;o(4),s(t.name),o(2),s(t.phone),o(2),s(t.serviceName),o(3),m(" ",t.branchName||"Chi nh\xE1nh ch\xEDnh"," "),o(2),m(" ",v(14,5,t.createdDate,"dd/MM/yyyy")," ")}}function W(h,n){if(h&1&&(e(0,"tr",40)(1,"td",41),i(2),a(),e(3,"td",42),i(4),a(),e(5,"td",42)(6,"span",43),i(7),a()(),e(8,"td",42)(9,"span",44),i(10),a()(),e(11,"td",42),i(12),a(),e(13,"td",42),i(14),y(15,"date"),a(),e(16,"td",42)(17,"span",43),i(18),a()()()),h&2){let t=n.$implicit;o(2),s(t.name),o(2),s(t.phone),o(2),d("ngClass",C(12,Q,t.gender==="Nam",t.gender==="N\u1EEF",!t.gender)),o(),m(" ",t.gender||"Ch\u01B0a x\xE1c \u0111\u1ECBnh"," "),o(3),m(" ",t.serviceName," "),o(2),s(t.branchName||t.branchId),o(2),s(v(15,9,t.createdDate,"dd/MM/yyyy")),o(3),d("ngClass",b(16,X,!t.isCancelled,t.isCancelled)),o(),m(" ",t.isCancelled?"\u0110\xE3 h\u1EE7y":"Ho\u1EA1t \u0111\u1ED9ng"," ")}}var V=class h{cdr=u(K);chartConfig={barChartTitle:"\u0110\u0103ng K\xFD Kh\xF3a H\u1ECDc Theo Th\u1EDDi Gian",pieChartTitle:"Ph\xE2n B\u1ED1 Kh\xF3a H\u1ECDc",barChart:{title:"\u0110\u0103ng K\xFD Kh\xF3a H\u1ECDc Theo Th\u1EDDi Gian",yAxisTitle:"S\u1ED1 L\u01B0\u1EE3t \u0110\u0103ng K\xFD",seriesName:"H\u1ECDc Vi\xEAn \u0110\u0103ng K\xFD",color:"#4CAF50"},pieChart:{title:"Ph\xE2n B\u1ED1 Theo Kh\xF3a H\u1ECDc",colors:["#4CAF50","#2196F3","#FF9800","#9C27B0","#E91E63","#F44336","#00BCD4","#3F51B5"]},labels:{dashboard:"B\u1EA3ng \u0111i\u1EC1u khi\u1EC3n",analytics:"Ph\xE2n t\xEDch kh\xF3a h\u1ECDc",totalCount:"T\u1ED5ng \u0111\u0103ng k\xFD",daysActive:"Ng\xE0y c\xF3 \u0111\u0103ng k\xFD",dailyAverage:"Trung b\xECnh/ng\xE0y",peakValue:"Cao nh\u1EA5t trong ng\xE0y",timeRange:"Kho\u1EA3ng th\u1EDDi gian",from:"T\u1EEB ng\xE0y",to:"\u0110\u1EBFn ng\xE0y",refreshData:"L\xE0m m\u1EDBi d\u1EEF li\u1EC7u",exportData:"Xu\u1EA5t d\u1EEF li\u1EC7u",loadingAnalytics:"\u0110ang t\u1EA3i d\u1EEF li\u1EC7u kh\xF3a h\u1ECDc...",errorLoadingData:"L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u kh\xF3a h\u1ECDc",noDataAvailable:"Kh\xF4ng c\xF3 \u0111\u0103ng k\xFD kh\xF3a h\u1ECDc",noDataMessage:"Kh\xF4ng c\xF3 \u0111\u0103ng k\xFD kh\xF3a h\u1ECDc trong kho\u1EA3ng th\u1EDDi gian \u0111\xE3 ch\u1ECDn. Th\u1EED \u0111i\u1EC1u ch\u1EC9nh b\u1ED9 l\u1ECDc ho\u1EB7c l\xE0m m\u1EDBi d\u1EEF li\u1EC7u.",categoryDistribution:"Ph\xE2n b\u1ED5 theo kh\xF3a h\u1ECDc",temporalAnalysis:"Ph\xE2n t\xEDch theo th\u1EDDi gian",categoryBreakdown:"Chi ti\u1EBFt kh\xF3a h\u1ECDc",peakDay:"Ng\xE0y \u0111\u0103ng k\xFD nhi\u1EC1u nh\u1EA5t",timeAnalytics:"Ph\xE2n t\xEDch th\u1EDDi gian",activeDays:"Ng\xE0y c\xF3 ho\u1EA1t \u0111\u1ED9ng",peakPerformanceDay:"Ng\xE0y hi\u1EC7u su\u1EA5t cao nh\u1EA5t",highestValue:"S\u1ED1 \u0111\u0103ng k\xFD cao nh\u1EA5t",dataInsights:"Th\xF4ng tin chi ti\u1EBFt kh\xF3a h\u1ECDc",detailedBreakdown:"Ph\xE2n t\xEDch chi ti\u1EBFt v\xE0 th\u1ED1ng k\xEA \u0111\u0103ng k\xFD"}};chartData={timeData:{},categoryData:{},totalCount:0};_UserService=u(_);_KhachhangService=u(G);_KhoahocService=u(L);profile=this._UserService.profile;pageSize=this._KhoahocService.pageSize;Khoahocs={data:[],totalRegistrations:0,activeCourses:0,conversionRate:0};ngOnInit(){return x(this,null,function*(){yield this._UserService.getProfile();let n=this.profile()?.referrals?.map(t=>t.phone);this.Khoahocs=yield this._KhoahocService.SearchBy({listphone:n,pageSize:9999}),console.log("Khoahocs:",this.Khoahocs),this.calculateStatistics(),this.processKhoahocDataForChart(),this.cdr.detectChanges()})}calculateStatistics(){this.Khoahocs.totalRegistrations=this.Khoahocs.data.length,this.Khoahocs.activeCourses=[...new Set(this.Khoahocs.data.map(t=>t.serviceName))].length;let n=this.Khoahocs.data.filter(t=>t.status==="active"||!t.isCancelled).length;this.Khoahocs.conversionRate=this.Khoahocs.totalRegistrations>0?(n/this.Khoahocs.totalRegistrations*100).toFixed(1):"0"}processKhoahocDataForChart(){let n=this.Khoahocs.data,t=n.reduce((c,l)=>{let g=new Date(l.createdDate||l.createdAt),f=`${g.getDate().toString().padStart(2,"0")}/${(g.getMonth()+1).toString().padStart(2,"0")}/${g.getFullYear()}`;return c[f]=(c[f]||0)+1,c},{}),r=n.reduce((c,l)=>{let g=l.serviceName||"Kh\xF4ng x\xE1c \u0111\u1ECBnh";return c[g]=(c[g]||0)+1,c},{});this.chartData={timeData:t,categoryData:r,totalCount:n.length}}getSummaryStats(){return{totalRegistrations:this.Khoahocs.totalRegistrations,activeCourses:this.Khoahocs.activeCourses,conversionRate:this.Khoahocs.conversionRate,averagePerDay:this.Khoahocs.totalRegistrations>0?Math.round(this.Khoahocs.totalRegistrations/30):0}}getTopCourses(n=5){let t=this.Khoahocs.data.reduce((r,c)=>{let l=c.serviceName||"Kh\xF4ng x\xE1c \u0111\u1ECBnh";return r[l]||(r[l]={name:l,total:0,branch:c.branchName||"Kh\xF4ng x\xE1c \u0111\u1ECBnh"}),r[l].total++,r},{});return Object.values(t).sort((r,c)=>c.total-r.total).slice(0,n)}refreshData(){return x(this,null,function*(){yield this.ngOnInit()})}exportData(){return{summary:this.getSummaryStats(),courses:this.Khoahocs.data,chartData:this.chartData,config:this.chartConfig,topCourses:this.getTopCourses()}}formatDate(n){return`${n.getDate().toString().padStart(2,"0")}/${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getFullYear()}`}static \u0275fac=function(t){return new(t||h)};static \u0275cmp=E({type:h,selectors:[["app-khoahoc"]],decls:62,vars:10,consts:[[1,"container","mx-auto","bg-gray-100"],[1,"flex","flex-row","space-x-2","mb-6","items-center"],["mat-icon-button","","color","primary",3,"routerLink"],[1,"flex","flex-col"],[1,"text-xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-600"],[3,"chartData","config","rawData","dateField","categoryField"],[1,"mt-8","grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"p-6","rounded-lg","shadow-md","bg-white"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-gray-400"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-gray-100","text-gray-700"],[1,"p-3","text-left"],[1,"p-3","text-center"],["class","border-b hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"space-y-3","max-h-96","overflow-y-auto"],["class","p-3 border rounded-lg hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"mt-8","p-6","bg-white","rounded-lg","shadow-md"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-200"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-700","uppercase","whitespace-nowrap"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"border-b","hover:bg-gray-50","transition-colors"],[1,"p-3"],[1,"flex","items-center","space-x-2"],[1,"w-6","h-6","rounded-full","bg-blue-100","flex","items-center","justify-center","text-xs","font-bold","text-blue-600"],[1,"font-medium"],[1,"p-3","text-center","font-semibold","text-green-600"],[1,"p-3","text-center","text-gray-600"],[1,"p-3","border","rounded-lg","hover:bg-gray-50","transition-colors"],[1,"flex","items-center","justify-between"],[1,"flex-1"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-right"],[1,"text-sm","font-medium","text-blue-600"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap","font-medium","text-gray-900"],[1,"px-6","py-4"],[1,"px-2","py-1","text-xs","rounded-full",3,"ngClass"],[1,"px-2","py-1","text-xs","bg-green-100","text-green-800","rounded-full"]],template:function(t,r){t&1&&(e(0,"div",0)(1,"header",1)(2,"button",2)(3,"mat-icon"),i(4,"arrow_back"),a()(),e(5,"div",3)(6,"span",4),i(7,"\u0110\u0103ng K\xFD Kh\xF3a H\u1ECDc"),a(),e(8,"span",5),i(9,"Qu\u1EA3n l\xFD v\xE0 ph\xE2n t\xEDch \u0111\u0103ng k\xFD kh\xF3a h\u1ECDc"),a()()(),S(10,"app-customchart",6),e(11,"div",7)(12,"div",8)(13,"div",9)(14,"h2",10),i(15,"Kh\xF3a H\u1ECDc Ph\u1ED5 Bi\u1EBFn"),a(),e(16,"mat-icon",11),i(17,"star"),a()(),e(18,"div",12)(19,"table",13)(20,"thead")(21,"tr",14)(22,"th",15),i(23,"T\xEAn Kh\xF3a H\u1ECDc"),a(),e(24,"th",16),i(25,"\u0110\u0103ng K\xFD"),a(),e(26,"th",16),i(27,"Chi Nh\xE1nh"),a()()(),e(28,"tbody"),p(29,q,11,4,"tr",17),a()()()(),e(30,"div",8)(31,"div",9)(32,"h2",10),i(33,"\u0110\u0103ng K\xFD G\u1EA7n \u0110\xE2y"),a(),e(34,"mat-icon",11),i(35,"schedule"),a()(),e(36,"div",18),p(37,J,15,8,"div",19),a()()(),e(38,"div",20)(39,"div",9)(40,"h2",10),i(41,"Chi Ti\u1EBFt \u0110\u0103ng K\xFD Kh\xF3a H\u1ECDc"),a()(),e(42,"div",12)(43,"table",21)(44,"thead",22)(45,"tr")(46,"th",23),i(47,"H\u1ECD T\xEAn"),a(),e(48,"th",23),i(49,"S\u1ED1 \u0110i\u1EC7n Tho\u1EA1i"),a(),e(50,"th",23),i(51,"Gi\u1EDBi T\xEDnh"),a(),e(52,"th",23),i(53,"Kh\xF3a H\u1ECDc"),a(),e(54,"th",23),i(55,"Chi Nh\xE1nh"),a(),e(56,"th",23),i(57,"Ng\xE0y \u0110\u0103ng K\xFD"),a(),e(58,"th",23),i(59,"Tr\u1EA1ng Th\xE1i"),a()()(),e(60,"tbody",24),p(61,W,19,19,"tr",25),a()()()()()),t&2&&(o(2),d("routerLink",D(9,Y)),o(8),d("chartData",r.chartData)("config",r.chartConfig)("rawData",r.Khoahocs.data)("dateField","createdDate")("categoryField","serviceName"),o(19),d("ngForOf",r.getTopCourses(5)),o(8),d("ngForOf",r.Khoahocs.data.slice(0,10)),o(24),d("ngForOf",r.Khoahocs.data))},dependencies:[B,P,H,O,j,$,U,R,A,N,I,w,T,F,k,M,z],encapsulation:2})};export{V as KhoahocComponent};
