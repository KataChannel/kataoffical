import{a as Y}from"./chunk-CIEKPUEE.js";import{a as V}from"./chunk-XDODLAE3.js";import{b as G}from"./chunk-NAZSWLQP.js";import{e as z}from"./chunk-TTUYA3IA.js";import"./chunk-WO6JBKZH.js";import"./chunk-KCHV3U57.js";import{a as k}from"./chunk-YOCWHFJM.js";import"./chunk-FLOPEQPR.js";import"./chunk-YWRND724.js";import{a as U}from"./chunk-UPQBSB5M.js";import"./chunk-UNPR42CG.js";import"./chunk-2A2F2WSO.js";import"./chunk-4D4RNNXO.js";import{l as j}from"./chunk-Y2MGBHEY.js";import"./chunk-N33J6L7E.js";import"./chunk-AYFHUWB6.js";import{b as K}from"./chunk-QLVEQRWO.js";import"./chunk-DZJMYHXN.js";import{c as P}from"./chunk-ZUCVSP5M.js";import"./chunk-54PG2AAV.js";import"./chunk-PKTJEQ3B.js";import{c as $}from"./chunk-ZQFWJ2OQ.js";import{h as O}from"./chunk-IU4WBIK7.js";import"./chunk-E4XDAHCC.js";import{a as R,b as H}from"./chunk-EPSPETOK.js";import"./chunk-KDLSUHPH.js";import"./chunk-VR2W35LS.js";import"./chunk-CQ54KAN2.js";import"./chunk-43DN6HYK.js";import"./chunk-4VR3POOM.js";import"./chunk-QU4AVUAP.js";import"./chunk-SGYCFQGT.js";import"./chunk-7GYZWPAF.js";import{c as I,h as _}from"./chunk-NLC72BFZ.js";import"./chunk-5B7P4IWF.js";import"./chunk-FNL7TNJH.js";import"./chunk-EUNMJJRI.js";import{d as A}from"./chunk-A4U7PHZP.js";import{h as M,i as w,m as N,p as B}from"./chunk-MKGF5YGY.js";import{Eb as f,Ec as b,Gc as C,Hc as E,Jc as L,Lc as F,Ob as l,Sc as T,Yb as e,Zb as n,_b as S,ja as u,lb as o,uc as r,vc as d,wc as g,yb as D}from"./chunk-R6SUZUUA.js";import"./chunk-EU2KAMEK.js";import{a as x,b as v,j as p}from"./chunk-47CWAPKR.js";var X=()=>["../"],q=(h,i,t)=>({"bg-green-100 text-green-800":h,"bg-yellow-100 text-yellow-800":i,"bg-red-100 text-red-800":t}),J=(h,i)=>({"text-green-600":h,"text-red-600":i});function W(h,i){if(h&1&&(e(0,"tr",20)(1,"td",21)(2,"div",22)(3,"div",23),r(4),n(),e(5,"span",24),r(6),n()()(),e(7,"td",25),r(8),n(),e(9,"td",26),r(10),n(),e(11,"td",16)(12,"span",27),r(13),n()()()),h&2){let t=i.$implicit,a=i.index;o(4),g(" ",a+1," "),o(2),d(t.name),o(2),d(t.total),o(2),d(t.successful),o(2),l("ngClass",E(6,q,+t.successRate>=80,+t.successRate>=60&&+t.successRate<80,+t.successRate<60)),o(),g(" ",t.successRate,"% ")}}function Z(h,i){if(h&1&&(e(0,"div",28)(1,"div",29)(2,"div",30)(3,"div",31),r(4),n(),e(5,"div",5),r(6),n(),e(7,"div",32),r(8),n()(),e(9,"div",33)(10,"div",34),r(11),n(),e(12,"div",32),r(13),L(14,"date"),n()()()()),h&2){let t=i.$implicit;o(4),d(t.custName),o(2),d(t.phone),o(2),d(t.branchName),o(2),l("ngClass",C(9,J,!t.isCancel,t.isCancel)),o(),g(" ",t.statusName," "),o(2),g(" ",F(14,6,t.createdAt,"dd/MM/yyyy")," ")}}var Q=class h{cdr=u(T);displayedColumns=["branchName","appointments","successRate","source"];startDay=new Date(new Date().setDate(new Date().getDate()-7));endDay=new Date;chartConfig={barChartTitle:"L\u01B0\u1EE3t H\u1EB9n Theo Th\u1EDDi Gian",pieChartTitle:"Ph\xE2n B\u1ED1 Ngu\u1ED3n H\u1EB9n",barChart:{title:"L\u01B0\u1EE3t H\u1EB9n Theo Th\u1EDDi Gian",yAxisTitle:"S\u1ED1 L\u01B0\u1EE3t H\u1EB9n",seriesName:"L\u01B0\u1EE3t H\u1EB9n \u0110\u1EBFn",color:"#4CAF50"},pieChart:{title:"Ph\xE2n B\u1ED1 Ngu\u1ED3n H\u1EB9n",colors:["#4CAF50","#2196F3","#FF9800","#9C27B0","#E91E63","#F44336","#00BCD4","#3F51B5"]},labels:{dashboard:"B\u1EA3ng \u0111i\u1EC1u khi\u1EC3n",analytics:"Ph\xE2n t\xEDch l\u01B0\u1EE3t h\u1EB9n",totalCount:"T\u1ED5ng l\u01B0\u1EE3t h\u1EB9n",daysActive:"Ng\xE0y c\xF3 l\u01B0\u1EE3t h\u1EB9n",dailyAverage:"Trung b\xECnh/ng\xE0y",peakValue:"Cao nh\u1EA5t trong ng\xE0y",timeRange:"Kho\u1EA3ng th\u1EDDi gian",from:"T\u1EEB ng\xE0y",to:"\u0110\u1EBFn ng\xE0y",refreshData:"L\xE0m m\u1EDBi d\u1EEF li\u1EC7u",exportData:"Xu\u1EA5t d\u1EEF li\u1EC7u",loadingAnalytics:"\u0110ang t\u1EA3i d\u1EEF li\u1EC7u l\u01B0\u1EE3t h\u1EB9n...",errorLoadingData:"L\u1ED7i khi t\u1EA3i d\u1EEF li\u1EC7u l\u01B0\u1EE3t h\u1EB9n",noDataAvailable:"Kh\xF4ng c\xF3 l\u01B0\u1EE3t h\u1EB9n",noDataMessage:"Kh\xF4ng c\xF3 l\u01B0\u1EE3t h\u1EB9n trong kho\u1EA3ng th\u1EDDi gian \u0111\xE3 ch\u1ECDn. Th\u1EED \u0111i\u1EC1u ch\u1EC9nh b\u1ED9 l\u1ECDc ho\u1EB7c l\xE0m m\u1EDBi d\u1EEF li\u1EC7u.",categoryDistribution:"Ph\xE2n b\u1ED5 theo ngu\u1ED3n",temporalAnalysis:"Ph\xE2n t\xEDch theo th\u1EDDi gian",categoryBreakdown:"Chi ti\u1EBFt ngu\u1ED3n h\u1EB9n",peakDay:"Ng\xE0y c\xF3 nhi\u1EC1u h\u1EB9n nh\u1EA5t",timeAnalytics:"Ph\xE2n t\xEDch th\u1EDDi gian",activeDays:"Ng\xE0y c\xF3 ho\u1EA1t \u0111\u1ED9ng",peakPerformanceDay:"Ng\xE0y hi\u1EC7u su\u1EA5t cao nh\u1EA5t",highestValue:"S\u1ED1 l\u01B0\u1EE3t h\u1EB9n cao nh\u1EA5t",dataInsights:"Th\xF4ng tin chi ti\u1EBFt l\u01B0\u1EE3t h\u1EB9n",detailedBreakdown:"Ph\xE2n t\xEDch chi ti\u1EBFt v\xE0 th\u1ED1ng k\xEA l\u01B0\u1EE3t h\u1EB9n"}};chartData={timeData:{},categoryData:{},totalCount:0};_UserService=u(k);_KhachhangService=u(V);_LichhenService=u(U);profile=this._UserService.profile;pageSize=this._LichhenService.pageSize;Lichhens={data:[],Thanhcong:0,Tonglich:0,Chinhanh:0};ngOnInit(){return p(this,null,function*(){yield this._UserService.getProfile();let i=this.profile()?.referrals?.map(t=>t.phone);this.Lichhens=yield this._LichhenService.SearchBy({listphone:i,pageSize:9999}),console.log("Lichhens:",this.Lichhens),this.Lichhens.Thanhcong=this.Lichhens.data.filter(t=>t.isCancel===!1).length,this.Lichhens.Tonglich=this.Lichhens.data.length,this.Lichhens.Chinhanh=[...new Set(this.Lichhens.data.map(t=>t.branchName))].length,this.processLichhenDataForChart(),this.cdr.detectChanges()})}processLichhenDataForChart(){let i=this.Lichhens.data,t=i.reduce((s,c)=>{let m=new Date(c.createdAt),y=`${m.getDate().toString().padStart(2,"0")}/${(m.getMonth()+1).toString().padStart(2,"0")}/${m.getFullYear()}`;return s[y]=(s[y]||0)+1,s},{}),a=i.reduce((s,c)=>{let m=c.sourceName||c.branchName||"Kh\xF4ng x\xE1c \u0111\u1ECBnh";return s[m]=(s[m]||0)+1,s},{});this.chartData={timeData:t,categoryData:a,totalCount:i.length}}getSummaryStats(){return{totalAppointments:this.Lichhens.Tonglich,successfulAppointments:this.Lichhens.Thanhcong,successRate:this.Lichhens.Tonglich>0?(this.Lichhens.Thanhcong/this.Lichhens.Tonglich*100).toFixed(1):"0",activeBranches:this.Lichhens.Chinhanh,dateRange:`${this.formatDate(this.startDay)} - ${this.formatDate(this.endDay)}`}}formatDate(i){return`${i.getDate().toString().padStart(2,"0")}/${(i.getMonth()+1).toString().padStart(2,"0")}/${i.getFullYear()}`}refreshData(){return p(this,null,function*(){yield this.ngOnInit()})}exportData(){return{summary:this.getSummaryStats(),appointments:this.Lichhens.data,chartData:this.chartData,config:this.chartConfig}}getTopBranches(i=5){let t=this.Lichhens.data.reduce((a,s)=>{let c=s.branchName||"Kh\xF4ng x\xE1c \u0111\u1ECBnh";return a[c]||(a[c]={name:c,total:0,successful:0,cancelled:0}),a[c].total++,s.isCancel?a[c].cancelled++:a[c].successful++,a},{});return Object.values(t).map(a=>v(x({},a),{successRate:a.total>0?(a.successful/a.total*100).toFixed(1):"0"})).sort((a,s)=>s.total-a.total).slice(0,i)}static \u0275fac=function(t){return new(t||h)};static \u0275cmp=D({type:h,selectors:[["app-luotden"]],decls:40,vars:9,consts:[[1,"container","mx-auto","bg-gray-100"],[1,"flex","flex-row","space-x-2","mb-6","items-center"],["mat-icon-button","","color","primary",3,"routerLink"],[1,"flex","flex-col"],[1,"text-xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-600"],[3,"chartData","config","rawData","dateField","categoryField"],[1,"mt-8","grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"p-6","rounded-lg","shadow-md","bg-white"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-gray-400"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-gray-100","text-gray-700"],[1,"p-3","text-left"],[1,"p-3","text-center"],["class","border-b hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"space-y-3","max-h-96","overflow-y-auto"],["class","p-3 border rounded-lg hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"border-b","hover:bg-gray-50","transition-colors"],[1,"p-3"],[1,"flex","items-center","space-x-2"],[1,"w-6","h-6","rounded-full","bg-blue-100","flex","items-center","justify-center","text-xs","font-bold","text-blue-600"],[1,"font-medium"],[1,"p-3","text-center","font-semibold"],[1,"p-3","text-center","text-green-600","font-semibold"],[1,"px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"p-3","border","rounded-lg","hover:bg-gray-50","transition-colors"],[1,"flex","items-center","justify-between"],[1,"flex-1"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-right"],[1,"text-sm","font-medium",3,"ngClass"]],template:function(t,a){t&1&&(e(0,"div",0)(1,"header",1)(2,"button",2)(3,"mat-icon"),r(4,"arrow_back"),n()(),e(5,"div",3)(6,"span",4),r(7,"B\u1EA3ng \u0110i\u1EC1u Khi\u1EC3n L\u01B0\u1EE3t H\u1EB9n \u0110\u1EBFn Chi Nh\xE1nh"),n(),e(8,"span",5),r(9,"Qu\u1EA3n l\xFD v\xE0 ph\xE2n t\xEDch l\u01B0\u1EE3t h\u1EB9n kh\xE1ch h\xE0ng"),n()()(),S(10,"app-customchart",6),e(11,"div",7)(12,"div",8)(13,"div",9)(14,"h2",10),r(15,"Chi Nh\xE1nh H\xE0ng \u0110\u1EA7u"),n(),e(16,"mat-icon",11),r(17,"leaderboard"),n()(),e(18,"div",12)(19,"table",13)(20,"thead")(21,"tr",14)(22,"th",15),r(23,"T\xEAn Chi Nh\xE1nh"),n(),e(24,"th",16),r(25,"T\u1ED5ng H\u1EB9n"),n(),e(26,"th",16),r(27,"Th\xE0nh C\xF4ng"),n(),e(28,"th",16),r(29,"T\u1EF7 L\u1EC7"),n()()(),e(30,"tbody"),f(31,W,14,10,"tr",17),n()()()(),e(32,"div",8)(33,"div",9)(34,"h2",10),r(35,"L\u01B0\u1EE3t H\u1EB9n G\u1EA7n \u0110\xE2y"),n(),e(36,"mat-icon",11),r(37,"schedule"),n()(),e(38,"div",18),f(39,Z,15,12,"div",19),n()()()()),t&2&&(o(2),l("routerLink",b(8,X)),o(8),l("chartData",a.chartData)("config",a.chartConfig)("rawData",a.Lichhens.data)("dateField","createdAt")("categoryField","branchName"),o(21),l("ngForOf",a.getTopBranches(5)),o(8),l("ngForOf",a.Lichhens.data.slice(0,10)))},dependencies:[P,O,$,K,z,j,G,H,R,_,I,A,B,M,w,N,Y],encapsulation:2})};export{Q as LuotdenComponent};
