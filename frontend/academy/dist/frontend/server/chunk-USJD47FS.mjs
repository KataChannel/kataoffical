import './polyfills.server.mjs';
import{a as R}from"./chunk-IN4EAQS4.mjs";import{a as P}from"./chunk-KFDDXHVV.mjs";import"./chunk-BHSUXMGO.mjs";import"./chunk-XYW3N2TH.mjs";import"./chunk-WZNDKZHB.mjs";import{a as _,b as U}from"./chunk-ZO5BTQX6.mjs";import"./chunk-CHLRJVWI.mjs";import"./chunk-73IBRO6I.mjs";import"./chunk-FW423F55.mjs";import"./chunk-RBBE3QCJ.mjs";import"./chunk-HBVR6GXD.mjs";import{c as L,h as F}from"./chunk-IRRE6H53.mjs";import"./chunk-UE4SGS3X.mjs";import"./chunk-KLKELR3G.mjs";import{e as A}from"./chunk-YL66THYG.mjs";import{r as C}from"./chunk-TS5YM2X4.mjs";import{$b as B,Ab as b,Ac as h,Bc as T,Ic as k,Sb as v,Tb as S,Ub as E,_b as w,ac as t,bc as e,cc as r,ja as x,ld as D,nb as o,yc as n,zc as f}from"./chunk-LCAOUERI.mjs";import"./chunk-KB5IWD3E.mjs";import{j as p}from"./chunk-RIAI3ORJ.mjs";var N=()=>["../"],j=(g,l)=>l.key;function O(g,l){if(g&1&&(t(0,"div")(1,"div",66)(2,"span",67),n(3),e(),t(4,"span",68),n(5),e()(),t(6,"div",69),r(7,"div",70),e()()),g&2){let i=l.$implicit;o(3),T("",i.key," (",i==null||i.value==null?null:i.value.count," )"),o(),E("text-blue-600",i.key==="Unknown")("text-green-600",i.key==="website")("text-teal-500",i.key==="whatsapp"),o(),h(" ",i==null||i.value==null?null:i.value.ratio," "),o(2),S("width",i==null||i.value==null?null:i.value.ratio),E("bg-blue-600",i.key==="Unknown")("bg-green-600",i.key==="website")("bg-teal-500",i.key==="whatsapp")}}var I=class g{_TrackingService=x(R);_UserService=x(P);profile=this._UserService.profile;ListTracking=this._TrackingService.ListTracking;Unique=0;BounceRate=0;groupedByPlatform=[];constructor(){D(()=>p(this,null,function*(){yield this._UserService.getProfile(),yield this._TrackingService.getTrackingBy({refCode:this.profile().phone,eventType:"page_view"})}))}ngOnInit(){return p(this,null,function*(){yield this._TrackingService.getTrackingBy({refCode:this.profile().phone,eventType:"page_view"}),console.log(this.ListTracking()),this.Unique=this.ListTracking().reduce((a,u)=>(a.includes(u.ipAddress)||a.push(u.ipAddress),a),[]).length,console.log("Unique IPs:",this.Unique),this.BounceRate=this.calculateBounceRate(this.ListTracking()),console.log("Bounce Rate:",this.BounceRate);let l=this.ListTracking().length,i=this.ListTracking().reduce((a,u)=>{let m=u.sharePlatform||"Unknown";return a[m]=(a[m]||0)+1,a},{});this.groupedByPlatform=Object.entries(i).reduce((a,[u,m])=>(a.push({key:u,value:{count:m,ratio:l?(m/l*100).toFixed(2)+"%":"0%"}}),a),[]),console.log("Tracking events grouped by sharePlatform with counts and ratios:",this.groupedByPlatform)})}calculateBounceRate(l){l.sort((d,s)=>new Date(d.createdAt).getTime()-new Date(s.createdAt).getTime());let i=[],a=[],u=null,m=30*60*1e3,M=(d,s)=>d.ipAddress===s.ipAddress&&d.userAgent===s.userAgent;l.forEach(d=>{let s=new Date(d.createdAt);!u||s.getTime()-u.getTime()<=m&&M(d,l[a[0]])?a.push(l.indexOf(d)):(i.push(a),a=[l.indexOf(d)]),u=s}),a.length>0&&i.push(a);let y=i.filter(d=>d.length===1).length,c=i.length,q=c>0?y/c*100:0;return{totalSessions:c,bouncedSessions:y,bounceRate:q.toFixed(2)}}static \u0275fac=function(i){return new(i||g)};static \u0275cmp=b({type:g,selectors:[["app-luottruycap"]],decls:168,vars:5,consts:[[1,"container","mx-auto","md:p-8"],[1,"flex","flex-row","space-x-2","mb-6"],["mat-icon-button","","color","primary",3,"routerLink"],[1,"flex","flex-col"],[1,"text-xl","font-bold","text-gray-800"],[1,"text-gray-600"],[1,"mb-8","p-4","bg-white","rounded-lg","shadow"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between"],[1,"text-lg","font-semibold","text-gray-700","mb-3","sm:mb-0"],[1,"flex","flex-row","items-center","gap-2"],["id","filterDay",1,"date-filter-button","bg-gray-200","hover:bg-gray-300","text-gray-700","font-medium","p-2","rounded-md","text-sm"],[1,"fas","fa-calendar-day","mr-2"],["id","filterMonth",1,"date-filter-button","bg-gray-200","hover:bg-gray-300","text-gray-700","font-medium","p-2","rounded-md","text-sm","active"],[1,"fas","fa-calendar-alt","mr-2"],["id","filterCustom",1,"date-filter-button","bg-gray-200","hover:bg-gray-300","text-gray-700","font-medium","p-2","rounded-md","text-sm"],[1,"fas","fa-calendar-edit","mr-2"],["id","customDateRange",1,"mt-4","hidden"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","items-end"],["for","startDate",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","date","id","startDate","name","startDate",1,"date-input","mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","sm:text-sm","p-2"],["for","endDate",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","date","id","endDate","name","endDate",1,"date-input","mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","sm:text-sm","p-2"],["id","applyCustomDate",1,"bg-indigo-600","hover:bg-indigo-700","text-white","font-medium","p-2","rounded-md","text-sm","h-10","md:mt-0","mt-4"],[1,"fas","fa-check","mr-2"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6","mb-8"],[1,"metric-card","bg-white","p-6","rounded-lg","shadow-md"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-500"],[1,"text-3xl","font-bold","text-indigo-600"],[1,"bg-indigo-100","p-3","rounded-full"],[1,"fas","fa-eye","fa-2x","text-indigo-600"],[1,"text-xs","text-green-500","mt-2","flex","items-center"],[1,"fas","fa-arrow-up","mr-1"],[1,"text-3xl","font-bold","text-green-600"],[1,"bg-green-100","p-3","rounded-full"],[1,"fas","fa-users","fa-2x","text-green-600"],[1,"text-3xl","font-bold","text-red-600"],[1,"bg-red-100","p-3","rounded-full"],[1,"fas","fa-sign-out-alt","fa-2x","text-red-600"],[1,"text-xs","text-red-500","mt-2","flex","items-center"],[1,"lg:col-span-2","bg-white","p-6","rounded-lg","shadow-md"],[1,"text-xl","font-semibold","text-gray-700","mb-4"],[1,"chart-placeholder","h-64","md:h-80"],[1,"text-center"],[1,"bg-white","p-6","rounded-lg","shadow-md"],[1,"space-y-4"],[1,"chart-placeholder","h-40","mt-6"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","text-gray-900"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full","bg-green-100","text-green-800"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-green-500"],[1,"fas","fa-arrow-up"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full","bg-yellow-100","text-yellow-800"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],[1,"fas","fa-minus"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full","bg-red-100","text-red-800"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-red-500"],[1,"fas","fa-arrow-down"],[1,"mt-12","text-center","text-sm","text-gray-500"],["id","currentYear"],[1,"fas","fa-heart","text-red-500"],[1,"flex","justify-between","mb-1"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-sm","font-medium"],[1,"w-full","bg-gray-200","rounded-full","h-2.5"],[1,"h-2.5","rounded-full"]],template:function(i,a){i&1&&(t(0,"div",0)(1,"header",1)(2,"button",2)(3,"mat-icon"),n(4,"arrow_back"),e()(),t(5,"div",3)(6,"span",4),n(7,"Landing Page"),e(),t(8,"span",5),n(9,"T\u1ED5ng quan hi\u1EC7u su\u1EA5t c\xE1c trang \u0111\xEDch c\u1EE7a b\u1EA1n."),e()()(),t(10,"section",6)(11,"div",7)(12,"h2",8),n(13,"Ch\u1ECDn Khung Th\u1EDDi Gian"),e(),t(14,"div",9)(15,"button",10),r(16,"i",11),n(17,"1 Ng\xE0y "),e(),t(18,"button",12),r(19,"i",13),n(20,"1 Th\xE1ng "),e(),t(21,"button",14),r(22,"i",15),n(23,"T\xF9y Ch\u1EC9nh "),e()()(),t(24,"div",16)(25,"div",17)(26,"div")(27,"label",18),n(28,"T\u1EEB ng\xE0y"),e(),r(29,"input",19),e(),t(30,"div")(31,"label",20),n(32,"\u0110\u1EBFn ng\xE0y"),e(),r(33,"input",21),e(),t(34,"button",22),r(35,"i",23),n(36,"\xC1p D\u1EE5ng "),e()()()(),t(37,"main")(38,"section",24)(39,"div",25)(40,"div",26)(41,"div")(42,"p",27),n(43,"T\u1ED5ng L\u01B0\u1EE3t Truy C\u1EADp"),e(),t(44,"p",28),n(45),e()(),t(46,"div",29),r(47,"i",30),e()(),t(48,"p",31),r(49,"i",32),n(50," 12.5% so v\u1EDBi k\u1EF3 tr\u01B0\u1EDBc "),e()(),t(51,"div",25)(52,"div",26)(53,"div")(54,"p",27),n(55,"Kh\xE1ch Truy C\u1EADp Duy Nh\u1EA5t"),e(),t(56,"p",33),n(57),e()(),t(58,"div",34),r(59,"i",35),e()(),t(60,"p",31),r(61,"i",32),n(62," 8.2% so v\u1EDBi k\u1EF3 tr\u01B0\u1EDBc "),e()(),t(63,"div",25)(64,"div",26)(65,"div")(66,"p",27),n(67,"T\u1EF7 L\u1EC7 Tho\xE1t"),e(),t(68,"p",36),n(69),e()(),t(70,"div",37),r(71,"i",38),e()(),t(72,"p",39),r(73,"i",32),n(74," 1.5% so v\u1EDBi k\u1EF3 tr\u01B0\u1EDBc "),e()()(),t(75,"section",24)(76,"div",40)(77,"h2",41),n(78,"Ngu\u1ED3n L\u01B0u L\u01B0\u1EE3ng Truy C\u1EADp"),e(),t(79,"div",42)(80,"p",43),n(81,"Bi\u1EC3u \u0111\u1ED3 ngu\u1ED3n l\u01B0u l\u01B0\u1EE3ng s\u1EBD \u0111\u01B0\u1EE3c hi\u1EC3n th\u1ECB \u1EDF \u0111\xE2y."),e()()(),t(82,"div",44)(83,"h2",41),n(84,"Ph\xE2n Lo\u1EA1i N\u1EC1n T\u1EA3ng"),e(),t(85,"div",45),w(86,O,8,17,"div",null,j),e(),t(88,"div",46)(89,"p",43),n(90,"Bi\u1EC3u \u0111\u1ED3 tr\xF2n ph\xE2n lo\u1EA1i thi\u1EBFt b\u1ECB."),e()()()(),t(91,"section",44)(92,"h2",41),n(93,"Landing Pages H\xE0ng \u0110\u1EA7u"),e(),t(94,"div",47)(95,"table",48)(96,"thead",49)(97,"tr")(98,"th",50),n(99," T\xEAn Trang "),e(),t(100,"th",50),n(101," L\u01B0\u1EE3t Truy C\u1EADp "),e(),t(102,"th",50),n(103," T\u1EF7 L\u1EC7 Chuy\u1EC3n \u0110\u1ED5i "),e(),t(104,"th",50),n(105," Xu H\u01B0\u1EDBng "),e()()(),t(106,"tbody",51)(107,"tr")(108,"td",52)(109,"div",53),n(110,"/landing/khuyen-mai-he"),e()(),t(111,"td",52)(112,"div",53),n(113,"25,300"),e()(),t(114,"td",52)(115,"span",54),n(116," 15.2% "),e()(),t(117,"td",55),r(118,"i",56),n(119," T\u0103ng "),e()(),t(120,"tr")(121,"td",52)(122,"div",53),n(123,"/landing/san-pham-moi"),e()(),t(124,"td",52)(125,"div",53),n(126,"18,750"),e()(),t(127,"td",52)(128,"span",54),n(129," 10.5% "),e()(),t(130,"td",55),r(131,"i",56),n(132," T\u0103ng "),e()(),t(133,"tr")(134,"td",52)(135,"div",53),n(136,"/landing/dang-ky-nhan-tin"),e()(),t(137,"td",52)(138,"div",53),n(139,"12,100"),e()(),t(140,"td",52)(141,"span",57),n(142," 8.1% "),e()(),t(143,"td",58),r(144,"i",59),n(145," \u1ED4n \u0111\u1ECBnh "),e()(),t(146,"tr")(147,"td",52)(148,"div",53),n(149,"/landing/uu-dai-dac-biet"),e()(),t(150,"td",52)(151,"div",53),n(152,"9,800"),e()(),t(153,"td",52)(154,"span",60),n(155," 5.3% "),e()(),t(156,"td",61),r(157,"i",62),n(158," Gi\u1EA3m "),e()()()()()()(),t(159,"footer",63)(160,"p"),n(161,"\xA9 "),r(162,"span",64),n(163," C\xF4ng Ty C\u1ED5 Ph\u1EA7n ABC. B\u1EA3o l\u01B0u m\u1ECDi quy\u1EC1n."),e(),t(164,"p"),n(165,"Dashboard \u0111\u01B0\u1EE3c thi\u1EBFt k\u1EBF v\u1EDBi "),r(166,"i",65),n(167," b\u1EDFi Nh\xF3m Ph\xE1t Tri\u1EC3n."),e()()()),i&2&&(o(2),v("routerLink",k(4,N)),o(43),f(a.ListTracking().length),o(12),f(a.Unique),o(12),h("",a.BounceRate.bounceRate,"%"),o(17),B(a.groupedByPlatform))},dependencies:[F,L,U,_,A,C],encapsulation:2})};export{I as LuottruycapComponent};
