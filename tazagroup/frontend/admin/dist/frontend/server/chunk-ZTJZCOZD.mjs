import './polyfills.server.mjs';
import{a as j}from"./chunk-A2S4MP2M.mjs";import{a as G}from"./chunk-VRNVQVFS.mjs";import"./chunk-CHLRJVWI.mjs";import"./chunk-73IBRO6I.mjs";import"./chunk-Z737B2UH.mjs";import{a as N}from"./chunk-TVHPOFGR.mjs";import{c as X,f as Y,h as Z}from"./chunk-N3WMCL45.mjs";import"./chunk-CREX4RSV.mjs";import"./chunk-WZNDKZHB.mjs";import"./chunk-KANEWG3T.mjs";import{a as z}from"./chunk-5GCODM36.mjs";import"./chunk-ZPDI4CY6.mjs";import"./chunk-RBBE3QCJ.mjs";import"./chunk-VSZQVMKK.mjs";import"./chunk-XP7XFBNN.mjs";import"./chunk-JU6I7WJX.mjs";import{d as M,e as W}from"./chunk-6EJ73YDZ.mjs";import"./chunk-RQ6E63D4.mjs";import{b as q,g as H,j as J,n as Q,p as $,q as ee,u as te,v as ie,x as ne,y as ae}from"./chunk-A5N7QCHU.mjs";import"./chunk-34MH7FUK.mjs";import"./chunk-GHGG3UQP.mjs";import{a as w,b as K}from"./chunk-STYRF6RJ.mjs";import"./chunk-GQE37IB4.mjs";import{a as O}from"./chunk-HEXCONHZ.mjs";import"./chunk-E7RUSUK7.mjs";import"./chunk-KHOVWPMH.mjs";import{a as F,d as R}from"./chunk-QFRV3ESJ.mjs";import{K as V,m as B,q as T}from"./chunk-MAUXFLOO.mjs";import{$b as n,Dc as y,Ec as x,Fb as _,Fc as S,Ic as D,Ob as C,Pb as k,Qc as P,Rb as g,ac as a,bc as b,fc as v,ia as s,jb as A,jc as h,kc as c,ld as I,nb as u,ra as f,sa as m,vc as L,wc as o,zb as E}from"./chunk-M7S6MLVJ.mjs";import"./chunk-KB5IWD3E.mjs";import{j as d}from"./chunk-RIAI3ORJ.mjs";var oe=()=>[B,M,w],le=()=>[te,$,ee,M,w,ne,q,H,J],U=()=>({standalone:!0});function se(r,t){if(r&1&&b(0,"iframe",6),r&2){let e=c(2);g("src",e.SafeUrl,A)}}function ce(r,t){if(r&1){let e=v();n(0,"div",2),_(1,se,1,1,"iframe",3),a(),n(2,"div",4)(3,"button",5),h("click",function(){f(e);let i=c(),l=L(5);return m(i.openDangkyDialog(l))}),n(4,"mat-icon"),o(5,"how_to_reg"),a(),n(6,"span"),o(7,"\u0110\u0103ng K\xFD"),a()()()}if(r&2){let e=c();u(),g("ngIf",e.SafeUrl)}}function pe(r,t){if(r&1){let e=v();n(0,"div",8)(1,"div",9)(2,"mat-form-field",10)(3,"mat-label"),o(4,"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i"),a(),n(5,"input",11),S("ngModelChange",function(i){f(e);let l=c(2);return x(l.User.phone,i)||(l.User.phone=i),m(i)}),a(),n(6,"mat-icon",12),o(7,"call"),a()(),n(8,"mat-form-field",10)(9,"mat-label"),o(10,"Email"),a(),n(11,"input",11),S("ngModelChange",function(i){f(e);let l=c(2);return x(l.User.email,i)||(l.User.email=i),m(i)}),a(),n(12,"mat-icon",12),o(13,"email"),a()(),n(14,"mat-form-field",10)(15,"mat-label"),o(16,"M\u1EADt kh\u1EA9u"),a(),n(17,"input",13),h("keyup.enter",function(){f(e);let i=c(2);return m(i.Dangky())}),S("ngModelChange",function(i){f(e);let l=c(2);return x(l.User.password,i)||(l.User.password=i),m(i)}),a(),n(18,"mat-icon",12),o(19,"lock"),a()(),n(20,"div")(21,"button",14),h("click",function(){f(e);let i=c(2);return m(i.Dangky())}),n(22,"span",15)(23,"mat-icon"),o(24,"how_to_reg"),a(),n(25,"span"),o(26,"\u0110\u0103ng K\xFD"),a()()()()()()}if(r&2){let e=c(2);u(5),y("ngModel",e.User.phone),g("ngModelOptions",D(9,U))("placeholder","S\u1ED1 \u0111i\u1EC7n tho\u1EA1i"),u(6),y("ngModel",e.User.email),g("ngModelOptions",D(10,U))("placeholder","Email"),u(6),y("ngModel",e.User.password),g("ngModelOptions",D(11,U))("placeholder","M\u1EADt kh\u1EA9u")}}function fe(r,t){r&1&&(n(0,"mat-dialog-content")(1,"div",7),_(2,pe,27,12),C(3,2,le),k(),a()())}var re=class r{_LandingpageService=s(G);_AffiliatelinkService=s(j);_UserService=s(N);_StorageService=s(O);sanitizer=s(V);DetailLandingpage=this._LandingpageService.DetailLandingpage;LinkAffiliate=this._AffiliatelinkService.ListAffiliatelink;Profile;SafeUrl;affiliateCode;_route=s(F);_router=s(R);_dialog=s(X);_snackBar=s(z);constructor(){I(()=>d(this,null,function*(){this._StorageService.getItem("token")&&(yield this._UserService.getProfile(),this.Profile=this._UserService.profile()),this._route.paramMap.subscribe(t=>d(this,null,function*(){let e=t.get("slug");yield this._LandingpageService.getLandingpageBy({slug:e}),this.SafeUrl=this.SecurityTrustUrl(this.DetailLandingpage().contentHtml)})),this._route.queryParamMap.subscribe(t=>{let e=t.get("ref");e&&(this.affiliateCode=e,console.log("Affiliate ref code:",this.affiliateCode),this._AffiliatelinkService.Tracking(this.affiliateCode))})}))}ngOnInit(){this._AffiliatelinkService.listenAffiliatelinkUpdates()}getAffiliateLink(t){console.log(t);let e=this.LinkAffiliate().find(i=>i.landingPageId==t.id);return console.log("affiliateLink",e),e?e?.landingPage?.slug+"/?ref="+e.codeId:null}SecurityTrustUrl(t){return this.sanitizer.bypassSecurityTrustResourceUrl(t)}CreateAffiliateLink(t){return d(this,null,function*(){console.log(t),this.Profile.id;let e={landingPageId:t.id,createdById:this.Profile.id};yield this._AffiliatelinkService.CreateAffiliatelink(e),yield this._AffiliatelinkService.getAffiliateListBy({createdById:this.Profile.id}),console.log(this._AffiliatelinkService.ListAffiliatelink())})}CopyLinkAffiliate(t){}SharedAffiliate(t){}onRegister(){}openDangkyDialog(t){if(this.Profile){this._snackBar.open("B\u1EA1n \u0111ang l\xE0 th\xE0nh vi\xEAn","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-warning"]});return}this._dialog.open(t,{hasBackdrop:!0,disableClose:!1}).afterClosed().subscribe(p=>{p=="true"&&this.onRegister()})}loginGoogle(){this._UserService.loginWithGoogle()}User={};Dangky(){return d(this,null,function*(){if(this.User.affiliateCode=this.affiliateCode,(this.User.phone&&this.User.phone!==""||this.User.email&&this.User.email!=="")&&this.User.password&&this.User.password!=="")try{this._UserService.register(this.User).then(t=>{console.log(t),t&&t.statusCode==201&&(this._snackBar.open("\u0110\u0103ng k\xFD th\xE0nh c\xF4ng","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-success"]}),setTimeout(()=>{this._dialog.closeAll(),this._router.navigate(["/welcome"])},1e3))})}catch(t){console.error("Login error:",t)}else this._snackBar.open("Vui l\xF2ng \u0111i\u1EC1n \u0111\u1EE7 th\xF4ng tin","",{duration:1e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["snackbar-error"]})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-detaillandingpage"]],decls:6,vars:0,consts:[["DangkyDialog",""],[1,"h-screen","flex","flex-col","space-y-2","container","mx-auto"],[1,"iframe-container"],["width","100%","class","h-screen-20","frameborder","0",3,"src",4,"ngIf"],[1,"flex","flex-row","justify-center","space-x-2"],["mat-flat-button","","color","primary",1,"flex","flex-row","space-x-1",3,"click"],["width","100%","frameborder","0",1,"h-screen-20",3,"src"],[1,"flex","flex-col","space-y-8","items-center","justify-center"],[1,"relative","min-w-96","h-full","flex","flex-col","p-8"],[1,"transition","duration-100","relative","flex","flex-col","space-y-6","items-center","mx-auto","lg:max-w-lg","w-full"],["subscriptSizing","dynamic","appearance","outline",1,"w-full"],["type","text","matInput","",1,"w-full",3,"ngModelChange","ngModel","ngModelOptions","placeholder"],["matPrefix","",1,"material-symbols-outlined"],["type","password","matInput","",1,"w-full",3,"keyup.enter","ngModelChange","ngModel","ngModelOptions","placeholder"],["color","primary","mat-flat-button","",3,"click"],[1,"flex","flex-row","space-x-1"]],template:function(e,p){e&1&&(n(0,"div",1),_(1,ce,8,1),C(2,1,oe),k(),a(),_(4,fe,5,0,"ng-template",null,0,P))},dependencies:[T,ie,W,K,ae,Q,Z,Y],encapsulation:2})};export{re as DetaillandingpageComponent};
