/// prisma/spa.prisma (Spa Service)
datasource db { provider = "postgresql"; url = env("SPA_DATABASE_URL"); }
generator client { provider = "prisma-client-js"; output = "../node_modules/.prisma/client-spa"; previewFeatures = ["extendedWhereUnique"]; }
enum AppointmentStatus { SCHEDULED CONFIRMED CHECKED_IN COMPLETED CANCELLED NO_SHOW } enum PaymentStatus { UNPAID PAID PARTIALLY_PAID REFUNDED }
model Client { id String @id @default(uuid()); customerId String @unique; preferences String?; allergies String?; createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; appointments Appointment[]; memberships Membership[]; activities Activity[] @relation("ActivityClients"); @@map("clients"); }
model SpaService { id String @id @default(uuid()); name String @unique; durationMin Int; price Decimal; isActive Boolean @default(true); createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; appointments AppointmentService[]; @@map("spa_services"); }
model Therapist { id String @id @default(uuid()); employeeId String? @unique; firstName String; lastName String; isActive Boolean @default(true); createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; appointments Appointment[]; @@map("therapists"); }
model Appointment { id String @id @default(uuid()); clientId String; client Client @relation(fields: [clientId], references: [id], onDelete: Restrict); startTime DateTime; endTime DateTime; therapistId String?; therapist Therapist? @relation(fields: [therapistId], references: [id], onDelete: SetNull); status AppointmentStatus @default(SCHEDULED); totalAmount Decimal?; paymentStatus PaymentStatus? @default(UNPAID); createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; services AppointmentService[]; activities Activity[] @relation("ActivityAppointments"); @@index([clientId]); @@index([therapistId]); @@index([startTime]); @@map("appointments"); }
model AppointmentService { appointmentId String; appointment Appointment @relation(fields: [appointmentId], references: [id], onDelete: Cascade); serviceId String; service SpaService @relation(fields: [serviceId], references: [id], onDelete: Restrict); @@id([appointmentId, serviceId]); @@map("appointment_services"); }
model Membership { id String @id @default(uuid()); clientId String; client Client @relation(fields: [clientId], references: [id], onDelete: Cascade); packageName String; startDate DateTime; endDate DateTime?; createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; @@index([clientId]); @@map("memberships"); }
model Activity { id String @id @default(uuid()); subject String; type String; status String @default("OPEN"); dueDate DateTime?; description String?; ownerId String; clientId String?; client Client? @relation("ActivityClients", fields: [clientId], references: [id], onDelete: Cascade); appointmentId String?; appointment Appointment? @relation("ActivityAppointments", fields: [appointmentId], references: [id], onDelete: Cascade); createdAt DateTime @default(now()); updatedAt DateTime @updatedAt; @@index([ownerId]); @@index([clientId]); @@index([appointmentId]); @@map("activities"); }